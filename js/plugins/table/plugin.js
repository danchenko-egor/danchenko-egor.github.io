(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const t=(e,t,o)=>{var l;return!!o(e,t.prototype)||(null===(l=e.constructor)||void 0===l?void 0:l.name)===t.name},o=e=>{const o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&t(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":o},l=e=>t=>o(t)===e,n=e=>t=>typeof t===e,r=e=>t=>e===t,a=l("string"),s=l("array"),c=n("boolean"),i=r(void 0),m=e=>null===e||void 0===e,d=e=>!m(e),u=n("function"),p=n("number"),b=()=>{},g=(e,t)=>o=>e(t(o)),h=e=>()=>e,f=e=>e,y=(e,t)=>e===t;function w(e,...t){return(...o)=>{const l=t.concat(o);return e.apply(null,l)}}const S=e=>{e()},C=h(!1),v=h(!0);class T{constructor(e,t){this.tag=e,this.value=t}static some(e){return new T(!0,e)}static none(){return T.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?T.some(e(this.value)):T.none()}bind(e){return this.tag?e(this.value):T.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:T.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!==e&&void 0!==e?e:"Called getOrDie on None")}static from(e){return d(e)?T.some(e):T.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}T.singletonNone=new T(!1);const x=Object.keys,A=Object.hasOwnProperty,R=(e,t)=>{const o=x(e);for(let l=0,n=o.length;l<n;l++){const n=o[l],r=e[n];t(r,n)}},O=e=>(t,o)=>{e[o]=t},_=(e,t,o,l)=>{R(e,((e,n)=>{(t(e,n)?o:l)(e,n)}))},I=(e,t)=>{const o={};return _(e,t,O(o),b),o},D=(e,t)=>{const o=[];return R(e,((e,l)=>{o.push(t(e,l))})),o},M=e=>D(e,f),N=e=>x(e).length,P=(e,t)=>k(e,t)?T.from(e[t]):T.none(),k=(e,t)=>A.call(e,t),B=(e,t)=>k(e,t)&&void 0!==e[t]&&null!==e[t],E=Array.prototype.indexOf,F=Array.prototype.push,q=(e,t)=>E.call(e,t),j=(e,t)=>q(e,t)>-1,L=(e,t)=>{for(let o=0,l=e.length;o<l;o++){const l=e[o];if(t(l,o))return!0}return!1},H=(e,t)=>{const o=[];for(let l=0;l<e;l++)o.push(t(l));return o},V=(e,t)=>{const o=e.length,l=new Array(o);for(let n=0;n<o;n++){const o=e[n];l[n]=t(o,n)}return l},$=(e,t)=>{for(let o=0,l=e.length;o<l;o++){const l=e[o];t(l,o)}},z=(e,t)=>{for(let o=e.length-1;o>=0;o--){const l=e[o];t(l,o)}},W=(e,t)=>{const o=[],l=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],a=t(r,n)?o:l;a.push(r)}return{pass:o,fail:l}},U=(e,t)=>{const o=[];for(let l=0,n=e.length;l<n;l++){const n=e[l];t(n,l)&&o.push(n)}return o},G=(e,t,o)=>(z(e,((e,l)=>{o=t(o,e,l)})),o),K=(e,t,o)=>($(e,((e,l)=>{o=t(o,e,l)})),o),J=(e,t,o)=>{for(let l=0,n=e.length;l<n;l++){const n=e[l];if(t(n,l))return T.some(n);if(o(n,l))break}return T.none()},Q=(e,t)=>J(e,t,C),X=e=>{const t=[];for(let o=0,l=e.length;o<l;++o){if(!s(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);F.apply(t,e[o])}return t},Y=(e,t)=>X(V(e,t)),Z=(e,t)=>{for(let o=0,l=e.length;o<l;++o){const l=e[o];if(!0!==t(l,o))return!1}return!0},ee=(e,t)=>{const o={};for(let l=0,n=e.length;l<n;l++){const n=e[l];o[String(n)]=t(n,l)}return o},te=(e,t)=>t>=0&&t<e.length?T.some(e[t]):T.none(),oe=e=>te(e,0),le=e=>te(e,e.length-1),ne=(e,t)=>{for(let o=0;o<e.length;o++){const l=t(e[o],o);if(l.isSome())return l}return T.none()},re=(e,t)=>{const o=t||document,l=o.createElement("div");if(l.innerHTML=e,!l.hasChildNodes()||l.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return ce(l.childNodes[0])},ae=(e,t)=>{const o=t||document,l=o.createElement(e);return ce(l)},se=(e,t)=>{const o=t||document,l=o.createTextNode(e);return ce(l)},ce=e=>{if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},ie=(e,t,o)=>T.from(e.dom.elementFromPoint(t,o)).map(ce),me={fromHtml:re,fromTag:ae,fromText:se,fromDom:ce,fromPoint:ie};"undefined"!==typeof window?window:Function("return this;")();const de=8,ue=9,pe=11,be=1,ge=3,he=e=>{const t=e.dom.nodeName;return t.toLowerCase()},fe=e=>e.dom.nodeType,ye=e=>t=>fe(t)===e,we=e=>fe(e)===de||"#comment"===he(e),Se=ye(be),Ce=ye(ge),ve=ye(ue),Te=ye(pe),xe=e=>t=>Se(t)&&he(t)===e,Ae=(e,t)=>{const o=e.dom;if(o.nodeType!==be)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Re=e=>e.nodeType!==be&&e.nodeType!==ue&&e.nodeType!==pe||0===e.childElementCount,Oe=(e,t)=>{const o=void 0===t?document:t.dom;return Re(o)?[]:V(o.querySelectorAll(e),me.fromDom)},_e=(e,t)=>{const o=void 0===t?document:t.dom;return Re(o)?T.none():T.from(o.querySelector(e)).map(me.fromDom)},Ie=(e,t)=>e.dom===t.dom,De=Ae,Me=e=>me.fromDom(e.dom.ownerDocument),Ne=e=>ve(e)?e:Me(e),Pe=e=>T.from(e.dom.parentNode).map(me.fromDom),ke=(e,t)=>{const o=u(t)?t:C;let l=e.dom;const n=[];while(null!==l.parentNode&&void 0!==l.parentNode){const e=l.parentNode,t=me.fromDom(e);if(n.push(t),!0===o(t))break;l=e}return n},Be=e=>T.from(e.dom.previousSibling).map(me.fromDom),Ee=e=>T.from(e.dom.nextSibling).map(me.fromDom),Fe=e=>V(e.dom.childNodes,me.fromDom),qe=(e,t)=>{const o=e.dom.childNodes;return T.from(o[t]).map(me.fromDom)},je=e=>qe(e,0),Le=e=>Te(e)&&d(e.dom.host),He=u(Element.prototype.attachShadow)&&u(Node.prototype.getRootNode),Ve=He?e=>me.fromDom(e.dom.getRootNode()):Ne,$e=e=>{const t=Ve(e);return Le(t)?T.some(t):T.none()},ze=e=>me.fromDom(e.dom.host),We=e=>{const t=Ce(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return $e(me.fromDom(t)).fold((()=>o.body.contains(t)),g(We,ze))},Ue=(e,t)=>U(Fe(e),t),Ge=(e,t)=>{let o=[];return $(Fe(e),(e=>{t(e)&&(o=o.concat([e])),o=o.concat(Ge(e,t))})),o},Ke=(e,t)=>Ue(e,(e=>Ae(e,t))),Je=(e,t)=>Oe(t,e);var Qe=(e,t,o,l,n)=>e(o,l)?T.some(o):u(n)&&n(o)?T.none():t(o,l,n);const Xe=(e,t,o)=>{let l=e.dom;const n=u(o)?o:C;while(l.parentNode){l=l.parentNode;const e=me.fromDom(l);if(t(e))return T.some(e);if(n(e))break}return T.none()},Ye=(e,t)=>{const o=e=>t(me.fromDom(e)),l=Q(e.dom.childNodes,o);return l.map(me.fromDom)},Ze=(e,t,o)=>Xe(e,(e=>Ae(e,t)),o),et=(e,t)=>Ye(e,(e=>Ae(e,t))),tt=(e,t)=>_e(t,e),ot=(e,t,o)=>{const l=(e,t)=>Ae(e,t);return Qe(l,Ze,e,t,o)},lt=(e,t,o)=>{if(!(a(o)||c(o)||p(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},nt=(e,t,o)=>{lt(e.dom,t,o)},rt=(e,t)=>{const o=e.dom;R(t,((e,t)=>{lt(o,t,e)}))},at=(e,t)=>{const o=e.dom.getAttribute(t);return null===o?void 0:o},st=(e,t)=>T.from(at(e,t)),ct=(e,t)=>{e.dom.removeAttribute(t)},it=e=>K(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),mt=(e,t,o=y)=>e.exists((e=>o(e,t))),dt=e=>{const t=[],o=e=>{t.push(e)};for(let l=0;l<e.length;l++)e[l].each(o);return t},ut=(e,t,o)=>e.isSome()&&t.isSome()?T.some(o(e.getOrDie(),t.getOrDie())):T.none(),pt=e=>e.bind(f),bt=(e,t)=>e?T.some(t):T.none(),gt=(e,t)=>e.substring(t),ht=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,ft=(e,t)=>yt(e,t)?gt(e,t.length):e,yt=(e,t)=>ht(e,t,0),wt=e=>t=>t.replace(e,""),St=wt(/^\s+|\s+$/g),Ct=e=>e.length>0,vt=e=>!Ct(e),Tt=(e,t=10)=>{const o=parseInt(e,t);return isNaN(o)?T.none():T.some(o)},xt=e=>{const t=parseFloat(e);return isNaN(t)?T.none():T.some(t)},At=e=>void 0!==e.style&&u(e.style.getPropertyValue),Rt=(e,t,o)=>{if(!a(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);At(e)&&e.style.setProperty(t,o)},Ot=(e,t)=>{At(e)&&e.style.removeProperty(t)},_t=(e,t,o)=>{const l=e.dom;Rt(l,t,o)},It=(e,t)=>{const o=e.dom,l=window.getComputedStyle(o),n=l.getPropertyValue(t);return""!==n||We(e)?n:Dt(o,t)},Dt=(e,t)=>At(e)?e.style.getPropertyValue(t):"",Mt=(e,t)=>{const o=e.dom,l=Dt(o,t);return T.from(l).filter((e=>e.length>0))},Nt=(e,t)=>{const o=e.dom;Ot(o,t),mt(st(e,"style").map(St),"")&&ct(e,"style")},Pt=(e,t,o=0)=>st(e,t).map((e=>parseInt(e,10))).getOr(o),kt=(e,t)=>Bt(e,t,v),Bt=(e,t,o)=>Y(Fe(e),(e=>Ae(e,t)?o(e)?[e]:[]:Bt(e,t,o))),Et=["tfoot","thead","tbody","colgroup"],Ft=e=>j(Et,e),qt=(e,t)=>({rows:e,columns:t}),jt=(e,t,o)=>({element:e,rowspan:t,colspan:o}),Lt=(e,t,o,l,n,r)=>({element:e,rowspan:t,colspan:o,row:l,column:n,isLocked:r}),Ht=(e,t,o)=>({element:e,cells:t,section:o}),Vt=(e,t,o,l)=>({startRow:e,startCol:t,finishRow:o,finishCol:l}),$t=(e,t,o)=>({element:e,colspan:t,column:o}),zt=(e,t)=>({element:e,columns:t}),Wt=(e,t,o=C)=>{if(o(t))return T.none();if(j(e,he(t)))return T.some(t);const l=e=>Ae(e,"table")||o(e);return Ze(t,e.join(","),l)},Ut=(e,t)=>Wt(["td","th"],e,t),Gt=e=>kt(e,"th,td"),Kt=e=>Ae(e,"colgroup")?Ke(e,"col"):Y(Xt(e),(e=>Ke(e,"col"))),Jt=(e,t)=>ot(e,"table",t),Qt=e=>kt(e,"tr"),Xt=e=>Jt(e).fold(h([]),(e=>Ke(e,"colgroup"))),Yt=(e,t)=>V(e,(e=>{if("colgroup"===he(e)){const t=V(Kt(e),(e=>{const t=Pt(e,"span",1);return jt(e,1,t)}));return Ht(e,t,"colgroup")}{const o=V(Gt(e),(e=>{const t=Pt(e,"rowspan",1),o=Pt(e,"colspan",1);return jt(e,t,o)}));return Ht(e,o,t(e))}})),Zt=e=>Pe(e).map((e=>{const t=he(e);return Ft(t)?t:"tbody"})).getOr("tbody"),eo=e=>{const t=Qt(e),o=Xt(e),l=[...o,...t];return Yt(l,Zt)},to="data-snooker-locked-cols",oo=e=>st(e,to).bind((e=>T.from(e.match(/\d+/g)))).map((e=>ee(e,v))),lo=(e,t)=>e+","+t,no=(e,t,o)=>T.from(e.access[lo(t,o)]),ro=(e,t,o)=>{const l=ao(e,(e=>o(t,e.element)));return l.length>0?T.some(l[0]):T.none()},ao=(e,t)=>{const o=Y(e.all,(e=>e.cells));return U(o,t)},so=e=>{const t={};let o=0;return $(e.cells,(e=>{const l=e.colspan;H(l,(n=>{const r=o+n;t[r]=$t(e.element,l,r)})),o+=l})),t},co=e=>{const t={},o=[],l=oe(e).map((e=>e.element)).bind(Jt),n=l.bind(oo).getOr({});let r=0,a=0,s=0;const{pass:c,fail:i}=W(e,(e=>"colgroup"===e.section));$(i,(e=>{const l=[];$(e.cells,(e=>{let o=0;while(void 0!==t[lo(s,o)])o++;const r=B(n,o.toString()),c=Lt(e.element,e.rowspan,e.colspan,s,o,r);for(let l=0;l<e.colspan;l++)for(let n=0;n<e.rowspan;n++){const e=s+n,r=o+l,i=lo(e,r);t[i]=c,a=Math.max(a,r+1)}l.push(c)})),r++,o.push(Ht(e.element,l,e.section)),s++}));const{columns:m,colgroups:d}=le(c).map((e=>{const t=so(e),o=zt(e.element,M(t));return{colgroups:[o],columns:t}})).getOrThunk((()=>({colgroups:[],columns:{}}))),u=qt(r,a);return{grid:u,access:t,all:o,columns:m,colgroups:d}},io=e=>{const t=eo(e);return co(t)},mo=e=>Y(e.all,(e=>e.cells)),uo=e=>M(e.columns),po=e=>x(e.columns).length>0,bo=(e,t)=>T.from(e.columns[t]),go={fromTable:io,generate:co,getAt:no,findItem:ro,filterItems:ao,justCells:mo,justColumns:uo,hasColumns:po,getColumnAt:bo};var ho=tinymce.util.Tools.resolve("tinymce.util.Tools");const fo=(e,t,o)=>{const l=e.select("td,th",t);let n;for(let r=0;r<l.length;r++){const t=e.getStyle(l[r],o);if(i(n)&&(n=t),n!==t)return""}return n},yo=(e,t,o)=>{ho.each("left center right".split(" "),(l=>{l!==o&&e.formatter.remove("align"+l,{},t)})),o&&e.formatter.apply("align"+o,{},t)},wo=(e,t,o)=>{ho.each("top middle bottom".split(" "),(l=>{l!==o&&e.formatter.remove("valign"+l,{},t)})),o&&e.formatter.apply("valign"+o,{},t)},So=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},Co=(e,t)=>xt(e).getOr(t),vo=(e,t,o)=>Co(It(e,t),o),To=(e,t,o,l)=>{const n=vo(e,`padding-${o}`,0),r=vo(e,`padding-${l}`,0),a=vo(e,`border-${o}-width`,0),s=vo(e,`border-${l}-width`,0);return t-n-r-a-s},xo=(e,t)=>{const o=e.dom,l=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?l:To(e,l,"left","right")},Ao=e=>xo(e,"content-box"),Ro=Ao;var Oo=tinymce.util.Tools.resolve("tinymce.Env");const _o="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",Io=H(5,(e=>{const t=`${e+1}px`;return{title:t,value:t}})),Do=V(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(e=>({title:e,value:e.toLowerCase()}))),Mo="100%",No=e=>{var t;const o=e.dom,l=null!==(t=o.getParent(e.selection.getStart(),o.isBlock))&&void 0!==t?t:e.getBody();return Ro(me.fromDom(l))+"px"},Po=(e,t)=>Zo(e)||!Wo(e)?t:Yo(e)?{...t,width:No(e)}:{...t,width:Mo},ko=(e,t)=>Zo(e)||Wo(e)?t:Yo(e)?{...t,width:No(e)}:{...t,width:Mo},Bo=e=>t=>t.options.get(e),Eo=e=>{const t=e.options.register;t("table_border_widths",{processor:"object[]",default:Io}),t("table_border_styles",{processor:"object[]",default:Do}),t("table_cell_advtab",{processor:"boolean",default:!0}),t("table_row_advtab",{processor:"boolean",default:!0}),t("table_advtab",{processor:"boolean",default:!0}),t("table_appearance_options",{processor:"boolean",default:!0}),t("table_grid",{processor:"boolean",default:!Oo.deviceType.isTouch()}),t("table_cell_class_list",{processor:"object[]",default:[]}),t("table_row_class_list",{processor:"object[]",default:[]}),t("table_class_list",{processor:"object[]",default:[]}),t("table_toolbar",{processor:"string",default:_o}),t("table_background_color_map",{processor:"object[]",default:[]}),t("table_border_color_map",{processor:"object[]",default:[]})},Fo=Bo("table_sizing_mode"),qo=Bo("table_border_widths"),jo=Bo("table_border_styles"),Lo=Bo("table_cell_advtab"),Ho=Bo("table_row_advtab"),Vo=Bo("table_advtab"),$o=Bo("table_appearance_options"),zo=Bo("table_grid"),Wo=Bo("table_style_by_css"),Uo=Bo("table_cell_class_list"),Go=Bo("table_row_class_list"),Ko=Bo("table_class_list"),Jo=Bo("table_toolbar"),Qo=Bo("table_background_color_map"),Xo=Bo("table_border_color_map"),Yo=e=>"fixed"===Fo(e),Zo=e=>"responsive"===Fo(e),el=e=>{const t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:Po(e,o)},tl=e=>{const t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:ko(e,o)},ol=e=>e.nodeName.toLowerCase(),ll=e=>me.fromDom(e.getBody()),nl=e=>t=>Ie(t,ll(e)),rl=e=>e?e.replace(/px$/,""):"",al=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,sl=e=>me.fromDom(e.selection.getStart()),cl=e=>me.fromDom(e.selection.getEnd()),il=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,ml=(e,t)=>{let o=!0;const l=w(il,t);for(let n=t.startRow;n<=t.finishRow;n++)for(let r=t.startCol;r<=t.finishCol;r++)o=o&&go.getAt(e,n,r).exists(l);return o?T.some(t):T.none()},dl=(e,t)=>Vt(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),ul=(e,t,o)=>{const l=go.findItem(e,t,Ie),n=go.findItem(e,o,Ie);return l.bind((e=>n.map((t=>dl(e,t)))))},pl=(e,t,o)=>ul(e,t,o).bind((t=>ml(e,t))),bl=(e,t,o)=>{const l=gl(e);return pl(l,t,o)},gl=go.fromTable,hl=(e,t)=>{const o=Pe(e);o.each((o=>{o.dom.insertBefore(t.dom,e.dom)}))},fl=(e,t)=>{const o=Ee(e);o.fold((()=>{const o=Pe(e);o.each((e=>{wl(e,t)}))}),(e=>{hl(e,t)}))},yl=(e,t)=>{const o=je(e);o.fold((()=>{wl(e,t)}),(o=>{e.dom.insertBefore(t.dom,o.dom)}))},wl=(e,t)=>{e.dom.appendChild(t.dom)},Sl=(e,t)=>{hl(e,t),wl(t,e)},Cl=(e,t)=>{$(t,((o,l)=>{const n=0===l?e:t[l-1];fl(n,o)}))},vl=(e,t)=>{$(t,(t=>{wl(e,t)}))},Tl=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},xl=e=>{const t=Fe(e);t.length>0&&Cl(e,t),Tl(e)},Al=(e,t)=>{const o=o=>{if(!e(o))throw new Error("Can only get "+t+" value of a "+t+" node");return l(o).getOr("")},l=t=>e(t)?T.from(t.dom.nodeValue):T.none(),n=(o,l)=>{if(!e(o))throw new Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=l};return{get:o,getOption:l,set:n}},Rl=Al(Ce,"text"),Ol=e=>Rl.get(e),_l=(e,t)=>Rl.set(e,t);var Il=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Dl=()=>{const e=e=>me.fromDom(e.dom.cloneNode(!1)),t=e=>Ne(e).dom,o=e=>!!Se(e)&&("body"===he(e)||j(Il,he(e))),l=e=>!!Se(e)&&j(["br","img","hr","input"],he(e)),n=e=>Se(e)&&"false"===at(e,"contenteditable"),r=(e,t)=>e.dom.compareDocumentPosition(t.dom),a=(e,t)=>{const o=it(e);rt(t,o)},s=e=>{const t=he(e);return j(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},c=e=>Se(e)?st(e,"lang"):T.none();return{up:h({selector:Ze,closest:ot,predicate:Xe,all:ke}),down:h({selector:Je,predicate:Ge}),styles:h({get:It,getRaw:Mt,set:_t,remove:Nt}),attrs:h({get:at,set:nt,remove:ct,copyTo:a}),insert:h({before:hl,after:fl,afterAll:Cl,append:wl,appendAll:vl,prepend:yl,wrap:Sl}),remove:h({unwrap:xl,remove:Tl}),create:h({nu:me.fromTag,clone:e,text:me.fromText}),query:h({comparePosition:r,prevSibling:Be,nextSibling:Ee}),property:h({children:Fe,name:he,parent:Pe,document:t,isText:Ce,isComment:we,isElement:Se,isSpecial:s,getLanguage:c,getText:Ol,setText:_l,isBoundary:o,isEmptyTag:l,isNonEditable:n}),eq:Ie,is:De}};const Ml=(e,t,o,l)=>{const n=o[0],r=o.slice(1);return l(e,t,n,r)},Nl=(e,t,o)=>o.length>0?Ml(e,t,o,Pl):T.none(),Pl=(e,t,o,l)=>{const n=t(e,o);return G(l,((o,l)=>{const n=t(e,l);return kl(e,o,n)}),n)},kl=(e,t,o)=>t.bind((t=>o.filter(w(e.eq,t)))),Bl=Nl,El=Dl(),Fl=(e,t)=>Bl(El,((t,o)=>e(o)),t),ql=e=>Ze(e,"table"),jl=(e,t)=>{const o=Je(e,t);return o.length>0?T.some(o):T.none()},Ll=(e,t,o)=>tt(e,t).bind((t=>tt(e,o).bind((e=>Fl(ql,[t,e]).map((o=>({first:t,last:e,table:o}))))))),Hl=(e,t)=>jl(e,t),Vl=(e,t,o)=>Ll(e,t,o).bind((t=>{const o=t=>Ie(e,t),l="thead,tfoot,tbody,table",n=Ze(t.first,l,o),r=Ze(t.last,l,o);return n.bind((e=>r.bind((o=>Ie(e,o)?bl(t.table,t.first,t.last):T.none()))))})),$l=e=>V(e,me.fromDom),zl="data-mce-selected",Wl="td["+zl+"],th["+zl+"]",Ul="data-mce-first-selected",Gl="td["+Ul+"],th["+Ul+"]",Kl="data-mce-last-selected",Jl="td["+Kl+"],th["+Kl+"]",Ql={selected:zl,selectedSelector:Wl,firstSelected:Ul,firstSelectedSelector:Gl,lastSelected:Kl,lastSelectedSelector:Jl},Xl=e=>Jt(e).bind((e=>Hl(e,Ql.firstSelectedSelector))).fold(h(e),(e=>e[0])),Yl=e=>(t,o)=>{const l=he(t),n="col"===l||"colgroup"===l?Xl(t):t;return ot(n,e,o)},Zl=Yl("th,td,caption"),en=Yl("th,td"),tn=e=>$l(e.model.table.getSelectedCells()),on=(e,t)=>{const o=en(e),l=o.bind((e=>Jt(e))).map((e=>Qt(e)));return ut(o,l,((e,o)=>U(o,(o=>L($l(o.dom.cells),(o=>"1"===at(o,t)||Ie(o,e))))))).getOr([])},ln=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],nn=e=>({value:e}),rn=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,an=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,sn=e=>rn.test(e)||an.test(e),cn=e=>ft(e,"#").toUpperCase(),mn=e=>sn(e)?T.some({value:cn(e)}):T.none(),dn=e=>{const t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},un=e=>{const t=dn(e.red)+dn(e.green)+dn(e.blue);return nn(t)},pn=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,bn=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,gn=(e,t,o,l)=>({red:e,green:t,blue:o,alpha:l}),hn=(e,t,o,l)=>{const n=parseInt(e,10),r=parseInt(t,10),a=parseInt(o,10),s=parseFloat(l);return gn(n,r,a,s)},fn=e=>{if("transparent"===e)return T.some(gn(0,0,0,0));const t=pn.exec(e);if(null!==t)return T.some(hn(t[1],t[2],t[3],"1"));const o=bn.exec(e);return null!==o?T.some(hn(o[1],o[2],o[3],o[4])):T.none()},yn=e=>mn(e).orThunk((()=>fn(e).map(un))).getOrThunk((()=>{const t=document.createElement("canvas");t.height=1,t.width=1;const o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),o.fillStyle="#FFFFFF",o.fillStyle=e,o.fillRect(0,0,1,1);const l=o.getImageData(0,0,1,1).data,n=l[0],r=l[1],a=l[2],s=l[3];return un(gn(n,r,a,s))})),wn=e=>fn(e).map(un).map((e=>"#"+e.value)).getOr(e),Sn=e=>{let t=e;const o=()=>t,l=e=>{t=e};return{get:o,set:l}},Cn=e=>{const t=Sn(T.none()),o=()=>t.get().each(e),l=()=>{o(),t.set(T.none())},n=()=>t.get().isSome(),r=()=>t.get(),a=e=>{o(),t.set(T.some(e))};return{clear:l,isSet:n,get:r,set:a}},vn=()=>Cn((e=>e.unbind())),Tn=(e,t,o)=>l=>{const n=vn(),r=vt(o),a=()=>{const a=tn(e),s=l=>e.formatter.match(t,{value:o},l.dom,r);r?(l.setActive(!L(a,s)),n.set(e.formatter.formatChanged(t,(e=>l.setActive(!e)),!0))):(l.setActive(Z(a,s)),n.set(e.formatter.formatChanged(t,l.setActive,!1,{value:o})))};return e.initialized?a():e.on("init",a),n.clear},xn=e=>B(e,"menu"),An=e=>V(e,(e=>{const t=e.text||e.title||"";return xn(e)?{text:t,items:An(e.menu)}:{text:t,value:e.value}})),Rn=(e,t,o,l)=>V(t,(t=>{const n=t.text||t.title;return xn(t)?{type:"nestedmenuitem",text:n,getSubmenuItems:()=>Rn(e,t.menu,o,l)}:{text:n,type:"togglemenuitem",onAction:()=>l(t.value),onSetup:Tn(e,o,t.value)}})),On=(e,t)=>o=>{e.execCommand("mceTableApplyCellStyle",!1,{[t]:o})},_n=e=>Y(e,(e=>xn(e)?[{...e,menu:_n(e.menu)}]:Ct(e.value)?[e]:[])),In=(e,t,o,l)=>n=>n(Rn(e,t,o,l)),Dn=(e,t,o)=>{const l=V(t,(e=>({text:e.title,value:"#"+yn(e.value).value,type:"choiceitem"})));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:l.length>0?l:void 0,allowCustomColors:!1},onAction:t=>{const l="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,{[o]:l})}}]},Mn=e=>()=>{const t=e.queryCommandValue("mceTableRowType"),o="header"===t?"body":"header";e.execCommand("mceTableRowType",!1,{type:o})},Nn=e=>()=>{const t=e.queryCommandValue("mceTableColType"),o="th"===t?"td":"th";e.execCommand("mceTableColType",!1,{type:o})},Pn=e=>{const t=An(Uo(e));return t.length>0?T.some({name:"class",type:"listbox",label:"Class",items:t}):T.none()},kn=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:ln}],Bn=e=>kn.concat(Pn(e).toArray()),En=(e,t)=>{const o=[{text:"Select...",value:""}],l=[{name:"borderstyle",type:"listbox",label:"Border style",items:o.concat(An(jo(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],n={name:"borderwidth",type:"input",label:"Border width"},r="cell"===t?[n].concat(l):l;return{title:"Advanced",name:"advanced",items:r}},Fn=(e,t)=>{const o=e.dom,l=(e,l)=>{o.setAttrib(t,e,l)},n=(e,l)=>{o.setStyle(t,e,l)},r=(o,l)=>{""===l?e.formatter.remove(o,{value:null},t,!0):e.formatter.apply(o,{value:l},t)};return{setAttrib:l,setStyle:n,setFormat:r}},qn={normal:Fn},jn=xe("th"),Ln=(e,t)=>e&&t?"sectionCells":e?"section":"cells",Hn=e=>{const t="thead"===e.section,o=mt(Vn(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:Ln(t,o)}:{type:"body"}},Vn=e=>{const t=U(e,(e=>jn(e.element)));return 0===t.length?T.some("td"):t.length===e.length?T.some("th"):T.none()},$n=e=>{const t=V(e,(e=>Hn(e).type)),o=j(t,"header"),l=j(t,"footer");if(o||l){const e=j(t,"body");return!o||e||l?o||e||!l?T.none():T.some("footer"):T.some("header")}return T.some("body")},zn=e=>{let t,o=!1;return(...l)=>(o||(o=!0,t=e.apply(null,l)),t)},Wn=(e,t)=>ne(e.all,(e=>Q(e.cells,(e=>Ie(t,e.element))))),Un=(e,t,o)=>{const l=V(t.selection,(t=>Ut(t).bind((t=>Wn(e,t))).filter(o))),n=dt(l);return bt(n.length>0,n)},Gn=(e,t)=>t.mergable,Kn=(e,t)=>t.unmergable,Jn=(e,t)=>Un(e,t,v),Qn=(e,t)=>Wn(e,t).exists((e=>!e.isLocked)),Xn=(e,t)=>Z(t,(t=>Qn(e,t))),Yn=(e,t)=>Gn(e,t).filter((t=>Xn(e,t.cells))),Zn=(e,t)=>Kn(e,t).filter((t=>Xn(e,t))),er=e=>{if(!s(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],o={};return $(e,((l,n)=>{const r=x(l);if(1!==r.length)throw new Error("one and only one name per case");const a=r[0],c=l[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!s(c))throw new Error("case arguments must be an array");t.push(a),o[a]=(...o)=>{const l=o.length;if(l!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+l);const r=e=>{const l=x(e);if(t.length!==l.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+l.join(","));const n=Z(t,(e=>j(l,e)));if(!n)throw new Error("Not all branches were specified when using match. Specified: "+l.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,o)};return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);const l=t[n];return l.apply(null,o)},match:r,log:e=>{console.log(e,{constructors:t,constructor:a,params:o})}}}})),o},tr={generate:er},or=(tr.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),(e,t)=>{const o=go.fromTable(e),l=Jn(o,t);return l.bind((e=>{const t=e[e.length-1],l=e[0].row,n=t.row+t.rowspan,r=o.all.slice(l,n);return $n(r)})).getOr("")}),lr=or,nr=e=>yt(e,"rgb")?wn(e):e,rr=e=>{const t=me.fromDom(e);return{borderwidth:Mt(t,"border-width").getOr(""),borderstyle:Mt(t,"border-style").getOr(""),bordercolor:Mt(t,"border-color").map(nr).getOr(""),backgroundcolor:Mt(t,"background-color").map(nr).getOr("")}},ar=e=>{const t=e[0],o=e.slice(1);return $(o,(e=>{$(x(t),(o=>{R(e,((e,l)=>{const n=t[o];""!==n&&o===l&&n!==e&&(t[o]="")}))}))})),t},sr=(e,t,o,l)=>Q(e,(e=>!i(o.formatter.matchNode(l,t+e)))).getOr(""),cr=w(sr,["left","center","right"],"align"),ir=w(sr,["top","middle","bottom"],"valign"),mr=(e,t)=>{const o=el(e),l=tl(e),n=()=>({borderstyle:P(o,"border-style").getOr(""),bordercolor:nr(P(o,"border-color").getOr("")),backgroundcolor:nr(P(o,"background-color").getOr(""))}),r={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},a=()=>{const t=o["border-width"];return Wo(e)&&t?{border:t}:P(l,"border").fold((()=>({})),(e=>({border:e})))},s=t?n():{},c=()=>{const e=P(o,"border-spacing").or(P(l,"cellspacing")).fold((()=>({})),(e=>({cellspacing:e}))),t=P(o,"border-padding").or(P(l,"cellpadding")).fold((()=>({})),(e=>({cellpadding:e})));return{...e,...t}},i={...r,...o,...l,...s,...a(),...c()};return i},dr=e=>Jt(me.fromDom(e)).map((t=>{const o={selection:$l(e.cells)};return lr(t,o)})).getOr(""),ur=(e,t,o)=>{const l=(t,o)=>{const l=Mt(me.fromDom(o),"border-width");return Wo(e)&&l.isSome()?l.getOr(""):t.getAttrib(o,"border")||fo(e.dom,o,"border-width")||fo(e.dom,o,"border")||""},n=e.dom,r=Wo(e)?n.getStyle(t,"border-spacing")||n.getAttrib(t,"cellspacing"):n.getAttrib(t,"cellspacing")||n.getStyle(t,"border-spacing"),a=Wo(e)?fo(n,t,"padding")||n.getAttrib(t,"cellpadding"):n.getAttrib(t,"cellpadding")||fo(n,t,"padding");return{width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),cellspacing:null!==r&&void 0!==r?r:"",cellpadding:null!==a&&void 0!==a?a:"",border:l(n,t),caption:!!n.select("caption",t)[0],class:n.getAttrib(t,"class",""),align:cr(e,t),...o?rr(t):{}}},pr=(e,t,o)=>{const l=e.dom;return{height:l.getStyle(t,"height")||l.getAttrib(t,"height"),class:l.getAttrib(t,"class",""),type:dr(t),align:cr(e,t),...o?rr(t):{}}},br=(e,t,o,l)=>{const n=e.dom,r=l.getOr(t),a=(e,t)=>n.getStyle(e,t)||n.getAttrib(e,t);return{width:a(r,"width"),height:a(t,"height"),scope:n.getAttrib(t,"scope"),celltype:ol(t),class:n.getAttrib(t,"class",""),halign:cr(e,t),valign:ir(e,t),...o?rr(t):{}}},gr=(e,t)=>{const o=go.fromTable(e),l=go.justCells(o),n=U(l,(e=>L(t,(t=>Ie(e.element,t)))));return V(n,(e=>({element:e.element.dom,column:go.getColumnAt(o,e.column).map((e=>e.element.dom))})))},hr=(e,t,o,l)=>{l("scope")&&e.setAttrib("scope",o.scope),l("class")&&e.setAttrib("class",o.class),l("height")&&e.setStyle("height",al(o.height)),l("width")&&t.setStyle("width",al(o.width))},fr=(e,t,o)=>{o("backgroundcolor")&&e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),o("bordercolor")&&e.setFormat("tablecellbordercolor",t.bordercolor),o("borderstyle")&&e.setFormat("tablecellborderstyle",t.borderstyle),o("borderwidth")&&e.setFormat("tablecellborderwidth",al(t.borderwidth))},yr=(e,t,o,l)=>{const n=1===t.length;$(t,(t=>{const r=t.element,a=n?v:l,s=qn.normal(e,r),c=t.column.map((t=>qn.normal(e,t))).getOr(s);hr(s,c,o,a),Lo(e)&&fr(s,o,a),l("halign")&&yo(e,r,o.halign),l("valign")&&wo(e,r,o.valign)}))},wr=(e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},Sr=(e,t,o,l)=>{const n=I(l,((e,t)=>o[t]!==e));N(n)>0&&t.length>=1&&Jt(t[0]).each((o=>{const r=gr(o,t),a=N(I(n,((e,t)=>"scope"!==t&&"celltype"!==t)))>0,s=k(n,"celltype");(a||k(n,"scope"))&&yr(e,r,l,w(k,n)),s&&wr(e,l),So(e,o.dom,{structure:s,style:a})}))},Cr=(e,t,o,l)=>{const n=l.getData();l.close(),e.undoManager.transact((()=>{Sr(e,t,o,n),e.focus()}))},vr=(e,t)=>{const o=Jt(t[0]).map((o=>V(gr(o,t),(t=>br(e,t.element,Lo(e),t.column)))));return ar(o.getOrDie())},Tr=e=>{const t=tn(e);if(0===t.length)return;const o=vr(e,t),l={type:"tabpanel",tabs:[{title:"General",name:"general",items:Bn(e)},En(e,"cell")]},n={type:"panel",items:[{type:"grid",columns:2,items:Bn(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:Lo(e)?l:n,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:w(Cr,e,t,o)})},xr=e=>{const t=An(Go(e));return t.length>0?T.some({name:"class",type:"listbox",label:"Class",items:t}):T.none()},Ar=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Rr=e=>Ar.concat(xr(e).toArray()),Or=(e,t,o)=>{o("class")&&e.setAttrib("class",t.class),o("height")&&e.setStyle("height",al(t.height))},_r=(e,t,o)=>{o("backgroundcolor")&&e.setStyle("background-color",t.backgroundcolor),o("bordercolor")&&e.setStyle("border-color",t.bordercolor),o("borderstyle")&&e.setStyle("border-style",t.borderstyle)},Ir=(e,t,o,l)=>{const n=1===t.length,r=n?v:l;$(t,(t=>{const n=qn.normal(e,t);Or(n,o,r),Ho(e)&&_r(n,o,r),l("align")&&yo(e,t,o.align)}))},Dr=(e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},Mr=(e,t,o,l)=>{const n=I(l,((e,t)=>o[t]!==e));if(N(n)>0){const o=k(n,"type"),r=!o||N(n)>1;r&&Ir(e,t,l,w(k,n)),o&&Dr(e,l),Jt(me.fromDom(t[0])).each((t=>So(e,t.dom,{structure:o,style:r})))}},Nr=(e,t,o,l)=>{const n=l.getData();l.close(),e.undoManager.transact((()=>{Mr(e,t,o,n),e.focus()}))},Pr=e=>{const t=on(sl(e),Ql.selected);if(0===t.length)return;const o=V(t,(t=>pr(e,t.dom,Ho(e)))),l=ar(o),n={type:"tabpanel",tabs:[{title:"General",name:"general",items:Rr(e)},En(e,"row")]},r={type:"panel",items:[{type:"grid",columns:2,items:Rr(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:Ho(e)?n:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:l,onSubmit:w(Nr,e,V(t,(e=>e.dom)),l)})},kr=(e,t,o)=>{const l=o?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],n=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],r=$o(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],a=[{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],s=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return l.concat(n).concat(r).concat(a).concat(s)},Br=(e,t,o,l)=>{if("TD"===t.tagName||"TH"===t.tagName)a(o)&&d(l)?e.setStyle(t,o,l):e.setStyles(t,o);else if(t.children)for(let n=0;n<t.children.length;n++)Br(e,t.children[n],o,l)},Er=(e,t,o)=>{const l=e.dom,n={},r={};if(i(o.class)||(n.class=o.class),r.height=al(o.height),Wo(e)?r.width=al(o.width):l.getAttrib(t,"width")&&(n.width=rl(o.width)),Wo(e)?(r["border-width"]=al(o.border),r["border-spacing"]=al(o.cellspacing)):(n.border=o.border,n.cellpadding=o.cellpadding,n.cellspacing=o.cellspacing),Wo(e)&&t.children)for(let a=0;a<t.children.length;a++)Br(l,t.children[a],{"border-width":al(o.border),padding:al(o.cellpadding)}),Vo(e)&&Br(l,t.children[a],{"border-color":o.bordercolor});if(Vo(e)){const e=o;r["background-color"]=e.backgroundcolor,r["border-color"]=e.bordercolor,r["border-style"]=e.borderstyle}n.style=l.serializeStyle({...el(e),...r}),l.setAttribs(t,{...tl(e),...n})},Fr=(e,t,o,l)=>{const n=e.dom,r=l.getData(),a=I(r,((e,t)=>o[t]!==e));l.close(),""===r.class&&delete r.class,e.undoManager.transact((()=>{if(!t){const o=Tt(r.cols).getOr(1),l=Tt(r.rows).getOr(1);e.execCommand("mceInsertTable",!1,{rows:l,columns:o}),t=en(sl(e),nl(e)).bind((t=>Jt(t,nl(e)))).map((e=>e.dom)).getOrDie()}if(N(a)>0){Er(e,t,r);const o=n.select("caption",t)[0];(o&&!r.caption||!o&&r.caption)&&e.execCommand("mceTableToggleCaption"),yo(e,t,r.align)}if(e.focus(),e.addVisual(),N(a)>0){const o=k(a,"caption"),l=!o||N(a)>1;So(e,t,{structure:o,style:l})}}))},qr=(e,t)=>{const o=e.dom;let l,n=mr(e,Vo(e));t?(n.cols="1",n.rows="1",Vo(e)&&(n.borderstyle="",n.bordercolor="",n.backgroundcolor="")):(l=o.getParent(e.selection.getStart(),"table",e.getBody()),l?n=ur(e,l,Vo(e)):Vo(e)&&(n.borderstyle="",n.bordercolor="",n.backgroundcolor=""));const r=An(Ko(e));r.length>0&&n.class&&(n.class=n.class.replace(/\s*mce\-item\-table\s*/g,""));const a={type:"grid",columns:2,items:kr(e,r,t)},s=()=>({type:"panel",items:[a]}),c=()=>({type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},En(e,"table")]}),i=Vo(e)?c():s();e.windowManager.open({title:"Table Properties",size:"normal",body:i,onSubmit:w(Fr,e,l,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n})},jr=e=>{R({mceTableProps:w(qr,e,!1),mceTableRowProps:w(Pr,e),mceTableCellProps:w(Tr,e)},((t,o)=>e.addCommand(o,(()=>t())))),e.addCommand("mceInsertTableDialog",(t=>{qr(e,!0)}))},Lr=(e,t)=>et(e,t).isSome(),Hr=f,Vr=e=>{const t=(e,t)=>st(e,t).exists((e=>parseInt(e,10)>1)),o=e=>t(e,"rowspan")||t(e,"colspan");return e.length>0&&Z(e,o)?T.some(e):T.none()},$r=(e,t,o)=>t.length<=1?T.none():Vl(e,o.firstSelectedSelector,o.lastSelectedSelector).map((e=>({bounds:e,cells:t}))),zr=e=>({element:e,mergable:T.none(),unmergable:T.none(),selection:[e]}),Wr=(e,t,o)=>({element:o,mergable:$r(t,e,Ql),unmergable:Vr(e),selection:Hr(e)}),Ur=e=>{const t=Sn(T.none()),o=Sn([]);let l=T.none();const n=xe("caption"),r=e=>l.forall((t=>!t[e])),a=()=>Zl(sl(e),nl(e)),s=()=>Zl(cl(e),nl(e)),c=()=>a().bind((t=>pt(ut(Jt(t),s().bind(Jt),((o,l)=>Ie(o,l)?n(t)?T.some(zr(t)):T.some(Wr(tn(e),o,t)):T.none()))))),i=e=>{const t=Jt(e.element);return t.map((t=>{const o=go.fromTable(t),l=Jn(o,e).getOr([]),n=K(l,((e,t)=>(t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=o.grid.columns&&(e.onLast=!0)),e)),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Yn(o,e).isSome(),unmergeable:Zn(o,e).isSome(),locked:n}}))},m=()=>{t.set(zn(c)()),l=t.get().bind(i),$(o.get(),S)},d=e=>(e(),o.set(o.get().concat([e])),()=>{o.set(U(o.get(),(t=>t!==e)))}),u=(e,o)=>d((()=>t.get().fold((()=>{e.setEnabled(!1)}),(t=>{e.setEnabled(!o(t))})))),p=(e,o,l)=>d((()=>t.get().fold((()=>{e.setEnabled(!1),e.setActive(!1)}),(t=>{e.setEnabled(!o(t)),e.setActive(l(t))})))),b=e=>l.exists((t=>t.locked[e])),g=e=>u(e,(e=>!1)),h=e=>u(e,(e=>n(e.element))),f=e=>t=>u(t,(t=>n(t.element)||b(e))),y=e=>t=>u(t,(t=>n(t.element)||e().isNone())),w=(e,t)=>o=>u(o,(o=>n(o.element)||e().isNone()||b(t))),v=e=>u(e,(e=>r("mergeable"))),x=e=>u(e,(e=>r("unmergeable"))),A=t=>p(t,C,(t=>{const o=Jt(t.element,nl(e));return o.exists((e=>Lr(e,"caption")))})),R=(t,o)=>l=>p(l,(e=>n(e.element)),(()=>e.queryCommandValue(t)===o)),O=R("mceTableRowType","header"),_=R("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",m),{onSetupTable:g,onSetupCellOrRow:h,onSetupColumn:f,onSetupPasteable:y,onSetupPasteableColumn:w,onSetupMergeable:v,onSetupUnmergeable:x,resetTargets:m,onSetupTableWithCaption:A,onSetupTableRowHeaders:O,onSetupTableColumnHeaders:_,targets:t.get}};var Gr=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const Kr="x-tinymce/dom-table-",Jr=Kr+"rows",Qr=Kr+"columns",Xr=e=>{var t;const o=null!==(t=Gr.read())&&void 0!==t?t:[];return ne(o,(t=>T.from(t.getType(e))))},Yr=()=>Xr(Jr),Zr=()=>Xr(Qr),ea=(e,t)=>{e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:e=>e("inserttable | cell row column | advtablesort | tableprops deletetable")});const o=t=>()=>e.execCommand(t),l=(t,l)=>{e.queryCommandSupported(l.command)&&e.ui.registry.addButton(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)})},n=(t,l)=>{e.queryCommandSupported(l.command)&&e.ui.registry.addToggleButton(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)})};l("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:t.onSetupTable}),l("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:t.onSetupTable}),l("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),l("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:t.onSetupMergeable}),l("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),l("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),l("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),l("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),l("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),l("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),l("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),l("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),l("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:t.onSetupCellOrRow}),l("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:t.onSetupCellOrRow}),l("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:t.onSetupPasteable(Yr)}),l("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:t.onSetupPasteable(Yr)}),l("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:t.onSetupColumn("onAny")}),l("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:t.onSetupColumn("onAny")}),l("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:t.onSetupPasteableColumn(Zr,"onFirst")}),l("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:t.onSetupPasteableColumn(Zr,"onLast")}),l("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table"});const r=_n(Ko(e));0!==r.length&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:In(e,r,"tableclass",(t=>e.execCommand("mceTableToggleClass",!1,t))),onSetup:t.onSetupTable});const a=_n(Uo(e));0!==a.length&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:In(e,a,"tablecellclass",(t=>e.execCommand("mceTableCellToggleClass",!1,t))),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:In(e,ln,"tablecellverticalalign",On(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:In(e,qo(e),"tablecellborderwidth",On(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:In(e,jo(e),"tablecellborderstyle",On(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:t=>t(Dn(e,Qo(e),"background-color")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:t=>t(Dn(e,Xo(e),"border-color")),onSetup:t.onSetupCellOrRow})),n("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),n("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:Mn(e),onSetup:t.onSetupTableRowHeaders}),n("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:Nn(e),onSetup:t.onSetupTableColumnHeaders})},ta=e=>{const t=t=>e.dom.is(t,"table")&&e.getBody().contains(t),o=Jo(e);o.length>0&&e.ui.registry.addContextToolbar("table",{predicate:t,items:o,scope:"node",position:"node"})},oa=(e,t)=>{const o=t=>()=>e.execCommand(t),l=(t,l)=>!!e.queryCommandSupported(l.command)&&(e.ui.registry.addMenuItem(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)}),!0),n=(t,l)=>{e.queryCommandSupported(l.command)&&e.ui.registry.addToggleMenuItem(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)})},r=t=>{e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},a=[l("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:t.onSetupCellOrRow}),l("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:t.onSetupCellOrRow}),l("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:t.onSetupCellOrRow}),l("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:t.onSetupCellOrRow}),l("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:t.onSetupCellOrRow}),l("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:t.onSetupCellOrRow}),l("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:t.onSetupPasteable(Yr)}),l("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:t.onSetupPasteable(Yr)})],s=[l("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:t.onSetupColumn("onFirst")}),l("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:t.onSetupColumn("onLast")}),l("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:t.onSetupColumn("onAny")}),l("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:t.onSetupColumn("onAny")}),l("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:t.onSetupColumn("onAny")}),l("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:t.onSetupPasteableColumn(Zr,"onFirst")}),l("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:t.onSetupPasteableColumn(Zr,"onLast")})],c=[l("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:t.onSetupCellOrRow}),l("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:t.onSetupMergeable}),l("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:t.onSetupUnmergeable})];zo(e)?e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}):e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTableDialog")}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTableDialog")}),l("tableprops",{text:"Table properties",onSetup:t.onSetupTable,command:"mceTableProps"}),l("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,command:"mceTableDelete"}),j(a,!0)&&e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:h("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),j(s,!0)&&e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:h("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),j(c,!0)&&e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:h("tablecellprops tablemergecells tablesplitcells")}),e.ui.registry.addContextMenu("table",{update:()=>(t.resetTargets(),t.targets().fold(h(""),(e=>"caption"===he(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable")))});const i=_n(Ko(e));0!==i.length&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>Rn(e,i,"tableclass",(t=>e.execCommand("mceTableToggleClass",!1,t))),onSetup:t.onSetupTable});const m=_n(Uo(e));0!==m.length&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>Rn(e,m,"tablecellclass",(t=>e.execCommand("mceTableCellToggleClass",!1,t))),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>Rn(e,ln,"tablecellverticalalign",On(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>Rn(e,qo(e),"tablecellborderwidth",On(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>Rn(e,jo(e),"tablecellborderstyle",On(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>Dn(e,Qo(e),"background-color"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>Dn(e,Xo(e),"border-color"),onSetup:t.onSetupCellOrRow})),n("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),n("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:Mn(e),onSetup:t.onSetupTableRowHeaders}),n("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:Nn(e),onSetup:t.onSetupTableRowHeaders})},la=e=>{const t=Ur(e);Eo(e),jr(e),oa(e,t),ea(e,t),ta(e)};var na=()=>{e.add("table",la)};na()})();