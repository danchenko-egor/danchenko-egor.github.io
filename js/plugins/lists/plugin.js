(function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager");const e=(t,e,n)=>{var o;return!!n(t,e.prototype)||(null===(o=t.constructor)||void 0===o?void 0:o.name)===e.name},n=t=>{const n=typeof t;return null===t?"null":"object"===n&&Array.isArray(t)?"array":"object"===n&&e(t,String,((t,e)=>e.isPrototypeOf(t)))?"string":n},o=t=>e=>n(e)===t,r=t=>e=>typeof e===t,s=o("string"),i=o("object"),l=o("array"),a=r("boolean"),d=t=>null===t||void 0===t,c=t=>!d(t),m=r("function"),u=r("number"),p=()=>{},g=t=>()=>t,h=(t,e)=>t===e,f=t=>e=>!t(e),y=g(!1);class C{constructor(t,e){this.tag=t,this.value=e}static some(t){return new C(!0,t)}static none(){return C.singletonNone}fold(t,e){return this.tag?e(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?C.some(t(this.value)):C.none()}bind(t){return this.tag?t(this.value):C.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:C.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(null!==t&&void 0!==t?t:"Called getOrDie on None")}static from(t){return c(t)?C.some(t):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}C.singletonNone=new C(!1);const v=Array.prototype.slice,b=Array.prototype.indexOf,S=Array.prototype.push,N=(t,e)=>b.call(t,e),L=(t,e)=>N(t,e)>-1,T=(t,e)=>{for(let n=0,o=t.length;n<o;n++){const o=t[n];if(e(o,n))return!0}return!1},D=(t,e)=>{const n=t.length,o=new Array(n);for(let r=0;r<n;r++){const n=t[r];o[r]=e(n,r)}return o},O=(t,e)=>{for(let n=0,o=t.length;n<o;n++){const o=t[n];e(o,n)}},k=(t,e)=>{const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o];e(r,o)&&n.push(r)}return n},w=(t,e)=>{if(0===t.length)return[];{let n=e(t[0]);const o=[];let r=[];for(let s=0,i=t.length;s<i;s++){const i=t[s],l=e(i);l!==n&&(o.push(r),r=[]),n=l,r.push(i)}return 0!==r.length&&o.push(r),o}},A=(t,e,n)=>(O(t,((t,o)=>{n=e(n,t,o)})),n),E=(t,e,n)=>{for(let o=0,r=t.length;o<r;o++){const r=t[o];if(e(r,o))return C.some(r);if(n(r,o))break}return C.none()},x=(t,e)=>E(t,e,y),B=t=>{const e=[];for(let n=0,o=t.length;n<o;++n){if(!l(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);S.apply(e,t[n])}return e},P=(t,e)=>B(D(t,e)),M=t=>{const e=v.call(t,0);return e.reverse(),e},I=(t,e)=>e>=0&&e<t.length?C.some(t[e]):C.none(),R=t=>I(t,0),U=t=>I(t,t.length-1),$=(t,e)=>{const n=[],o=m(e)?t=>T(n,(n=>e(n,t))):t=>L(n,t);for(let r=0,s=t.length;r<s;r++){const e=t[r];o(e)||n.push(e)}return n},_=(t,e,n=h)=>t.exists((t=>n(t,e))),H=(t,e,n=h)=>F(t,e,n).getOr(t.isNone()&&e.isNone()),F=(t,e,n)=>t.isSome()&&e.isSome()?C.some(n(t.getOrDie(),e.getOrDie())):C.none(),j=1,K=(t,e)=>{const n=e||document,o=n.createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||o.childNodes.length>1){const e="HTML does not have a single root node";throw console.error(e,t),new Error(e)}return Q(o.childNodes[0])},V=(t,e)=>{const n=e||document,o=n.createElement(t);return Q(o)},z=(t,e)=>{const n=e||document,o=n.createTextNode(t);return Q(o)},Q=t=>{if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:t}},q=(t,e,n)=>C.from(t.dom.elementFromPoint(e,n)).map(Q),W={fromHtml:K,fromTag:V,fromText:z,fromDom:Q,fromPoint:q},Z=(t,e)=>{const n=t.dom;if(n.nodeType!==j)return!1;{const t=n;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}},G=(t,e)=>t.dom===e.dom,J=(t,e)=>{const n=t.dom,o=e.dom;return n!==o&&n.contains(o)},X=Z;var Y=(t,e,n,o,r)=>t(n,o)?C.some(n):m(r)&&r(n)?C.none():e(n,o,r);"undefined"!==typeof window?window:Function("return this;")();const tt=t=>{const e=t.dom.nodeName;return e.toLowerCase()},et=t=>t.dom.nodeType,nt=t=>e=>et(e)===t,ot=nt(j),rt=t=>e=>ot(e)&&tt(e)===t,st=t=>C.from(t.dom.parentNode).map(W.fromDom),it=t=>C.from(t.dom.parentElement).map(W.fromDom),lt=t=>C.from(t.dom.nextSibling).map(W.fromDom),at=t=>D(t.dom.childNodes,W.fromDom),dt=(t,e)=>{const n=t.dom.childNodes;return C.from(n[e]).map(W.fromDom)},ct=t=>dt(t,0),mt=t=>dt(t,t.dom.childNodes.length-1),ut=(t,e,n)=>{let o=t.dom;const r=m(n)?n:y;while(o.parentNode){o=o.parentNode;const t=W.fromDom(o);if(e(t))return C.some(t);if(r(t))break}return C.none()},pt=(t,e,n)=>{const o=(t,e)=>e(t);return Y(o,ut,t,e,n)},gt=(t,e)=>{const n=st(t);n.each((n=>{n.dom.insertBefore(e.dom,t.dom)}))},ht=(t,e)=>{const n=lt(t);n.fold((()=>{const n=st(t);n.each((t=>{ft(t,e)}))}),(t=>{gt(t,e)}))},ft=(t,e)=>{t.dom.appendChild(e.dom)},yt=(t,e)=>{O(e,(e=>{gt(t,e)}))},Ct=(t,e)=>{O(e,(e=>{ft(t,e)}))},vt=t=>{t.dom.textContent="",O(at(t),(t=>{bt(t)}))},bt=t=>{const e=t.dom;null!==e.parentNode&&e.parentNode.removeChild(e)};var St=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Nt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Lt=tinymce.util.Tools.resolve("tinymce.util.VK");const Tt=t=>D(t,W.fromDom),Dt=Object.keys,Ot=(t,e)=>{const n=Dt(t);for(let o=0,r=n.length;o<r;o++){const r=n[o],s=t[r];e(s,r)}},kt=t=>(e,n)=>{t[n]=e},wt=(t,e,n,o)=>{Ot(t,((t,r)=>{(e(t,r)?n:o)(t,r)}))},At=(t,e)=>{const n={};return wt(t,e,kt(n),p),n},Et=(t,e,n)=>{if(!(s(n)||a(n)||u(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},xt=(t,e)=>{const n=t.dom;Ot(e,((t,e)=>{Et(n,e,t)}))},Bt=t=>A(t.dom.attributes,((t,e)=>(t[e.name]=e.value,t)),{}),Pt=(t,e)=>W.fromDom(t.dom.cloneNode(e)),Mt=t=>Pt(t,!0),It=(t,e)=>{const n=W.fromTag(e),o=Bt(t);return xt(n,o),n},Rt=(t,e)=>{const n=It(t,e);ht(t,n);const o=at(t);return Ct(n,o),bt(t),n};var Ut=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),$t=tinymce.util.Tools.resolve("tinymce.util.Tools");const _t=t=>e=>c(e)&&e.nodeName.toLowerCase()===t,Ht=t=>e=>c(e)&&t.test(e.nodeName),Ft=t=>c(t)&&3===t.nodeType,jt=t=>c(t)&&1===t.nodeType,Kt=Ht(/^(OL|UL|DL)$/),Vt=Ht(/^(OL|UL)$/),zt=_t("ol"),Qt=Ht(/^(LI|DT|DD)$/),qt=Ht(/^(DT|DD)$/),Wt=Ht(/^(TH|TD)$/),Zt=_t("br"),Gt=t=>{var e;return(null===(e=t.parentNode)||void 0===e?void 0:e.firstChild)===t},Jt=(t,e)=>c(e)&&e.nodeName in t.schema.getTextBlockElements(),Xt=(t,e)=>c(t)&&t.nodeName in e,Yt=(t,e)=>!!Zt(e)&&(t.isBlock(e.nextSibling)&&!Zt(e.previousSibling)),te=(t,e,n)=>{const o=t.isEmpty(e);return!(n&&t.select("span[data-mce-type=bookmark]",e).length>0)&&o},ee=(t,e)=>t.isChildOf(e,t.getRoot()),ne=t=>e=>e.options.get(t),oe=t=>{const e=t.options.register;e("lists_indent_on_tab",{processor:"boolean",default:!0})},re=ne("lists_indent_on_tab"),se=ne("forced_root_block"),ie=ne("forced_root_block_attrs"),le=(t,e)=>{const n=t.dom,o=t.schema.getBlockElements(),r=n.createFragment(),s=se(t),i=ie(t);let l,a,d=!1;a=n.create(s,i),Xt(e.firstChild,o)||r.appendChild(a);while(l=e.firstChild){const t=l.nodeName;d||"SPAN"===t&&"bookmark"===l.getAttribute("data-mce-type")||(d=!0),Xt(l,o)?(r.appendChild(l),a=null):(a||(a=n.create(s,i),r.appendChild(a)),a.appendChild(l))}return!d&&a&&a.appendChild(n.create("br",{"data-mce-bogus":"1"})),r},ae=Ut.DOM,de=(t,e,n)=>{const o=t=>{const e=t.parentNode;e&&$t.each(r,(t=>{e.insertBefore(t,n.parentNode)})),ae.remove(t)},r=ae.select('span[data-mce-type="bookmark"]',e),s=le(t,n),i=ae.createRng();i.setStartAfter(n),i.setEndAfter(e);const l=i.extractContents();for(let d=l.firstChild;d;d=d.firstChild)if("LI"===d.nodeName&&t.dom.isEmpty(d)){ae.remove(d);break}t.dom.isEmpty(l)||ae.insertAfter(l,e),ae.insertAfter(s,e);const a=n.parentElement;a&&te(t.dom,a)&&o(a),ae.remove(n),te(t.dom,e)&&ae.remove(e)},ce=rt("dd"),me=rt("dt"),ue=(t,e)=>{ce(e)?Rt(e,"dt"):me(e)&&it(e).each((n=>de(t,n.dom,e.dom)))},pe=t=>{me(t)&&Rt(t,"dd")},ge=(t,e,n)=>{O(n,"Indent"===e?pe:e=>ue(t,e))},he=(t,e)=>{if(Ft(t))return{container:t,offset:e};const n=St.getNode(t,e);return Ft(n)?{container:n,offset:e>=t.childNodes.length?n.data.length:0}:n.previousSibling&&Ft(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Ft(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:t,offset:e}},fe=t=>{const e=t.cloneRange(),n=he(t.startContainer,t.startOffset);e.setStart(n.container,n.offset);const o=he(t.endContainer,t.endOffset);return e.setEnd(o.container,o.offset),e},ye=["OL","UL","DL"],Ce=ye.join(","),ve=(t,e)=>{const n=e||t.selection.getStart(!0);return t.dom.getParent(n,Ce,we(t,n))},be=(t,e)=>c(t)&&1===e.length&&e[0]===t,Se=t=>k(t.querySelectorAll(Ce),Kt),Ne=t=>{const e=ve(t),n=t.selection.getSelectedBlocks();return be(e,n)?Se(e):k(n,(t=>Kt(t)&&e!==t))},Le=(t,e)=>{const n=$t.map(e,(e=>{const n=t.dom.getParent(e,"li,dd,dt",we(t,e));return n||e}));return $(n)},Te=t=>{const e=t.selection.getSelectedBlocks();return k(Le(t,e),Qt)},De=t=>k(Te(t),qt),Oe=(t,e)=>{const n=t.dom.getParents(e,"TD,TH");return n.length>0?n[0]:t.getBody()},ke=(t,e)=>!Kt(e)&&!Qt(e)&&T(ye,(n=>t.isValidChild(e.nodeName,n))),we=(t,e)=>{const n=t.dom.getParents(e,t.dom.isBlock),o=x(n,(e=>ke(t.schema,e)));return o.getOr(t.getBody())},Ae=(t,e)=>{const n=t.dom.getParents(e,"ol,ul",we(t,e));return U(n)},Ee=t=>{const e=Ae(t,t.selection.getStart()),n=k(t.selection.getSelectedBlocks(),Vt);return e.toArray().concat(n)},xe=t=>{const e=Ee(t);return Be(t,e)},Be=(t,e)=>{const n=D(e,(e=>Ae(t,e).getOr(e)));return $(n)},Pe=t=>/\btox\-/.test(t.className),Me=(t,e)=>E(t,Kt,Wt).exists((t=>t.nodeName===e&&!Pe(t))),Ie=(t,e)=>null!==e&&"false"===t.dom.getContentEditableParent(e),Re=t=>{const e=ve(t);return Ie(t,e)},Ue=(t,e)=>{const n=t.dom.getParent(e,"ol,ul,dl");return Ie(t,n)},$e=(t,e)=>{const n=t.selection.getNode();return e({parents:t.dom.getParents(n),element:n}),t.on("NodeChange",e),()=>t.off("NodeChange",e)},_e=(t,e)=>{const n=e||document,o=n.createDocumentFragment();return O(t,(t=>{o.appendChild(t.dom)})),W.fromDom(o)},He=(t,e,n)=>t.dispatch("ListMutation",{action:e,element:n}),Fe=t=>e=>e.replace(t,""),je=Fe(/^\s+|\s+$/g),Ke=t=>t.length>0,Ve=t=>!Ke(t),ze=t=>void 0!==t.style&&m(t.style.getPropertyValue),Qe=(t,e,n)=>{if(!s(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);ze(t)&&t.style.setProperty(e,n)},qe=(t,e,n)=>{const o=t.dom;Qe(o,e,n)},We=(t,e)=>{ft(t.item,e.list)},Ze=t=>{for(let e=1;e<t.length;e++)We(t[e-1],t[e])},Ge=(t,e)=>{F(U(t),R(e),We)},Je=(t,e)=>{const n={list:W.fromTag(e,t),item:W.fromTag("li",t)};return ft(n.list,n.item),n},Xe=(t,e,n)=>{const o=[];for(let r=0;r<n;r++)o.push(Je(t,e.listType));return o},Ye=(t,e)=>{for(let n=0;n<t.length-1;n++)qe(t[n].item,"list-style-type","none");U(t).each((t=>{xt(t.list,e.listAttributes),xt(t.item,e.itemAttributes),Ct(t.item,e.content)}))},tn=(t,e)=>{tt(t.list)!==e.listType&&(t.list=Rt(t.list,e.listType)),xt(t.list,e.listAttributes)},en=(t,e,n)=>{const o=W.fromTag("li",t);return xt(o,e),Ct(o,n),o},nn=(t,e)=>{ft(t.list,e),t.item=e},on=(t,e,n)=>{const o=e.slice(0,n.depth);return U(o).each((e=>{const o=en(t,n.itemAttributes,n.content);nn(e,o),tn(e,n)})),o},rn=(t,e,n)=>{const o=Xe(t,n,n.depth-e.length);return Ze(o),Ye(o,n),Ge(e,o),e.concat(o)},sn=(t,e)=>{const n=A(e,((e,n)=>n.depth>e.length?rn(t,e,n):on(t,e,n)),[]);return R(n).map((t=>t.list))},ln=t=>X(t,"OL,UL"),an=t=>ct(t).exists(ln),dn=t=>mt(t).exists(ln),cn=t=>t.depth>0,mn=t=>t.isSelected,un=t=>{const e=at(t),n=dn(t)?e.slice(0,-1):e;return D(n,Mt)},pn=(t,e,n)=>st(t).filter(ot).map((o=>({depth:e,dirty:!1,isSelected:n,content:un(t),itemAttributes:Bt(t),listAttributes:Bt(o),listType:tt(o)}))),gn=(t,e)=>{switch(t){case"Indent":e.depth++;break;case"Outdent":e.depth--;break;case"Flatten":e.depth=0}e.dirty=!0},hn=(t,e)=>{t.listType=e.listType,t.listAttributes={...e.listAttributes}},fn=t=>{t.listAttributes=At(t.listAttributes,((t,e)=>"start"!==e))},yn=(t,e)=>{const n=t[e].depth,o=t=>t.depth===n&&!t.dirty,r=t=>t.depth<n;return E(M(t.slice(0,e)),o,r).orThunk((()=>E(t.slice(e+1),o,r)))},Cn=t=>(O(t,((e,n)=>{yn(t,n).fold((()=>{e.dirty&&fn(e)}),(t=>hn(e,t)))})),t),vn=t=>{let e=t;const n=()=>e,o=t=>{e=t};return{get:n,set:o}},bn=(t,e,n,o)=>ct(o).filter(ln).fold((()=>{e.each((t=>{G(t.start,o)&&n.set(!0)}));const r=pn(o,t,n.get());e.each((t=>{G(t.end,o)&&n.set(!1)}));const s=mt(o).filter(ln).map((o=>Sn(t,e,n,o))).getOr([]);return r.toArray().concat(s)}),(o=>Sn(t,e,n,o))),Sn=(t,e,n,o)=>P(at(o),(o=>{const r=ln(o)?Sn:bn,s=t+1;return r(s,e,n,o)})),Nn=(t,e)=>{const n=vn(!1),o=0;return D(t,(t=>({sourceList:t,entries:Sn(o,e,n,t)})))},Ln=(t,e)=>{const n=Cn(e);return D(n,(e=>{const n=_e(e.content);return W.fromDom(le(t,n.dom))}))},Tn=(t,e)=>{const n=Cn(e);return sn(t.contentDocument,n).toArray()},Dn=(t,e)=>P(w(e,cn),(e=>{const n=R(e).exists(cn);return n?Tn(t,e):Ln(t,e)})),On=(t,e)=>{O(k(t,mn),(t=>gn(e,t)))},kn=t=>{const e=D(Te(t),W.fromDom);return F(x(e,f(an)),x(M(e),f(an)),((t,e)=>({start:t,end:e})))},wn=(t,e,n)=>{const o=Nn(e,kn(t));O(o,(e=>{On(e.entries,n);const o=Dn(t,e.entries);O(o,(e=>{He(t,"Indent"===n?"IndentList":"OutdentList",e.dom)})),yt(e.sourceList,o),bt(e.sourceList)}))},An=(t,e)=>{const n=Tt(xe(t)),o=Tt(De(t));let r=!1;if(n.length||o.length){const s=t.selection.getBookmark();wn(t,n,e),ge(t,e,o),t.selection.moveToBookmark(s),t.selection.setRng(fe(t.selection.getRng())),t.nodeChanged(),r=!0}return r},En=(t,e)=>!Re(t)&&An(t,e),xn=t=>En(t,"Indent"),Bn=t=>En(t,"Outdent"),Pn=t=>En(t,"Flatten");var Mn=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");const In=Ut.DOM,Rn=t=>{const e={},n=n=>{let o=t[n?"startContainer":"endContainer"],r=t[n?"startOffset":"endOffset"];if(jt(o)){const t=In.create("span",{"data-mce-type":"bookmark"});o.hasChildNodes()?(r=Math.min(r,o.childNodes.length-1),n?o.insertBefore(t,o.childNodes[r]):In.insertAfter(t,o.childNodes[r])):o.appendChild(t),o=t,r=0}e[n?"startContainer":"endContainer"]=o,e[n?"startOffset":"endOffset"]=r};return n(!0),t.collapsed||n(),e},Un=t=>{const e=e=>{const n=t=>{var e;let n=null===(e=t.parentNode)||void 0===e?void 0:e.firstChild,o=0;while(n){if(n===t)return o;jt(n)&&"bookmark"===n.getAttribute("data-mce-type")||o++,n=n.nextSibling}return-1};let o=t[e?"startContainer":"endContainer"],r=t[e?"startOffset":"endOffset"];if(o){if(jt(o)&&o.parentNode){const t=o;r=n(o),o=o.parentNode,In.remove(t),!o.hasChildNodes()&&In.isBlock(o)&&o.appendChild(In.create("br"))}t[e?"startContainer":"endContainer"]=o,t[e?"startOffset":"endOffset"]=r}};e(!0),e();const n=In.createRng();return n.setStart(t.startContainer,t.startOffset),t.endContainer&&n.setEnd(t.endContainer,t.endOffset),fe(n)},$n=t=>{switch(t){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},_n=(t,e,n)=>{const o=n["list-style-type"]?n["list-style-type"]:null;t.setStyle(e,"list-style-type",o)},Hn=(t,e)=>{$t.each(e,((e,n)=>{t.setAttribute(n,e)}))},Fn=(t,e,n)=>{Hn(e,n["list-attributes"]),$t.each(t.select("li",e),(t=>{Hn(t,n["list-item-attributes"])}))},jn=(t,e,n)=>{_n(t,e,n),Fn(t,e,n)},Kn=(t,e,n)=>{$t.each(n,(n=>t.setStyle(e,n,"")))},Vn=(t,e,n,o)=>{let r=e[n?"startContainer":"endContainer"];const s=e[n?"startOffset":"endOffset"];jt(r)&&(r=r.childNodes[Math.min(s,r.childNodes.length-1)]||r),!n&&Zt(r.nextSibling)&&(r=r.nextSibling);while(r.parentNode!==o){const e=r.parentNode;if(Jt(t,r))return r;if(/^(TD|TH)$/.test(e.nodeName))return r;r=e}return r},zn=(t,e,n)=>{const o=[],r=t.dom,s=Vn(t,e,!0,n),i=Vn(t,e,!1,n);let l;const a=[];for(let d=s;d;d=d.nextSibling)if(a.push(d),d===i)break;return $t.each(a,(e=>{var s;if(Jt(t,e))return o.push(e),void(l=null);if(r.isBlock(e)||Zt(e))return Zt(e)&&r.remove(e),void(l=null);const i=e.nextSibling;Mn.isBookmarkNode(e)&&(Kt(i)||Jt(t,i)||!i&&e.parentNode===n)?l=null:(l||(l=r.create("p"),null===(s=e.parentNode)||void 0===s||s.insertBefore(l,e),o.push(l)),l.appendChild(e))})),o},Qn=(t,e,n)=>{const o=t.getStyle(e,"list-style-type");let r=n?n["list-style-type"]:"";return r=null===r?"":r,o===r},qn=(t,e,n)=>{const o=t.selection.getRng();let r="LI";const s=we(t,t.selection.getStart(!0)),i=t.dom;if("false"===i.getContentEditable(t.selection.getNode()))return;e=e.toUpperCase(),"DL"===e&&(r="DT");const l=Rn(o),a=zn(t,o,s);$t.each(a,(o=>{let s;const l=o.previousSibling,a=o.parentNode;Qt(a)||(l&&Kt(l)&&l.nodeName===e&&Qn(i,l,n)?(s=l,o=i.rename(o,r),l.appendChild(o)):(s=i.create(e),a.insertBefore(s,o),s.appendChild(o),o=i.rename(o,r)),Kn(i,o,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),jn(i,s,n),Xn(t.dom,s))})),t.selection.setRng(Un(l))},Wn=(t,e)=>Kt(t)&&t.nodeName===(null===e||void 0===e?void 0:e.nodeName),Zn=(t,e,n)=>{const o=t.getStyle(e,"list-style-type",!0),r=t.getStyle(n,"list-style-type",!0);return o===r},Gn=(t,e)=>t.className===e.className,Jn=(t,e,n)=>Wn(e,n)&&Zn(t,e,n)&&Gn(e,n),Xn=(t,e)=>{let n,o=e.nextSibling;if(Jn(t,e,o)){const r=o;while(n=r.firstChild)e.appendChild(n);t.remove(r)}if(o=e.previousSibling,Jn(t,e,o)){const r=o;while(n=r.lastChild)e.insertBefore(n,e.firstChild);t.remove(r)}},Yn=(t,e,n,o)=>{if(e.nodeName!==n){const r=t.dom.rename(e,n);jn(t.dom,r,o),He(t,$n(n),r)}else jn(t.dom,e,o),He(t,$n(n),e)},to=(t,e,n,o,r)=>{const s=Kt(e);if(s&&e.nodeName===o&&!eo(r))Pn(t);else{qn(t,o,r);const i=Rn(t.selection.getRng()),l=s?[e,...n]:n;$t.each(l,(e=>{Yn(t,e,o,r)})),t.selection.setRng(Un(i))}},eo=t=>"list-style-type"in t,no=(t,e,n,o)=>{if(e!==t.getBody())if(e)if(e.nodeName!==n||eo(o)||Pe(e)){const r=Rn(t.selection.getRng());jn(t.dom,e,o);const s=t.dom.rename(e,n);Xn(t.dom,s),t.selection.setRng(Un(r)),qn(t,n,o),He(t,$n(n),s)}else Pn(t);else qn(t,n,o),He(t,$n(n),e)},oo=(t,e,n)=>{const o=ve(t);if(Ue(t,o))return;const r=Ne(t),s=i(n)?n:{};r.length>0?to(t,o,r,e,s):no(t,o,e,s)},ro=Ut.DOM,so=(t,e)=>{const n=e.parentElement;if(n&&"LI"===n.nodeName&&n.firstChild===e){const o=n.previousSibling;o&&"LI"===o.nodeName?(o.appendChild(e),te(t,n)&&ro.remove(n)):ro.setStyle(n,"listStyleType","none")}if(Kt(n)){const t=n.previousSibling;t&&"LI"===t.nodeName&&t.appendChild(e)}},io=(t,e)=>{const n=$t.grep(t.select("ol,ul",e));$t.each(n,(e=>{so(t,e)}))},lo=(t,e,n,o)=>{let r=e.startContainer;const s=e.startOffset;if(Ft(r)&&(n?s<r.data.length:s>0))return r;const i=t.schema.getNonEmptyElements();jt(r)&&(r=St.getNode(r,s));const l=new Nt(r,o);n&&Yt(t.dom,r)&&l.next();const a=n?l.next.bind(l):l.prev2.bind(l);while(r=a()){if("LI"===r.nodeName&&!r.hasChildNodes())return r;if(i[r.nodeName])return r;if(Ft(r)&&r.data.length>0)return r}return null},ao=(t,e)=>{const n=e.childNodes;return 1===n.length&&!Kt(n[0])&&t.isBlock(n[0])},co=(t,e)=>{ao(t,e)&&t.remove(e.firstChild,!0)},mo=(t,e,n)=>{let o;const r=ao(t,n)?n.firstChild:n;if(co(t,e),!te(t,e,!0))while(o=e.firstChild)r.appendChild(o)},uo=(t,e,n)=>{let o;const r=e.parentNode;if(!ee(t,e)||!ee(t,n))return;Kt(n.lastChild)&&(o=n.lastChild),r===n.lastChild&&Zt(r.previousSibling)&&t.remove(r.previousSibling);const s=n.lastChild;s&&Zt(s)&&e.hasChildNodes()&&t.remove(s),te(t,n,!0)&&vt(W.fromDom(n)),mo(t,e,n),o&&n.appendChild(o);const i=J(W.fromDom(n),W.fromDom(e)),l=i?t.getParents(e,Kt,n):[];t.remove(e),O(l,(e=>{te(t,e)&&e!==t.getRoot()&&t.remove(e)}))},po=(t,e,n)=>{vt(W.fromDom(n)),uo(t.dom,e,n),t.selection.setCursorLocation(n,0)},go=(t,e,n,o)=>{const r=t.dom;if(r.isEmpty(o))po(t,n,o);else{const s=Rn(e);uo(r,n,o),t.selection.setRng(Un(s))}},ho=(t,e,n,o)=>{const r=Rn(e);uo(t.dom,n,o);const s=Un(r);t.selection.setRng(s)},fo=(t,e)=>{const n=t.dom,o=t.selection,r=o.getStart(),s=Oe(t,r),i=n.getParent(o.getStart(),"LI",s);if(i){const r=i.parentElement;if(r===t.getBody()&&te(n,r))return!0;const l=fe(o.getRng()),a=n.getParent(lo(t,l,e,s),"LI",s);if(a&&a!==i)return t.undoManager.transact((()=>{e?go(t,l,a,i):Gt(i)?Bn(t):ho(t,l,i,a)})),!0;if(!a&&!e&&0===l.startOffset&&0===l.endOffset)return t.undoManager.transact((()=>{Pn(t)})),!0}return!1},yo=(t,e,n)=>{const o=t.getParent(e.parentNode,t.isBlock,n);t.remove(e),o&&t.isEmpty(o)&&t.remove(o)},Co=(t,e)=>{const n=t.dom,o=t.selection.getStart(),r=Oe(t,o),s=n.getParent(o,n.isBlock,r);if(s&&n.isEmpty(s)){const o=fe(t.selection.getRng()),i=n.getParent(lo(t,o,e,r),"LI",r);if(i){const l=t=>L(["td","th","caption"],tt(t)),a=t=>t.dom===r,d=pt(W.fromDom(i),l,a),c=pt(W.fromDom(o.startContainer),l,a);return!!H(d,c,G)&&(t.undoManager.transact((()=>{yo(n,s,r),Xn(n,i.parentNode),t.selection.select(i,!0),t.selection.collapse(e)})),!0)}}return!1},vo=(t,e)=>fo(t,e)||Co(t,e),bo=t=>{const e=t.selection.getStart(),n=Oe(t,e),o=t.dom.getParent(e,"LI,DT,DD",n);return o||Te(t).length>0},So=t=>!!bo(t)&&(t.undoManager.transact((()=>{t.execCommand("Delete"),io(t.dom,t.getBody())})),!0),No=(t,e)=>{const n=t.selection;return!Ue(t,n.getNode())&&(n.isCollapsed()?vo(t,e):So(t))},Lo=t=>{t.on("ExecCommand",(e=>{const n=e.command.toLowerCase();"delete"!==n&&"forwarddelete"!==n||!bo(t)||io(t.dom,t.getBody())})),t.on("keydown",(e=>{e.keyCode===Lt.BACKSPACE?No(t,!1)&&e.preventDefault():e.keyCode===Lt.DELETE&&No(t,!0)&&e.preventDefault()}))},To=t=>({backspaceDelete:e=>{No(t,e)}}),Do=(t,e)=>{const n=ve(t);null===n||Ue(t,n)||t.undoManager.transact((()=>{i(e.styles)&&t.dom.setStyles(n,e.styles),i(e.attrs)&&Ot(e.attrs,((e,o)=>t.dom.setAttrib(n,o,e)))}))},Oo=t=>{const e=M(je(t).split("")),n=D(e,((t,e)=>{const n=t.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,e)*n}));return A(n,((t,e)=>t+e),0)},ko=t=>{if(t--,t<0)return"";{const e=t%26,n=Math.floor(t/26),o=ko(n),r=String.fromCharCode("A".charCodeAt(0)+e);return o+r}},wo=t=>/^[A-Z]+$/.test(t),Ao=t=>/^[a-z]+$/.test(t),Eo=t=>/^[0-9]+$/.test(t),xo=t=>Eo(t)?2:wo(t)?0:Ao(t)?1:Ve(t)?3:4,Bo=t=>{switch(xo(t)){case 2:return C.some({listStyleType:C.none(),start:t});case 0:return C.some({listStyleType:C.some("upper-alpha"),start:Oo(t).toString()});case 1:return C.some({listStyleType:C.some("lower-alpha"),start:Oo(t).toString()});case 3:return C.some({listStyleType:C.none(),start:""});case 4:return C.none()}},Po=t=>{const e=parseInt(t.start,10);return _(t.listStyleType,"upper-alpha")?ko(e):_(t.listStyleType,"lower-alpha")?ko(e).toLowerCase():t.start},Mo=t=>{const e=ve(t);zt(e)&&!Ue(t,e)&&t.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:Po({start:t.dom.getAttrib(e,"start","1"),listStyleType:C.from(t.dom.getStyle(e,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:e=>{const n=e.getData();Bo(n.start).each((e=>{t.execCommand("mceListUpdate",!1,{attrs:{start:"1"===e.start?"":e.start},styles:{"list-style-type":e.listStyleType.getOr("")}})})),e.close()}})},Io=(t,e)=>()=>{const n=ve(t);return c(n)&&n.nodeName===e},Ro=t=>{t.addCommand("mceListProps",(()=>{Mo(t)}))},Uo=t=>{t.on("BeforeExecCommand",(e=>{const n=e.command.toLowerCase();"indent"===n?xn(t):"outdent"===n&&Bn(t)})),t.addCommand("InsertUnorderedList",((e,n)=>{oo(t,"UL",n)})),t.addCommand("InsertOrderedList",((e,n)=>{oo(t,"OL",n)})),t.addCommand("InsertDefinitionList",((e,n)=>{oo(t,"DL",n)})),t.addCommand("RemoveList",(()=>{Pn(t)})),Ro(t),t.addCommand("mceListUpdate",((e,n)=>{i(n)&&Do(t,n)})),t.addQueryStateHandler("InsertUnorderedList",Io(t,"UL")),t.addQueryStateHandler("InsertOrderedList",Io(t,"OL")),t.addQueryStateHandler("InsertDefinitionList",Io(t,"DL"))},$o=t=>{t.on("keydown",(e=>{e.keyCode!==Lt.TAB||Lt.metaKeyPressed(e)||t.undoManager.transact((()=>{(e.shiftKey?Bn(t):xn(t))&&e.preventDefault()}))}))},_o=t=>{re(t)&&$o(t),Lo(t)},Ho=(t,e)=>n=>{const o=o=>{n.setActive(Me(o.parents,e)),n.setEnabled(!Ue(t,o.element))};return $e(t,o)},Fo=t=>{const e=e=>()=>t.execCommand(e);t.hasPlugin("advlist")||(t.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:e("InsertOrderedList"),onSetup:Ho(t,"OL")}),t.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:e("InsertUnorderedList"),onSetup:Ho(t,"UL")}))},jo=(t,e)=>n=>{const o=o=>n.setEnabled(Me(o.parents,e)&&!Ue(t,o.element));return $e(t,o)},Ko=t=>{const e={text:"List properties...",icon:"ordered-list",onAction:()=>t.execCommand("mceListProps"),onSetup:jo(t,"OL")};t.ui.registry.addMenuItem("listprops",e),t.ui.registry.addContextMenu("lists",{update:e=>{const n=ve(t,e);return zt(n)?["listprops"]:[]}})};var Vo=()=>{t.add("lists",(t=>(oe(t),t.hasPlugin("rtc",!0)?Ro(t):(_o(t),Uo(t)),Fo(t),Ko(t),To(t))))};Vo()})();