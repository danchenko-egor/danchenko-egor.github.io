(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const t=()=>/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g,n=e=>t=>t.options.get(e),o=e=>{const n=e.options.register;n("autolink_pattern",{processor:"regexp",default:new RegExp("^"+t().source+"$","i")}),n("link_default_target",{processor:"string"}),n("link_default_protocol",{processor:"string",default:"https"})},r=n("autolink_pattern"),a=n("link_default_target"),s=n("link_default_protocol"),l=n("allow_unsafe_link_target"),i=(e,t,n)=>{var o;return!!n(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},c=e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&i(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":t},d=e=>t=>c(t)===e,u=e=>t=>e===t,f=d("string"),g=u(void 0),m=e=>null===e||void 0===e,k=e=>!m(e),p=e=>t=>!e(t),h=Object.hasOwnProperty,w=(e,t)=>h.call(e,t),y=(e,t,n)=>""===t||e.length>=t.length&&e.substr(n,n+t.length)===t,v=(e,t,n=0,o)=>{const r=e.indexOf(t,n);return-1!==r&&(!!g(o)||r+t.length<=o)},_=(e,t)=>y(e,t,0),A="\ufeff",C=e=>e===A,b=e=>e.replace(/\uFEFF/g,"");var $=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker");const x=e=>3===e.nodeType,E=e=>1===e.nodeType,P=e=>/^[(\[{ \u00a0]$/.test(e),z=e=>/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(e),N=e=>/[?!,.;:]/.test(e),T=(e,t,n)=>{for(let o=t-1;o>=0;o--){const t=e.charAt(o);if(!C(t)&&n(t))return o}return-1},Z=(e,t)=>{let n=e,o=t;while(E(n)&&n.childNodes[o])n=n.childNodes[o],o=x(n)?n.data.length:n.childNodes.length;return{container:n,offset:o}},B=(e,t)=>{var n;const o=e.schema.getVoidElements(),a=r(e),{dom:l,selection:i}=e;if(null!==l.getParent(i.getNode(),"a[href]"))return null;const c=i.getRng(),d=$(l,(e=>l.isBlock(e)||w(o,e.nodeName.toLowerCase())||"false"===l.getContentEditable(e))),{container:u,offset:f}=Z(c.endContainer,c.endOffset),g=null!==(n=l.getParent(u,l.isBlock))&&void 0!==n?n:l.getRoot(),m=d.backwards(u,f+t,((e,t)=>{const n=e.data,o=T(n,t,p(P));return-1===o||N(n[o])?o:o+1}),g);if(!m)return null;let k=m.container;const h=d.backwards(m.container,m.offset,((e,t)=>{k=e;const n=T(e.data,t,P);return-1===n?n:n+1}),g),y=l.createRng();h?y.setStart(h.container,h.offset):y.setStart(k,0),y.setEnd(m.container,m.offset);const A=b(y.toString()),C=A.match(a);if(C){let t=C[0];if(_(t,"www.")){const n=s(e);t=n+"://"+t}else v(t,"@")&&!z(t)&&(t="mailto:"+t);return{rng:y,url:t}}return null},O=(e,t)=>{const{dom:n,selection:o}=e,{rng:r,url:s}=t,i=o.getBookmark();o.setRng(r);const c="createlink",d={command:c,ui:!1,value:s},u=e.dispatch("BeforeExecCommand",d);if(!u.isDefaultPrevented()){e.getDoc().execCommand(c,!1,s),e.dispatch("ExecCommand",d);const t=a(e);if(f(t)){const r=o.getNode();n.setAttrib(r,"target",t),"_blank"!==t||l(e)||n.setAttrib(r,"rel","noopener")}}o.moveToBookmark(i),e.nodeChanged()},R=e=>{const t=B(e,-1);k(t)&&O(e,t)},S=R,j=e=>{const t=B(e,0);k(t)&&O(e,t)},D=e=>{e.on("keydown",(t=>{13!==t.keyCode||t.isDefaultPrevented()||j(e)})),e.on("keyup",(t=>{32===t.keyCode?R(e):(48===t.keyCode&&t.shiftKey||221===t.keyCode)&&S(e)}))};var F=()=>{e.add("autolink",(e=>{o(e),D(e)}))};F()})();