(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const o=e=>o=>typeof o===e,n=o("function");var t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),a=tinymce.util.Tools.resolve("tinymce.util.Tools");const c=e=>o=>o.options.get(e),i=e=>{const o=e.options.register;o("save_enablewhendirty",{processor:"boolean",default:!0}),o("save_onsavecallback",{processor:"function"}),o("save_oncancelcallback",{processor:"function"})},s=c("save_enablewhendirty"),r=c("save_onsavecallback"),l=c("save_oncancelcallback"),d=(e,o)=>{e.notificationManager.open({text:o,type:"error"})},m=e=>{const o=t.DOM.getParent(e.id,"form");if(s(e)&&!e.isDirty())return;e.save();const a=r(e);if(n(a))return a.call(e,e),void e.nodeChanged();o?(e.setDirty(!1),o.onsubmit&&!o.onsubmit()||("function"===typeof o.submit?o.submit():d(e,"Error: Form submit field collision.")),e.nodeChanged()):d(e,"Error: No form element found.")},u=e=>{const o=a.trim(e.startContent),t=l(e);n(t)?t.call(e,e):e.resetContent(o)},v=e=>{e.addCommand("mceSave",(()=>{m(e)})),e.addCommand("mceCancel",(()=>{u(e)}))},y=e=>o=>{const n=()=>{o.setEnabled(!s(e)||e.isDirty())};return n(),e.on("NodeChange dirty",n),()=>e.off("NodeChange dirty",n)},f=e=>{e.ui.registry.addButton("save",{icon:"save",tooltip:"Save",enabled:!1,onAction:()=>e.execCommand("mceSave"),onSetup:y(e)}),e.ui.registry.addButton("cancel",{icon:"cancel",tooltip:"Cancel",enabled:!1,onAction:()=>e.execCommand("mceCancel"),onSetup:y(e)}),e.addShortcut("Meta+S","","mceSave")};var b=()=>{e.add("save",(e=>{i(e),f(e),v(e)}))};b()})();