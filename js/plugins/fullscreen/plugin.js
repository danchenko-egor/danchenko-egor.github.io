(function(){"use strict";const e=e=>{let t=e;const n=()=>t,o=e=>{t=e};return{get:n,set:o}};var t=tinymce.util.Tools.resolve("tinymce.PluginManager");const n=e=>({isFullscreen:()=>null!==e.get()}),o=(e,t,n)=>{var o;return!!n(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},r=e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&o(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":t},s=e=>t=>r(t)===e,i=e=>t=>typeof t===e,l=e=>t=>e===t,a=s("string"),c=s("array"),u=l(null),d=i("boolean"),m=l(void 0),h=e=>null===e||void 0===e,f=e=>!h(e),g=i("function"),p=i("number"),v=()=>{},w=(e,t)=>(...n)=>e(t.apply(null,n)),y=(e,t)=>n=>e(t(n)),b=e=>()=>e;function S(e,...t){return(...n)=>{const o=t.concat(n);return e.apply(null,o)}}const x=b(!1),E=b(!0);class F{constructor(e,t){this.tag=e,this.value=t}static some(e){return new F(!0,e)}static none(){return F.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?F.some(e(this.value)):F.none()}bind(e){return this.tag?e(this.value):F.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:F.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!==e&&void 0!==e?e:"Called getOrDie on None")}static from(e){return f(e)?F.some(e):F.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}F.singletonNone=new F(!1);const T=t=>{const n=e(F.none()),o=()=>n.get().each(t),r=()=>{o(),n.set(F.none())},s=()=>n.get().isSome(),i=()=>n.get(),l=e=>{o(),n.set(F.some(e))};return{clear:r,isSet:s,get:i,set:l}},k=()=>T((e=>e.unbind())),O=()=>{const e=T(v),t=t=>e.get().each(t);return{...e,on:t}},C=(e,t)=>{let n=null;const o=()=>{u(n)||(clearTimeout(n),n=null)},r=(...o)=>{u(n)&&(n=setTimeout((()=>{n=null,e.apply(null,o)}),t))};return{cancel:o,throttle:r}},D=Array.prototype.push,A=(e,t)=>{const n=e.length,o=new Array(n);for(let r=0;r<n;r++){const n=e[r];o[r]=t(n,r)}return o},R=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const o=e[n];t(o,n)}},N=(e,t)=>{const n=[];for(let o=0,r=e.length;o<r;o++){const r=e[o];t(r,o)&&n.push(r)}return n},L=(e,t,n)=>{for(let o=0,r=e.length;o<r;o++){const r=e[o];if(t(r,o))return F.some(r);if(n(r,o))break}return F.none()},M=(e,t)=>L(e,t,x),P=e=>{const t=[];for(let n=0,o=e.length;n<o;++n){if(!c(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);D.apply(t,e[n])}return t},H=(e,t)=>P(A(e,t)),W=(e,t)=>t>=0&&t<e.length?F.some(e[t]):F.none(),q=e=>W(e,0),B=(e,t)=>{for(let n=0;n<e.length;n++){const o=t(e[n],n);if(o.isSome())return o}return F.none()},I=Object.keys,V=(e,t)=>{const n=I(e);for(let o=0,r=n.length;o<r;o++){const r=n[o],s=e[r];t(s,r)}},_=(e,t,n=0,o)=>{const r=e.indexOf(t,n);return-1!==r&&(!!m(o)||r+t.length<=o)},j=e=>void 0!==e.style&&g(e.style.getPropertyValue),z=(e,t)=>{const n=t||document,o=n.createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return K(o.childNodes[0])},$=(e,t)=>{const n=t||document,o=n.createElement(e);return K(o)},U=(e,t)=>{const n=t||document,o=n.createTextNode(e);return K(o)},K=e=>{if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},X=(e,t,n)=>F.from(e.dom.elementFromPoint(t,n)).map(K),Y={fromHtml:z,fromTag:$,fromText:U,fromDom:K,fromPoint:X};"undefined"!==typeof window?window:Function("return this;")();const G=9,J=11,Q=1,Z=3,ee=e=>e.dom.nodeType,te=e=>t=>ee(t)===e,ne=te(Q),oe=te(Z),re=te(G),se=te(J),ie=(e,t)=>{const n=e.dom;if(n.nodeType!==Q)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},le=e=>e.nodeType!==Q&&e.nodeType!==G&&e.nodeType!==J||0===e.childElementCount,ae=(e,t)=>{const n=void 0===t?document:t.dom;return le(n)?[]:A(n.querySelectorAll(e),Y.fromDom)},ce=(e,t)=>e.dom===t.dom,ue=e=>Y.fromDom(e.dom.ownerDocument),de=e=>re(e)?e:ue(e),me=e=>F.from(e.dom.parentNode).map(Y.fromDom),he=(e,t)=>{const n=g(t)?t:x;let o=e.dom;const r=[];while(null!==o.parentNode&&void 0!==o.parentNode){const e=o.parentNode,t=Y.fromDom(e);if(r.push(t),!0===n(t))break;o=e}return r},fe=e=>{const t=t=>N(t,(t=>!ce(e,t)));return me(e).map(ge).map(t).getOr([])},ge=e=>A(e.dom.childNodes,Y.fromDom),pe=e=>se(e)&&f(e.dom.host),ve=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode),we=b(ve),ye=ve?e=>Y.fromDom(e.dom.getRootNode()):de,be=e=>{const t=ye(e);return pe(t)?F.some(t):F.none()},Se=e=>Y.fromDom(e.dom.host),xe=e=>{if(we()&&f(e.target)){const t=Y.fromDom(e.target);if(ne(t)&&Ee(t)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return q(t)}}return F.from(e.target)},Ee=e=>f(e.dom.shadowRoot),Fe=e=>{const t=oe(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;const n=t.ownerDocument;return be(Y.fromDom(t)).fold((()=>n.body.contains(t)),y(Fe,Se))},Te=e=>{const t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return Y.fromDom(t)},ke=(e,t,n)=>{if(!(a(n)||d(n)||p(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Oe=(e,t,n)=>{ke(e.dom,t,n)},Ce=(e,t)=>{const n=e.dom.getAttribute(t);return null===n?void 0:n},De=(e,t)=>{e.dom.removeAttribute(t)},Ae=(e,t,n)=>{if(!a(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);j(e)&&e.style.setProperty(t,n)},Re=(e,t)=>{const n=e.dom;V(t,((e,t)=>{Ae(n,t,e)}))},Ne=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n),r=o.getPropertyValue(t);return""!==r||Fe(e)?r:Le(n,t)},Le=(e,t)=>j(e)?e.style.getPropertyValue(t):"",Me=(e,t,n,o,r,s,i)=>({target:e,x:t,y:n,stop:o,prevent:r,kill:s,raw:i}),Pe=e=>{const t=Y.fromDom(xe(e).getOr(e.target)),n=()=>e.stopPropagation(),o=()=>e.preventDefault(),r=w(o,n);return Me(t,e.clientX,e.clientY,n,o,r,e)},He=(e,t)=>n=>{e(n)&&t(Pe(n))},We=(e,t,n,o,r)=>{const s=He(n,o);return e.dom.addEventListener(t,s,r),{unbind:S(Be,e,t,s,r)}},qe=(e,t,n,o)=>We(e,t,n,o,!1),Be=(e,t,n,o)=>{e.dom.removeEventListener(t,n,o)},Ie=E,Ve=(e,t,n)=>qe(e,t,Ie,n),_e=e=>{let t,n=!1;return(...o)=>(n||(n=!0,t=e.apply(null,o)),t)},je=(e,t,n,o)=>{const r=e.isiOS()&&!0===/ipad/i.test(n),s=e.isiOS()&&!r,i=e.isiOS()||e.isAndroid(),l=i||o("(pointer:coarse)"),a=r||!s&&i&&o("(min-device-width:768px)"),c=s||i&&!a,u=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),d=!c&&!a&&!u;return{isiPad:b(r),isiPhone:b(s),isTablet:b(a),isPhone:b(c),isTouch:b(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:b(u),isDesktop:b(d)}},ze=(e,t)=>{for(let n=0;n<e.length;n++){const o=e[n];if(o.test(t))return o}},$e=(e,t)=>{const n=ze(e,t);if(!n)return{major:0,minor:0};const o=e=>Number(t.replace(n,"$"+e));return Xe(o(1),o(2))},Ue=(e,t)=>{const n=String(t).toLowerCase();return 0===e.length?Ke():$e(e,n)},Ke=()=>Xe(0,0),Xe=(e,t)=>({major:e,minor:t}),Ye={nu:Xe,detect:Ue,unknown:Ke},Ge=(e,t)=>B(t.brands,(t=>{const n=t.brand.toLowerCase();return M(e,(e=>{var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:Ye.nu(parseInt(t.version,10),0)})))})),Je=(e,t)=>{const n=String(t).toLowerCase();return M(e,(e=>e.search(n)))},Qe=(e,t)=>Je(e,t).map((e=>{const n=Ye.detect(e.versionRegexes,t);return{current:e.name,version:n}})),Ze=(e,t)=>Je(e,t).map((e=>{const n=Ye.detect(e.versionRegexes,t);return{current:e.name,version:n}})),et=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tt=e=>t=>_(t,e),nt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>_(e,"edge/")&&_(e,"chrome")&&_(e,"safari")&&_(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,et],search:e=>_(e,"chrome")&&!_(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>_(e,"msie")||_(e,"trident")},{name:"Opera",versionRegexes:[et,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tt("firefox")},{name:"Safari",versionRegexes:[et,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(_(e,"safari")||_(e,"mobile/"))&&_(e,"applewebkit")}],ot=[{name:"Windows",search:tt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>_(e,"iphone")||_(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tt("linux"),versionRegexes:[]},{name:"Solaris",search:tt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],rt={browsers:b(nt),oses:b(ot)},st="Edge",it="Chromium",lt="IE",at="Opera",ct="Firefox",ut="Safari",dt=()=>mt({current:void 0,version:Ye.unknown()}),mt=e=>{const t=e.current,n=e.version,o=e=>()=>t===e;return{current:t,version:n,isEdge:o(st),isChromium:o(it),isIE:o(lt),isOpera:o(at),isFirefox:o(ct),isSafari:o(ut)}},ht={unknown:dt,nu:mt,edge:b(st),chromium:b(it),ie:b(lt),opera:b(at),firefox:b(ct),safari:b(ut)},ft="Windows",gt="iOS",pt="Android",vt="Linux",wt="macOS",yt="Solaris",bt="FreeBSD",St="ChromeOS",xt=()=>Et({current:void 0,version:Ye.unknown()}),Et=e=>{const t=e.current,n=e.version,o=e=>()=>t===e;return{current:t,version:n,isWindows:o(ft),isiOS:o(gt),isAndroid:o(pt),isMacOS:o(wt),isLinux:o(vt),isSolaris:o(yt),isFreeBSD:o(bt),isChromeOS:o(St)}},Ft={unknown:xt,nu:Et,windows:b(ft),ios:b(gt),android:b(pt),linux:b(vt),macos:b(wt),solaris:b(yt),freebsd:b(bt),chromeos:b(St)},Tt=(e,t,n)=>{const o=rt.browsers(),r=rt.oses(),s=t.bind((e=>Ge(o,e))).orThunk((()=>Qe(o,e))).fold(ht.unknown,ht.nu),i=Ze(r,e).fold(Ft.unknown,Ft.nu),l=je(i,s,e,n);return{browser:s,os:i,deviceType:l}},kt={detect:Tt},Ot=e=>window.matchMedia(e).matches;let Ct=_e((()=>kt.detect(navigator.userAgent,F.from(navigator.userAgentData),Ot)));const Dt=()=>Ct(),At=(e,t)=>{const n=(n,o)=>At(e+n,t+o);return{left:e,top:t,translate:n}},Rt=At,Nt=e=>{const t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return Rt(n,o)},Lt=e=>{const t=void 0===e?window:e;return Dt().browser.isFirefox()?F.none():F.from(t.visualViewport)},Mt=(e,t,n,o)=>({x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}),Pt=e=>{const t=void 0===e?window:e,n=t.document,o=Nt(Y.fromDom(n));return Lt(t).fold((()=>{const e=t.document.documentElement,n=e.clientWidth,r=e.clientHeight;return Mt(o.left,o.top,n,r)}),(e=>Mt(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)))},Ht=(e,t,n)=>Lt(n).map((n=>{const o=e=>t(Pe(e));return n.addEventListener(e,o),{unbind:()=>n.removeEventListener(e,o)}})).getOrThunk((()=>({unbind:v})));var Wt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),qt=tinymce.util.Tools.resolve("tinymce.Env");const Bt=(e,t)=>{e.dispatch("FullscreenStateChanged",{state:t}),e.dispatch("ResizeEditor")},It=e=>t=>t.options.get(e),Vt=e=>{const t=e.options.register;t("fullscreen_native",{processor:"boolean",default:!1})},_t=It("fullscreen_native"),jt=e=>{const t=Y.fromDom(e.getElement());return be(t).map(Se).getOrThunk((()=>Te(ue(t))))},zt=e=>void 0!==e.fullscreenElement?e.fullscreenElement:void 0!==e.msFullscreenElement?e.msFullscreenElement:void 0!==e.webkitFullscreenElement?e.webkitFullscreenElement:null,$t=()=>void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",Ut=e=>{const t=e.dom;t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},Kt=e=>{const t=e.dom;t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()},Xt=e=>e.dom===zt(ue(e).dom),Yt=(e,t,n)=>N(he(e,n),t),Gt=(e,t)=>N(fe(e),t),Jt=e=>ae(e),Qt=(e,t,n)=>Yt(e,(e=>ie(e,t)),n),Zt=(e,t)=>Gt(e,(e=>ie(e,t))),en="data-ephox-mobile-fullscreen-style",tn="display:none!important;",nn="position:absolute!important;",on="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",rn="background-color:rgb(255,255,255)!important;",sn=qt.os.isAndroid(),ln=e=>{const t=Ne(e,"background-color");return void 0!==t&&""!==t?"background-color:"+t+"!important":rn},an=(e,t,n)=>{const o=e=>Zt(e,"*:not(.tox-silver-sink)"),r=t=>n=>{const o=Ce(n,"style"),r=void 0===o?"no-styles":o.trim();r!==t&&(Oe(n,en,r),Re(n,e.parseStyle(t)))},s=Qt(t,"*"),i=H(s,o),l=ln(n);R(i,r(tn)),R(s,r(nn+on+l));const a=!0===sn?"":nn;r(a+on+l)(t)},cn=e=>{const t=Jt("["+en+"]");R(t,(t=>{const n=Ce(t,en);n&&"no-styles"!==n?Re(t,e.parseStyle(n)):De(t,"style"),De(t,en)}))},un=Wt.DOM,dn=()=>Pt(window),mn=e=>window.scrollTo(e.x,e.y),hn=Lt().fold((()=>({bind:v,unbind:v})),(e=>{const t=O(),n=k(),o=k(),r=()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0},s=()=>{window.requestAnimationFrame((()=>{t.on((t=>Re(t,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})))}))},i=C((()=>{r(),s()}),50),l=e=>{t.set(e),i.throttle(),n.set(Ht("resize",i.throttle)),o.set(Ht("scroll",i.throttle))},a=()=>{t.on((()=>{n.clear(),o.clear()})),t.clear()};return{bind:l,unbind:a}})),fn=(e,t)=>{const n=document.body,o=document.documentElement,r=e.getContainer(),s=Y.fromDom(r),i=jt(e),l=t.get(),a=Y.fromDom(e.getBody()),c=qt.deviceType.isTouch(),u=r.style,d=e.iframeElement,m=null===d||void 0===d?void 0:d.style,h=e=>{e(n,"tox-fullscreen"),e(o,"tox-fullscreen"),e(r,"tox-fullscreen"),be(s).map((e=>Se(e).dom)).each((t=>{e(t,"tox-fullscreen"),e(t,"tox-shadowhost")}))},f=()=>{c&&cn(e.dom),h(un.removeClass),hn.unbind(),F.from(t.get()).each((e=>e.fullscreenChangeHandler.unbind()))};if(l)l.fullscreenChangeHandler.unbind(),_t(e)&&Xt(i)&&Kt(ue(i)),m.width=l.iframeWidth,m.height=l.iframeHeight,u.width=l.containerWidth,u.height=l.containerHeight,u.top=l.containerTop,u.left=l.containerLeft,f(),mn(l.scrollPos),t.set(null),Bt(e,!1),e.off("remove",f);else{const n=Ve(ue(i),$t(),(n=>{_t(e)&&(Xt(i)||null===t.get()||fn(e,t))})),o={scrollPos:dn(),containerWidth:u.width,containerHeight:u.height,containerTop:u.top,containerLeft:u.left,iframeWidth:m.width,iframeHeight:m.height,fullscreenChangeHandler:n};c&&an(e.dom,s,a),m.width=m.height="100%",u.width=u.height="",h(un.addClass),hn.bind(s),e.on("remove",f),t.set(o),_t(e)&&Ut(i),Bt(e,!0)}},gn=(e,t)=>{e.addCommand("mceFullScreen",(()=>{fn(e,t)}))},pn=(e,t)=>n=>{n.setActive(null!==t.get());const o=e=>n.setActive(e.state);return e.on("FullscreenStateChanged",o),()=>e.off("FullscreenStateChanged",o)},vn=(e,t)=>{const n=()=>e.execCommand("mceFullScreen");e.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:n,onSetup:pn(e,t)}),e.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:n,onSetup:pn(e,t)})};var wn=()=>{t.add("fullscreen",(t=>{const o=e(null);return t.inline||(Vt(t),gn(t,o),vn(t,o),t.addShortcut("Meta+Shift+F","","mceFullScreen")),n(o)}))};wn()})();