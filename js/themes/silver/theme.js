(function(){"use strict";const e=Object.getPrototypeOf,t=(e,t,o)=>{var n;return!!o(e,t.prototype)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name},o=e=>{const o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&t(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":o},n=e=>t=>o(t)===e,r=e=>t=>typeof t===e,s=e=>t=>e===t,a=(o,n)=>l(o)&&t(o,n,((t,o)=>e(t)===o)),i=n("string"),l=n("object"),c=e=>a(e,Object),d=n("array"),u=s(null),m=r("boolean"),g=s(void 0),p=e=>null===e||void 0===e,h=e=>!p(e),f=r("function"),b=r("number"),v=(e,t)=>{if(d(e)){for(let o=0,n=e.length;o<n;++o)if(!t(e[o]))return!1;return!0}return!1},y=()=>{},x=e=>()=>e(),w=(e,t)=>(...o)=>e(t.apply(null,o)),S=(e,t)=>o=>e(t(o)),k=e=>()=>e,C=e=>e,O=(e,t)=>e===t;function _(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const T=e=>t=>!e(t),E=e=>()=>{throw new Error(e)},D=e=>e(),M=k(!1),A=k(!0);var B=tinymce.util.Tools.resolve("tinymce.ThemeManager");class F{constructor(e,t){this.tag=e,this.value=t}static some(e){return new F(!0,e)}static none(){return F.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?F.some(e(this.value)):F.none()}bind(e){return this.tag?e(this.value):F.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:F.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!==e&&void 0!==e?e:"Called getOrDie on None")}static from(e){return h(e)?F.some(e):F.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}F.singletonNone=new F(!1);const I=Array.prototype.slice,R=Array.prototype.indexOf,N=Array.prototype.push,V=(e,t)=>R.call(e,t),H=(e,t)=>{const o=V(e,t);return-1===o?F.none():F.some(o)},z=(e,t)=>V(e,t)>-1,P=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];if(t(n,o))return!0}return!1},L=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},U=(e,t)=>{const o=[];for(let n=0;n<e.length;n+=t){const r=I.call(e,n,n+t);o.push(r)}return o},W=(e,t)=>{const o=e.length,n=new Array(o);for(let r=0;r<o;r++){const o=e[r];n[r]=t(o,r)}return n},j=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];t(n,o)}},G=(e,t)=>{for(let o=e.length-1;o>=0;o--){const n=e[o];t(n,o)}},$=(e,t)=>{const o=[],n=[];for(let r=0,s=e.length;r<s;r++){const s=e[r],a=t(s,r)?o:n;a.push(s)}return{pass:o,fail:n}},q=(e,t)=>{const o=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t(r,n)&&o.push(r)}return o},K=(e,t,o)=>(G(e,((e,n)=>{o=t(o,e,n)})),o),X=(e,t,o)=>(j(e,((e,n)=>{o=t(o,e,n)})),o),Y=(e,t,o)=>{for(let n=0,r=e.length;n<r;n++){const r=e[n];if(t(r,n))return F.some(r);if(o(r,n))break}return F.none()},J=(e,t)=>Y(e,t,M),Z=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];if(t(n,o))return F.some(o)}return F.none()},Q=e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!d(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);N.apply(t,e[o])}return t},ee=(e,t)=>Q(W(e,t)),te=(e,t)=>{for(let o=0,n=e.length;o<n;++o){const n=e[o];if(!0!==t(n,o))return!1}return!0},oe=e=>{const t=I.call(e,0);return t.reverse(),t},ne=(e,t)=>q(e,(e=>!z(t,e))),re=(e,t)=>{const o={};for(let n=0,r=e.length;n<r;n++){const r=e[n];o[String(r)]=t(r,n)}return o},se=e=>[e],ae=(e,t)=>{const o=I.call(e,0);return o.sort(t),o},ie=(e,t)=>t>=0&&t<e.length?F.some(e[t]):F.none(),le=e=>ie(e,0),ce=e=>ie(e,e.length-1),de=f(Array.from)?Array.from:e=>I.call(e),ue=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return F.none()},me=Object.keys,ge=Object.hasOwnProperty,pe=(e,t)=>{const o=me(e);for(let n=0,r=o.length;n<r;n++){const r=o[n],s=e[r];t(s,r)}},he=(e,t)=>fe(e,((e,o)=>({k:o,v:t(e,o)}))),fe=(e,t)=>{const o={};return pe(e,((e,n)=>{const r=t(e,n);o[r.k]=r.v})),o},be=e=>(t,o)=>{e[o]=t},ve=(e,t,o,n)=>{pe(e,((e,r)=>{(t(e,r)?o:n)(e,r)}))},ye=(e,t)=>{const o={},n={};return ve(e,t,be(o),be(n)),{t:o,f:n}},xe=(e,t)=>{const o={};return ve(e,t,be(o),y),o},we=(e,t)=>{const o=[];return pe(e,((e,n)=>{o.push(t(e,n))})),o},Se=(e,t)=>{const o=me(e);for(let n=0,r=o.length;n<r;n++){const r=o[n],s=e[r];if(t(s,r,e))return F.some(s)}return F.none()},ke=e=>we(e,C),Ce=(e,t)=>Oe(e,t)?F.from(e[t]):F.none(),Oe=(e,t)=>ge.call(e,t),_e=(e,t)=>Oe(e,t)&&void 0!==e[t]&&null!==e[t],Te=(e,t,o=O)=>e.exists((e=>o(e,t))),Ee=(e,t,o=O)=>Ae(e,t,o).getOr(e.isNone()&&t.isNone()),De=e=>{const t=[],o=e=>{t.push(e)};for(let n=0;n<e.length;n++)e[n].each(o);return t},Me=e=>{const t=[];for(let o=0;o<e.length;o++){const n=e[o];if(!n.isSome())return F.none();t.push(n.getOrDie())}return F.some(t)},Ae=(e,t,o)=>e.isSome()&&t.isSome()?F.some(o(e.getOrDie(),t.getOrDie())):F.none(),Be=(e,t,o,n)=>e.isSome()&&t.isSome()&&o.isSome()?F.some(n(e.getOrDie(),t.getOrDie(),o.getOrDie())):F.none(),Fe=(e,t)=>void 0!==e&&null!==e?F.some(t(e)):F.none(),Ie=(e,t)=>e?F.some(t):F.none(),Re=(e,t)=>e+t,Ne=(e,t)=>e.substring(t),Ve=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,He=(e,t)=>Le(e,t)?Ne(e,t.length):e,ze=(e,t)=>Ue(e,t)?e:Re(e,t),Pe=(e,t,o=0,n)=>{const r=e.indexOf(t,o);return-1!==r&&(!!g(n)||r+t.length<=n)},Le=(e,t)=>Ve(e,t,0),Ue=(e,t)=>Ve(e,t,e.length-t.length),We=e=>t=>t.replace(e,""),je=We(/^\s+|\s+$/g),Ge=e=>e.length>0,$e=e=>!Ge(e),qe=e=>void 0!==e.style&&f(e.style.getPropertyValue),Ke=(e,t)=>{const o=t||document,n=o.createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return Je(n.childNodes[0])},Xe=(e,t)=>{const o=t||document,n=o.createElement(e);return Je(n)},Ye=(e,t)=>{const o=t||document,n=o.createTextNode(e);return Je(n)},Je=e=>{if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},Ze=(e,t,o)=>F.from(e.dom.elementFromPoint(t,o)).map(Je),Qe={fromHtml:Ke,fromTag:Xe,fromText:Ye,fromDom:Je,fromPoint:Ze},et="undefined"!==typeof window?window:Function("return this;")(),tt=(e,t)=>{let o=void 0!==t&&null!==t?t:et;for(let n=0;n<e.length&&void 0!==o&&null!==o;++n)o=o[e[n]];return o},ot=(e,t)=>{const o=e.split(".");return tt(o,t)},nt=(e,t)=>ot(e,t),rt=(e,t)=>{const o=nt(e,t);if(void 0===o||null===o)throw new Error(e+" not available on this browser");return o},st=Object.getPrototypeOf,at=e=>rt("HTMLElement",e),it=e=>{const t=ot("ownerDocument.defaultView",e);return l(e)&&(at(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(st(e).constructor.name))},lt=9,ct=11,dt=1,ut=3,mt=e=>{const t=e.dom.nodeName;return t.toLowerCase()},gt=e=>e.dom.nodeType,pt=e=>t=>gt(t)===e,ht=e=>ft(e)&&it(e.dom),ft=pt(dt),bt=pt(ut),vt=pt(lt),yt=pt(ct),xt=e=>t=>ft(t)&&mt(t)===e,wt=(e,t)=>{const o=e.dom;if(o.nodeType!==dt)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},St=e=>e.nodeType!==dt&&e.nodeType!==lt&&e.nodeType!==ct||0===e.childElementCount,kt=(e,t)=>{const o=void 0===t?document:t.dom;return St(o)?[]:W(o.querySelectorAll(e),Qe.fromDom)},Ct=(e,t)=>{const o=void 0===t?document:t.dom;return St(o)?F.none():F.from(o.querySelector(e)).map(Qe.fromDom)},Ot=(e,t)=>e.dom===t.dom,_t=(e,t)=>{const o=e.dom,n=t.dom;return o!==n&&o.contains(n)},Tt=e=>Qe.fromDom(e.dom.ownerDocument),Et=e=>vt(e)?e:Tt(e),Dt=e=>Qe.fromDom(Et(e).dom.documentElement),Mt=e=>Qe.fromDom(Et(e).dom.defaultView),At=e=>F.from(e.dom.parentNode).map(Qe.fromDom),Bt=e=>F.from(e.dom.parentElement).map(Qe.fromDom),Ft=e=>F.from(e.dom.offsetParent).map(Qe.fromDom),It=e=>F.from(e.dom.nextSibling).map(Qe.fromDom),Rt=e=>W(e.dom.childNodes,Qe.fromDom),Nt=(e,t)=>{const o=e.dom.childNodes;return F.from(o[t]).map(Qe.fromDom)},Vt=e=>Nt(e,0),Ht=(e,t)=>({element:e,offset:t}),zt=(e,t)=>{const o=Rt(e);return o.length>0&&t<o.length?Ht(o[t],0):Ht(e,t)},Pt=e=>yt(e)&&h(e.dom.host),Lt=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),Ut=k(Lt),Wt=Lt?e=>Qe.fromDom(e.dom.getRootNode()):Et,jt=e=>Pt(e)?e:Qe.fromDom(Et(e).dom.body),Gt=e=>$t(e).isSome(),$t=e=>{const t=Wt(e);return Pt(t)?F.some(t):F.none()},qt=e=>Qe.fromDom(e.dom.host),Kt=e=>{if(Ut()&&h(e.target)){const t=Qe.fromDom(e.target);if(ft(t)&&Xt(t)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return le(t)}}return F.from(e.target)},Xt=e=>h(e.dom.shadowRoot),Yt=e=>{const t=bt(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return $t(Qe.fromDom(t)).fold((()=>o.body.contains(t)),S(Yt,qt))},Jt=()=>Zt(Qe.fromDom(document)),Zt=e=>{const t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return Qe.fromDom(t)},Qt=(e,t,o)=>{if(!(i(o)||m(o)||b(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},eo=(e,t,o)=>{Qt(e.dom,t,o)},to=(e,t)=>{const o=e.dom;pe(t,((e,t)=>{Qt(o,t,e)}))},oo=(e,t)=>{const o=e.dom.getAttribute(t);return null===o?void 0:o},no=(e,t)=>F.from(oo(e,t)),ro=(e,t)=>{const o=e.dom;return!(!o||!o.hasAttribute)&&o.hasAttribute(t)},so=(e,t)=>{e.dom.removeAttribute(t)},ao=e=>X(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),io=(e,t,o)=>{if(!i(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);qe(e)&&e.style.setProperty(t,o)},lo=(e,t)=>{qe(e)&&e.style.removeProperty(t)},co=(e,t,o)=>{const n=e.dom;io(n,t,o)},uo=(e,t)=>{const o=e.dom;pe(t,((e,t)=>{io(o,t,e)}))},mo=(e,t)=>{const o=e.dom;pe(t,((e,t)=>{e.fold((()=>{lo(o,t)}),(e=>{io(o,t,e)}))}))},go=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o),r=n.getPropertyValue(t);return""!==r||Yt(e)?r:po(o,t)},po=(e,t)=>qe(e)?e.style.getPropertyValue(t):"",ho=(e,t)=>{const o=e.dom,n=po(o,t);return F.from(n).filter((e=>e.length>0))},fo=e=>{const t={},o=e.dom;if(qe(o))for(let n=0;n<o.style.length;n++){const e=o.style.item(n);t[e]=o.style[e]}return t},bo=(e,t,o)=>{const n=Qe.fromTag(e);co(n,t,o);const r=ho(n,t);return r.isSome()},vo=(e,t)=>{const o=e.dom;lo(o,t),Te(no(e,"style").map(je),"")&&so(e,"style")},yo=e=>e.dom.offsetWidth,xo=(e,t)=>{const o=(t,o)=>{if(!b(o)&&!o.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+o);const n=t.dom;qe(n)&&(n.style[e]=o+"px")},n=o=>{const n=t(o);if(n<=0||null===n){const t=go(o,e);return parseFloat(t)||0}return n},r=n,s=(e,t)=>X(t,((t,o)=>{const n=go(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r}),0),a=(e,t,o)=>{const n=s(e,o),r=t>n?t-n:0;return r};return{set:o,get:n,getOuter:r,aggregate:s,max:a}},wo=xo("height",(e=>{const t=e.dom;return Yt(e)?t.getBoundingClientRect().height:t.offsetHeight})),So=e=>wo.get(e),ko=e=>wo.getOuter(e),Co=(e,t)=>{const o=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],n=wo.max(e,t,o);co(e,"max-height",n+"px")},Oo=(e,t)=>{const o=(o,n)=>Oo(e+o,t+n);return{left:e,top:t,translate:o}},_o=Oo,To=e=>{const t=e.getBoundingClientRect();return _o(t.left,t.top)},Eo=(e,t)=>void 0!==e?e:void 0!==t?t:0,Do=e=>{const t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return _o(o.offsetLeft,o.offsetTop);const s=Eo(null===n||void 0===n?void 0:n.pageYOffset,r.scrollTop),a=Eo(null===n||void 0===n?void 0:n.pageXOffset,r.scrollLeft),i=Eo(r.clientTop,o.clientTop),l=Eo(r.clientLeft,o.clientLeft);return Mo(e).translate(a-l,s-i)},Mo=e=>{const t=e.dom,o=t.ownerDocument,n=o.body;return n===t?_o(n.offsetLeft,n.offsetTop):Yt(e)?To(t):_o(0,0)},Ao=xo("width",(e=>e.dom.offsetWidth)),Bo=(e,t)=>Ao.set(e,t),Fo=e=>Ao.get(e),Io=e=>Ao.getOuter(e),Ro=(e,t)=>{const o=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],n=Ao.max(e,t,o);co(e,"max-width",n+"px")},No=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},Vo=(e,t,o,n)=>{const r=e.isiOS()&&!0===/ipad/i.test(o),s=e.isiOS()&&!r,a=e.isiOS()||e.isAndroid(),i=a||n("(pointer:coarse)"),l=r||!s&&a&&n("(min-device-width:768px)"),c=s||a&&!l,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),u=!c&&!l&&!d;return{isiPad:k(r),isiPhone:k(s),isTablet:k(l),isPhone:k(c),isTouch:k(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:k(d),isDesktop:k(u)}},Ho=(e,t)=>{for(let o=0;o<e.length;o++){const n=e[o];if(n.test(t))return n}},zo=(e,t)=>{const o=Ho(e,t);if(!o)return{major:0,minor:0};const n=e=>Number(t.replace(o,"$"+e));return Uo(n(1),n(2))},Po=(e,t)=>{const o=String(t).toLowerCase();return 0===e.length?Lo():zo(e,o)},Lo=()=>Uo(0,0),Uo=(e,t)=>({major:e,minor:t}),Wo={nu:Uo,detect:Po,unknown:Lo},jo=(e,t)=>ue(t.brands,(t=>{const o=t.brand.toLowerCase();return J(e,(e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:Wo.nu(parseInt(t.version,10),0)})))})),Go=(e,t)=>{const o=String(t).toLowerCase();return J(e,(e=>e.search(o)))},$o=(e,t)=>Go(e,t).map((e=>{const o=Wo.detect(e.versionRegexes,t);return{current:e.name,version:o}})),qo=(e,t)=>Go(e,t).map((e=>{const o=Wo.detect(e.versionRegexes,t);return{current:e.name,version:o}})),Ko=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Xo=e=>t=>Pe(t,e),Yo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>Pe(e,"edge/")&&Pe(e,"chrome")&&Pe(e,"safari")&&Pe(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ko],search:e=>Pe(e,"chrome")&&!Pe(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>Pe(e,"msie")||Pe(e,"trident")},{name:"Opera",versionRegexes:[Ko,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Xo("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Xo("firefox")},{name:"Safari",versionRegexes:[Ko,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(Pe(e,"safari")||Pe(e,"mobile/"))&&Pe(e,"applewebkit")}],Jo=[{name:"Windows",search:Xo("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>Pe(e,"iphone")||Pe(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Xo("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Xo("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Xo("linux"),versionRegexes:[]},{name:"Solaris",search:Xo("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Xo("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Xo("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Zo={browsers:k(Yo),oses:k(Jo)},Qo="Edge",en="Chromium",tn="IE",on="Opera",nn="Firefox",rn="Safari",sn=()=>an({current:void 0,version:Wo.unknown()}),an=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(Qo),isChromium:n(en),isIE:n(tn),isOpera:n(on),isFirefox:n(nn),isSafari:n(rn)}},ln={unknown:sn,nu:an,edge:k(Qo),chromium:k(en),ie:k(tn),opera:k(on),firefox:k(nn),safari:k(rn)},cn="Windows",dn="iOS",un="Android",mn="Linux",gn="macOS",pn="Solaris",hn="FreeBSD",fn="ChromeOS",bn=()=>vn({current:void 0,version:Wo.unknown()}),vn=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(cn),isiOS:n(dn),isAndroid:n(un),isMacOS:n(gn),isLinux:n(mn),isSolaris:n(pn),isFreeBSD:n(hn),isChromeOS:n(fn)}},yn={unknown:bn,nu:vn,windows:k(cn),ios:k(dn),android:k(un),linux:k(mn),macos:k(gn),solaris:k(pn),freebsd:k(hn),chromeos:k(fn)},xn=(e,t,o)=>{const n=Zo.browsers(),r=Zo.oses(),s=t.bind((e=>jo(n,e))).orThunk((()=>$o(n,e))).fold(ln.unknown,ln.nu),a=qo(r,e).fold(yn.unknown,yn.nu),i=Vo(a,s,e,o);return{browser:s,os:a,deviceType:i}},wn={detect:xn},Sn=e=>window.matchMedia(e).matches;let kn=No((()=>wn.detect(navigator.userAgent,F.from(navigator.userAgentData),Sn)));const Cn=()=>kn(),On=(e,t,o,n,r,s,a)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:s,raw:a}),_n=e=>{const t=Qe.fromDom(Kt(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=w(n,o);return On(t,e.clientX,e.clientY,o,n,r,e)},Tn=(e,t)=>o=>{e(o)&&t(_n(o))},En=(e,t,o,n,r)=>{const s=Tn(o,n);return e.dom.addEventListener(t,s,r),{unbind:_(An,e,t,s,r)}},Dn=(e,t,o,n)=>En(e,t,o,n,!1),Mn=(e,t,o,n)=>En(e,t,o,n,!0),An=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},Bn=(e,t)=>{const o=At(e);o.each((o=>{o.dom.insertBefore(t.dom,e.dom)}))},Fn=(e,t)=>{const o=It(e);o.fold((()=>{const o=At(e);o.each((e=>{Rn(e,t)}))}),(e=>{Bn(e,t)}))},In=(e,t)=>{const o=Vt(e);o.fold((()=>{Rn(e,t)}),(o=>{e.dom.insertBefore(t.dom,o.dom)}))},Rn=(e,t)=>{e.dom.appendChild(t.dom)},Nn=(e,t,o)=>{Nt(e,o).fold((()=>{Rn(e,t)}),(e=>{Bn(e,t)}))},Vn=(e,t)=>{j(t,(t=>{Rn(e,t)}))},Hn=e=>{e.dom.textContent="",j(Rt(e),(e=>{zn(e)}))},zn=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Pn=e=>{const t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return _o(o,n)},Ln=(e,t,o)=>{const n=void 0!==o?o.dom:document,r=n.defaultView;r&&r.scrollTo(e,t)},Un=e=>{const t=void 0===e?window:e;return Cn().browser.isFirefox()?F.none():F.from(t.visualViewport)},Wn=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),jn=e=>{const t=void 0===e?window:e,o=t.document,n=Pn(Qe.fromDom(o));return Un(t).fold((()=>{const e=t.document.documentElement,o=e.clientWidth,r=e.clientHeight;return Wn(n.left,n.top,o,r)}),(e=>Wn(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height)))},Gn=()=>Qe.fromDom(document),$n=(e,t)=>{const o=e.view(t);return o.fold(k([]),(t=>{const o=e.owner(t),n=$n(e,o);return[t].concat(n)}))},qn=(e,t)=>{const o=t.owner(e),n=$n(t,o);return F.some(n)},Kn=e=>{var t;const o=e.dom===document?F.none():F.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return o.map(Qe.fromDom)},Xn=e=>Tt(e);var Yn=Object.freeze({__proto__:null,view:Kn,owner:Xn});const Jn=e=>{const t=Gn(),o=Pn(t),n=qn(e,Yn);return n.fold(_(Do,e),(t=>{const n=Mo(e),r=K(t,((e,t)=>{const o=Mo(t);return{left:e.left+o.left,top:e.top+o.top}}),{left:0,top:0});return _o(r.left+n.left+o.left,r.top+n.top+o.top)}))},Zn=(e,t,o)=>({point:e,width:t,height:o}),Qn=(e,t,o,n)=>({x:e,y:t,width:o,height:n}),er=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),tr=e=>{const t=Do(e),o=Io(e),n=ko(e);return er(t.left,t.top,o,n)},or=e=>{const t=Jn(e),o=Io(e),n=ko(e);return er(t.left,t.top,o,n)},nr=()=>jn(window),rr=e=>{const t=t=>t(e),o=k(e),n=()=>r,r={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:A,isError:M,map:t=>ir.value(t(e)),mapError:n,bind:t,exists:t,forall:t,getOr:o,or:n,getOrThunk:o,orThunk:n,getOrDie:o,each:t=>{t(e)},toOptional:()=>F.some(e)};return r},sr=e=>{const t=()=>o,o={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:M,isError:A,map:t,mapError:t=>ir.error(t(e)),bind:t,exists:M,forall:A,getOr:C,or:C,getOrThunk:D,orThunk:D,getOrDie:E(String(e)),each:y,toOptional:F.none};return o},ar=(e,t)=>e.fold((()=>sr(t)),rr),ir={value:rr,error:sr,fromOption:ar};var lr;(function(e){e[e["Error"]=0]="Error",e[e["Value"]=1]="Value"})(lr||(lr={}));const cr=(e,t,o)=>e.stype===lr.Error?t(e.serror):o(e.svalue),dr=e=>{const t=[],o=[];return j(e,(e=>{cr(e,(e=>o.push(e)),(e=>t.push(e)))})),{values:t,errors:o}},ur=(e,t)=>e.stype===lr.Error?{stype:lr.Error,serror:t(e.serror)}:e,mr=(e,t)=>e.stype===lr.Value?{stype:lr.Value,svalue:t(e.svalue)}:e,gr=(e,t)=>e.stype===lr.Value?t(e.svalue):e,pr=(e,t)=>e.stype===lr.Error?t(e.serror):e,hr=e=>({stype:lr.Value,svalue:e}),fr=e=>({stype:lr.Error,serror:e}),br=e=>cr(e,ir.error,ir.value),vr=e=>e.fold(fr,hr),yr={fromResult:vr,toResult:br,svalue:hr,partition:dr,serror:fr,bind:gr,bindError:pr,map:mr,mapError:ur,fold:cr},xr=(e,t,o,n)=>({tag:"field",key:e,newKey:t,presence:o,prop:n}),wr=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),Sr=(e,t,o)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return o(e.newKey,e.instantiator)}},kr=(e,t)=>t,Cr=(e,t)=>{const o=c(e)&&c(t);return o?_r(e,t):t},Or=e=>(...t)=>{if(0===t.length)throw new Error("Can't merge zero objects");const o={};for(let n=0;n<t.length;n++){const r=t[n];for(const t in r)Oe(r,t)&&(o[t]=e(o[t],r[t]))}return o},_r=Or(Cr),Tr=Or(kr),Er=()=>({tag:"required",process:{}}),Dr=e=>({tag:"defaultedThunk",process:e}),Mr=e=>Dr(k(e)),Ar=()=>({tag:"option",process:{}}),Br=e=>({tag:"mergeWithThunk",process:e}),Fr=e=>Br(k(e)),Ir=(e,t)=>e.length>0?yr.svalue(_r(t,Tr.apply(void 0,e))):yr.svalue(t),Rr=e=>w(yr.serror,Q)(e),Nr=(e,t)=>{const o=yr.partition(e);return o.errors.length>0?Rr(o.errors):Ir(o.values,t)},Vr=e=>{const t=yr.partition(e);return t.errors.length>0?Rr(t.errors):yr.svalue(t.values)},Hr={consolidateObj:Nr,consolidateArr:Vr},zr=e=>l(e)&&me(e).length>100?" removed due to size":JSON.stringify(e,null,2),Pr=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:k("... (only showing first ten failures)")}]):e;return W(t,(e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()))},Lr=(e,t)=>yr.serror([{path:e,getErrorInfo:t}]),Ur=(e,t,o)=>Lr(e,(()=>'Could not find valid *required* value for "'+t+'" in '+zr(o))),Wr=(e,t)=>Lr(e,(()=>'Choice schema did not contain choice key: "'+t+'"')),jr=(e,t,o)=>Lr(e,(()=>'The chosen schema: "'+o+'" did not exist in branches: '+zr(t))),Gr=(e,t)=>Lr(e,(()=>"There are unsupported fields: ["+t.join(", ")+"] specified")),$r=(e,t)=>Lr(e,k(t)),qr=e=>{const t=(t,o)=>yr.bindError(e(o),(e=>$r(t,e))),o=k("val");return{extract:t,toString:o}},Kr=qr(yr.svalue),Xr=(e,t,o,n)=>Ce(t,o).fold((()=>Ur(e,o,t)),n),Yr=(e,t,o,n)=>{const r=Ce(e,t).getOrThunk((()=>o(e)));return n(r)},Jr=(e,t,o)=>o(Ce(e,t)),Zr=(e,t,o,n)=>{const r=Ce(e,t).map((t=>!0===t?o(e):t));return n(r)},Qr=(e,t,o,n,r)=>{const s=e=>r.extract(t.concat([n]),e),a=e=>e.fold((()=>yr.svalue(F.none())),(e=>{const o=r.extract(t.concat([n]),e);return yr.map(o,F.some)}));switch(e.tag){case"required":return Xr(t,o,n,s);case"defaultedThunk":return Yr(o,n,e.process,s);case"option":return Jr(o,n,a);case"defaultedOptionThunk":return Zr(o,n,e.process,a);case"mergeWithThunk":return Yr(o,n,k({}),(t=>{const n=_r(e.process(o),t);return s(n)}))}},es=(e,t,o)=>{const n={},r=[];for(const s of o)Sr(s,((o,s,a,i)=>{const l=Qr(a,e,t,o,i);yr.fold(l,(e=>{r.push(...e)}),(e=>{n[s]=e}))}),((e,o)=>{n[e]=o(t)}));return r.length>0?yr.serror(r):yr.svalue(n)},ts=e=>{const t=(t,o)=>e().extract(t,o),o=()=>e().toString();return{extract:t,toString:o}},os=e=>me(xe(e,h)),ns=e=>{const t=rs(e),o=K(e,((e,t)=>Sr(t,(t=>_r(e,{[t]:!0})),k(e))),{}),n=(e,n)=>{const r=m(n)?[]:os(n),s=q(r,(e=>!_e(o,e)));return 0===s.length?t.extract(e,n):Gr(e,s)};return{extract:n,toString:t.toString}},rs=e=>{const t=(t,o)=>es(t,o,e),o=()=>{const t=W(e,(e=>Sr(e,((e,t,o,n)=>e+" -> "+n.toString()),((e,t)=>"state("+e+")"))));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:o}},ss=e=>{const t=(t,o)=>{const n=W(o,((o,n)=>e.extract(t.concat(["["+n+"]"]),o)));return Hr.consolidateArr(n)},o=()=>"array("+e.toString()+")";return{extract:t,toString:o}},as=(e,t)=>{const o=void 0!==t?t:C,n=(t,n)=>{const r=[];for(const s of e){const e=s.extract(t,n);if(e.stype===lr.Value)return{stype:lr.Value,svalue:o(e.svalue)};r.push(e)}return Hr.consolidateArr(r)},r=()=>"oneOf("+W(e,(e=>e.toString())).join(", ")+")";return{extract:n,toString:r}},is=(e,t)=>{const o=(t,o)=>ss(qr(e)).extract(t,o),n=(e,n)=>{const r=me(n),s=o(e,r);return yr.bind(s,(o=>{const r=W(o,(e=>xr(e,e,Er(),t)));return rs(r).extract(e,n)}))},r=()=>"setOf("+t.toString()+")";return{extract:n,toString:r}},ls=(e,t)=>{const o=No(t),n=(e,t)=>o().extract(e,t),r=()=>o().toString();return{extract:n,toString:r}},cs=w(ss,rs),ds=k(Kr),us=(e,t)=>qr((o=>{const n=typeof o;return e(o)?yr.svalue(o):yr.serror(`Expected type: ${t} but got: ${n}`)})),ms=us(b,"number"),gs=us(i,"string"),ps=us(m,"boolean"),hs=us(f,"function"),fs=e=>{if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every((t=>fs(e[t])));default:return!1}},bs=qr((e=>fs(e)?yr.svalue(e):yr.serror("Expected value to be acceptable for sending via postMessage"))),vs=(e,t,o,n)=>{const r=Ce(o,n);return r.fold((()=>jr(e,o,n)),(o=>o.extract(e.concat(["branch: "+n]),t)))},ys=(e,t)=>{const o=(o,n)=>{const r=Ce(n,e);return r.fold((()=>Wr(o,e)),(e=>vs(o,n,t,e)))},n=()=>"chooseOn("+e+"). Possible values: "+me(t);return{extract:o,toString:n}},xs=()=>ss(Kr),ws=e=>qr((t=>e(t).fold(yr.serror,yr.svalue))),Ss=(e,t)=>is((t=>yr.fromResult(e(t))),t),ks=(e,t,o)=>{const n=t.extract([e],o);return yr.mapError(n,(e=>({input:o,errors:e})))},Cs=(e,t,o)=>yr.toResult(ks(e,t,o)),Os=e=>e.fold((e=>{throw new Error(Ts(e))}),C),_s=(e,t,o)=>Os(Cs(e,t,o)),Ts=e=>"Errors: \n"+Pr(e.errors).join("\n")+"\n\nInput object: "+zr(e.input),Es=(e,t)=>ys(e,he(t,rs)),Ds=(e,t)=>ls(e,t),Ms=xr,As=wr,Bs=e=>ws((t=>z(e,t)?ir.value(t):ir.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`))),Fs=e=>Ms(e,e,Er(),ds()),Is=(e,t)=>Ms(e,e,Er(),t),Rs=e=>Is(e,ms),Ns=e=>Is(e,gs),Vs=(e,t)=>Ms(e,e,Er(),Bs(t)),Hs=e=>Is(e,ps),zs=e=>Is(e,hs),Ps=(e,t)=>Ms(e,e,Ar(),qr((o=>yr.serror("The field: "+e+" is forbidden. "+t)))),Ls=(e,t)=>Ms(e,e,Er(),rs(t)),Us=(e,t)=>Ms(e,e,Er(),cs(t)),Ws=(e,t)=>Ms(e,e,Er(),ss(t)),js=e=>Ms(e,e,Ar(),ds()),Gs=(e,t)=>Ms(e,e,Ar(),t),$s=e=>Gs(e,ms),qs=e=>Gs(e,gs),Ks=(e,t)=>Gs(e,Bs(t)),Xs=e=>Gs(e,hs),Ys=(e,t)=>Gs(e,ss(t)),Js=(e,t)=>Gs(e,rs(t)),Zs=(e,t)=>Gs(e,ns(t)),Qs=(e,t)=>Ms(e,e,Mr(t),ds()),ea=(e,t,o)=>Ms(e,e,Mr(t),o),ta=(e,t)=>ea(e,t,ms),oa=(e,t)=>ea(e,t,gs),na=(e,t,o)=>ea(e,t,Bs(o)),ra=(e,t)=>ea(e,t,ps),sa=(e,t)=>ea(e,t,hs),aa=(e,t)=>ea(e,t,bs),ia=(e,t,o)=>ea(e,t,ss(o)),la=(e,t,o)=>ea(e,t,rs(o)),ca=e=>{let t=e;const o=()=>t,n=e=>{t=e};return{get:o,set:n}},da=e=>{if(!d(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],o={};return j(e,((n,r)=>{const s=me(n);if(1!==s.length)throw new Error("one and only one name per case");const a=s[0],i=n[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!d(i))throw new Error("case arguments must be an array");t.push(a),o[a]=(...o)=>{const n=o.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+n);const s=e=>{const n=me(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));const r=te(t,(e=>z(n,e)));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,o)};return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);const n=t[r];return n.apply(null,o)},match:s,log:e=>{console.log(e,{constructors:t,constructor:a,params:o})}}}})),o},ua={generate:da};ua.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const ma=e=>{const t=[],o=[];return j(e,(e=>{e.fold((e=>{t.push(e)}),(e=>{o.push(e)}))})),{errors:t,values:o}},ga=(e,t)=>{const o={};return pe(e,((e,n)=>{z(t,n)||(o[n]=e)})),o},pa=(e,t)=>({[e]:t}),ha=e=>{const t={};return j(e,(e=>{t[e.key]=e.value})),t},fa=(e,t)=>ga(e,t),ba=(e,t)=>pa(e,t),va=e=>ha(e),ya=(e,t)=>0===e.length?ir.value(t):ir.value(_r(t,Tr.apply(void 0,e))),xa=e=>ir.error(Q(e)),wa=(e,t)=>{const o=ma(e);return o.errors.length>0?xa(o.errors):ya(o.values,t)},Sa=e=>f(e)?e:M,ka=(e,t,o)=>{let n=e.dom;const r=Sa(o);while(n.parentNode){n=n.parentNode;const e=Qe.fromDom(n),o=t(e);if(o.isSome())return o;if(r(e))break}return F.none()},Ca=(e,t,o)=>{const n=t(e),r=Sa(o);return n.orThunk((()=>r(e)?F.none():ka(e,t,r)))},Oa=(e,t)=>Ot(e.element,t.event.target),_a={can:A,abort:M,run:y},Ta=e=>{if(!_e(e,"can")&&!_e(e,"abort")&&!_e(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return{..._a,...e}},Ea=(e,t)=>(...o)=>X(e,((e,n)=>e&&t(n).apply(void 0,o)),!0),Da=(e,t)=>(...o)=>X(e,((e,n)=>e||t(n).apply(void 0,o)),!1),Ma=e=>f(e)?{can:A,abort:M,run:e}:e,Aa=e=>{const t=Ea(e,(e=>e.can)),o=Da(e,(e=>e.abort)),n=(...t)=>{j(e,(e=>{e.run.apply(void 0,t)}))};return{can:t,abort:o,run:n}},Ba=k,Fa=Ba("touchstart"),Ia=Ba("touchmove"),Ra=Ba("touchend"),Na=Ba("touchcancel"),Va=Ba("mousedown"),Ha=Ba("mousemove"),za=Ba("mouseout"),Pa=Ba("mouseup"),La=Ba("mouseover"),Ua=Ba("focusin"),Wa=Ba("focusout"),ja=Ba("keydown"),Ga=Ba("keyup"),$a=Ba("input"),qa=Ba("change"),Ka=Ba("click"),Xa=Ba("transitioncancel"),Ya=Ba("transitionend"),Ja=Ba("transitionstart"),Za=Ba("selectstart"),Qa=e=>k("alloy."+e),ei={tap:Qa("tap")},ti=Qa("focus"),oi=Qa("blur.post"),ni=Qa("paste.post"),ri=Qa("receive"),si=Qa("execute"),ai=Qa("focus.item"),ii=ei.tap,li=Qa("longpress"),ci=Qa("sandbox.close"),di=Qa("typeahead.cancel"),ui=Qa("system.init"),mi=Qa("system.touchmove"),gi=Qa("system.touchend"),pi=Qa("system.scroll"),hi=Qa("system.resize"),fi=Qa("system.attached"),bi=Qa("system.detached"),vi=Qa("system.dismissRequested"),yi=Qa("system.repositionRequested"),xi=Qa("focusmanager.shifted"),wi=Qa("slotcontainer.visibility"),Si=Qa("change.tab"),ki=Qa("dismiss.tab"),Ci=Qa("highlight"),Oi=Qa("dehighlight"),_i=(e,t)=>{Mi(e,e.element,t,{})},Ti=(e,t,o)=>{Mi(e,e.element,t,o)},Ei=e=>{_i(e,si())},Di=(e,t,o)=>{Mi(e,t,o,{})},Mi=(e,t,o,n)=>{const r={target:t,...n};e.getSystem().triggerEvent(o,t,r)},Ai=(e,t,o,n)=>{const r={...n,target:t};e.getSystem().triggerEvent(o,t,r)},Bi=(e,t,o,n)=>{e.getSystem().triggerEvent(o,t,n.event)},Fi=e=>va(e),Ii=(e,t)=>({key:e,value:Ta({abort:t})}),Ri=(e,t)=>({key:e,value:Ta({can:t})}),Ni=e=>({key:e,value:Ta({run:(e,t)=>{t.event.prevent()}})}),Vi=(e,t)=>({key:e,value:Ta({run:t})}),Hi=(e,t,o)=>({key:e,value:Ta({run:(e,n)=>{t.apply(void 0,[e,n].concat(o))}})}),zi=e=>t=>Vi(e,t),Pi=e=>t=>({key:e,value:Ta({run:(e,o)=>{Oa(e,o)&&t(e,o)}})}),Li=(e,t)=>Vi(e,((o,n)=>{o.getSystem().getByUid(t).each((t=>{Bi(t,t.element,e,n)}))})),Ui=(e,t,o)=>{const n=t.partUids[o];return Li(e,n)},Wi=(e,t)=>Vi(e,((e,o)=>{const n=o.event,r=e.getSystem().getByDom(n.target).getOrThunk((()=>{const t=Ca(n.target,(t=>e.getSystem().getByDom(t).toOptional()),M);return t.getOr(e)}));t(e,r,o)})),ji=e=>Vi(e,((e,t)=>{t.cut()})),Gi=e=>Vi(e,((e,t)=>{t.stop()})),$i=(e,t)=>Pi(e)(t),qi=Pi(fi()),Ki=Pi(bi()),Xi=Pi(ui()),Yi=zi(si()),Ji=(e,t)=>{const o=t||document,n=o.createElement("div");return n.innerHTML=e,Rt(Qe.fromDom(n))},Zi=e=>e.dom.innerHTML,Qi=(e,t)=>{const o=Tt(e),n=o.dom,r=Qe.fromDom(n.createDocumentFragment()),s=Ji(t,n);Vn(r,s),Hn(e),Rn(e,r)},el=e=>{const t=Qe.fromTag("div"),o=Qe.fromDom(e.dom.cloneNode(!0));return Rn(t,o),Zi(t)},tl=(e,t)=>Qe.fromDom(e.dom.cloneNode(t)),ol=e=>tl(e,!1),nl=e=>{if(Pt(e))return"#shadow-root";{const t=ol(e);return el(t)}},rl=e=>nl(e),sl=(e,t,o)=>Ot(t,e.element)&&!Ot(t,o),al=Fi([Ri(ti(),((e,t)=>{const o=t.event,n=o.originator,r=o.target;return!sl(e,n,r)||(console.warn(ti()+" did not get interpreted by the desired target. \nOriginator: "+rl(n)+"\nTarget: "+rl(r)+"\nCheck the "+ti()+" event handlers"),!1)}))]);var il=Object.freeze({__proto__:null,events:al});let ll=0;const cl=e=>{const t=new Date,o=t.getTime(),n=Math.floor(1e9*Math.random());return ll++,e+"_"+n+ll+String(o)},dl=k("alloy-id-"),ul=k("data-alloy-id"),ml=dl(),gl=ul(),pl=(e,t)=>{const o=cl(ml+e);return hl(t,o),o},hl=(e,t)=>{Object.defineProperty(e.dom,gl,{value:t,writable:!0})},fl=e=>{const t=ft(e)?e.dom[gl]:null;return F.from(t)},bl=e=>cl(e),vl=C,yl=e=>{const t=t=>`The component must be in a context to execute: ${t}`+(e?"\n"+rl(e().element)+" is not in context.":""),o=e=>()=>{throw new Error(t(e))},n=e=>()=>{console.warn(t(e))};return{debugInfo:k("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:M}},xl=yl(),wl=(e,t,o)=>{const n=o.toString(),r=n.indexOf(")")+1,s=n.indexOf("("),a=n.substring(s+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:Sl(a.slice(0,1).concat(a.slice(3)))}),e},Sl=e=>W(e,(e=>Ue(e,"/*")?e.substring(0,e.length-"/*".length):e)),kl=(e,t)=>{const o=e.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),s=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:Sl(s)}),e},Cl=(e,t)=>{const o=t.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),s=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:Sl(s.slice(1))}),e},Ol=cl("alloy-premade"),_l=e=>(Object.defineProperty(e.element.dom,Ol,{value:e.uid,writable:!0}),ba(Ol,e)),Tl=e=>Oe(e.dom,Ol),El=e=>Ce(e,Ol),Dl=e=>Cl(((t,...o)=>e(t.getApis(),t,...o)),e),Ml={init:()=>Al({readState:k("No State required")})},Al=e=>e,Bl=(e,t)=>{const o=W(t,(e=>Js(e.name(),[Fs("config"),Qs("state",Ml)]))),n=Cs("component.behaviours",rs(o),e.behaviours).fold((t=>{throw new Error(Ts(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),C);return{list:t,data:he(n,(e=>{const t=e.map((e=>({config:e.config,state:e.state.init(e.config)})));return k(t)}))}},Fl=e=>e.list,Il=e=>e.data,Rl=(e,t)=>{const o={};return pe(e,((e,n)=>{pe(e,((e,r)=>{const s=Ce(o,r).getOr([]);o[r]=s.concat([t(n,e)])}))})),o},Nl=e=>({classes:g(e.classes)?[]:e.classes,attributes:g(e.attributes)?{}:e.attributes,styles:g(e.styles)?{}:e.styles}),Vl=(e,t)=>({...e,attributes:{...e.attributes,...t.attributes},styles:{...e.styles,...t.styles},classes:e.classes.concat(t.classes)}),Hl=(e,t,o,n)=>{const r={...t};j(o,(t=>{r[t.name()]=t.exhibit(e,n)}));const s=Rl(r,((e,t)=>({name:e,modification:t}))),a=e=>K(e,((e,t)=>({...t.modification,...e})),{}),i=K(s.classes,((e,t)=>t.modification.concat(e)),[]),l=a(s.attributes),c=a(s.styles);return Nl({classes:i,attributes:l,styles:c})},zl=(e,t,o,n)=>{try{const r=ae(o,((o,r)=>{const s=o[t],a=r[t],i=n.indexOf(s),l=n.indexOf(a);if(-1===i)throw new Error("The ordering for "+e+" does not have an entry for "+s+".\nOrder specified: "+JSON.stringify(n,null,2));if(-1===l)throw new Error("The ordering for "+e+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(n,null,2));return i<l?-1:l<i?1:0}));return ir.value(r)}catch(r){return ir.error([r])}},Pl=(e,t)=>({handler:e,purpose:t}),Ll=(e,t)=>({cHandler:e,purpose:t}),Ul=(e,t)=>Ll(_.apply(void 0,[e.handler].concat(t)),e.purpose),Wl=e=>e.cHandler,jl=(e,t)=>({name:e,handler:t}),Gl=(e,t)=>{const o={};return j(e,(e=>{o[e.name()]=e.handlers(t)})),o},$l=(e,t,o)=>{const n={...o,...Gl(t,e)};return Rl(n,jl)},ql=(e,t,o,n)=>{const r=$l(e,o,n);return Jl(r,t)},Kl=e=>{const t=Ma(e);return(e,o,...n)=>{const r=[e,o].concat(n);t.abort.apply(void 0,r)?o.stop():t.can.apply(void 0,r)&&t.run.apply(void 0,r)}},Xl=(e,t)=>ir.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(t,(e=>e.name)),null,2)]),Yl=(e,t,o)=>{const n=t[o];return n?zl("Event: "+o,"name",e,n).map((e=>{const t=W(e,(e=>e.handler));return Aa(t)})):Xl(o,e)},Jl=(e,t)=>{const o=we(e,((e,o)=>{const n=1===e.length?ir.value(e[0].handler):Yl(e,t,o);return n.map((n=>{const r=Kl(n),s=e.length>1?q(t[o],(t=>P(e,(e=>e.name===t)))).join(" > "):e[0].name;return ba(o,Pl(r,s))}))}));return wa(o,{})},Zl="alloy.base.behaviour",Ql=rs([Ms("dom","dom",Er(),rs([Fs("tag"),Qs("styles",{}),Qs("classes",[]),Qs("attributes",{}),js("value"),js("innerHtml")])),Fs("components"),Fs("uid"),Qs("events",{}),Qs("apis",{}),Ms("eventOrder","eventOrder",Fr({[si()]:["disabling",Zl,"toggling","typeaheadevents"],[ti()]:[Zl,"focusing","keying"],[ui()]:[Zl,"disabling","toggling","representing"],[$a()]:[Zl,"representing","streaming","invalidating"],[bi()]:[Zl,"representing","item-events","tooltipping"],[Va()]:["focusing",Zl,"item-type-events"],[Fa()]:["focusing",Zl,"item-type-events"],[La()]:["item-type-events","tooltipping"],[ri()]:["receiving","reflecting","tooltipping"]}),ds()),js("domModification")]),ec=e=>Cs("custom.definition",Ql,e),tc=e=>({...e.dom,uid:e.uid,domChildren:W(e.components,(e=>e.element))}),oc=e=>e.domModification.fold((()=>Nl({})),Nl),nc=e=>e.events,rc=(e,t)=>{const o=oo(e,t);return void 0===o||""===o?[]:o.split(" ")},sc=(e,t,o)=>{const n=rc(e,t),r=n.concat([o]);return eo(e,t,r.join(" ")),!0},ac=(e,t,o)=>{const n=q(rc(e,t),(e=>e!==o));return n.length>0?eo(e,t,n.join(" ")):so(e,t),!1},ic=e=>void 0!==e.dom.classList,lc=e=>rc(e,"class"),cc=(e,t)=>sc(e,"class",t),dc=(e,t)=>ac(e,"class",t),uc=(e,t)=>{ic(e)?e.dom.classList.add(t):cc(e,t)},mc=e=>{const t=ic(e)?e.dom.classList:lc(e);0===t.length&&so(e,"class")},gc=(e,t)=>{if(ic(e)){const o=e.dom.classList;o.remove(t)}else dc(e,t);mc(e)},pc=(e,t)=>ic(e)&&e.dom.classList.contains(t),hc=(e,t)=>{j(t,(t=>{uc(e,t)}))},fc=(e,t)=>{j(t,(t=>{gc(e,t)}))},bc=(e,t)=>te(t,(t=>pc(e,t))),vc=e=>{const t=e.dom.classList,o=new Array(t.length);for(let n=0;n<t.length;n++){const e=t.item(n);null!==e&&(o[n]=e)}return o},yc=e=>ic(e)?vc(e):lc(e),xc=e=>e.dom.value,wc=(e,t)=>{if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},Sc=(e,t,o)=>{const n=Nt(e,t);return n.map((e=>{const t=o.exists((t=>!Ot(t,e)));if(t){const t=o.map(mt).getOr("span"),n=Qe.fromTag(t);return Bn(e,n),n}return e}))},kc=(e,t,o)=>{o.fold((()=>Rn(e,t)),(e=>{Ot(e,t)||(Bn(e,t),zn(e))}))},Cc=(e,t,o)=>{const n=W(t,o),r=Rt(e);return j(r.slice(n.length),zn),n},Oc=(e,t,o,n)=>{const r=Nt(e,t),s=n(o,r),a=Sc(e,t,r);return kc(e,s.element,a),s},_c=(e,t,o)=>Cc(e,t,((t,n)=>Oc(e,n,t,o))),Tc=(e,t)=>Cc(e,t,((t,o)=>{const n=Nt(e,o);return kc(e,t,n),t})),Ec=(e,t)=>{const o=me(e),n=me(t),r=ne(n,o),s=ye(e,((e,o)=>!Oe(t,o)||e!==t[o])).t;return{toRemove:r,toSet:s}},Dc=(e,t)=>{const{class:o,style:n,...r}=ao(t),{toSet:s,toRemove:a}=Ec(e.attributes,r),i=()=>{j(a,(e=>so(t,e))),to(t,s)},l=fo(t),{toSet:c,toRemove:d}=Ec(e.styles,l),u=()=>{j(d,(e=>vo(t,e))),uo(t,c)},m=yc(t),g=ne(m,e.classes),p=ne(e.classes,m),h=()=>{hc(t,p),fc(t,g)},f=e=>{Qi(t,e)},b=()=>{const o=e.domChildren;Tc(t,o)},v=()=>{const o=t,n=e.value.getOrUndefined();n!==xc(o)&&wc(o,null!==n&&void 0!==n?n:"")};return i(),h(),u(),e.innerHtml.fold(b,f),v(),t},Mc=e=>{const t=Qe.fromTag(e.tag);to(t,e.attributes),hc(t,e.classes),uo(t,e.styles),e.innerHtml.each((e=>Qi(t,e)));const o=e.domChildren;return Vn(t,o),e.value.each((e=>{wc(t,e)})),t},Ac=(e,t)=>{try{const o=Dc(e,t);return F.some(o)}catch(o){return F.none()}},Bc=e=>e.innerHtml.isSome()&&e.domChildren.length>0,Fc=(e,t)=>{const o=t=>mt(t)===e.tag&&!Bc(e)&&!Tl(t),n=t.filter(o).bind((t=>Ac(e,t))).getOrThunk((()=>Mc(e)));return hl(n,e.uid),n},Ic=e=>{const t=Ce(e,"behaviours").getOr({});return ee(me(t),(e=>{const o=t[e];return h(o)?[o.me]:[]}))},Rc=(e,t)=>Bl(e,t),Nc=e=>{const t=Ic(e);return Rc(e,t)},Vc=(e,t,o)=>{const n=tc(e),r=oc(e),s={"alloy.base.modification":r},a=t.length>0?Hl(o,s,t,n):r;return Vl(n,a)},Hc=(e,t,o)=>{const n={"alloy.base.behaviour":nc(e)};return ql(o,e.eventOrder,t,n).getOrDie()},zc=(e,t)=>{const o=()=>x,n=ca(xl),r=Os(ec(e)),s=Nc(e),a=Fl(s),i=Il(s),l=Vc(r,a,i),c=Fc(l,t),d=Hc(r,a,i),u=ca(r.components),m=e=>{n.set(e)},g=()=>{n.set(yl(o))},p=()=>{const e=Rt(c),t=ee(e,(e=>n.get().getByDom(e).fold((()=>[]),se)));u.set(t)},h=t=>{const o=i,n=f(o[t.name()])?o[t.name()]:()=>{throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))};return n()},b=e=>f(i[e.name()]),v=()=>r.apis,y=e=>i[e]().map((e=>e.state.readState())).getOr("not enabled"),x={uid:e.uid,getSystem:n.get,config:h,hasConfigured:b,spec:e,readState:y,getApis:v,connect:m,disconnect:g,element:c,syncComponents:p,components:u.get,events:d};return x},Pc=(e,t)=>{const o=Ce(e,"components").getOr([]);return t.fold((()=>W(o,qc)),(e=>W(o,((t,o)=>$c(t,Nt(e,o))))))},Lc=(e,t)=>{const{events:o,...n}=vl(e),r=Pc(n,t),s={...n,events:{...il,...o},components:r};return ir.value(zc(s,t))},Uc=e=>{const t=Qe.fromText(e);return Wc({element:t})},Wc=e=>{const t=_s("external.component",ns([Fs("element"),js("uid")]),e),o=ca(yl()),n=e=>{o.set(e)},r=()=>{o.set(yl((()=>a)))},s=t.uid.getOrThunk((()=>bl("external")));hl(t.element,s);const a={uid:s,getSystem:o.get,config:F.none,hasConfigured:M,connect:n,disconnect:r,getApis:()=>({}),element:t.element,spec:e,readState:k("No state"),syncComponents:y,components:k([]),events:{}};return _l(a)},jc=bl,Gc=e=>Oe(e,"uid"),$c=(e,t)=>El(e).getOrThunk((()=>{const o=Gc(e)?e:{uid:jc(""),...e};return Lc(o,t).getOrDie()})),qc=e=>$c(e,F.none()),Kc=_l;var Xc=(e,t,o,n,r)=>e(o,n)?F.some(o):f(r)&&r(o)?F.none():t(o,n,r);const Yc=(e,t,o)=>{let n=e.dom;const r=f(o)?o:M;while(n.parentNode){n=n.parentNode;const e=Qe.fromDom(n);if(t(e))return F.some(e);if(r(e))break}return F.none()},Jc=(e,t,o)=>{const n=(e,t)=>t(e);return Xc(n,Yc,e,t,o)},Zc=(e,t)=>{const o=e=>t(Qe.fromDom(e)),n=J(e.dom.childNodes,o);return n.map(Qe.fromDom)},Qc=(e,t)=>{const o=e=>{for(let n=0;n<e.childNodes.length;n++){const r=Qe.fromDom(e.childNodes[n]);if(t(r))return F.some(r);const s=o(e.childNodes[n]);if(s.isSome())return s}return F.none()};return o(e.dom)},ed=(e,t,o)=>Jc(e,t,o).isSome(),td=(e,t,o)=>Yc(e,(e=>wt(e,t)),o),od=(e,t)=>Zc(e,(e=>wt(e,t))),nd=(e,t)=>Ct(t,e),rd=(e,t,o)=>{const n=(e,t)=>wt(e,t);return Xc(n,td,e,t,o)},sd="aria-controls",ad=e=>{const t=Jc(e,(e=>{if(!ft(e))return!1;const t=oo(e,"id");return void 0!==t&&t.indexOf(sd)>-1}));return t.bind((e=>{const t=oo(e,"id"),o=Wt(e);return nd(o,`[${sd}="${t}"]`)}))},id=()=>{const e=cl(sd),t=t=>{eo(t,sd,e)},o=e=>{so(e,sd)};return{id:e,link:t,unlink:o}},ld=(e,t)=>ad(t).exists((t=>cd(e,t))),cd=(e,t)=>ed(t,(t=>Ot(t,e.element)),M)||ld(e,t),dd="unknown";var ud;(function(e){e[e["STOP"]=0]="STOP",e[e["NORMAL"]=1]="NORMAL",e[e["LOGGING"]=2]="LOGGING"})(ud||(ud={}));const md=ca({}),gd=(e,t)=>{const o=[],n=(new Date).getTime();return{logEventCut:(e,t,n)=>{o.push({outcome:"cut",target:t,purpose:n})},logEventStopped:(e,t,n)=>{o.push({outcome:"stopped",target:t,purpose:n})},logNoParent:(e,t,n)=>{o.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:(e,t)=>{o.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,n)=>{o.push({outcome:"response",purpose:n,target:t})},write:()=>{const r=(new Date).getTime();z(["mousemove","mouseover","mouseout",ui()],e)||console.log(e,{event:e,time:r-n,target:t.dom,sequence:W(o,(e=>z(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+rl(e.target)+")":e.outcome))})}}},pd=(e,t,o)=>{const n=Ce(md.get(),e).orThunk((()=>{const t=me(md.get());return ue(t,(t=>e.indexOf(t)>-1?F.some(md.get()[t]):F.none()))})).getOr(ud.NORMAL);switch(n){case ud.NORMAL:return o(yd());case ud.LOGGING:{const n=gd(e,t),r=o(n);return n.write(),r}case ud.STOP:return!0}},hd=["alloy/data/Fields","alloy/debugging/Debugging"],fd=()=>{const e=new Error;if(void 0!==e.stack){const t=e.stack.split("\n");return J(t,(e=>e.indexOf("alloy")>0&&!P(hd,(t=>e.indexOf(t)>-1)))).getOr(dd)}return dd},bd={logEventCut:y,logEventStopped:y,logNoParent:y,logEventNoHandlers:y,logEventResponse:y,write:y},vd=(e,t,o)=>pd(e,t,o),yd=k(bd),xd=k([Fs("menu"),Fs("selectedMenu")]),wd=k([Fs("item"),Fs("selectedItem")]);k(rs(wd().concat(xd())));const Sd=k(rs(wd())),kd=Ls("initSize",[Fs("numColumns"),Fs("numRows")]),Cd=()=>Is("markers",Sd()),Od=()=>Ls("markers",[Fs("backgroundMenu")].concat(xd()).concat(wd())),_d=e=>Ls("markers",W(e,Fs)),Td=(e,t,o)=>(fd(),Ms(t,t,o,ws((e=>ir.value(((...t)=>e.apply(void 0,t))))))),Ed=e=>Td("onHandler",e,Mr(y)),Dd=e=>Td("onKeyboardHandler",e,Mr(F.none)),Md=e=>Td("onHandler",e,Er()),Ad=e=>Td("onKeyboardHandler",e,Er()),Bd=(e,t)=>As(e,k(t)),Fd=e=>As(e,C),Id=k(kd),Rd=(e,t,o,n,r,s,a,i=!1)=>({x:e,y:t,bubble:o,direction:n,placement:r,restriction:s,label:`${a}-${r}`,alwaysFit:i}),Nd=ua.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Vd=(e,t,o,n,r,s,a,i,l)=>e.fold(t,o,n,r,s,a,i,l),Hd=(e,t,o,n)=>e.fold(t,t,n,n,t,n,o,o),zd=(e,t,o,n)=>e.fold(t,n,t,n,o,o,t,n),Pd=Nd.southeast,Ld=Nd.southwest,Ud=Nd.northeast,Wd=Nd.northwest,jd=Nd.south,Gd=Nd.north,$d=Nd.east,qd=Nd.west,Kd=(e,t,o,n)=>{const r=e+t;return r>n?o:r<o?n:r},Xd=(e,t,o)=>Math.min(Math.max(e,t),o),Yd=(e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},Jd=(e,t)=>re(["left","right","top","bottom"],(o=>Ce(t,o).map((t=>Yd(e,t))))),Zd=(e,t,o)=>{const n=(n,r)=>t[n].map((t=>{const s="top"===n||"bottom"===n,a=s?o.top:o.left,i="left"===n||"top"===n?Math.max:Math.min,l=i(t,r)+a;return s?Xd(l,e.y,e.bottom):Xd(l,e.x,e.right)})).getOr(r),r=n("left",e.x),s=n("top",e.y),a=n("right",e.right),i=n("bottom",e.bottom);return er(r,s,a-r,i-s)},Qd="layout",eu=e=>e.x,tu=(e,t)=>e.x+e.width/2-t.width/2,ou=(e,t)=>e.x+e.width-t.width,nu=(e,t)=>e.y-t.height,ru=e=>e.y+e.height,su=(e,t)=>e.y+e.height/2-t.height/2,au=e=>e.x+e.width,iu=(e,t)=>e.x-t.width,lu=(e,t,o)=>Rd(eu(e),ru(e),o.southeast(),Pd(),"southeast",Jd(e,{left:1,top:3}),Qd),cu=(e,t,o)=>Rd(ou(e,t),ru(e),o.southwest(),Ld(),"southwest",Jd(e,{right:0,top:3}),Qd),du=(e,t,o)=>Rd(eu(e),nu(e,t),o.northeast(),Ud(),"northeast",Jd(e,{left:1,bottom:2}),Qd),uu=(e,t,o)=>Rd(ou(e,t),nu(e,t),o.northwest(),Wd(),"northwest",Jd(e,{right:0,bottom:2}),Qd),mu=(e,t,o)=>Rd(tu(e,t),nu(e,t),o.north(),Gd(),"north",Jd(e,{bottom:2}),Qd),gu=(e,t,o)=>Rd(tu(e,t),ru(e),o.south(),jd(),"south",Jd(e,{top:3}),Qd),pu=(e,t,o)=>Rd(au(e),su(e,t),o.east(),$d(),"east",Jd(e,{left:0}),Qd),hu=(e,t,o)=>Rd(iu(e,t),su(e,t),o.west(),qd(),"west",Jd(e,{right:1}),Qd),fu=()=>[lu,cu,du,uu,gu,mu,pu,hu],bu=()=>[cu,lu,uu,du,gu,mu,pu,hu],vu=()=>[du,uu,lu,cu,mu,gu],yu=()=>[uu,du,cu,lu,mu,gu],xu=()=>[lu,cu,du,uu,gu,mu],wu=()=>[cu,lu,uu,du,gu,mu],Su=(e,t)=>t.universal?e:q(e,(e=>z(t.channels,e))),ku=e=>Fi([Vi(ri(),((t,o)=>{const n=e.channels,r=me(n),s=o,a=Su(r,s);j(a,(e=>{const o=n[e],r=o.schema,a=_s("channel["+e+"] data\nReceiver: "+rl(t.element),r,s.data);o.onReceive(t,a)}))}))]);var Cu=Object.freeze({__proto__:null,events:ku}),Ou=[Is("channels",Ss(ir.value,ns([Md("onReceive"),Qs("schema",ds())])))];const _u=(e,t,o)=>Yi((n=>{o(n,e,t)})),Tu=(e,t,o)=>Xi(((n,r)=>{o(n,e,t)})),Eu=(e,t,o,n,r,s)=>{const a=ns(e),i=Js(t,[Zs("config",e)]);return Bu(a,i,t,o,n,r,s)},Du=(e,t,o,n,r,s)=>{const a=e,i=Js(t,[Gs("config",e)]);return Bu(a,i,t,o,n,r,s)},Mu=(e,t,o)=>{const n=(n,...r)=>{const s=[n].concat(r);return n.config({name:k(e)}).fold((()=>{throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+o)}),(e=>{const o=Array.prototype.slice.call(s,1);return t.apply(void 0,[n,e.config,e.state].concat(o))}))};return wl(n,o,t)},Au=e=>({key:e,value:void 0}),Bu=(e,t,o,n,r,s,a)=>{const i=e=>_e(e,o)?e[o]():F.none(),l=he(r,((e,t)=>Mu(o,e,t))),c=he(s,((e,t)=>kl(e,t))),d={...c,...l,revoke:_(Au,o),config:t=>{const n=_s(o+"-config",e,t);return{key:o,value:{config:n,me:d,configAsRaw:No((()=>_s(o+"-config",e,t))),initialConfig:t,state:a}}},schema:k(t),exhibit:(e,t)=>Ae(i(e),Ce(n,"exhibit"),((e,o)=>o(t,e.config,e.state))).getOrThunk((()=>Nl({}))),name:k(o),handlers:e=>i(e).map((e=>{const t=Ce(n,"events").getOr((()=>({})));return t(e.config,e.state)})).getOr({})};return d},Fu=e=>va(e),Iu=ns([Fs("fields"),Fs("name"),Qs("active",{}),Qs("apis",{}),Qs("state",Ml),Qs("extra",{})]),Ru=e=>{const t=_s("Creating behaviour: "+e.name,Iu,e);return Eu(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Nu=ns([Fs("branchKey"),Fs("branches"),Fs("name"),Qs("active",{}),Qs("apis",{}),Qs("state",Ml),Qs("extra",{})]),Vu=e=>{const t=_s("Creating behaviour: "+e.name,Nu,e);return Du(Es(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Hu=k(void 0),zu=Ru({fields:Ou,name:"receiving",active:Cu}),Pu=(e,t)=>Nl({classes:[],styles:t.useFixed()?{}:{position:"relative"}});var Lu=Object.freeze({__proto__:null,exhibit:Pu});const Uu=e=>e.dom.focus(),Wu=e=>e.dom.blur(),ju=e=>{const t=Wt(e).dom;return e.dom===t.activeElement},Gu=(e=Gn())=>F.from(e.dom.activeElement).map(Qe.fromDom),$u=e=>Gu(Wt(e)).filter((t=>e.dom.contains(t.dom))),qu=(e,t)=>{const o=Wt(t),n=Gu(o).bind((e=>{const o=t=>Ot(e,t);return o(t)?F.some(t):Qc(t,o)})),r=e(t);return n.each((e=>{Gu(o).filter((t=>Ot(t,e))).fold((()=>{Uu(e)}),y)})),r},Ku=(e,t,o,n,r)=>{const s=e=>e+"px";return{position:e,left:t.map(s),top:o.map(s),right:n.map(s),bottom:r.map(s)}},Xu=e=>({...e,position:F.some(e.position)}),Yu=(e,t)=>{mo(e,Xu(t))},Ju=ua.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Zu=(e,t,o,n,r,s)=>{const a=t.rect,i=a.x-o,l=a.y-n,c=a.width,d=a.height,u=r-(i+c),m=s-(l+d),g=F.some(i),p=F.some(l),h=F.some(u),f=F.some(m),b=F.none();return Vd(t.direction,(()=>Ku(e,g,p,b,b)),(()=>Ku(e,b,p,h,b)),(()=>Ku(e,g,b,b,f)),(()=>Ku(e,b,b,h,f)),(()=>Ku(e,g,p,b,b)),(()=>Ku(e,g,b,b,f)),(()=>Ku(e,g,p,b,b)),(()=>Ku(e,b,p,h,b)))},Qu=(e,t)=>e.fold((()=>{const e=t.rect;return Ku("absolute",F.some(e.x),F.some(e.y),F.none(),F.none())}),((e,o,n,r)=>Zu("absolute",t,e,o,n,r)),((e,o,n,r)=>Zu("fixed",t,e,o,n,r))),em=(e,t)=>{const o=_(Jn,t),n=e.fold(o,o,(()=>{const e=Pn();return Jn(t).translate(-e.left,-e.top)})),r=Io(t),s=ko(t);return er(n.left,n.top,r,s)},tm=(e,t)=>t.fold((()=>e.fold(nr,nr,er)),(t=>e.fold(t,t,(()=>{const o=t(),n=om(e,o.x,o.y);return er(n.left,n.top,o.width,o.height)})))),om=(e,t,o)=>{const n=_o(t,o),r=()=>{const e=Pn();return n.translate(-e.left,-e.top)};return e.fold(k(n),k(n),r)},nm=(e,t,o,n)=>e.fold(t,o,n);Ju.none;const rm=Ju.relative,sm=Ju.fixed,am=(e,t)=>({anchorBox:e,origin:t}),im=(e,t)=>am(e,t),lm="data-alloy-placement",cm=(e,t)=>{eo(e,lm,t)},dm=e=>no(e,lm),um=e=>so(e,lm),mm=ua.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),gm=(e,t)=>{const{x:o,y:n,right:r,bottom:s}=t,{x:a,y:i,right:l,bottom:c,width:d,height:u}=e,m=a>=o&&a<=r,g=i>=n&&i<=s,p=m&&g,h=l<=r&&l>=o,f=c<=s&&c>=n,b=h&&f,v=Math.min(d,a>=o?r-a:l-o),y=Math.min(u,i>=n?s-i:c-n);return{originInBounds:p,sizeInBounds:b,visibleW:v,visibleH:y}},pm=(e,t)=>{const{x:o,y:n,right:r,bottom:s}=t,{x:a,y:i,width:l,height:c}=e,d=Math.max(o,r-l),u=Math.max(n,s-c),m=Xd(a,o,d),g=Xd(i,n,u),p=Math.min(m+l,r)-m,h=Math.min(g+c,s)-g;return er(m,g,p,h)},hm=(e,t,o)=>{const n=k(t.bottom-o.y),r=k(o.bottom-t.y),s=Hd(e,r,r,n),a=k(t.right-o.x),i=k(o.right-t.x),l=zd(e,i,i,a);return{maxWidth:l,maxHeight:s}},fm=(e,t,o,n)=>{const r=e.bubble,s=r.offset,a=Zd(n,e.restriction,s),i=e.x+s.left,l=e.y+s.top,c=er(i,l,t,o),{originInBounds:d,sizeInBounds:u,visibleW:m,visibleH:g}=gm(c,a),p=d&&u,h=p?c:pm(c,a),f=h.width>0&&h.height>0,{maxWidth:b,maxHeight:v}=hm(e.direction,h,n),y={rect:h,maxHeight:v,maxWidth:b,direction:e.direction,placement:e.placement,classes:{on:r.classesOn,off:r.classesOff},layout:e.label,testY:l};return p||e.alwaysFit?mm.fit(y):mm.nofit(y,m,g,f)},bm=(e,t,o,n,r,s)=>{const a=n.width,i=n.height,l=(t,l,c,d,u)=>{const m=t(o,n,r,e,s),g=fm(m,a,i,s);return g.fold(k(g),((e,t,o,n)=>{const r=u===n?o>d||t>c:!u&&n;return r?g:mm.nofit(l,c,d,u)}))},c=X(t,((e,t)=>{const o=_(l,t);return e.fold(k(e),o)}),mm.nofit({rect:o,maxHeight:n.height,maxWidth:n.width,direction:Pd(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:o.y},-1,-1,!1));return c.fold(C,C)},vm=e=>{const t=ca(F.none()),o=()=>t.get().each(e),n=()=>{o(),t.set(F.none())},r=()=>t.get().isSome(),s=()=>t.get(),a=e=>{o(),t.set(F.some(e))};return{clear:n,isSet:r,get:s,set:a}},ym=()=>vm((e=>e.destroy())),xm=()=>vm((e=>e.unbind())),wm=()=>{const e=vm(y),t=t=>e.get().each(t);return{...e,on:t}},Sm=A,km=(e,t,o)=>Dn(e,t,Sm,o),Cm=(e,t,o)=>Mn(e,t,Sm,o),Om=_n,_m=["top","bottom","right","left"],Tm="data-alloy-transition-timer",Em=(e,t)=>bc(e,t.classes),Dm=(e,t,o)=>o.exists((o=>{const n=e.mode;return"all"===n||o[n]!==t[n]})),Mm=(e,t)=>{const o=e=>parseFloat(e).toFixed(3);return Se(t,((t,n)=>{const r=e[n].map(o),s=t.map(o);return!Ee(r,s)})).isSome()},Am=e=>{const t=t=>{const o=go(e,t),n=o.split(/\s*,\s*/);return q(n,Ge)},o=e=>{if(i(e)&&/^[\d.]+/.test(e)){const t=parseFloat(e);return Ue(e,"ms")?t:1e3*t}return 0},n=t("transition-delay"),r=t("transition-duration");return X(r,((e,t,r)=>{const s=o(n[r])+o(t);return Math.max(e,s)}),0)},Bm=(e,t)=>{const o=xm(),n=xm();let r;const s=t=>{var o;const n=null!==(o=t.raw.pseudoElement)&&void 0!==o?o:"";return Ot(t.target,e)&&$e(n)&&z(_m,t.raw.propertyName)},a=a=>{if(p(a)||s(a)){o.clear(),n.clear();const s=null===a||void 0===a?void 0:a.raw.type;(p(s)||s===Ya())&&(clearTimeout(r),so(e,Tm),fc(e,t.classes))}},i=km(e,Ja(),(t=>{s(t)&&(i.unbind(),o.set(km(e,Ya(),a)),n.set(km(e,Xa(),a)))})),l=Am(e);requestAnimationFrame((()=>{r=setTimeout(a,l+17),eo(e,Tm,r)}))},Fm=(e,t)=>{hc(e,t.classes),no(e,Tm).each((t=>{clearTimeout(parseInt(t,10)),so(e,Tm)})),Bm(e,t)},Im=(e,t,o,n,r,s)=>{const a=Dm(n,r,s);if(a||Em(e,n)){co(e,"position",o.position);const s=em(t,e),i=Qu(t,{...r,rect:s}),l=re(_m,(e=>i[e]));Mm(o,l)&&(mo(e,l),a&&Fm(e,n),yo(e))}else fc(e,n.classes)},Rm=e=>({width:Io(e),height:ko(e)}),Nm=(e,t,o,n)=>{vo(t,"max-height"),vo(t,"max-width");const r=Rm(t);return bm(t,n.preference,e,r,o,n.bounds)},Vm=(e,t)=>{const o=t.classes;fc(e,o.off),hc(e,o.on)},Hm=(e,t,o)=>{const n=o.maxHeightFunction;n(e,t.maxHeight)},zm=(e,t,o)=>{const n=o.maxWidthFunction;n(e,t.maxWidth)},Pm=(e,t,o)=>{const n=Qu(o.origin,t);o.transition.each((r=>{Im(e,o.origin,n,r,t,o.lastPlacement)})),Yu(e,n)},Lm=(e,t)=>{cm(e,t.placement)},Um=(e,t)=>{Co(e,Math.floor(t))},Wm=k(((e,t)=>{Um(e,t),uo(e,{"overflow-x":"hidden","overflow-y":"auto"})})),jm=k(((e,t)=>{Um(e,t)})),Gm=(e,t,o)=>void 0===e[t]?o:e[t],$m=(e,t,o,n,r,s,a,i)=>{const l=Gm(a,"maxHeightFunction",Wm()),c=Gm(a,"maxWidthFunction",y),d=e.anchorBox,u=e.origin,m={bounds:tm(u,s),origin:u,preference:n,maxHeightFunction:l,maxWidthFunction:c,lastPlacement:r,transition:i};return qm(d,t,o,m)},qm=(e,t,o,n)=>{const r=Nm(e,t,o,n);return Pm(t,r,n),Lm(t,r),Vm(t,r),Hm(t,r,n),zm(t,r,n),{layout:r.layout,placement:r.placement}},Km=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Xm=(e,t,o,n=1)=>{const r=e*n,s=t*n,a=e=>Ce(o,e).getOr([]),i=(e,t,o)=>{const n=ne(Km,o);return{offset:_o(e,t),classesOn:ee(o,a),classesOff:ee(n,a)}};return{southeast:()=>i(-e,t,["top","alignLeft"]),southwest:()=>i(e,t,["top","alignRight"]),south:()=>i(-e/2,t,["top","alignCentre"]),northeast:()=>i(-e,-t,["bottom","alignLeft"]),northwest:()=>i(e,-t,["bottom","alignRight"]),north:()=>i(-e/2,-t,["bottom","alignCentre"]),east:()=>i(e,-t/2,["valignCentre","left"]),west:()=>i(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>i(r,s,["top","alignLeft","inset"]),insetNorthwest:()=>i(-r,s,["top","alignRight","inset"]),insetNorth:()=>i(-r/2,s,["top","alignCentre","inset"]),insetSoutheast:()=>i(r,-s,["bottom","alignLeft","inset"]),insetSouthwest:()=>i(-r,-s,["bottom","alignRight","inset"]),insetSouth:()=>i(-r/2,-s,["bottom","alignCentre","inset"]),insetEast:()=>i(-r,-s/2,["valignCentre","right","inset"]),insetWest:()=>i(r,-s/2,["valignCentre","left","inset"])}},Ym=()=>Xm(0,0,{}),Jm=C,Zm=(e,t)=>o=>"rtl"===Qm(o)?t:e,Qm=e=>"rtl"===go(e,"direction")?"rtl":"ltr";var eg;(function(e){e["TopToBottom"]="toptobottom",e["BottomToTop"]="bottomtotop"})(eg||(eg={}));const tg="data-alloy-vertical-dir",og=e=>ed(e,(e=>ft(e)&&oo(e,"data-alloy-vertical-dir")===eg.BottomToTop)),ng=()=>Js("layouts",[Fs("onLtr"),Fs("onRtl"),js("onBottomLtr"),js("onBottomRtl")]),rg=(e,t,o,n,r,s,a)=>{const i=a.map(og).getOr(!1),l=t.layouts.map((t=>t.onLtr(e))),c=t.layouts.map((t=>t.onRtl(e))),d=i?t.layouts.bind((t=>t.onBottomLtr.map((t=>t(e))))).or(l).getOr(r):l.getOr(o),u=i?t.layouts.bind((t=>t.onBottomRtl.map((t=>t(e))))).or(c).getOr(s):c.getOr(n),m=Zm(d,u);return m(e)},sg=(e,t,o)=>{const n=t.hotspot,r=em(o,n.element),s=rg(e.element,t,xu(),wu(),vu(),yu(),F.some(t.hotspot.element));return F.some(Jm({anchorBox:r,bubble:t.bubble.getOr(Ym()),overrides:t.overrides,layouts:s,placer:F.none()}))};var ag=[Fs("hotspot"),js("bubble"),Qs("overrides",{}),ng(),Bd("placement",sg)];const ig=(e,t,o)=>{const n=om(o,t.x,t.y),r=er(n.left,n.top,t.width,t.height),s=rg(e.element,t,fu(),bu(),fu(),bu(),F.none());return F.some(Jm({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:s,placer:F.none()}))};var lg=[Fs("x"),Fs("y"),Qs("height",0),Qs("width",0),Qs("bubble",Ym()),Qs("overrides",{}),ng(),Bd("placement",ig)];const cg=ua.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),dg=e=>e.fold(C,((e,t,o)=>e.translate(-t,-o))),ug=e=>e.fold(C,C),mg=e=>X(e,((e,t)=>e.translate(t.left,t.top)),_o(0,0)),gg=e=>{const t=W(e,dg);return mg(t)},pg=e=>{const t=W(e,ug);return mg(t)},hg=cg.screen,fg=cg.absolute,bg=(e,t,o)=>{const n=Mt(o.root).dom,r=t=>{const o=Tt(t),n=Tt(e.element);return Ot(o,n)};return F.from(n.frameElement).map(Qe.fromDom).filter(r).map(Do)},vg=(e,t,o)=>{const n=Tt(e.element),r=Pn(n),s=bg(e,t,o).getOr(r);return fg(s,r.left,r.top)},yg=(e,t,o,n)=>{const r=hg(_o(e,t));return F.some(Zn(r,o,n))},xg=(e,t,o,n,r)=>e.map((e=>{const s=[t,e.point],a=nm(n,(()=>pg(s)),(()=>pg(s)),(()=>gg(s))),i=Qn(a.left,a.top,e.width,e.height),l=o.showAbove?vu():xu(),c=o.showAbove?yu():wu(),d=rg(r,o,l,c,l,c,F.none());return Jm({anchorBox:i,bubble:o.bubble.getOr(Ym()),overrides:o.overrides,layouts:d,placer:F.none()})})),wg=(e,t,o)=>{const n=vg(e,o,t);return t.node.filter(Yt).bind((r=>{const s=r.dom.getBoundingClientRect(),a=yg(s.left,s.top,s.width,s.height),i=t.node.getOr(e.element);return xg(a,n,t,o,i)}))};var Sg=[Fs("node"),Fs("root"),js("bubble"),ng(),Qs("overrides",{}),Qs("showAbove",!1),Bd("placement",wg)];const kg="\ufeff",Cg=" ",Og=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),_g={create:Og},Tg=ua.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Eg=(e,t,o,n)=>e.fold(t,o,n),Dg=e=>e.fold(C,C,C),Mg=Tg.before,Ag=Tg.on,Bg=Tg.after,Fg={before:Mg,on:Ag,after:Bg,cata:Eg,getStart:Dg},Ig=ua.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Rg=e=>Ig.exact(e.start,e.soffset,e.finish,e.foffset),Ng=e=>e.match({domRange:e=>Qe.fromDom(e.startContainer),relative:(e,t)=>Fg.getStart(e),exact:(e,t,o,n)=>e}),Vg=Ig.domRange,Hg=Ig.relative,zg=Ig.exact,Pg=e=>{const t=Ng(e);return Mt(t)},Lg=_g.create,Ug={domRange:Vg,relative:Hg,exact:zg,exactFromRange:Rg,getWin:Pg,range:Lg},Wg=(e,t)=>{t.fold((t=>{e.setStartBefore(t.dom)}),((t,o)=>{e.setStart(t.dom,o)}),(t=>{e.setStartAfter(t.dom)}))},jg=(e,t)=>{t.fold((t=>{e.setEndBefore(t.dom)}),((t,o)=>{e.setEnd(t.dom,o)}),(t=>{e.setEndAfter(t.dom)}))},Gg=(e,t,o)=>{const n=e.document.createRange();return Wg(n,t),jg(n,o),n},$g=(e,t,o,n,r)=>{const s=e.document.createRange();return s.setStart(t.dom,o),s.setEnd(n.dom,r),s},qg=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),Kg=e=>{const t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?F.some(o).map(qg):F.none()},Xg=e=>{const t=e.getBoundingClientRect();return t.width>0||t.height>0?F.some(t).map(qg):F.none()},Yg=ua.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Jg=(e,t,o)=>t(Qe.fromDom(o.startContainer),o.startOffset,Qe.fromDom(o.endContainer),o.endOffset),Zg=(e,t)=>t.match({domRange:e=>({ltr:k(e),rtl:F.none}),relative:(t,o)=>({ltr:No((()=>Gg(e,t,o))),rtl:No((()=>F.some(Gg(e,o,t))))}),exact:(t,o,n,r)=>({ltr:No((()=>$g(e,t,o,n,r))),rtl:No((()=>F.some($g(e,n,r,t,o))))})}),Qg=(e,t)=>{const o=t.ltr();if(o.collapsed){const n=t.rtl().filter((e=>!1===e.collapsed));return n.map((e=>Yg.rtl(Qe.fromDom(e.endContainer),e.endOffset,Qe.fromDom(e.startContainer),e.startOffset))).getOrThunk((()=>Jg(e,Yg.ltr,o)))}return Jg(e,Yg.ltr,o)},ep=(e,t)=>{const o=Zg(e,t);return Qg(e,o)},tp=(e,t)=>{const o=ep(e,t);return o.match({ltr:(t,o,n,r)=>{const s=e.document.createRange();return s.setStart(t.dom,o),s.setEnd(n.dom,r),s},rtl:(t,o,n,r)=>{const s=e.document.createRange();return s.setStart(n.dom,r),s.setEnd(t.dom,o),s}})};Yg.ltr,Yg.rtl;const op=(e,t)=>kt(t,e),np=(e,t,o,n)=>{const r=Tt(e),s=r.dom.createRange();return s.setStart(e.dom,t),s.setEnd(o.dom,n),s},rp=(e,t,o,n)=>{const r=np(e,t,o,n),s=Ot(e,o)&&t===n;return r.collapsed&&!s},sp=e=>F.from(e.getSelection()),ap=e=>{if(e.rangeCount>0){const t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return F.some(_g.create(Qe.fromDom(t.startContainer),t.startOffset,Qe.fromDom(o.endContainer),o.endOffset))}return F.none()},ip=e=>{if(null===e.anchorNode||null===e.focusNode)return ap(e);{const t=Qe.fromDom(e.anchorNode),o=Qe.fromDom(e.focusNode);return rp(t,e.anchorOffset,o,e.focusOffset)?F.some(_g.create(t,e.anchorOffset,o,e.focusOffset)):ap(e)}},lp=e=>sp(e).filter((e=>e.rangeCount>0)).bind(ip),cp=(e,t)=>{const o=tp(e,t);return Kg(o)},dp=(e,t)=>{const o=tp(e,t);return Xg(o)},up=(e,t)=>{const o=o=>{if(!e(o))throw new Error("Can only get "+t+" value of a "+t+" node");return n(o).getOr("")},n=t=>e(t)?F.from(t.dom.nodeValue):F.none(),r=(o,n)=>{if(!e(o))throw new Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=n};return{get:o,getOption:n,set:r}},mp=up(bt,"text"),gp=e=>mp.get(e),pp=(e,t)=>({element:e,offset:t}),hp=(e,t)=>{const o=Rt(e);if(0===o.length)return pp(e,t);if(t<o.length)return pp(o[t],0);{const e=o[o.length-1],t=bt(e)?gp(e).length:Rt(e).length;return pp(e,t)}},fp=(e,t)=>bt(e)?pp(e,t):hp(e,t),bp=(e,t)=>{const o=t.getSelection.getOrThunk((()=>()=>lp(e)));return o().map((e=>{const t=fp(e.start,e.soffset),o=fp(e.finish,e.foffset);return Ug.range(t.element,t.offset,o.element,o.offset)}))},vp=(e,t,o)=>{const n=Mt(t.root).dom,r=vg(e,o,t),s=bp(n,t).bind((e=>{const t=dp(n,Ug.exactFromRange(e)).orThunk((()=>{const t=Qe.fromText(kg);Bn(e.start,t);const o=cp(n,Ug.exact(t,0,t,1));return zn(t),o}));return t.bind((e=>yg(e.left,e.top,e.width,e.height)))})),a=bp(n,t).bind((e=>ft(e.start)?F.some(e.start):Bt(e.start))),i=a.getOr(e.element);return xg(s,r,t,o,i)};var yp=[js("getSelection"),Fs("root"),js("bubble"),ng(),Qs("overrides",{}),Qs("showAbove",!1),Bd("placement",vp)];const xp="link-layout",wp=e=>e.x+e.width,Sp=(e,t)=>e.x-t.width,kp=(e,t)=>e.y-t.height+e.height,Cp=e=>e.y,Op=(e,t,o)=>Rd(wp(e),Cp(e),o.southeast(),Pd(),"southeast",Jd(e,{left:0,top:2}),xp),_p=(e,t,o)=>Rd(Sp(e,t),Cp(e),o.southwest(),Ld(),"southwest",Jd(e,{right:1,top:2}),xp),Tp=(e,t,o)=>Rd(wp(e),kp(e,t),o.northeast(),Ud(),"northeast",Jd(e,{left:0,bottom:3}),xp),Ep=(e,t,o)=>Rd(Sp(e,t),kp(e,t),o.northwest(),Wd(),"northwest",Jd(e,{right:1,bottom:3}),xp),Dp=()=>[Op,_p,Tp,Ep],Mp=()=>[_p,Op,Ep,Tp],Ap=(e,t,o)=>{const n=em(o,t.item.element),r=rg(e.element,t,Dp(),Mp(),Dp(),Mp(),F.none());return F.some(Jm({anchorBox:n,bubble:Ym(),overrides:t.overrides,layouts:r,placer:F.none()}))};var Bp=[Fs("item"),ng(),Qs("overrides",{}),Bd("placement",Ap)],Fp=Es("type",{selection:yp,node:Sg,hotspot:ag,submenu:Bp,makeshift:lg});const Ip=[Ws("classes",gs),na("mode","all",["all","layout","placement"])],Rp=[Qs("useFixed",M),js("getBounds")],Np=[Is("anchor",Fp),Js("transition",Ip)],Vp=()=>{const e=document.documentElement;return sm(0,0,e.clientWidth,e.clientHeight)},Hp=e=>{const t=Do(e.element),o=e.element.dom.getBoundingClientRect();return rm(t.left,t.top,o.width,o.height)},zp=(e,t,o,n,r,s,a)=>{const i=im(o.anchorBox,t);return $m(i,r.element,o.bubble,o.layouts,s,n,o.overrides,a)},Pp=(e,t,o,n,r)=>{Lp(e,t,o,n,r,F.none())},Lp=(e,t,o,n,r,s)=>{const a=s.map(tr);return Up(e,t,o,n,r,a)},Up=(e,t,o,n,r,s)=>{const a=_s("placement.info",rs(Np),r),i=a.anchor,l=n.element,c=o.get(n.uid);qu((()=>{co(l,"position","fixed");const r=ho(l,"visibility");co(l,"visibility","hidden");const d=t.useFixed()?Vp():Hp(e),u=i.placement,m=s.map(k).or(t.getBounds);u(e,i,d).each((t=>{const r=t.placer.getOr(zp),s=r(e,d,t,m,n,c,a.transition);o.set(n.uid,s)})),r.fold((()=>{vo(l,"visibility")}),(e=>{co(l,"visibility",e)})),ho(l,"left").isNone()&&ho(l,"top").isNone()&&ho(l,"right").isNone()&&ho(l,"bottom").isNone()&&Te(ho(l,"position"),"fixed")&&vo(l,"position")}),l)},Wp=(e,t,o)=>t.useFixed()?"fixed":"absolute",jp=(e,t,o,n)=>{const r=n.element;j(["position","left","right","top","bottom"],(e=>vo(r,e))),um(r),o.clear(n.uid)};var Gp=Object.freeze({__proto__:null,position:Pp,positionWithin:Lp,positionWithinBounds:Up,getMode:Wp,reset:jp});const $p=()=>{let e={};const t=(t,o)=>{e[t]=o},o=t=>Ce(e,t),n=t=>{h(t)?delete e[t]:e={}};return Al({readState:()=>e,clear:n,set:t,get:o})};var qp=Object.freeze({__proto__:null,init:$p});const Kp=Ru({fields:Rp,name:"positioning",active:Lu,apis:Gp,state:qp}),Xp=e=>e.getSystem().isConnected(),Yp=e=>{_i(e,bi());const t=e.components();j(t,Yp)},Jp=e=>{const t=e.components();j(t,Jp),_i(e,fi())},Zp=(e,t)=>{e.getSystem().addToWorld(t),Yt(e.element)&&Jp(t)},Qp=e=>{Yp(e),e.getSystem().removeFromWorld(e)},eh=(e,t)=>{Rn(e.element,t.element)},th=e=>{j(e.components(),(e=>zn(e.element))),Hn(e.element),e.syncComponents()},oh=(e,t,o)=>{const n=e.components();th(e);const r=o(t),s=ne(n,r);j(s,(t=>{Yp(t),e.getSystem().removeFromWorld(t)})),j(r,(t=>{Xp(t)?eh(e,t):(e.getSystem().addToWorld(t),eh(e,t),Yt(e.element)&&Jp(t))})),e.syncComponents()},nh=(e,t,o)=>{const n=e.components(),r=ee(t,(e=>El(e).toArray()));j(n,(e=>{z(r,e)||Qp(e)}));const s=o(t),a=ne(n,s);j(a,(e=>{Xp(e)&&Qp(e)})),j(s,(t=>{Xp(t)||Zp(e,t)})),e.syncComponents()},rh=(e,t)=>{sh(e,t,Rn)},sh=(e,t,o)=>{e.getSystem().addToWorld(t),o(e.element,t.element),Yt(e.element)&&Jp(t),e.syncComponents()},ah=e=>{Yp(e),zn(e.element),e.getSystem().removeFromWorld(e)},ih=e=>{const t=At(e.element).bind((t=>e.getSystem().getByDom(t).toOptional()));ah(e),t.each((e=>{e.syncComponents()}))},lh=e=>{const t=e.components();j(t,ah),Hn(e.element),e.syncComponents()},ch=(e,t)=>{uh(e,t,Rn)},dh=(e,t)=>{uh(e,t,Fn)},uh=(e,t,o)=>{o(e,t.element);const n=Rt(t.element);j(n,(e=>{t.getByDom(e).each(Jp)}))},mh=e=>{const t=Rt(e.element);j(t,(t=>{e.getByDom(t).each(Yp)})),zn(e.element)},gh=(e,t,o,n)=>{o.get().each((t=>{lh(e)}));const r=t.getAttachPoint(e);rh(r,e);const s=e.getSystem().build(n);return rh(e,s),o.set(s),s},ph=(e,t,o,n)=>{const r=gh(e,t,o,n);return t.onOpen(e,r),r},hh=(e,t,o,n)=>o.get().map((()=>gh(e,t,o,n))),fh=(e,t,o,n,r)=>{kh(e,t),ph(e,t,o,n),r(),Oh(e,t)},bh=(e,t,o)=>{o.get().each((n=>{lh(e),ih(e),t.onClose(e,n),o.clear()}))},vh=(e,t,o)=>o.isOpen(),yh=(e,t,o,n)=>vh(e,t,o)&&o.get().exists((o=>t.isPartOf(e,o,n))),xh=(e,t,o)=>o.get(),wh=(e,t,o,n)=>{ho(e.element,t).fold((()=>{so(e.element,o)}),(t=>{eo(e.element,o,t)})),co(e.element,t,n)},Sh=(e,t,o)=>{no(e.element,o).fold((()=>vo(e.element,t)),(o=>co(e.element,t,o)))},kh=(e,t,o)=>{const n=t.getAttachPoint(e);co(e.element,"position",Kp.getMode(n)),wh(e,"visibility",t.cloakVisibilityAttr,"hidden")},Ch=e=>P(["top","left","right","bottom"],(t=>ho(e,t).isSome())),Oh=(e,t,o)=>{Ch(e.element)||vo(e.element,"position"),Sh(e,"visibility",t.cloakVisibilityAttr)};var _h=Object.freeze({__proto__:null,cloak:kh,decloak:Oh,open:ph,openWhileCloaked:fh,close:bh,isOpen:vh,isPartOf:yh,getState:xh,setContent:hh});const Th=(e,t)=>Fi([Vi(ci(),((o,n)=>{bh(o,e,t)}))]);var Eh=Object.freeze({__proto__:null,events:Th}),Dh=[Ed("onOpen"),Ed("onClose"),Fs("isPartOf"),Fs("getAttachPoint"),Qs("cloakVisibilityAttr","data-precloak-visibility")];const Mh=()=>{const e=wm(),t=k("not-implemented");return Al({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})};var Ah=Object.freeze({__proto__:null,init:Mh});const Bh=Ru({fields:Dh,name:"sandboxing",active:Eh,apis:_h,state:Ah}),Fh=k("dismiss.popups"),Ih=k("reposition.popups"),Rh=k("mouse.released"),Nh=ns([Qs("isExtraPart",M),Js("fireEventInstead",[Qs("event",vi())])]),Vh=e=>{const t=_s("Dismissal",Nh,e);return{[Fh()]:{schema:ns([Fs("target")]),onReceive:(e,o)=>{if(Bh.isOpen(e)){const n=Bh.isPartOf(e,o.target)||t.isExtraPart(e,o.target);n||t.fireEventInstead.fold((()=>Bh.close(e)),(t=>_i(e,t.event)))}}}}},Hh=ns([Js("fireEventInstead",[Qs("event",yi())]),zs("doReposition")]),zh=e=>{const t=_s("Reposition",Hh,e);return{[Ih()]:{onReceive:e=>{Bh.isOpen(e)&&t.fireEventInstead.fold((()=>t.doReposition(e)),(t=>_i(e,t.event)))}}}},Ph=(e,t,o)=>{t.store.manager.onLoad(e,t,o)},Lh=(e,t,o)=>{t.store.manager.onUnload(e,t,o)},Uh=(e,t,o,n)=>{t.store.manager.setValue(e,t,o,n)},Wh=(e,t,o)=>t.store.manager.getValue(e,t,o),jh=(e,t,o)=>o;var Gh=Object.freeze({__proto__:null,onLoad:Ph,onUnload:Lh,setValue:Uh,getValue:Wh,getState:jh});const $h=(e,t)=>{const o=e.resetOnDom?[qi(((o,n)=>{Ph(o,e,t)})),Ki(((o,n)=>{Lh(o,e,t)}))]:[Tu(e,t,Ph)];return Fi(o)};var qh=Object.freeze({__proto__:null,events:$h});const Kh=()=>{const e=ca(null),t=()=>({mode:"memory",value:e.get()}),o=()=>null===e.get(),n=()=>{e.set(null)};return Al({set:e.set,get:e.get,isNotSet:o,clear:n,readState:t})},Xh=()=>{const e=y;return Al({readState:e})},Yh=()=>{const e=ca({}),t=ca({}),o=()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),n=()=>{e.set({}),t.set({})},r=o=>Ce(e.get(),o).orThunk((()=>Ce(t.get(),o))),s=o=>{const n=e.get(),r=t.get(),s={},a={};j(o,(e=>{s[e.value]=e,Ce(e,"meta").each((t=>{Ce(t,"text").each((t=>{a[t]=e}))}))})),e.set({...n,...s}),t.set({...r,...a})};return Al({readState:o,lookup:r,update:s,clear:n})},Jh=e=>e.store.manager.state(e);var Zh=Object.freeze({__proto__:null,memory:Kh,dataset:Yh,manual:Xh,init:Jh});const Qh=(e,t,o,n)=>{const r=t.store;o.update([n]),r.setValue(e,n),t.onSetValue(e,n)},ef=(e,t,o)=>{const n=t.store,r=n.getDataKey(e);return o.lookup(r).getOrThunk((()=>n.getFallbackEntry(r)))},tf=(e,t,o)=>{const n=t.store;n.initialValue.each((n=>{Qh(e,t,o,n)}))},of=(e,t,o)=>{o.clear()};var nf=[js("initialValue"),Fs("getFallbackEntry"),Fs("getDataKey"),Fs("setValue"),Bd("manager",{setValue:Qh,getValue:ef,onLoad:tf,onUnload:of,state:Yh})];const rf=(e,t,o)=>t.store.getValue(e),sf=(e,t,o,n)=>{t.store.setValue(e,n),t.onSetValue(e,n)},af=(e,t,o)=>{t.store.initialValue.each((o=>{t.store.setValue(e,o)}))};var lf=[Fs("getValue"),Qs("setValue",y),js("initialValue"),Bd("manager",{setValue:sf,getValue:rf,onLoad:af,onUnload:y,state:Ml.init})];const cf=(e,t,o,n)=>{o.set(n),t.onSetValue(e,n)},df=(e,t,o)=>o.get(),uf=(e,t,o)=>{t.store.initialValue.each((e=>{o.isNotSet()&&o.set(e)}))},mf=(e,t,o)=>{o.clear()};var gf=[js("initialValue"),Bd("manager",{setValue:cf,getValue:df,onLoad:uf,onUnload:mf,state:Kh})],pf=[ea("store",{mode:"memory"},Es("mode",{memory:gf,manual:lf,dataset:nf})),Ed("onSetValue"),Qs("resetOnDom",!1)];const hf=Ru({fields:pf,name:"representing",active:qh,apis:Gh,extra:{setValueFrom:(e,t)=>{const o=hf.getValue(t);hf.setValue(e,o)}},state:Zh}),ff=(e,t)=>la(e,{},W(t,(t=>Ps(t.name(),"Cannot configure "+t.name()+" for "+e))).concat([As("dump",C)])),bf=e=>e.dump,vf=(e,t)=>({...Fu(t),...e.dump}),yf={field:ff,augment:vf,get:bf},xf="placeholder",wf=ua.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Sf=e=>Oe(e,"uiType"),kf=(e,t,o,n)=>e.exists((e=>e!==o.owner))?wf.single(!0,k(o)):Ce(n,o.name).fold((()=>{throw new Error("Unknown placeholder component: "+o.name+"\nKnown: ["+me(n)+"]\nNamespace: "+e.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))}),(e=>e.replace())),Cf=(e,t,o,n)=>Sf(o)&&o.uiType===xf?kf(e,t,o,n):wf.single(!1,k(o)),Of=(e,t,o,n)=>{const r=Cf(e,t,o,n);return r.fold(((r,s)=>{const a=Sf(o)?s(t,o.config,o.validated):s(t),i=Ce(a,"components").getOr([]),l=ee(i,(o=>Of(e,t,o,n)));return[{...a,components:l}]}),((e,n)=>{if(Sf(o)){const e=n(t,o.config,o.validated),r=o.validated.preprocess.getOr(C);return r(e)}return n(t)}))},_f=(e,t,o,n)=>ee(o,(o=>Of(e,t,o,n))),Tf=(e,t)=>{let o=!1;const n=()=>o,r=()=>{if(o)throw new Error("Trying to use the same placeholder more than once: "+e);return o=!0,t},s=()=>t.fold(((e,t)=>e),((e,t)=>e));return{name:k(e),required:s,used:n,replace:r}},Ef=(e,t,o,n)=>{const r=he(n,((e,t)=>Tf(t,e))),s=_f(e,t,o,r);return pe(r,(o=>{if(!1===o.used()&&o.required())throw new Error("Placeholder: "+o.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),s},Df=wf.single,Mf=wf.multiple,Af=k(xf),Bf=ua.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ff=Qs("factory",{sketch:C}),If=Qs("schema",[]),Rf=Fs("name"),Nf=Ms("pname","pname",Dr((e=>"<alloy."+cl(e.name)+">")),ds()),Vf=As("schema",(()=>[js("preprocess")])),Hf=Qs("defaults",k({})),zf=Qs("overrides",k({})),Pf=rs([Ff,If,Rf,Nf,Hf,zf]),Lf=rs([Ff,If,Rf,Hf,zf]),Uf=rs([Ff,If,Rf,Nf,Hf,zf]),Wf=rs([Ff,Vf,Rf,Fs("unit"),Nf,Hf,zf]),jf=e=>e.fold(F.some,F.none,F.some,F.some),Gf=e=>{const t=e=>e.name;return e.fold(t,t,t,t)},$f=e=>e.fold(C,C,C,C),qf=(e,t)=>o=>{const n=_s("Converting part type",t,o);return e(n)},Kf=qf(Bf.required,Pf),Xf=qf(Bf.external,Lf),Yf=qf(Bf.optional,Uf),Jf=qf(Bf.group,Wf),Zf=k("entirety");var Qf=Object.freeze({__proto__:null,required:Kf,external:Xf,optional:Yf,group:Jf,asNamedPart:jf,name:Gf,asCommon:$f,original:Zf});const eb=(e,t,o,n)=>_r(t.defaults(e,o,n),o,{uid:e.partUids[t.name]},t.overrides(e,o,n)),tb=(e,t,o)=>{const n={},r={};return j(o,(e=>{e.fold((e=>{n[e.pname]=Df(!0,((t,o,n)=>e.factory.sketch(eb(t,e,o,n))))}),(e=>{const o=t.parts[e.name];r[e.name]=k(e.factory.sketch(eb(t,e,o[Zf()]),o))}),(e=>{n[e.pname]=Df(!1,((t,o,n)=>e.factory.sketch(eb(t,e,o,n))))}),(e=>{n[e.pname]=Mf(!0,((t,o,n)=>{const r=t[e.name];return W(r,(o=>e.factory.sketch(_r(e.defaults(t,o,n),o,e.overrides(t,o)))))}))}))})),{internals:k(n),externals:k(r)}},ob=(e,t)=>{const o={};return j(t,(t=>{jf(t).each((t=>{const n=nb(e,t.pname);o[t.name]=o=>{const r=_s("Part: "+t.name+" in "+e,rs(t.schema),o);return{...n,config:o,validated:r}}}))})),o},nb=(e,t)=>({uiType:Af(),owner:e,name:t}),rb=(e,t,o)=>({uiType:Af(),owner:e,name:t,config:o,validated:{}}),sb=e=>ee(e,(e=>e.fold(F.none,F.some,F.none,F.none).map((e=>Ls(e.name,e.schema.concat([Fd(Zf())])))).toArray())),ab=e=>W(e,Gf),ib=(e,t,o)=>tb(e,t,o),lb=(e,t,o)=>Ef(F.some(e),t,t.components,o),cb=(e,t,o)=>{const n=t.partUids[o];return e.getSystem().getByUid(n).toOptional()},db=(e,t,o)=>cb(e,t,o).getOrDie("Could not find part: "+o),ub=(e,t,o)=>{const n={},r=t.partUids,s=e.getSystem();return j(o,(e=>{n[e]=k(s.getByUid(r[e]))})),n},mb=(e,t)=>{const o=e.getSystem();return he(t.partUids,((e,t)=>k(o.getByUid(e))))},gb=e=>me(e.partUids),pb=(e,t,o)=>{const n={},r=t.partUids,s=e.getSystem();return j(o,(e=>{n[e]=k(s.getByUid(r[e]).getOrDie())})),n},hb=(e,t)=>{const o=ab(t);return va(W(o,(t=>({key:t,value:e+"-"+t}))))},fb=e=>Ms("partUids","partUids",Br((t=>hb(t.uid,e))),ds());var bb=Object.freeze({__proto__:null,generate:ob,generateOne:rb,schemas:sb,names:ab,substitutes:ib,components:lb,defaultUids:hb,defaultUidsSchema:fb,getAllParts:mb,getAllPartNames:gb,getPart:cb,getPartOrDie:db,getParts:ub,getPartsOrDie:pb});const vb=(e,t)=>{const o=e.length>0?[Ls("parts",e)]:[];return o.concat([Fs("uid"),Qs("dom",{}),Qs("components",[]),Fd("originalSpec"),Qs("debug.sketcher",{})]).concat(t)},yb=(e,t,o,n,r)=>{const s=vb(n,r);return _s(e+" [SpecSchema]",ns(s.concat(t)),o)},xb=(e,t,o,n)=>{const r=kb(n),s=yb(e,t,r,[],[]);return o(s,r)},wb=(e,t,o,n,r)=>{const s=kb(r),a=sb(o),i=fb(o),l=yb(e,t,s,a,[i]),c=ib(e,l,o),d=lb(e,l,c.internals());return n(l,d,s,c.externals())},Sb=e=>Oe(e,"uid"),kb=e=>Sb(e)?e:{...e,uid:bl("uid")},Cb=e=>void 0!==e.uid,Ob=ns([Fs("name"),Fs("factory"),Fs("configFields"),Qs("apis",{}),Qs("extraApis",{})]),_b=ns([Fs("name"),Fs("factory"),Fs("configFields"),Fs("partFields"),Qs("apis",{}),Qs("extraApis",{})]),Tb=e=>{const t=_s("Sketcher for "+e.name,Ob,e),o=e=>xb(t.name,t.configFields,t.factory,e),n=he(t.apis,Dl),r=he(t.extraApis,((e,t)=>kl(e,t)));return{name:t.name,configFields:t.configFields,sketch:o,...n,...r}},Eb=e=>{const t=_s("Sketcher for "+e.name,_b,e),o=e=>wb(t.name,t.configFields,t.partFields,t.factory,e),n=ob(t.name,t.partFields),r=he(t.apis,Dl),s=he(t.extraApis,((e,t)=>kl(e,t)));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:o,parts:n,...r,...s}},Db=e=>xt("input")(e)&&"radio"!==oo(e,"type")||xt("textarea")(e),Mb=(e,t,o)=>t.find(e);var Ab=Object.freeze({__proto__:null,getCurrent:Mb});const Bb=[Fs("find")],Fb=Ru({fields:Bb,name:"composing",apis:Ab}),Ib=["input","button","textarea","select"],Rb=(e,t,o)=>{const n=t.disabled()?Wb:jb;n(e,t)},Nb=(e,t)=>!0===t.useNative&&z(Ib,mt(e.element)),Vb=e=>ro(e.element,"disabled"),Hb=e=>{eo(e.element,"disabled","disabled")},zb=e=>{so(e.element,"disabled")},Pb=e=>"true"===oo(e.element,"aria-disabled"),Lb=e=>{eo(e.element,"aria-disabled","true")},Ub=e=>{eo(e.element,"aria-disabled","false")},Wb=(e,t,o)=>{t.disableClass.each((t=>{uc(e.element,t)}));const n=Nb(e,t)?Hb:Lb;n(e),t.onDisabled(e)},jb=(e,t,o)=>{t.disableClass.each((t=>{gc(e.element,t)}));const n=Nb(e,t)?zb:Ub;n(e),t.onEnabled(e)},Gb=(e,t)=>Nb(e,t)?Vb(e):Pb(e),$b=(e,t,o,n)=>{const r=n?Wb:jb;r(e,t)};var qb=Object.freeze({__proto__:null,enable:jb,disable:Wb,isDisabled:Gb,onLoad:Rb,set:$b});const Kb=(e,t)=>Nl({classes:t.disabled()?t.disableClass.toArray():[]}),Xb=(e,t)=>Fi([Ii(si(),((t,o)=>Gb(t,e))),Tu(e,t,Rb)]);var Yb=Object.freeze({__proto__:null,exhibit:Kb,events:Xb}),Jb=[sa("disabled",M),Qs("useNative",!0),js("disableClass"),Ed("onDisabled"),Ed("onEnabled")];const Zb=Ru({fields:Jb,name:"disabling",active:Yb,apis:qb}),Qb=(e,t,o,n)=>{const r=op(e.element,"."+t.highlightClass);j(r,(o=>{const r=P(n,(e=>Ot(e.element,o)));r||(gc(o,t.highlightClass),e.getSystem().getByDom(o).each((o=>{t.onDehighlight(e,o),_i(o,Oi())})))}))},ev=(e,t,o)=>Qb(e,t,o,[]),tv=(e,t,o,n)=>{iv(e,t,o,n)&&(gc(n.element,t.highlightClass),t.onDehighlight(e,n),_i(n,Oi()))},ov=(e,t,o,n)=>{Qb(e,t,o,[n]),iv(e,t,o,n)||(uc(n.element,t.highlightClass),t.onHighlight(e,n),_i(n,Ci()))},nv=(e,t,o)=>{dv(e,t).each((n=>{ov(e,t,o,n)}))},rv=(e,t,o)=>{uv(e,t).each((n=>{ov(e,t,o,n)}))},sv=(e,t,o,n)=>{cv(e,t,o,n).fold((e=>{throw e}),(n=>{ov(e,t,o,n)}))},av=(e,t,o,n)=>{const r=hv(e,t),s=J(r,n);s.each((n=>{ov(e,t,o,n)}))},iv=(e,t,o,n)=>pc(n.element,t.highlightClass),lv=(e,t,o)=>nd(e.element,"."+t.highlightClass).bind((t=>e.getSystem().getByDom(t).toOptional())),cv=(e,t,o,n)=>{const r=op(e.element,"."+t.itemClass);return F.from(r[n]).fold((()=>ir.error(new Error("No element found with index "+n))),e.getSystem().getByDom)},dv=(e,t,o)=>nd(e.element,"."+t.itemClass).bind((t=>e.getSystem().getByDom(t).toOptional())),uv=(e,t,o)=>{const n=op(e.element,"."+t.itemClass),r=n.length>0?F.some(n[n.length-1]):F.none();return r.bind((t=>e.getSystem().getByDom(t).toOptional()))},mv=(e,t,o,n)=>{const r=op(e.element,"."+t.itemClass),s=Z(r,(e=>pc(e,t.highlightClass)));return s.bind((t=>{const o=Kd(t,n,0,r.length-1);return e.getSystem().getByDom(r[o]).toOptional()}))},gv=(e,t,o)=>mv(e,t,o,-1),pv=(e,t,o)=>mv(e,t,o,1),hv=(e,t,o)=>{const n=op(e.element,"."+t.itemClass);return De(W(n,(t=>e.getSystem().getByDom(t).toOptional())))};var fv=Object.freeze({__proto__:null,dehighlightAll:ev,dehighlight:tv,highlight:ov,highlightFirst:nv,highlightLast:rv,highlightAt:sv,highlightBy:av,isHighlighted:iv,getHighlighted:lv,getFirst:dv,getLast:uv,getPrevious:gv,getNext:pv,getCandidates:hv}),bv=[Fs("highlightClass"),Fs("itemClass"),Ed("onHighlight"),Ed("onDehighlight")];const vv=Ru({fields:bv,name:"highlighting",apis:fv}),yv=[8],xv=[9],wv=[13],Sv=[27],kv=[32],Cv=[37],Ov=[38],_v=[39],Tv=[40],Ev=(e,t,o)=>{const n=oe(e.slice(0,t)),r=oe(e.slice(t+1));return J(n.concat(r),o)},Dv=(e,t,o)=>{const n=oe(e.slice(0,t));return J(n,o)},Mv=(e,t,o)=>{const n=e.slice(0,t),r=e.slice(t+1);return J(r.concat(n),o)},Av=(e,t,o)=>{const n=e.slice(t+1);return J(n,o)},Bv=e=>t=>{const o=t.raw;return z(e,o.which)},Fv=e=>t=>te(e,(e=>e(t))),Iv=e=>{const t=e.raw;return!0===t.shiftKey},Rv=e=>{const t=e.raw;return!0===t.ctrlKey},Nv=T(Iv),Vv=(e,t)=>({matches:e,classification:t}),Hv=(e,t)=>{const o=J(e,(e=>e.matches(t)));return o.map((e=>e.classification))},zv=(e,t,o)=>{const n=t.exists((e=>o.exists((t=>Ot(t,e)))));n||Ti(e,xi(),{prevFocus:t,newFocus:o})},Pv=()=>{const e=e=>$u(e.element),t=(t,o)=>{const n=e(t);t.getSystem().triggerFocus(o,t.element);const r=e(t);zv(t,n,r)};return{get:e,set:t}},Lv=()=>{const e=e=>vv.getHighlighted(e).map((e=>e.element)),t=(t,o)=>{const n=e(t);t.getSystem().getByDom(o).fold(y,(e=>{vv.highlight(t,e)}));const r=e(t);zv(t,n,r)};return{get:e,set:t}};var Uv;(function(e){e["OnFocusMode"]="onFocus",e["OnEnterOrSpaceMode"]="onEnterOrSpace",e["OnApiMode"]="onApi"})(Uv||(Uv={}));const Wv=(e,t,o,n,r)=>{const s=()=>e.concat([Qs("focusManager",Pv()),ea("focusInside","onFocus",ws((e=>z(["onFocus","onEnterOrSpace","onApi"],e)?ir.value(e):ir.error("Invalid value for focusInside")))),Bd("handler",l),Bd("state",t),Bd("sendFocusIn",r)]),a=(e,t,o,n,r)=>{const s=o(e,t,n,r);return Hv(s,t.event).bind((o=>o(e,t,n,r)))},i=(e,t)=>{const s=e.focusInside!==Uv.OnFocusMode?F.none():r(e).map((o=>Vi(ti(),((n,r)=>{o(n,e,t),r.stop()})))),i=(o,n)=>{const s=Bv(kv.concat(wv))(n.event);e.focusInside===Uv.OnEnterOrSpaceMode&&s&&Oa(o,n)&&r(e).each((r=>{r(o,e,t),n.stop()}))},l=[Vi(ja(),((n,r)=>{a(n,r,o,e,t).fold((()=>{i(n,r)}),(e=>{r.stop()}))})),Vi(Ga(),((o,r)=>{a(o,r,n,e,t).each((e=>{r.stop()}))}))];return Fi(s.toArray().concat(l))},l={schema:s,processKey:a,toEvents:i};return l},jv=e=>{const t=[js("onEscape"),js("onEnter"),Qs("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Qs("firstTabstop",0),Qs("useTabstopAt",A),js("visibilitySelector")].concat([e]),o=(e,t)=>{const o=e.visibilitySelector.bind((e=>rd(t,e))).getOr(t);return So(o)>0},n=(e,t)=>{const n=op(e.element,t.selector),r=q(n,(e=>o(t,e)));return F.from(r[t.firstTabstop])},r=(e,t)=>t.focusManager.get(e).bind((e=>rd(e,t.selector))),s=(e,t)=>o(e,t)&&e.useTabstopAt(t),a=(e,t,o)=>{n(e,t).each((o=>{t.focusManager.set(e,o)}))},i=(e,t,o,n,r)=>r(t,o,(e=>s(n,e))).fold((()=>n.cyclic?F.some(!0):F.none()),(t=>(n.focusManager.set(e,t),F.some(!0)))),l=(e,t,o,n)=>{const s=op(e.element,o.selector);return r(e,o).bind((t=>{const r=Z(s,_(Ot,t));return r.bind((t=>i(e,s,t,o,n)))}))},c=(e,t,o)=>{const n=o.cyclic?Ev:Dv;return l(e,t,o,n)},d=(e,t,o)=>{const n=o.cyclic?Mv:Av;return l(e,t,o,n)},u=(e,t,o)=>o.onEnter.bind((o=>o(e,t))),m=(e,t,o)=>o.onEscape.bind((o=>o(e,t))),g=k([Vv(Fv([Iv,Bv(xv)]),c),Vv(Bv(xv),d),Vv(Fv([Nv,Bv(wv)]),u)]),p=k([Vv(Bv(Sv),m)]);return Wv(t,Ml.init,g,p,(()=>F.some(a)))};var Gv=jv(As("cyclic",M)),$v=jv(As("cyclic",A));const qv=(e,t,o)=>(Di(e,o,si()),F.some(!0)),Kv=(e,t,o)=>{const n=Db(o)&&Bv(kv)(t.event);return n?F.none():qv(e,t,o)},Xv=(e,t)=>F.some(!0),Yv=[Qs("execute",Kv),Qs("useSpace",!1),Qs("useEnter",!0),Qs("useControlEnter",!1),Qs("useDown",!1)],Jv=(e,t,o)=>o.execute(e,t,e.element),Zv=(e,t,o,n)=>{const r=o.useSpace&&!Db(e.element)?kv:[],s=o.useEnter?wv:[],a=o.useDown?Tv:[],i=r.concat(s).concat(a);return[Vv(Bv(i),Jv)].concat(o.useControlEnter?[Vv(Fv([Rv,Bv(wv)]),Jv)]:[])},Qv=(e,t,o,n)=>o.useSpace&&!Db(e.element)?[Vv(Bv(kv),Xv)]:[];var ey=Wv(Yv,Ml.init,Zv,Qv,(()=>F.none()));const ty=()=>{const e=wm(),t=(t,o)=>{e.set({numRows:t,numColumns:o})},o=()=>e.get().map((e=>e.numRows)),n=()=>e.get().map((e=>e.numColumns));return Al({readState:()=>e.get().map((e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)}))).getOr({numRows:"?",numColumns:"?"}),setGridSize:t,getNumRows:o,getNumColumns:n})},oy=e=>e.state(e);var ny=Object.freeze({__proto__:null,flatgrid:ty,init:oy});const ry=e=>(t,o,n,r)=>{const s=e(t.element);return ly(s,t,o,n,r)},sy=(e,t)=>{const o=Zm(e,t);return ry(o)},ay=(e,t)=>{const o=Zm(t,e);return ry(o)},iy=e=>(t,o,n,r)=>ly(e,t,o,n,r),ly=(e,t,o,n,r)=>{const s=n.focusManager.get(t).bind((o=>e(t.element,o,n,r)));return s.map((e=>(n.focusManager.set(t,e),!0)))},cy=iy,dy=iy,uy=iy,my=e=>e.offsetWidth<=0&&e.offsetHeight<=0,gy=e=>!my(e.dom),py=(e,t)=>Z(e,t).map((t=>({index:t,candidates:e}))),hy=(e,t,o)=>{const n=e=>Ot(e,t),r=op(e,o),s=q(r,gy);return py(s,n)},fy=(e,t)=>Z(e,(e=>Ot(t,e))),by=(e,t,o,n)=>{const r=Math.floor(t/o),s=t%o;return n(r,s).bind((t=>{const n=t.row*o+t.column;return n>=0&&n<e.length?F.some(e[n]):F.none()}))},vy=(e,t,o,n,r)=>by(e,t,n,((t,s)=>{const a=t===o-1,i=a?e.length-t*n:n,l=Kd(s,r,0,i-1);return F.some({row:t,column:l})})),yy=(e,t,o,n,r)=>by(e,t,n,((t,s)=>{const a=Kd(t,r,0,o-1),i=a===o-1,l=i?e.length-a*n:n,c=Xd(s,0,l-1);return F.some({row:a,column:c})})),xy=(e,t,o,n)=>vy(e,t,o,n,1),wy=(e,t,o,n)=>vy(e,t,o,n,-1),Sy=(e,t,o,n)=>yy(e,t,o,n,-1),ky=(e,t,o,n)=>yy(e,t,o,n,1),Cy=[Fs("selector"),Qs("execute",Kv),Dd("onEscape"),Qs("captureTab",!1),Id()],Oy=(e,t,o)=>{nd(e.element,t.selector).each((o=>{t.focusManager.set(e,o)}))},_y=(e,t)=>t.focusManager.get(e).bind((e=>rd(e,t.selector))),Ty=(e,t,o,n)=>_y(e,o).bind((n=>o.execute(e,t,n))),Ey=e=>(t,o,n,r)=>hy(t,o,n.selector).bind((t=>e(t.candidates,t.index,r.getNumRows().getOr(n.initSize.numRows),r.getNumColumns().getOr(n.initSize.numColumns)))),Dy=(e,t,o)=>o.captureTab?F.some(!0):F.none(),My=(e,t,o)=>o.onEscape(e,t),Ay=Ey(wy),By=Ey(xy),Fy=Ey(Sy),Iy=Ey(ky),Ry=k([Vv(Bv(Cv),sy(Ay,By)),Vv(Bv(_v),ay(Ay,By)),Vv(Bv(Ov),cy(Fy)),Vv(Bv(Tv),dy(Iy)),Vv(Fv([Iv,Bv(xv)]),Dy),Vv(Fv([Nv,Bv(xv)]),Dy),Vv(Bv(kv.concat(wv)),Ty)]),Ny=k([Vv(Bv(Sv),My),Vv(Bv(kv),Xv)]);var Vy=Wv(Cy,ty,Ry,Ny,(()=>F.some(Oy)));const Hy=(e,t,o,n)=>{const r=e=>"button"===mt(e)&&"disabled"===oo(e,"disabled"),s=(e,t,o)=>{const a=Kd(t,n,0,o.length-1);return a===e?F.none():r(o[a])?s(e,a,o):F.from(o[a])};return hy(e,o,t).bind((e=>{const t=e.index,o=e.candidates;return s(t,t,o)}))},zy=[Fs("selector"),Qs("getInitial",F.none),Qs("execute",Kv),Dd("onEscape"),Qs("executeOnMove",!1),Qs("allowVertical",!0)],Py=(e,t)=>t.focusManager.get(e).bind((e=>rd(e,t.selector))),Ly=(e,t,o)=>Py(e,o).bind((n=>o.execute(e,t,n))),Uy=(e,t,o)=>{t.getInitial(e).orThunk((()=>nd(e.element,t.selector))).each((o=>{t.focusManager.set(e,o)}))},Wy=(e,t,o)=>Hy(e,o.selector,t,-1),jy=(e,t,o)=>Hy(e,o.selector,t,1),Gy=e=>(t,o,n,r)=>e(t,o,n,r).bind((()=>n.executeOnMove?Ly(t,o,n):F.some(!0))),$y=(e,t,o)=>o.onEscape(e,t),qy=(e,t,o,n)=>{const r=Cv.concat(o.allowVertical?Ov:[]),s=_v.concat(o.allowVertical?Tv:[]);return[Vv(Bv(r),Gy(sy(Wy,jy))),Vv(Bv(s),Gy(ay(Wy,jy))),Vv(Bv(wv),Ly),Vv(Bv(kv),Ly)]},Ky=k([Vv(Bv(kv),Xv),Vv(Bv(Sv),$y)]);var Xy=Wv(zy,Ml.init,qy,Ky,(()=>F.some(Uy)));const Yy=(e,t,o)=>F.from(e[t]).bind((e=>F.from(e[o]).map((e=>({rowIndex:t,columnIndex:o,cell:e}))))),Jy=(e,t,o,n)=>{const r=e[t],s=r.length,a=Kd(o,n,0,s-1);return Yy(e,t,a)},Zy=(e,t,o,n)=>{const r=Kd(o,n,0,e.length-1),s=e[r].length,a=Xd(t,0,s-1);return Yy(e,r,a)},Qy=(e,t,o,n)=>{const r=e[t],s=r.length,a=Xd(o+n,0,s-1);return Yy(e,t,a)},ex=(e,t,o,n)=>{const r=Xd(o+n,0,e.length-1),s=e[r].length,a=Xd(t,0,s-1);return Yy(e,r,a)},tx=(e,t,o)=>Jy(e,t,o,1),ox=(e,t,o)=>Jy(e,t,o,-1),nx=(e,t,o)=>Zy(e,o,t,-1),rx=(e,t,o)=>Zy(e,o,t,1),sx=(e,t,o)=>Qy(e,t,o,-1),ax=(e,t,o)=>Qy(e,t,o,1),ix=(e,t,o)=>ex(e,o,t,-1),lx=(e,t,o)=>ex(e,o,t,1),cx=[Ls("selectors",[Fs("row"),Fs("cell")]),Qs("cycles",!0),Qs("previousSelector",F.none),Qs("execute",Kv)],dx=(e,t,o)=>{const n=t.previousSelector(e).orThunk((()=>{const o=t.selectors;return nd(e.element,o.cell)}));n.each((o=>{t.focusManager.set(e,o)}))},ux=(e,t,o)=>$u(e.element).bind((n=>o.execute(e,t,n))),mx=(e,t)=>W(e,(e=>op(e,t.selectors.cell))),gx=(e,t)=>(o,n,r)=>{const s=r.cycles?e:t;return rd(n,r.selectors.row).bind((e=>{const t=op(e,r.selectors.cell);return fy(t,n).bind((t=>{const n=op(o,r.selectors.row);return fy(n,e).bind((e=>{const o=mx(n,r);return s(o,e,t).map((e=>e.cell))}))}))}))},px=gx(ox,sx),hx=gx(tx,ax),fx=gx(nx,ix),bx=gx(rx,lx),vx=k([Vv(Bv(Cv),sy(px,hx)),Vv(Bv(_v),ay(px,hx)),Vv(Bv(Ov),cy(fx)),Vv(Bv(Tv),dy(bx)),Vv(Bv(kv.concat(wv)),ux)]),yx=k([Vv(Bv(kv),Xv)]);var xx=Wv(cx,Ml.init,vx,yx,(()=>F.some(dx)));const wx=[Fs("selector"),Qs("execute",Kv),Qs("moveOnTab",!1)],Sx=(e,t,o)=>o.focusManager.get(e).bind((n=>o.execute(e,t,n))),kx=(e,t,o)=>{nd(e.element,t.selector).each((o=>{t.focusManager.set(e,o)}))},Cx=(e,t,o)=>Hy(e,o.selector,t,-1),Ox=(e,t,o)=>Hy(e,o.selector,t,1),_x=(e,t,o,n)=>o.moveOnTab?uy(Cx)(e,t,o,n):F.none(),Tx=(e,t,o,n)=>o.moveOnTab?uy(Ox)(e,t,o,n):F.none(),Ex=k([Vv(Bv(Ov),uy(Cx)),Vv(Bv(Tv),uy(Ox)),Vv(Fv([Iv,Bv(xv)]),_x),Vv(Fv([Nv,Bv(xv)]),Tx),Vv(Bv(wv),Sx),Vv(Bv(kv),Sx)]),Dx=k([Vv(Bv(kv),Xv)]);var Mx=Wv(wx,Ml.init,Ex,Dx,(()=>F.some(kx)));const Ax=[Dd("onSpace"),Dd("onEnter"),Dd("onShiftEnter"),Dd("onLeft"),Dd("onRight"),Dd("onTab"),Dd("onShiftTab"),Dd("onUp"),Dd("onDown"),Dd("onEscape"),Qs("stopSpaceKeyup",!1),js("focusIn")],Bx=(e,t,o)=>[Vv(Bv(kv),o.onSpace),Vv(Fv([Nv,Bv(wv)]),o.onEnter),Vv(Fv([Iv,Bv(wv)]),o.onShiftEnter),Vv(Fv([Iv,Bv(xv)]),o.onShiftTab),Vv(Fv([Nv,Bv(xv)]),o.onTab),Vv(Bv(Ov),o.onUp),Vv(Bv(Tv),o.onDown),Vv(Bv(Cv),o.onLeft),Vv(Bv(_v),o.onRight),Vv(Bv(kv),o.onSpace)],Fx=(e,t,o)=>[...o.stopSpaceKeyup?[Vv(Bv(kv),Xv)]:[],Vv(Bv(Sv),o.onEscape)];var Ix=Wv(Ax,Ml.init,Bx,Fx,(e=>e.focusIn));const Rx=Gv.schema(),Nx=$v.schema(),Vx=Xy.schema(),Hx=Vy.schema(),zx=xx.schema(),Px=ey.schema(),Lx=Mx.schema(),Ux=Ix.schema();var Wx=Object.freeze({__proto__:null,acyclic:Rx,cyclic:Nx,flow:Vx,flatgrid:Hx,matrix:zx,execution:Px,menu:Lx,special:Ux});const jx=e=>_e(e,"setGridSize"),Gx=Vu({branchKey:"mode",branches:Wx,name:"keying",active:{events:(e,t)=>{const o=e.handler;return o.toEvents(e,t)}},apis:{focusIn:(e,t,o)=>{t.sendFocusIn(t).fold((()=>{e.getSystem().triggerFocus(e.element,e.element)}),(n=>{n(e,t,o)}))},setGridSize:(e,t,o,n,r)=>{jx(o)?o.setGridSize(n,r):console.error("Layout does not support setGridSize")}},state:ny}),$x=(e,t)=>{qu((()=>{oh(e,t,(()=>W(t,e.getSystem().build)))}),e.element)},qx=(e,t)=>{qu((()=>{nh(e,t,(()=>_c(e.element,t,e.getSystem().buildOrPatch)))}),e.element)},Kx=(e,t,o,n)=>{Qp(t);const r=Oc(e.element,o,n,e.getSystem().buildOrPatch);Zp(e,r),e.syncComponents()},Xx=(e,t,o)=>{const n=e.getSystem().build(o);sh(e,n,t)},Yx=(e,t,o,n)=>{ih(t),Xx(e,((e,t)=>Nn(e,t,o)),n)},Jx=(e,t,o,n)=>{const r=t.reuseDom?qx:$x;return r(e,n)},Zx=(e,t,o,n)=>{Xx(e,Rn,n)},Qx=(e,t,o,n)=>{Xx(e,In,n)},ew=(e,t,o,n)=>{const r=tw(e),s=J(r,(e=>Ot(n.element,e.element)));s.each(ih)},tw=(e,t)=>e.components(),ow=(e,t,o,n,r)=>{const s=tw(e);return F.from(s[n]).map((o=>(r.fold((()=>ih(o)),(r=>{const s=t.reuseDom?Kx:Yx;s(e,o,n,r)})),o)))},nw=(e,t,o,n,r)=>{const s=tw(e);return Z(s,n).bind((n=>ow(e,t,o,n,r)))};var rw=Object.freeze({__proto__:null,append:Zx,prepend:Qx,remove:ew,replaceAt:ow,replaceBy:nw,set:Jx,contents:tw});const sw=Ru({fields:[ra("reuseDom",!0)],name:"replacing",apis:rw}),aw=(e,t)=>{const o=Fi(t);return Ru({fields:[Fs("enabled")],name:e,active:{events:k(o)}})},iw=(e,t)=>{const o=aw(e,t);return{key:e,value:{config:{},me:o,configAsRaw:k({}),initialConfig:{},state:Ml}}},lw=(e,t)=>{t.ignore||(Uu(e.element),t.onFocus(e))},cw=(e,t)=>{t.ignore||Wu(e.element)},dw=e=>ju(e.element);var uw=Object.freeze({__proto__:null,focus:lw,blur:cw,isFocused:dw});const mw=(e,t)=>{const o=t.ignore?{}:{attributes:{tabindex:"-1"}};return Nl(o)},gw=e=>Fi([Vi(ti(),((t,o)=>{lw(t,e),o.stop()}))].concat(e.stopMousedown?[Vi(Va(),((e,t)=>{t.event.prevent()}))]:[]));var pw=Object.freeze({__proto__:null,exhibit:mw,events:gw}),hw=[Ed("onFocus"),Qs("stopMousedown",!1),Qs("ignore",!1)];const fw=Ru({fields:hw,name:"focusing",active:pw,apis:uw}),bw=e=>{const t=()=>{const t=ca(e),o=()=>t.get(),n=e=>t.set(e),r=()=>t.set(e),s=()=>t.get();return{get:o,set:n,clear:r,readState:s}};return{init:t}},vw=(e,t,o)=>{const n=t.aria;n.update(e,n,o.get())},yw=(e,t,o)=>{t.toggleClass.each((t=>{o.get()?uc(e.element,t):gc(e.element,t)}))},xw=(e,t,o,n)=>{const r=o.get();o.set(n),yw(e,t,o),vw(e,t,o),r!==n&&t.onToggled(e,n)},ww=(e,t,o)=>{xw(e,t,o,!o.get())},Sw=(e,t,o)=>{xw(e,t,o,!0)},kw=(e,t,o)=>{xw(e,t,o,!1)},Cw=(e,t,o)=>o.get(),Ow=(e,t,o)=>{xw(e,t,o,t.selected)};var _w=Object.freeze({__proto__:null,onLoad:Ow,toggle:ww,isOn:Cw,on:Sw,off:kw,set:xw});const Tw=()=>Nl({}),Ew=(e,t)=>{const o=_u(e,t,ww),n=Tu(e,t,Ow);return Fi(Q([e.toggleOnExecute?[o]:[],[n]]))};var Dw=Object.freeze({__proto__:null,exhibit:Tw,events:Ew});const Mw=(e,t,o)=>{eo(e.element,"aria-pressed",o),t.syncWithExpanded&&Fw(e,t,o)},Aw=(e,t,o)=>{eo(e.element,"aria-selected",o)},Bw=(e,t,o)=>{eo(e.element,"aria-checked",o)},Fw=(e,t,o)=>{eo(e.element,"aria-expanded",o)};var Iw=[Qs("selected",!1),js("toggleClass"),Qs("toggleOnExecute",!0),Ed("onToggled"),ea("aria",{mode:"none"},Es("mode",{pressed:[Qs("syncWithExpanded",!1),Bd("update",Mw)],checked:[Bd("update",Bw)],expanded:[Bd("update",Fw)],selected:[Bd("update",Aw)],none:[Bd("update",y)]}))];const Rw=Ru({fields:Iw,name:"toggling",active:Dw,apis:_w,state:bw(!1)}),Nw=()=>{const e=(e,t)=>{t.stop(),Ei(e)};return[Vi(Ka(),e),Vi(ii(),e),ji(Fa()),ji(Va())]},Vw=e=>{const t=e=>Yi(((t,o)=>{e(t),o.stop()}));return Fi(Q([e.map(t).toArray(),Nw()]))},Hw="alloy.item-hover",zw="alloy.item-focus",Pw="alloy.item-toggled",Lw=e=>{($u(e.element).isNone()||fw.isFocused(e))&&(fw.isFocused(e)||fw.focus(e),Ti(e,Hw,{item:e}))},Uw=e=>{Ti(e,zw,{item:e})},Ww=(e,t)=>{Ti(e,Pw,{item:e,state:t})},jw=k(Hw),Gw=k(zw),$w=k(Pw),qw=e=>e.toggling.map((e=>e.exclusive?"menuitemradio":"menuitemcheckbox")).getOr("menuitem"),Kw=e=>({aria:{mode:"checked"},...xe(e,((e,t)=>"exclusive"!==t)),onToggled:(t,o)=>{f(e.onToggled)&&e.onToggled(t,o),Ww(t,o)}}),Xw=e=>({dom:e.dom,domModification:{...e.domModification,attributes:{role:qw(e),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:yf.augment(e.itemBehaviours,[e.toggling.fold(Rw.revoke,(e=>Rw.config(Kw(e)))),fw.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:e=>{Uw(e)}}),Gx.config({mode:"execution"}),hf.config({store:{mode:"memory",initialValue:e.data}}),iw("item-type-events",[...Nw(),Vi(La(),Lw),Vi(ai(),fw.focus)])]),components:e.components,eventOrder:e.eventOrder}),Yw=[Fs("data"),Fs("components"),Fs("dom"),Qs("hasSubmenu",!1),js("toggling"),yf.field("itemBehaviours",[Rw,fw,Gx,hf]),Qs("ignoreFocus",!1),Qs("domModification",{}),Bd("builder",Xw),Qs("eventOrder",{})],Jw=e=>({dom:e.dom,components:e.components,events:Fi([Gi(ai())])}),Zw=[Fs("dom"),Fs("components"),Bd("builder",Jw)],Qw=k("item-widget"),eS=k([Kf({name:"widget",overrides:e=>({behaviours:Fu([hf.config({store:{mode:"manual",getValue:t=>e.data,setValue:y}})])})})]),tS=e=>{const t=ib(Qw(),e,eS()),o=lb(Qw(),e,t.internals()),n=t=>cb(t,e,"widget").map((e=>(Gx.focusIn(e),e))),r=(t,o)=>Db(o.event.target)?F.none():(()=>e.autofocus?(o.setSource(t.element),F.none()):F.none())();return{dom:e.dom,components:o,domModification:e.domModification,events:Fi([Yi(((e,t)=>{n(e).each((e=>{t.stop()}))})),Vi(La(),Lw),Vi(ai(),((t,o)=>{e.autofocus?n(t):fw.focus(t)}))]),behaviours:yf.augment(e.widgetBehaviours,[hf.config({store:{mode:"memory",initialValue:e.data}}),fw.config({ignore:e.ignoreFocus,onFocus:e=>{Uw(e)}}),Gx.config({mode:"special",focusIn:e.autofocus?e=>{n(e)}:Hu(),onLeft:r,onRight:r,onEscape:(t,o)=>fw.isFocused(t)||e.autofocus?e.autofocus?(o.setSource(t.element),F.none()):F.none():(fw.focus(t),F.some(!0))})])}},oS=[Fs("uid"),Fs("data"),Fs("components"),Fs("dom"),Qs("autofocus",!1),Qs("ignoreFocus",!1),yf.field("widgetBehaviours",[hf,fw,Gx]),Qs("domModification",{}),fb(eS()),Bd("builder",tS)],nS=Es("type",{widget:oS,item:Yw,separator:Zw}),rS=(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}),sS=(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager}),aS=(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}),iS=k([Jf({factory:{sketch:e=>{const t=_s("menu.spec item",nS,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>Oe(t,"uid")?t:{...t,uid:bl("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),lS=k([Fs("value"),Fs("items"),Fs("dom"),Fs("components"),Qs("eventOrder",{}),ff("menuBehaviours",[vv,hf,Fb,Gx]),ea("movement",{mode:"menu",moveOnTab:!0},Es("mode",{grid:[Id(),Bd("config",rS)],matrix:[Bd("config",sS),Fs("rowSelector"),Qs("previousSelector",F.none)],menu:[Qs("moveOnTab",!0),Bd("config",aS)]})),Cd(),Qs("fakeFocus",!1),Qs("focusManager",Pv()),Ed("onHighlight"),Ed("onDehighlight")]),cS=k("alloy.menu-focus"),dS=(e,t)=>{const o=op(e.element,'[role="menuitemradio"][aria-checked="true"]');j(o,(o=>{Ot(o,t.element)||e.getSystem().getByDom(o).each((e=>{Rw.off(e)}))}))},uS=(e,t,o,n)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:vf(e.menuBehaviours,[vv.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),hf.config({store:{mode:"memory",initialValue:e.value}}),Fb.config({find:F.some}),Gx.config(e.movement.config(e,e.movement))]),events:Fi([Vi(Gw(),((e,t)=>{const o=t.event;e.getSystem().getByDom(o.target).each((o=>{vv.highlight(e,o),t.stop(),Ti(e,cS(),{menu:e,item:o})}))})),Vi(jw(),((e,t)=>{const o=t.event.item;vv.highlight(e,o)})),Vi($w(),((e,t)=>{const{item:o,state:n}=t.event;n&&"menuitemradio"===oo(o.element,"role")&&dS(e,o)}))]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}),mS=Eb({name:"Menu",configFields:lS(),partFields:iS(),factory:uS}),gS=e=>fe(e,((e,t)=>({k:e,v:t}))),pS=(e,t,o,n)=>Ce(o,n).bind((n=>Ce(e,n).bind((n=>{const r=pS(e,t,o,n);return F.some([n].concat(r))})))).getOr([]),hS=(e,t)=>{const o={};pe(e,((e,t)=>{j(e,(e=>{o[e]=t}))}));const n=t,r=gS(t),s=he(r,((e,t)=>[t].concat(pS(o,n,r,t))));return he(o,(e=>Ce(s,e).getOr([e])))},fS=()=>{const e=ca({}),t=ca({}),o=ca({}),n=wm(),r=ca({}),s=()=>{e.set({}),t.set({}),o.set({}),n.clear()},a=()=>n.get().isNone(),i=(e,o)=>{t.set({...t.get(),[e]:{type:"prepared",menu:o}})},l=(s,a,i,l)=>{n.set(s),e.set(i),t.set(a),r.set(l);const c=hS(l,i);o.set(c)},c=t=>Se(e.get(),((e,o)=>e===t)),d=(e,t,o)=>h(e).bind((n=>c(e).bind((e=>t(e).map((e=>({triggeredMenu:n,triggeringItem:e,triggeringPath:o}))))))),u=(e,t)=>{const r=q(b(e).toArray(),(e=>h(e).isSome()));return Ce(o.get(),e).bind((e=>{const o=oe(r.concat(e)),s=ee(o,((e,r)=>d(e,t,o.slice(0,r+1)).fold((()=>Te(n.get(),e)?[]:[F.none()]),(e=>[F.some(e)]))));return Me(s)}))},m=t=>Ce(e.get(),t).map((e=>{const n=Ce(o.get(),t).getOr([]);return[e].concat(n)})),g=e=>Ce(o.get(),e).bind((e=>e.length>1?F.some(e.slice(1)):F.none())),p=e=>Ce(o.get(),e),h=e=>f(e).bind(bS),f=e=>Ce(t.get(),e),b=t=>Ce(e.get(),t),v=e=>{const t=r.get();return ne(me(t),e)},y=()=>n.get().bind(h),x=()=>t.get();return{setMenuBuilt:i,setContents:l,expand:m,refresh:p,collapse:g,lookupMenu:f,lookupItem:b,otherMenus:v,getPrimary:y,getMenus:x,clear:s,isClear:a,getTriggeringPath:u}},bS=e=>"prepared"===e.type?F.some(e.menu):F.none(),vS={init:fS,extractPreparedMenu:bS},yS=cl("tiered-menu-item-highlight"),xS=cl("tiered-menu-item-dehighlight");var wS;(function(e){e[e["HighlightMenuAndItem"]=0]="HighlightMenuAndItem",e[e["HighlightJustMenu"]=1]="HighlightJustMenu",e[e["HighlightNone"]=2]="HighlightNone"})(wS||(wS={}));const SS=(e,t)=>{const o=wm(),n=(t,o,n)=>he(n,((n,r)=>{const s=()=>mS.sketch({...n,value:r,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:(e,t)=>{const o={menuComp:e,itemComp:t};Ti(e,yS,o)},onDehighlight:(e,t)=>{const o={menuComp:e,itemComp:t};Ti(e,xS,o)},focusManager:e.fakeFocus?Lv():Pv()});return r===o?{type:"prepared",menu:t.getSystem().build(s())}:{type:"notbuilt",nbMenu:s}})),r=vS.init(),s=t=>{const o=n(t,e.data.primary,e.data.menus),s=l();return r.setContents(e.data.primary,o,e.data.expansions,s),r.getPrimary()},a=e=>hf.getValue(e).value,i=(e,t,o)=>ue(t,(e=>{if(!e.getSystem().isConnected())return F.none();const t=vv.getCandidates(e);return J(t,(e=>a(e)===o))})),l=t=>he(e.data.menus,((e,t)=>ee(e.items,(e=>"separator"===e.type?[]:[e.data.value])))),c=vv.highlight,d=(t,o)=>{c(t,o),vv.getHighlighted(o).orThunk((()=>vv.getFirst(o))).each((n=>{e.fakeFocus?vv.highlight(o,n):Di(t,n.element,ai())}))},u=(e,t)=>De(W(t,(t=>e.lookupMenu(t).bind((e=>"prepared"===e.type?F.some(e.menu):F.none()))))),m=(t,o,n)=>{const r=u(o,o.otherMenus(n));j(r,(o=>{fc(o.element,[e.markers.backgroundMenu]),e.stayInDom||sw.remove(t,o)}))},g=t=>o.get().getOrThunk((()=>{const n={},r=op(t.element,`.${e.markers.item}`),s=q(r,(e=>"true"===oo(e,"aria-haspopup")));return j(s,(e=>{t.getSystem().getByDom(e).each((e=>{const t=a(e);n[t]=e}))})),o.set(n),n})),p=(e,t)=>{const o=g(e);pe(o,((e,o)=>{const n=z(t,o);eo(e.element,"aria-expanded",n)}))},h=(t,o,n)=>F.from(n[0]).bind((r=>o.lookupMenu(r).bind((r=>{if("notbuilt"===r.type)return F.none();{const s=r.menu,a=u(o,n.slice(1));return j(a,(t=>{uc(t.element,e.markers.backgroundMenu)})),Yt(s.element)||sw.append(t,Kc(s)),fc(s.element,[e.markers.backgroundMenu]),d(t,s),m(t,o,n),F.some(s)}}))));let f;(function(e){e[e["HighlightSubmenu"]=0]="HighlightSubmenu",e[e["HighlightParent"]=1]="HighlightParent"})(f||(f={}));const b=(e,t,o)=>{if("notbuilt"===o.type){const n=e.getSystem().build(o.nbMenu());return r.setMenuBuilt(t,n),n}return o.menu},v=(t,o,n=f.HighlightSubmenu)=>{if(o.hasConfigured(Zb)&&Zb.isDisabled(o))return F.some(o);{const s=a(o);return r.expand(s).bind((s=>(p(t,s),F.from(s[0]).bind((a=>r.lookupMenu(a).bind((i=>{const l=b(t,a,i);return Yt(l.element)||sw.append(t,Kc(l)),e.onOpenSubmenu(t,o,l,oe(s)),n===f.HighlightSubmenu?(vv.highlightFirst(l),h(t,r,s)):(vv.dehighlightAll(l),F.some(o))})))))))}},x=(t,o)=>{const n=a(o);return r.collapse(n).bind((n=>(p(t,n),h(t,r,n).map((n=>(e.onCollapseMenu(t,o,n),n))))))},w=(e,t)=>{const o=a(t);return r.refresh(o).bind((t=>(p(e,t),h(e,r,t))))},S=(e,t)=>Db(t.element)?F.none():v(e,t,f.HighlightSubmenu),k=(e,t)=>Db(t.element)?F.none():x(e,t),C=(t,o)=>x(t,o).orThunk((()=>e.onEscape(t,o).map((()=>t)))),O=t=>(o,n)=>rd(n.getSource(),`.${e.markers.item}`).bind((e=>o.getSystem().getByDom(e).toOptional().bind((e=>t(o,e).map(A))))),_=Fi([Vi(cS(),((e,t)=>{const o=t.event.item;r.lookupItem(a(o)).each((()=>{const o=t.event.menu;vv.highlight(e,o);const n=a(t.event.item);r.refresh(n).each((t=>m(e,r,t)))}))})),Yi(((t,o)=>{const n=o.event.target;t.getSystem().getByDom(n).each((o=>{const n=a(o);0===n.indexOf("collapse-item")&&x(t,o),v(t,o,f.HighlightSubmenu).fold((()=>{e.onExecute(t,o)}),y)}))})),qi(((t,o)=>{s(t).each((o=>{sw.append(t,Kc(o)),e.onOpenMenu(t,o),e.highlightOnOpen===wS.HighlightMenuAndItem?d(t,o):e.highlightOnOpen===wS.HighlightJustMenu&&c(t,o)}))})),Vi(yS,((t,o)=>{e.onHighlightItem(t,o.event.menuComp,o.event.itemComp)})),Vi(xS,((t,o)=>{e.onDehighlightItem(t,o.event.menuComp,o.event.itemComp)})),...e.navigateOnHover?[Vi(jw(),((t,o)=>{const n=o.event.item;w(t,n),v(t,n,f.HighlightParent),e.onHover(t,n)}))]:[]]),T=e=>vv.getHighlighted(e).bind(vv.getHighlighted),E=e=>{T(e).each((t=>{x(e,t)}))},D=e=>{r.getPrimary().each((t=>{d(e,t)}))},M=e=>F.from(e.components()[0]).filter((e=>"menu"===oo(e.element,"role"))),B=t=>{const o=r.getPrimary().bind((e=>T(t).bind((e=>{const o=a(e),n=ke(r.getMenus()),s=De(W(n,vS.extractPreparedMenu));return r.getTriggeringPath(o,(e=>i(t,s,e)))})).map((t=>({primary:e,triggeringPath:t})))));o.fold((()=>{M(t).each((o=>{e.onRepositionMenu(t,o,[])}))}),(({primary:o,triggeringPath:n})=>{e.onRepositionMenu(t,o,n)}))},I={collapseMenu:E,highlightPrimary:D,repositionMenus:B};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:vf(e.tmenuBehaviours,[Gx.config({mode:"special",onRight:O(S),onLeft:O(k),onEscape:O(C),focusIn:(e,t)=>{r.getPrimary().each((t=>{Di(e,t.element,ai())}))}}),vv.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),Fb.config({find:e=>vv.getHighlighted(e)}),sw.config({})]),eventOrder:e.eventOrder,apis:I,events:_}},kS=k("collapse-item"),CS=(e,t,o)=>({primary:e,menus:t,expansions:o}),OS=(e,t)=>({primary:e,menus:ba(e,t),expansions:{}}),_S=e=>({value:cl(kS()),meta:{text:e}}),TS=Tb({name:"TieredMenu",configFields:[Ad("onExecute"),Ad("onEscape"),Md("onOpenMenu"),Md("onOpenSubmenu"),Ed("onRepositionMenu"),Ed("onCollapseMenu"),Qs("highlightOnOpen",wS.HighlightMenuAndItem),Ls("data",[Fs("primary"),Fs("menus"),Fs("expansions")]),Qs("fakeFocus",!1),Ed("onHighlightItem"),Ed("onDehighlightItem"),Ed("onHover"),Od(),Fs("dom"),Qs("navigateOnHover",!0),Qs("stayInDom",!1),ff("tmenuBehaviours",[Gx,vv,Fb,sw]),Qs("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:SS,extraApis:{tieredData:CS,singleData:OS,collapseItem:_S}}),ES=(e,t,o,n,r)=>{const s=()=>e.lazySink(t),a="horizontal"===n.type?{layouts:{onLtr:()=>xu(),onRtl:()=>wu()}}:{},i=e=>2===e.length,l=e=>i(e)?a:{};return TS.sketch({dom:{tag:"div"},data:n.data,markers:n.menu.markers,highlightOnOpen:n.menu.highlightOnOpen,fakeFocus:n.menu.fakeFocus,onEscape:()=>(Bh.close(t),e.onEscape.map((e=>e(t))),F.some(!0)),onExecute:()=>F.some(!0),onOpenMenu:(e,t)=>{Kp.positionWithinBounds(s().getOrDie(),t,o,r())},onOpenSubmenu:(e,t,o,n)=>{const r=s().getOrDie();Kp.position(r,o,{anchor:{type:"submenu",item:t,...l(n)}})},onRepositionMenu:(e,t,n)=>{const a=s().getOrDie();Kp.positionWithinBounds(a,t,o,r()),j(n,(e=>{const t=l(e.triggeringPath);Kp.position(a,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})}))}})},DS=(e,t)=>{const o=(t,o)=>{const n=e.getRelated(t);return n.exists((e=>cd(e,o)))},n=(e,t)=>{Bh.setContent(e,t)},r=(e,t,o)=>{s(e,t,o,F.none())},s=(e,t,o,n)=>{a(e,t,o,(()=>n.map((e=>tr(e)))))},a=(t,o,n,r)=>{const s=e.lazySink(t).getOrDie();Bh.openWhileCloaked(t,o,(()=>Kp.positionWithinBounds(s,t,n,r()))),hf.setValue(t,F.some({mode:"position",config:n,getBounds:r}))},i=(e,t,o)=>{l(e,t,o,F.none)},l=(t,o,n,r)=>{const s=ES(e,t,o,n,r);Bh.open(t,s),hf.setValue(t,F.some({mode:"menu",menu:s}))},c=e=>{Bh.isOpen(e)&&(hf.setValue(e,F.none()),Bh.close(e))},d=e=>Bh.getState(e),u=t=>{Bh.isOpen(t)&&hf.getValue(t).each((o=>{switch(o.mode){case"menu":Bh.getState(t).each(TS.repositionMenus);break;case"position":const n=e.lazySink(t).getOrDie();Kp.positionWithinBounds(n,t,o.config,o.getBounds());break}}))},m={setContent:n,showAt:r,showWithin:s,showWithinBounds:a,showMenuAt:i,showMenuWithinBounds:l,hide:c,getContent:d,reposition:u,isOpen:Bh.isOpen};return{uid:e.uid,dom:e.dom,behaviours:vf(e.inlineBehaviours,[Bh.config({isPartOf:(e,t,n)=>cd(t,n)||o(e,n),getAttachPoint:t=>e.lazySink(t).getOrDie(),onOpen:t=>{e.onShow(t)},onClose:t=>{e.onHide(t)}}),hf.config({store:{mode:"memory",initialValue:F.none()}}),zu.config({channels:{...Vh({isExtraPart:t.isExtraPart,...e.fireDismissalEventInstead.map((e=>({fireEventInstead:{event:e.event}}))).getOr({})}),...zh({...e.fireRepositionEventInstead.map((e=>({fireEventInstead:{event:e.event}}))).getOr({}),doReposition:u})}})]),eventOrder:e.eventOrder,apis:m}},MS=Tb({name:"InlineView",configFields:[Fs("lazySink"),Ed("onShow"),Ed("onHide"),Xs("onEscape"),ff("inlineBehaviours",[Bh,hf,zu]),Js("fireDismissalEventInstead",[Qs("event",vi())]),Js("fireRepositionEventInstead",[Qs("event",yi())]),Qs("getRelated",F.none),Qs("isExtraPart",M),Qs("eventOrder",F.none)],factory:DS,apis:{showAt:(e,t,o,n)=>{e.showAt(t,o,n)},showWithin:(e,t,o,n,r)=>{e.showWithin(t,o,n,r)},showWithinBounds:(e,t,o,n,r)=>{e.showWithinBounds(t,o,n,r)},showMenuAt:(e,t,o,n)=>{e.showMenuAt(t,o,n)},showMenuWithinBounds:(e,t,o,n,r)=>{e.showMenuWithinBounds(t,o,n,r)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,o)=>{e.setContent(t,o)},reposition:(e,t)=>{e.reposition(t)}}});var AS=tinymce.util.Tools.resolve("tinymce.util.Delay");const BS=e=>{const t=Vw(e.action),o=e.dom.tag,n=t=>Ce(e.dom,"attributes").bind((e=>Ce(e,t))),r=()=>{if("button"===o){const e=n("type").getOr("button"),t=n("role").map((e=>({role:e}))).getOr({});return{type:e,...t}}{const e=n("role").getOr("button");return{role:e}}};return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:yf.augment(e.buttonBehaviours,[fw.config({}),Gx.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:r()},eventOrder:e.eventOrder}},FS=Tb({name:"Button",factory:BS,configFields:[Qs("uid",void 0),Fs("dom"),Qs("components",[]),yf.field("buttonBehaviours",[fw,Gx]),js("action"),js("role"),Qs("eventOrder",{})]}),IS=e=>{const t=Cb(e)&&_e(e,"uid")?e.uid:bl("memento"),o=e=>e.getSystem().getByUid(t).getOrDie(),n=e=>e.getSystem().getByUid(t).toOptional(),r=()=>({...e,uid:t});return{get:o,getOpt:n,asSpec:r}};var RS=tinymce.util.Tools.resolve("tinymce.util.I18n");const NS={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},VS="temporary-placeholder",HS=e=>()=>Ce(e,VS).getOr("!not found!"),zS=(e,t)=>{const o=e.toLowerCase();if(RS.isRtl()){const e=ze(o,"-rtl");return Oe(t,e)?e:o}return o},PS=(e,t)=>Ce(t,zS(e,t)),LS=(e,t)=>{const o=t();return PS(e,o).getOrThunk(HS(o))},US=(e,t,o)=>{const n=t();return PS(e,n).or(o).getOrThunk(HS(n))},WS=e=>!!RS.isRtl()&&Oe(NS,e),jS=()=>iw("add-focusable",[qi((e=>{od(e.element,"svg").each((e=>eo(e,"focusable","false")))}))]),GS=(e,t,o,n)=>{var r,s;const a=WS(t)?["tox-icon--flip"]:[],i=Ce(o,zS(t,o)).or(n).getOrThunk(HS(o));return{dom:{tag:e.tag,attributes:null!==(r=e.attributes)&&void 0!==r?r:{},classes:e.classes.concat(a),innerHtml:i},behaviours:Fu([...null!==(s=e.behaviours)&&void 0!==s?s:[],jS()])}},$S=(e,t,o,n=F.none())=>GS(t,e,o(),n),qS=(e,t,o)=>{const n=o(),r=J(e,(e=>Oe(n,zS(e,n))));return GS(t,r.getOr(VS),n,F.none())},KS={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},XS=e=>{const t=IS({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:Fu([sw.config({})])}),o=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${e}%`}}}),n=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${e}%`}}),r=IS({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:Fu([sw.config({})])}),s=(e,t)=>{e.getSystem().isConnected()&&r.getOpt(e).each((e=>{sw.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(t)]},n(t)])}))},a=(e,o)=>{if(e.getSystem().isConnected()){const n=t.get(e);sw.set(n,[Uc(o)])}},i={updateProgress:s,updateText:a},l=Q([e.icon.toArray(),e.level.toArray(),e.level.bind((e=>F.from(KS[e]))).toArray()]),c=IS(FS.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[$S("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:t=>{e.onAction(t)}})),d=qS(l,{tag:"div",classes:["tox-notification__icon"]},e.iconProvider),u={dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:Fu([sw.config({})])},m=[d,u];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map((e=>["tox-notification","tox-notification--in",`tox-notification--${e}`])).getOr(["tox-notification","tox-notification--in"])},behaviours:Fu([fw.config({}),iw("notification-events",[Vi(Ua(),(e=>{c.getOpt(e).each(fw.focus)}))])]),components:m.concat(e.progress?[r.asSpec()]:[]).concat(e.closeButton?[c.asSpec()]:[]),apis:i}},YS=Tb({name:"Notification",factory:XS,configFields:[js("level"),Fs("progress"),js("icon"),Fs("onAction"),Fs("text"),Fs("iconProvider"),Fs("translationProvider"),ra("closeButton",!0)],apis:{updateProgress:(e,t,o)=>{e.updateProgress(t,o)},updateText:(e,t,o)=>{e.updateText(t,o)}}});var JS,ZS,QS=(e,t,o)=>{const n=t.backstage.shared,r=()=>{const t=tr(Qe.fromDom(e.getContentAreaContainer())),o=nr(),n=Xd(o.x,t.x,t.right),r=Xd(o.y,t.y,t.bottom),s=Math.max(t.right,o.right),a=Math.max(t.bottom,o.bottom);return F.some(er(n,r,s-n,a-r))},s=(t,s)=>{const a=()=>{s(),MS.hide(l)},i=qc(YS.sketch({text:t.text,level:z(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:t.icon,closeButton:t.closeButton,onAction:a,iconProvider:n.providers.icons,translationProvider:n.providers.translate})),l=qc(MS.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.getSink,fireDismissalEventInstead:{},...n.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));o.add(l),b(t.timeout)&&t.timeout>0&&AS.setEditorTimeout(e,(()=>{a()}),t.timeout);const c=()=>{const t=Kc(i),o={maxHeightFunction:jm()},s=e.notificationManager.getNotifications();if(s[0]===d){const e={...n.anchors.banner(),overrides:o};MS.showWithinBounds(l,t,{anchor:e},r)}else H(s,d).each((e=>{const n=s[e-1].getEl(),a={type:"node",root:Jt(),node:F.some(Qe.fromDom(n)),overrides:o,layouts:{onRtl:()=>[gu],onLtr:()=>[gu]}};MS.showWithinBounds(l,t,{anchor:a},r)}))},d={close:a,reposition:c,text:e=>{YS.updateText(i,e)},settings:t,getEl:()=>i.element.dom,progressBar:{value:e=>{YS.updateProgress(i,e)}}};return d},a=e=>{e.close()},i=e=>e.settings;return{open:s,close:a,getArgs:i}},ek=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),tk=tinymce.util.Tools.resolve("tinymce.EditorManager"),ok=tinymce.util.Tools.resolve("tinymce.Env");(function(e){e["default"]="wrap",e["floating"]="floating",e["sliding"]="sliding",e["scrolling"]="scrolling"})(JS||(JS={})),function(e){e["auto"]="auto",e["top"]="top",e["bottom"]="bottom"}(ZS||(ZS={}));const nk=e=>t=>t.options.get(e),rk=e=>t=>F.from(e(t)),sk=e=>{const t=ok.deviceType.isPhone(),o=ok.deviceType.isTablet()||t,n=e.options.register,r=e=>i(e)||!1===e,s=e=>i(e)||b(e);n("skin",{processor:e=>i(e)||!1===e,default:"oxide"}),n("skin_url",{processor:"string"}),n("height",{processor:s,default:Math.max(e.getElement().offsetHeight,400)}),n("width",{processor:s,default:ek.DOM.getStyle(e.getElement(),"width")}),n("min_height",{processor:"number",default:100}),n("min_width",{processor:"number"}),n("max_height",{processor:"number"}),n("max_width",{processor:"number"}),n("style_formats",{processor:"object[]"}),n("style_formats_merge",{processor:"boolean",default:!1}),n("style_formats_autohide",{processor:"boolean",default:!1}),n("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),n("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),n("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),n("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),n("content_langs",{processor:"object[]"}),n("removed_menuitems",{processor:"string",default:""}),n("menubar",{processor:e=>i(e)||m(e),default:!t}),n("menu",{processor:"object",default:{}}),n("toolbar",{processor:e=>m(e)||i(e)||d(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),L(9,(e=>{n("toolbar"+(e+1),{processor:"string"})})),n("toolbar_mode",{processor:"string",default:o?"scrolling":"floating"}),n("toolbar_groups",{processor:"object",default:{}}),n("toolbar_location",{processor:"string",default:ZS.auto}),n("toolbar_persist",{processor:"boolean",default:!1}),n("toolbar_sticky",{processor:"boolean",default:e.inline}),n("toolbar_sticky_offset",{processor:"number",default:0}),n("fixed_toolbar_container",{processor:"string",default:""}),n("fixed_toolbar_container_target",{processor:"object"}),n("file_picker_callback",{processor:"function"}),n("file_picker_validator_handler",{processor:"function"}),n("file_picker_types",{processor:"string"}),n("typeahead_urls",{processor:"boolean",default:!0}),n("anchor_top",{processor:r,default:"#top"}),n("anchor_bottom",{processor:r,default:"#bottom"}),n("draggable_modal",{processor:"boolean",default:!1}),n("statusbar",{processor:"boolean",default:!0}),n("elementpath",{processor:"boolean",default:!0}),n("branding",{processor:"boolean",default:!0}),n("promotion",{processor:"boolean",default:!0}),n("resize",{processor:e=>"both"===e||m(e),default:!ok.deviceType.isTouch()}),n("sidebar_show",{processor:"string"})},ak=nk("readonly"),ik=nk("height"),lk=nk("width"),ck=rk(nk("min_width")),dk=rk(nk("min_height")),uk=rk(nk("max_width")),mk=rk(nk("max_height")),gk=rk(nk("style_formats")),pk=nk("style_formats_merge"),hk=nk("style_formats_autohide"),fk=nk("content_langs"),bk=nk("removed_menuitems"),vk=nk("toolbar_mode"),yk=nk("toolbar_groups"),xk=nk("toolbar_location"),wk=nk("fixed_toolbar_container"),Sk=nk("fixed_toolbar_container_target"),kk=nk("toolbar_persist"),Ck=nk("toolbar_sticky_offset"),Ok=nk("menubar"),_k=nk("toolbar"),Tk=nk("file_picker_callback"),Ek=nk("file_picker_validator_handler"),Dk=nk("file_picker_types"),Mk=nk("typeahead_urls"),Ak=nk("anchor_top"),Bk=nk("anchor_bottom"),Fk=nk("draggable_modal"),Ik=nk("statusbar"),Rk=nk("elementpath"),Nk=nk("branding"),Vk=nk("resize"),Hk=nk("paste_as_text"),zk=nk("sidebar_show"),Pk=nk("promotion"),Lk=e=>!1===e.options.get("skin"),Uk=e=>!1!==e.options.get("menubar"),Wk=e=>{const t=e.options.get("skin_url");if(Lk(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{const t=e.options.get("skin");return tk.baseURL+"/skins/ui/"+t}},jk=e=>e.options.get("line_height_formats").split(" "),Gk=e=>{const t=_k(e),o=i(t),n=d(t)&&t.length>0;return!qk(e)&&(n||o||!0===t)},$k=e=>{const t=L(9,(t=>e.options.get("toolbar"+(t+1)))),o=q(t,i);return Ie(o.length>0,o)},qk=e=>$k(e).fold((()=>{const t=_k(e);return v(t,i)&&t.length>0}),A),Kk=e=>xk(e)===ZS.bottom,Xk=e=>{var t;if(!e.inline)return F.none();const o=null!==(t=wk(e))&&void 0!==t?t:"";if(o.length>0)return nd(Jt(),o);const n=Sk(e);return h(n)?F.some(Qe.fromDom(n)):F.none()},Yk=e=>e.inline&&Xk(e).isSome(),Jk=e=>{const t=Xk(e);return t.getOrThunk((()=>jt(Wt(Qe.fromDom(e.getElement())))))},Zk=e=>e.inline&&!Uk(e)&&!Gk(e)&&!qk(e),Qk=e=>{const t=e.options.get("toolbar_sticky");return(t||e.inline)&&!Yk(e)&&!Zk(e)},eC=e=>{const t=e.options.get("menu");return he(t,(e=>({...e,items:e.items})))};var tC=Object.freeze({__proto__:null,get ToolbarMode(){return JS},get ToolbarLocation(){return ZS},register:sk,getSkinUrl:Wk,isReadOnly:ak,isSkinDisabled:Lk,getHeightOption:ik,getWidthOption:lk,getMinWidthOption:ck,getMinHeightOption:dk,getMaxWidthOption:uk,getMaxHeightOption:mk,getUserStyleFormats:gk,shouldMergeStyleFormats:pk,shouldAutoHideStyleFormats:hk,getLineHeightFormats:jk,getContentLanguages:fk,getRemovedMenuItems:bk,isMenubarEnabled:Uk,isMultipleToolbars:qk,isToolbarEnabled:Gk,isToolbarPersist:kk,getMultipleToolbarsOption:$k,getUiContainer:Jk,useFixedContainer:Yk,getToolbarMode:vk,isDraggableModal:Fk,isDistractionFree:Zk,isStickyToolbar:Qk,getStickyToolbarOffset:Ck,getToolbarLocation:xk,isToolbarLocationBottom:Kk,getToolbarGroups:yk,getMenus:eC,getMenubar:Ok,getToolbar:_k,getFilePickerCallback:Tk,getFilePickerTypes:Dk,useTypeaheadUrls:Mk,getAnchorTop:Ak,getAnchorBottom:Bk,getFilePickerValidatorHandler:Ek,useStatusBar:Ik,useElementPath:Rk,promotionEnabled:Pk,useBranding:Nk,getResize:Vk,getPasteAsText:Hk,getSidebarShow:zk});const oC="[data-mce-autocompleter]",nC=e=>rd(e,oC),rC=e=>nd(e,oC),sC=(e,t)=>{const o=(e,t)=>{Ti(e,ja(),{raw:t})},n=()=>e.getMenu().bind(vv.getHighlighted);t.on("keydown",(t=>{const r=t.which;e.isActive()&&(e.isMenuOpen()?13===r?(n().each(Ei),t.preventDefault()):40===r?(n().fold((()=>{e.getMenu().each(vv.highlightFirst)}),(e=>{o(e,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==r&&38!==r&&39!==r||n().each((e=>{o(e,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==r&&38!==r&&40!==r||e.cancelIfNecessary())})),t.on("NodeChange",(t=>{e.isActive()&&!e.isProcessingAction()&&nC(Qe.fromDom(t.element)).isNone()&&e.cancelIfNecessary()}))},aC={setup:sC};var iC;(function(e){e[e["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",e[e["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(iC||(iC={}));var lC=iC;const cC="tox-menu-nav__js",dC="tox-collection__item",uC="tox-swatch",mC={normal:cC,color:uC},gC="tox-collection__item--enabled",pC="tox-collection__group-heading",hC="tox-collection__item-icon",fC="tox-collection__item-label",bC="tox-collection__item-accessory",vC="tox-collection__item-caret",yC="tox-collection__item-checkmark",xC="tox-collection__item--active",wC="tox-collection__item-container",SC="tox-collection__item-container--column",kC="tox-collection__item-container--row",CC="tox-collection__item-container--align-right",OC="tox-collection__item-container--align-left",_C="tox-collection__item-container--valign-top",TC="tox-collection__item-container--valign-middle",EC="tox-collection__item-container--valign-bottom",DC=e=>Ce(mC,e).getOr(cC),MC=e=>"color"===e?"tox-swatches":"tox-menu",AC=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:MC(e),tieredMenu:"tox-tiered-menu"}),BC=e=>{const t=AC(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:DC(e)}},FC=(e,t,o)=>{const n=AC(o);return{tag:"div",classes:Q([[n.menu,`tox-menu-${t}-column`],e?[n.hasIcons]:[]])}},IC=[mS.parts.items({})],RC=(e,t,o)=>{const n=AC(o),r={tag:"div",classes:Q([[n.tieredMenu]])};return{dom:r,markers:BC(o)}},NC=k([js("data"),Qs("inputAttributes",{}),Qs("inputStyles",{}),Qs("tag","input"),Qs("inputClasses",[]),Ed("onSetValue"),Qs("styles",{}),Qs("eventOrder",{}),ff("inputBehaviours",[hf,fw]),Qs("selectOnFocus",!0)]),VC=e=>Fu([fw.config({onFocus:e.selectOnFocus?e=>{const t=e.element,o=xc(t);t.dom.setSelectionRange(0,o.length)}:y})]),HC=e=>({...VC(e),...vf(e.inputBehaviours,[hf.config({store:{mode:"manual",...e.data.map((e=>({initialValue:e}))).getOr({}),getValue:e=>xc(e.element),setValue:(e,t)=>{const o=xc(e.element);o!==t&&wc(e.element,t)}},onSetValue:e.onSetValue})])}),zC=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),PC=(e,t)=>({uid:e.uid,dom:zC(e),components:[],behaviours:HC(e),eventOrder:e.eventOrder}),LC=Tb({name:"Input",configFields:NC(),factory:PC}),UC=cl("refetch-trigger-event"),WC=cl("redirect-menu-item-interaction"),jC="tox-menu__searcher",GC=e=>nd(e.element,`.${jC}`).bind((t=>e.getSystem().getByDom(t).toOptional())),$C=GC,qC=(e,t)=>{hf.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd},KC=e=>{const t=hf.getValue(e),o=e.element.dom.selectionStart,n=e.element.dom.selectionEnd;return{fetchPattern:t,selectionStart:o,selectionEnd:n}},XC=(e,t)=>{no(t.element,"id").each((t=>eo(e.element,"aria-activedescendant",t)))},YC=e=>{const t=(e,t)=>(t.cut(),F.none()),o=(e,t)=>{const o={interactionEvent:t.event,eventType:t.event.raw.type};return Ti(e,WC,o),F.some(!0)},n="searcher-events";return{dom:{tag:"div",classes:[dC]},components:[LC.sketch({inputClasses:[jC,"tox-textfield"],inputAttributes:{...e.placeholder.map((t=>({placeholder:e.i18n(t)}))).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:Fu([iw(n,[Vi($a(),(e=>{_i(e,UC)})),Vi(ja(),((e,t)=>{"Escape"===t.event.raw.key&&t.stop()}))]),Gx.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[n,Gx.name()]}})]}},JC="tox-collection--results__js",ZC=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...null!==(t=e.dom.attributes)&&void 0!==t?t:{},id:cl("aria-item-search-result-id"),"aria-selected":"false"}}}:e},QC=(e,t)=>o=>{const n=U(o,t);return W(n,(t=>({dom:e,components:t})))},eO=e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[mS.parts.items({preprocess:"auto"!==e?QC({tag:"div",classes:["tox-swatches__row"]},e):C})]}]}),tO=e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[mS.parts.items({preprocess:QC({tag:"div",classes:["tox-collection__group"]},e)})]}),oO=(e,t)=>{const o=[];let n=[];return j(e,((e,r)=>{t(e,r)?(n.length>0&&o.push(n),n=[],(Oe(e.dom,"innerHtml")||e.components&&e.components.length>0)&&n.push(e)):n.push(e)})),n.length>0&&o.push(n),W(o,(e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e})))},nO=(e,t,o)=>mS.parts.items({preprocess:n=>{const r=W(n,o);return"auto"!==e&&e>1?QC({tag:"div",classes:["tox-collection__group"]},e)(r):oO(r,((e,o)=>"separator"===t[o].type))}}),rO=(e,t,o=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[nO(e,t,C)]}),sO=(e,t,o=!0)=>{const n=cl("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",JC].concat(1===e?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:n}},components:[nO(e,t,ZC)]}},aO=(e,t,o)=>{const n=cl("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[YC({i18n:RS.translate,placeholder:o.placeholder}),{dom:{tag:"div",classes:[...1===e?["tox-collection--list"]:["tox-collection--grid"],JC],attributes:{id:n}},components:[nO(e,t,ZC)]}]}},iO=(e,t=!0)=>({dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[mS.parts.items({preprocess:t=>oO(t,((t,o)=>"separator"===e[o].type))})]}),lO=e=>P(e,(e=>"icon"in e&&void 0!==e.icon)),cO=e=>(console.error(Ts(e)),console.log(e),F.none()),dO=(e,t,o,n,r)=>{const s=iO(o);return{value:e,dom:s.dom,components:s.components,items:o}},uO=(e,t,o,n,r)=>{const s=()=>"searchable"!==r.menuType?rO(n,o):"search-with-field"===r.searchMode.searchMode?aO(n,o,r.searchMode):sO(n,o);if("color"===r.menuType){const t=eO(n);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType&&"auto"===n){const t=rO(n,o);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType||"searchable"===r.menuType){const t=s();return{value:e,dom:t.dom,components:t.components,items:o}}if("listpreview"===r.menuType&&"auto"!==n){const t=tO(n);return{value:e,dom:t.dom,components:t.components,items:o}}return{value:e,dom:FC(t,n,r.menuType),components:IC,items:o}},mO=Ns("type"),gO=Ns("name"),pO=Ns("label"),hO=Ns("text"),fO=Ns("title"),bO=Ns("icon"),vO=Ns("value"),yO=zs("fetch"),xO=zs("getSubmenuItems"),wO=zs("onAction"),SO=zs("onItemAction"),kO=sa("onSetup",(()=>y)),CO=qs("name"),OO=qs("text"),_O=qs("icon"),TO=qs("tooltip"),EO=qs("label"),DO=qs("shortcut"),MO=Xs("select"),AO=ra("active",!1),BO=ra("borderless",!1),FO=ra("enabled",!0),IO=ra("primary",!1),RO=e=>Qs("columns",e),NO=Qs("meta",{}),VO=sa("onAction",y),HO=e=>oa("type",e),zO=e=>Ms("name","name",Dr((()=>cl(`${e}-name`))),gs),PO=e=>Ms("value","value",Dr((()=>cl(`${e}-value`))),ds()),LO=rs([mO,OO]),UO=e=>Cs("separatormenuitem",LO,e),WO=rs([HO("autocompleteitem"),AO,FO,NO,vO,OO,_O]),jO=e=>Cs("Autocompleter.Separator",LO,e),GO=e=>Cs("Autocompleter.Item",WO,e),$O=[FO,TO,_O,OO,kO],qO=rs([mO,wO].concat($O)),KO=e=>Cs("toolbarbutton",qO,e),XO=[AO].concat($O),YO=rs(XO.concat([mO,wO])),JO=e=>Cs("ToggleButton",YO,e),ZO=[sa("predicate",M),na("scope","node",["node","editor"]),na("position","selection",["node","selection","line"])],QO=$O.concat([HO("contextformbutton"),IO,wO,As("original",C)]),e_=XO.concat([HO("contextformbutton"),IO,wO,As("original",C)]),t_=$O.concat([HO("contextformbutton")]),o_=XO.concat([HO("contextformtogglebutton")]),n_=Es("type",{contextformbutton:QO,contextformtogglebutton:e_}),r_=rs([HO("contextform"),sa("initValue",k("")),EO,Ws("commands",n_),Gs("launch",Es("type",{contextformbutton:t_,contextformtogglebutton:o_}))].concat(ZO)),s_=e=>Cs("ContextForm",r_,e),a_=rs([HO("contexttoolbar"),Ns("items")].concat(ZO)),i_=e=>Cs("ContextToolbar",a_,e),l_=[mO,Ns("src"),qs("alt"),ia("classes",[],gs)],c_=rs(l_),d_=[mO,hO,CO,ia("classes",["tox-collection__item-label"],gs)],u_=rs(d_),m_=ts((()=>ys("type",{cardimage:c_,cardtext:u_,cardcontainer:g_}))),g_=rs([mO,oa("direction","horizontal"),oa("align","left"),oa("valign","middle"),Ws("items",m_)]),p_=[FO,OO,DO,PO("menuitem"),NO],h_=rs([mO,EO,Ws("items",m_),kO,VO].concat(p_)),f_=e=>Cs("cardmenuitem",h_,e),b_=rs([mO,AO,_O].concat(p_)),v_=e=>Cs("choicemenuitem",b_,e),y_=[mO,Ns("fancytype"),VO],x_=[Qs("initData",{})].concat(y_),w_=[la("initData",{},[ra("allowCustomColors",!0),oa("storageKey","default"),Ys("colors",ds())])].concat(y_),S_=Es("fancytype",{inserttable:x_,colorswatch:w_}),k_=e=>Cs("fancymenuitem",S_,e),C_=rs([mO,kO,VO,_O].concat(p_)),O_=e=>Cs("menuitem",C_,e),__=rs([mO,xO,kO,_O].concat(p_)),T_=e=>Cs("nestedmenuitem",__,e),E_=rs([mO,_O,AO,kO,wO].concat(p_)),D_=e=>Cs("togglemenuitem",E_,e),M_=(e,t,o)=>{const n=op(e.element,"."+o);if(n.length>0){const e=Z(n,(e=>{const o=e.dom.getBoundingClientRect().top,r=n[0].dom.getBoundingClientRect().top;return Math.abs(o-r)>t})).getOr(n.length);return F.some({numColumns:e,numRows:Math.ceil(n.length/e)})}return F.none()},A_=(e,t)=>Fu([iw(e,t)]),B_=e=>A_(cl("unnamed-events"),e),F_={namedEvents:A_,unnamedEvents:B_},I_=cl("tooltip.exclusive"),R_=cl("tooltip.show"),N_=cl("tooltip.hide"),V_=(e,t,o)=>{e.getSystem().broadcastOn([I_],{})},H_=(e,t,o,n)=>{o.getTooltip().each((e=>{e.getSystem().isConnected()&&sw.set(e,n)}))};var z_=Object.freeze({__proto__:null,hideAllExclusive:V_,setComponents:H_});const P_=(e,t)=>{const o=o=>{t.getTooltip().each((n=>{ih(n),e.onHide(o,n),t.clearTooltip()})),t.clearTimer()},n=o=>{if(!t.isShowing()){V_(o);const n=e.lazySink(o).getOrDie(),r=o.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:Fi("normal"===e.mode?[Vi(La(),(e=>{_i(o,R_)})),Vi(za(),(e=>{_i(o,N_)}))]:[]),behaviours:Fu([sw.config({})])});t.setTooltip(r),rh(n,r),e.onShow(o,r),Kp.position(n,r,{anchor:e.anchor(o)})}};return Fi(Q([[Vi(R_,(o=>{t.resetTimer((()=>{n(o)}),e.delay)})),Vi(N_,(n=>{t.resetTimer((()=>{o(n)}),e.delay)})),Vi(ri(),((e,t)=>{const n=t;n.universal||z(n.channels,I_)&&o(e)})),Ki((e=>{o(e)}))],"normal"===e.mode?[Vi(Ua(),(e=>{_i(e,R_)})),Vi(oi(),(e=>{_i(e,N_)})),Vi(La(),(e=>{_i(e,R_)})),Vi(za(),(e=>{_i(e,N_)}))]:[Vi(Ci(),((e,t)=>{_i(e,R_)})),Vi(Oi(),(e=>{_i(e,N_)}))]]))};var L_=Object.freeze({__proto__:null,events:P_}),U_=[Fs("lazySink"),Fs("tooltipDom"),Qs("exclusive",!0),Qs("tooltipComponents",[]),Qs("delay",300),na("mode","normal",["normal","follow-highlight"]),Qs("anchor",(e=>({type:"hotspot",hotspot:e,layouts:{onLtr:k([gu,mu,lu,du,cu,uu]),onRtl:k([gu,mu,lu,du,cu,uu])}}))),Ed("onHide"),Ed("onShow")];const W_=()=>{const e=wm(),t=wm(),o=()=>{e.on(clearTimeout)},n=(t,n)=>{o(),e.set(setTimeout(t,n))},r=k("not-implemented");return Al({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:o,resetTimer:n,readState:r})};var j_=Object.freeze({__proto__:null,init:W_});const G_=Ru({fields:U_,name:"tooltipping",active:L_,state:j_,apis:z_}),$_=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),q_="silver.readonly",K_=rs([Hs("readonly")]),X_=(e,t)=>{const o=e.mainUi.outerContainer,n=o.element,r=[e.mainUi.mothership,...e.uiMotherships];t&&j(r,(e=>{e.broadcastOn([Fh()],{target:n})})),j(r,(e=>{e.broadcastOn([q_],{readonly:t})}))},Y_=(e,t)=>{e.on("init",(()=>{e.mode.isReadOnly()&&X_(t,!0)})),e.on("SwitchMode",(()=>X_(t,e.mode.isReadOnly()))),ak(e)&&e.mode.set("readonly")},J_=()=>zu.config({channels:{[q_]:{schema:K_,onReceive:(e,t)=>{Zb.set(e,t.readonly)}}}}),Z_=e=>Zb.config({disabled:e,disableClass:"tox-collection__item--state-disabled"}),Q_=e=>Zb.config({disabled:e}),eT=e=>Zb.config({disabled:e,disableClass:"tox-tbtn--disabled"}),tT=e=>Zb.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),oT={item:Z_,button:Q_,splitButton:eT,toolbarButton:tT},nT=(e,t)=>{const o=e.getApi(t);return e=>{e(o)}},rT=(e,t)=>qi((o=>{const n=nT(e,o);n((o=>{const n=e.onSetup(o);f(n)&&t.set(n)}))})),sT=(e,t)=>Ki((o=>nT(e,o)(t.get()))),aT=(e,t)=>Yi(((o,n)=>{nT(e,o)(e.onAction),e.triggersSubmenu||t!==lC.CLOSE_ON_EXECUTE||(o.getSystem().isConnected()&&_i(o,ci()),n.stop())})),iT={[si()]:["disabling","alloy.base.behaviour","toggling","item-events"]},lT=De,cT=(e,t,o,n)=>{const r=ca(y);return{type:"item",dom:t.dom,components:lT(t.optComponents),data:e.data,eventOrder:iT,hasSubmenu:e.triggersSubmenu,itemBehaviours:Fu([iw("item-events",[aT(e,o),rT(e,r),sT(e,r)]),oT.item((()=>!e.enabled||n.isDisabled())),J_(),sw.config({})].concat(e.itemBehaviours))}},dT=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),uT=e=>{const t=ok.os.isMacOS()||ok.os.isiOS(),o={alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"},n={meta:"Ctrl",access:"Shift+Alt"},r=t?o:n,s=e.split("+"),a=W(s,(e=>{const t=e.toLowerCase().trim();return Oe(r,t)?r[t]:e}));return t?a.join(""):a.join("+")},mT=(e,t,o=[hC])=>$S(e,{tag:"div",classes:o},t),gT=e=>({dom:{tag:"div",classes:[fC]},components:[Uc(RS.translate(e))]}),pT=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),hT=(e,t)=>({dom:{tag:"div",classes:[fC]},components:[{dom:{tag:e.tag,styles:e.styles},components:[Uc(RS.translate(t))]}]}),fT=e=>({dom:{tag:"div",classes:[bC]},components:[Uc(uT(e))]}),bT=e=>mT("checkmark",e,[yC]),vT=e=>mT("chevron-right",e,[vC]),yT=e=>mT("chevron-down",e,[vC]),xT=(e,t)=>{const o="vertical"===e.direction?SC:kC,n="left"===e.align?OC:CC,r=()=>{switch(e.valign){case"top":return _C;case"middle":return TC;case"bottom":return EC}};return{dom:{tag:"div",classes:[wC,o,n,r()]},components:t}},wT=(e,t,o)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:o.getOr("")}}}),ST=(e,t,o)=>{const n="custom",r="remove",s=e.ariaLabel,a=e.value,i=e.iconContent.map((e=>US(e,t.icons,o))),l=()=>{const e=uC,o=i.getOr(""),l=s.map((e=>({title:t.translate(e)}))).getOr({}),c={tag:"div",attributes:l,classes:[e]};return a===n?{...c,tag:"button",classes:[...c.classes,"tox-swatches__picker-btn"],innerHtml:o}:a===r?{...c,classes:[...c.classes,"tox-swatch--remove"],innerHtml:o}:h(a)?{...c,attributes:{...c.attributes,"data-mce-color":a},styles:{"background-color":a},innerHtml:o}:c};return{dom:l(),optComponents:[]}},kT=e=>{const t=e.map((e=>({attributes:{title:RS.translate(e)}}))).getOr({});return{tag:"div",classes:[cC,dC],...t}},CT=(e,t,o,n)=>{const r={tag:"div",classes:[hC]},s=e=>$S(e,r,t.icons,n),a=()=>F.some({dom:r}),i=o?e.iconContent.map(s).orThunk(a):F.none(),l=e.checkMark,c=F.from(e.meta).fold((()=>gT),(e=>Oe(e,"style")?_(hT,e.style):gT)),d=e.htmlContent.fold((()=>e.textContent.map(c)),(e=>F.some(pT(e,[fC])))),u={dom:kT(e.ariaLabel),optComponents:[i,d,e.shortcutContent.map(fT),l,e.caret]};return u},OT=(e,t,o,n=F.none())=>"color"===e.presets?ST(e,t,n):CT(e,t,o,n),_T=(e,t)=>Ce(e,"tooltipWorker").map((e=>[G_.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:jm}}),mode:"follow-highlight",onShow:(t,o)=>{e((e=>{G_.setComponents(t,[Wc({element:Qe.fromDom(e)})])}))}})])).getOr([]),TT=e=>ek.DOM.encode(e),ET=(e,t)=>{const o=RS.translate(e),n=TT(o);if(t.length>0){const e=new RegExp($_(t),"gi");return n.replace(e,(e=>`<span class="tox-autocompleter-highlight">${e}</span>`))}return n},DT=(e,t,o,n,r,s,a,i=!0)=>{const l=OT({presets:n,textContent:F.none(),htmlContent:o?e.text.map((e=>ET(e,t))):F.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:F.none(),checkMark:F.none(),caret:F.none(),value:e.value},a.providers,i,e.icon);return cT({data:dT(e),enabled:e.enabled,getApi:k({}),onAction:t=>r(e.value,e.meta),onSetup:k(y),triggersSubmenu:!1,itemBehaviours:_T(e.meta,a)},l,s,a.providers)},MT=(e,t)=>W(e,(e=>{switch(e.type){case"cardcontainer":return xT(e,MT(e.items,t));case"cardimage":return wT(e.src,e.classes,e.alt);case"cardtext":const o=e.name.exists((e=>z(t.cardText.highlightOn,e))),n=o?F.from(t.cardText.matchText).getOr(""):"";return pT(ET(e.text,n),e.classes)}})),AT=(e,t,o,n)=>{const r=e=>({isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>{Zb.set(e,!t),j(op(e.element,"*"),(o=>{e.getSystem().getByDom(o).each((e=>{e.hasConfigured(Zb)&&Zb.set(e,!t)}))}))}}),s={dom:kT(e.label),optComponents:[F.some({dom:{tag:"div",classes:[wC,kC]},components:MT(e.items,n)})]};return cT({data:dT({text:F.none(),...e}),enabled:e.enabled,getApi:r,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:F.from(n.itemBehaviours).getOr([])},s,t,o.providers)},BT=(e,t,o,n,r,s,a,i=!0)=>{const l=e=>({setActive:t=>{Rw.set(e,t)},isActive:()=>Rw.isOn(e),isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t)}),c=OT({presets:o,textContent:t?e.text:F.none(),htmlContent:F.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:F.none(),checkMark:t?F.some(bT(a.icons)):F.none(),caret:F.none(),value:e.value},a,i);return _r(cT({data:dT(e),enabled:e.enabled,getApi:l,onAction:t=>n(e.value),onSetup:e=>(e.setActive(r),y),triggersSubmenu:!1,itemBehaviours:[]},c,s,a),{toggling:{toggleClass:gC,toggleOnExecute:!1,selected:e.active,exclusive:!0}})},FT=ob(Qw(),eS()),IT=e=>({value:e}),RT=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,NT=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,VT=e=>RT.test(e)||NT.test(e),HT=e=>He(e,"#").toUpperCase(),zT=e=>VT(e)?F.some({value:HT(e)}):F.none(),PT=e=>{const t=e.value.replace(RT,((e,t,o,n)=>t+t+o+o+n+n));return{value:t}},LT=e=>{const t=PT(e),o=NT.exec(t.value);return null===o?["FFFFFF","FF","FF","FF"]:o},UT=e=>{const t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},WT=e=>{const t=UT(e.red)+UT(e.green)+UT(e.blue);return IT(t)},jT=Math.min,GT=Math.max,$T=Math.round,qT=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,KT=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,XT=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),YT=e=>{const t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},JT=e=>{let t,o,n;const r=(e.hue||0)%360;let s=e.saturation/100,a=e.value/100;if(s=GT(0,jT(s,1)),a=GT(0,jT(a,1)),0===s)return t=o=n=$T(255*a),XT(t,o,n,1);const i=r/60,l=a*s,c=l*(1-Math.abs(i%2-1)),d=a-l;switch(Math.floor(i)){case 0:t=l,o=c,n=0;break;case 1:t=c,o=l,n=0;break;case 2:t=0,o=l,n=c;break;case 3:t=0,o=c,n=l;break;case 4:t=c,o=0,n=l;break;case 5:t=l,o=0,n=c;break;default:t=o=n=0}return t=$T(255*(t+d)),o=$T(255*(o+d)),n=$T(255*(n+d)),XT(t,o,n,1)},ZT=e=>{const t=LT(e),o=parseInt(t[1],16),n=parseInt(t[2],16),r=parseInt(t[3],16);return XT(o,n,r,1)},QT=(e,t,o,n)=>{const r=parseInt(e,10),s=parseInt(t,10),a=parseInt(o,10),i=parseFloat(n);return XT(r,s,a,i)},eE=e=>{if("transparent"===e)return F.some(XT(0,0,0,0));const t=qT.exec(e);if(null!==t)return F.some(QT(t[1],t[2],t[3],"1"));const o=KT.exec(e);return null!==o?F.some(QT(o[1],o[2],o[3],o[4])):F.none()},tE=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,oE=XT(255,0,0,1),nE=e=>{e.dispatch("SkinLoaded")},rE=(e,t)=>{e.dispatch("SkinLoadError",t)},sE=e=>{e.dispatch("ResizeEditor")},aE=(e,t)=>{e.dispatch("ResizeContent",t)},iE=(e,t)=>{e.dispatch("ScrollContent",t)},lE=(e,t)=>{e.dispatch("TextColorChange",t)},cE=(e,t)=>{e.dispatch("AfterProgressState",{state:t})},dE=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t}),uE=(e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})};var mE=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");const gE={},pE=(e,t=10)=>{const o=mE.getItem(e),n=i(o)?JSON.parse(o):[],r=e=>{const o=t-e.length;return o<0?e.slice(0,t):e},s=r(n),a=o=>{H(s,o).each(l),s.unshift(o),s.length>t&&s.pop(),mE.setItem(e,JSON.stringify(s))},l=e=>{s.splice(e,1)},c=()=>s.slice(0);return{add:a,state:c}},hE=e=>Ce(gE,e).getOrThunk((()=>{const t=`tinymce-custom-colors-${e}`,o=mE.getItem(t);if(p(o)){const e=mE.getItem("tinymce-custom-colors");mE.setItem(t,h(e)?e:"[]")}const n=pE(t,10);return gE[e]=n,n})),fE=e=>W(hE(e).state(),(e=>({type:"choiceitem",text:e,icon:"checkmark",value:e}))),bE=(e,t)=>{hE(e).add(t)},vE=(e,t,o)=>({hue:e,saturation:t,value:o}),yE=e=>{let t=0,o=0,n=0;const r=e.red/255,s=e.green/255,a=e.blue/255,i=Math.min(r,Math.min(s,a)),l=Math.max(r,Math.max(s,a));if(i===l)return n=i,vE(0,0,100*n);const c=r===i?s-a:a===i?r-s:a-r;return t=r===i?3:a===i?1:5,t=60*(t-c/(l-i)),o=(l-i)/l,n=l,vE(Math.round(t),Math.round(100*o),Math.round(100*n))},xE=e=>yE(ZT(e)),wE=e=>WT(JT(e)),SE=e=>zT(e).orThunk((()=>eE(e).map(WT))).getOrThunk((()=>{const t=document.createElement("canvas");t.height=1,t.width=1;const o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),o.fillStyle="#FFFFFF",o.fillStyle=e,o.fillRect(0,0,1,1);const n=o.getImageData(0,0,1,1).data,r=n[0],s=n[1],a=n[2],i=n[3];return WT(XT(r,s,a,i))})),kE="forecolor",CE="hilitecolor",OE=e=>Math.max(5,Math.ceil(Math.sqrt(e))),_E=e=>{const t=[];for(let o=0;o<e.length;o+=2)t.push({text:e[o+1],value:"#"+SE(e[o]).value,icon:"checkmark",type:"choiceitem"});return t},TE=e=>t=>t.options.get(e),EE="#000000",DE=e=>{const t=e.options.register,o=e=>v(e,i)?{value:_E(e),valid:!0}:{valid:!1,message:"Must be an array of strings."};t("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_background",{processor:o}),t("color_map_foreground",{processor:o}),t("color_cols",{processor:"number",default:OE(BE(e,"default").length)}),t("color_cols_foreground",{processor:"number",default:OE(BE(e,kE).length)}),t("color_cols_background",{processor:"number",default:OE(BE(e,CE).length)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:EE}),t("color_default_background",{processor:"string",default:EE})},ME=(e,t)=>t===kE?TE("color_cols_foreground")(e):t===CE?TE("color_cols_background")(e):TE("color_cols")(e),AE=TE("custom_colors"),BE=(e,t)=>t===kE&&e.options.isSet("color_map_foreground")?TE("color_map_foreground")(e):t===CE&&e.options.isSet("color_map_background")?TE("color_map_background")(e):TE("color_map")(e),FE=TE("color_default_foreground"),IE=TE("color_default_background"),RE=(e,t)=>{const o=go(Qe.fromDom(e.selection.getStart()),"hilitecolor"===t?"background-color":"color");return eE(o).map((e=>"#"+WT(e).value))},NE=(e,t,o)=>{e.undoManager.transact((()=>{e.focus(),e.formatter.apply(t,{value:o}),e.nodeChanged()}))},VE=(e,t)=>{e.undoManager.transact((()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()}))},HE=e=>{e.addCommand("mceApplyTextcolor",((t,o)=>{NE(e,t,o)})),e.addCommand("mceRemoveTextcolor",(t=>{VE(e,t)}))},zE=e=>{const t="choiceitem",o={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return e?[o,n]:[o]},PE=(e,t,o,n)=>{if("custom"===o){const o=$E(e);o((o=>{o.each((o=>{bE(t,o),e.execCommand("mceApplyTextcolor",t,o),n(o)}))}),RE(e,t).getOr(EE))}else"remove"===o?(n(""),e.execCommand("mceRemoveTextcolor",t)):(n(o),e.execCommand("mceApplyTextcolor",t,o))},LE=(e,t,o)=>e.concat(fE(t).concat(zE(o))),UE=(e,t,o)=>n=>{n(LE(e,t,o))},WE=(e,t,o)=>{const n="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";e.setIconFill(n,o)},jE=(e,t,o,n,r)=>{e.ui.registry.addSplitButton(t,{tooltip:n,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:t=>{const n=RE(e,o);return Te(n,t.toUpperCase())},columns:ME(e,o),fetch:UE(BE(e,o),o,AE(e)),onAction:t=>{PE(e,o,r.get(),y)},onItemAction:(n,s)=>{PE(e,o,s,(o=>{r.set(o),lE(e,{name:t,color:o})}))},onSetup:o=>{WE(o,t,r.get());const n=e=>{e.name===t&&WE(o,e.name,e.color)};return e.on("TextColorChange",n),()=>{e.off("TextColorChange",n)}}})},GE=(e,t,o,n)=>{e.ui.registry.addNestedMenuItem(t,{text:n,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",initData:{storageKey:o},onAction:t=>{PE(e,o,t.value,y)}}]})},$E=e=>(t,o)=>{let n=!1;const r=o=>{const r=o.getData(),s=r.colorpicker;n?(t(F.from(s)),o.close()):e.windowManager.alert(e.translate(["Invalid hex color code: {0}",s]))},s=(e,t)=>{"hex-valid"===t.name&&(n=t.value)},a={colorpicker:o};e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onAction:s,onSubmit:r,onClose:y,onCancel:()=>{t(F.none())}})},qE=e=>{HE(e);const t=FE(e),o=IE(e),n=ca(t),r=ca(o);jE(e,"forecolor","forecolor","Text color",n),jE(e,"backcolor","hilitecolor","Background color",r),GE(e,"forecolor","forecolor","Text color"),GE(e,"backcolor","hilitecolor","Background color")},KE=(e,t,o,n,r,s,a,i)=>{const l=lO(t),c="color"!==r?"normal":"color",d=XE(t,o,n,c,s,a,i),u={menuType:r};return uO(e,l,d,n,u)},XE=(e,t,o,n,r,s,a)=>De(W(e,(i=>"choiceitem"===i.type?v_(i).fold(cO,(i=>F.some(BT(i,1===o,n,t,s(i.value),r,a,lO(e))))):F.none()))),YE=(e,t)=>{const o=BC(t);if(1===e)return{mode:"menu",moveOnTab:!0};if("auto"===e)return{mode:"grid",selector:"."+o.item,initSize:{numColumns:1,numRows:1}};{const e="color"===t?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+e,previousSelector:e=>"color"===t?nd(e.element,"[aria-checked=true]"):F.none()}}},JE=(e,t)=>1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?`.${uC}`:`.${dC}`}},ZE=(e,t)=>{const o=QE(e,t),n=t.colorinput.getColorCols(e.initData.storageKey),r="color",s=KE(cl("menu-value"),o,(t=>{e.onAction({value:t})}),n,r,lC.CLOSE_ON_EXECUTE,M,t.shared.providers),a={...s,markers:BC(r),movement:YE(n,r)};return{type:"widget",data:{value:cl("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[FT.widget(mS.sketch(a))]}},QE=(e,t)=>{const o=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold((()=>LE(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,o)),(e=>e.concat(zE(o))))},eD=cl("cell-over"),tD=cl("cell-execute"),oD=(e,t,o)=>{const n=o=>Ti(o,eD,{row:e,col:t}),r=o=>Ti(o,tD,{row:e,col:t}),s=(e,t)=>{t.stop(),r(e)};return qc({dom:{tag:"div",attributes:{role:"button",["aria-labelledby"]:o}},behaviours:Fu([iw("insert-table-picker-cell",[Vi(La(),fw.focus),Vi(si(),r),Vi(Ka(),s),Vi(ii(),s)]),Rw.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),fw.config({onFocus:n})])})},nD=(e,t,o)=>{const n=[];for(let r=0;r<t;r++){const t=[];for(let n=0;n<o;n++)t.push(oD(r,n,e));n.push(t)}return n},rD=(e,t,o,n,r)=>{for(let s=0;s<n;s++)for(let n=0;n<r;n++)Rw.set(e[s][n],s<=t&&n<=o)},sD=e=>ee(e,(e=>W(e,Kc))),aD=(e,t)=>Uc(`${t}x${e}`),iD=e=>{const t=10,o=10,n=cl("size-label"),r=nD(n,t,o),s=aD(0,0),a=IS({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[s],behaviours:Fu([sw.config({})])});return{type:"widget",data:{value:cl("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[FT.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:sD(r).concat(a.asSpec()),behaviours:Fu([iw("insert-table-picker",[qi((e=>{sw.set(a.get(e),[s])})),Wi(eD,((e,n,s)=>{const{row:i,col:l}=s.event;rD(r,i,l,t,o),sw.set(a.get(e),[aD(i+1,l+1)])})),Wi(tD,((t,o,n)=>{const{row:r,col:s}=n.event;e.onAction({numRows:r+1,numColumns:s+1}),_i(t,ci())}))]),Gx.config({initSize:{numRows:t,numColumns:o},mode:"flatgrid",selector:'[role="button"]'})])})]}},lD={inserttable:iD,colorswatch:ZE},cD=(e,t)=>Ce(lD,e.fancytype).map((o=>o(e,t))),dD=(e,t,o,n=!0,r=!1)=>{const s=r?yT(o.icons):vT(o.icons),a=e=>({isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t)}),i=OT({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:F.none(),ariaLabel:e.text,caret:F.some(s),checkMark:F.none(),shortcutContent:e.shortcut},o,n);return cT({data:dT(e),getApi:a,enabled:e.enabled,onAction:y,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},i,t,o)},uD=(e,t,o,n=!0)=>{const r=e=>({isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t)}),s=OT({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:F.none(),ariaLabel:e.text,caret:F.none(),checkMark:F.none(),shortcutContent:e.shortcut},o,n);return cT({data:dT(e),getApi:r,enabled:e.enabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},s,t,o)},mD=e=>({type:"separator",dom:{tag:"div",classes:[dC,pC]},components:e.text.map(Uc).toArray()}),gD=(e,t,o,n=!0)=>{const r=e=>({setActive:t=>{Rw.set(e,t)},isActive:()=>Rw.isOn(e),isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t)}),s=OT({iconContent:e.icon,textContent:e.text,htmlContent:F.none(),ariaLabel:e.text,checkMark:F.some(bT(o.icons)),caret:F.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},o,n);return _r(cT({data:dT(e),enabled:e.enabled,getApi:r,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},s,t,o),{toggling:{toggleClass:gC,toggleOnExecute:!1,selected:e.active}})},pD=DT,hD=mD,fD=uD,bD=dD,vD=gD,yD=cD,xD=AT,wD=(e,t,o,n)=>o.getOrCreate(e,t,n),SD=(e,t,o,n)=>o.getExisting(e,t,n);var kD=Object.freeze({__proto__:null,getCoupled:wD,getExistingCoupled:SD}),CD=[Is("others",Ss(ir.value,ds()))];const OD=()=>{const e={},t=(t,o)=>{const n=me(t.others);if(0===n.length)throw new Error("Cannot find any known coupled components");return Ce(e,o)},o=(o,n,r)=>t(n,r).getOrThunk((()=>{const t=Ce(n.others,r).getOrDie("No information found for coupled component: "+r),s=t(o),a=o.getSystem().build(s);return e[r]=a,a})),n=(e,o,n)=>t(o,n).orThunk((()=>(Ce(o.others,n).getOrDie("No information found for coupled component: "+n),F.none()))),r=k({});return Al({readState:r,getExisting:n,getOrCreate:o})};var _D=Object.freeze({__proto__:null,init:OD});const TD=Ru({fields:CD,name:"coupling",apis:kD,state:_D}),ED=e=>{let t=F.none(),o=[];const n=e=>ED((t=>{r((o=>{t(e(o))}))})),r=e=>{a()?l(e):o.push(e)},s=e=>{a()||(t=F.some(e),i(o),o=[])},a=()=>t.isSome(),i=e=>{j(e,l)},l=e=>{t.each((t=>{setTimeout((()=>{e(t)}),0)}))};return e(s),{get:r,map:n,isReady:a}},DD=e=>ED((t=>{t(e)})),MD={nu:ED,pure:DD},AD=e=>{setTimeout((()=>{throw e}),0)},BD=e=>{const t=t=>{e().then(t,AD)},o=t=>BD((()=>e().then(t))),n=t=>BD((()=>e().then((e=>t(e).toPromise())))),r=t=>BD((()=>e().then((()=>t.toPromise())))),s=()=>MD.nu(t),a=()=>{let t=null;return BD((()=>(null===t&&(t=e()),t)))},i=e;return{map:o,bind:n,anonBind:r,toLazy:s,toCached:a,toPromise:i,get:t}},FD=e=>BD((()=>new Promise(e))),ID=e=>BD((()=>Promise.resolve(e))),RD={nu:FD,pure:ID},ND=k("sink"),VD=k(Yf({name:ND(),overrides:k({dom:{tag:"div"},behaviours:Fu([Kp.config({useFixed:A})]),events:Fi([ji(ja()),ji(Va()),ji(Ka())])})})),HD=(e,t)=>{const o=e.getHotspot(t).getOr(t),n="hotspot",r=e.getAnchorOverrides();return e.layouts.fold((()=>({type:n,hotspot:o,overrides:r})),(e=>({type:n,hotspot:o,overrides:r,layouts:e})))},zD=(e,t,o)=>{const n=e.fetch;return n(o).map(t)},PD=(e,t,o,n,r,s,a)=>{const i=zD(e,t,n),l=GD(n,e);return i.map((e=>e.bind((e=>F.from(TS.sketch({...s.menu(),uid:bl(""),data:e,highlightOnOpen:a,onOpenMenu:(e,t)=>{const n=l().getOrDie();Kp.position(n,t,{anchor:o}),Bh.decloak(r)},onOpenSubmenu:(e,t,o)=>{const n=l().getOrDie();Kp.position(n,o,{anchor:{type:"submenu",item:t}}),Bh.decloak(r)},onRepositionMenu:(e,t,n)=>{const r=l().getOrDie();Kp.position(r,t,{anchor:o}),j(n,(e=>{Kp.position(r,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})}))},onEscape:()=>(fw.focus(n),Bh.close(r),F.some(!0))}))))))},LD=(e,t,o,n,r,s,a)=>{const i=HD(e,o),l=PD(e,t,i,o,n,r,a);return l.map((e=>(e.fold((()=>{Bh.isOpen(n)&&Bh.close(n)}),(e=>{Bh.cloak(n),Bh.open(n,e),s(n)})),n)))},UD=(e,t,o,n,r,s,a)=>(Bh.close(n),RD.pure(n)),WD=(e,t,o,n,r,s)=>{const a=TD.getCoupled(o,"sandbox"),i=Bh.isOpen(a),l=i?UD:LD;return l(e,t,o,a,n,r,s)},jD=(e,t,o)=>{const n=Fb.getCurrent(t).getOr(t),r=Fo(e.element);o?co(n.element,"min-width",r+"px"):Bo(n.element,r)},GD=(e,t)=>e.getSystem().getByUid(t.uid+"-"+ND()).map((e=>()=>ir.value(e))).getOrThunk((()=>t.lazySink.fold((()=>()=>ir.error(new Error("No internal sink is specified, nor could an external sink be found"))),(t=>()=>t(e))))),$D=e=>{Bh.getState(e).each((e=>{TS.repositionMenus(e)}))},qD=(e,t,o)=>{const n=id(),r=(r,s)=>{const a=HD(e,t);n.link(t.element),e.matchWidth&&jD(a.hotspot,s,e.useMinWidth),e.onOpen(a,r,s),void 0!==o&&void 0!==o.onOpen&&o.onOpen(r,s)},s=(e,r)=>{n.unlink(t.element),void 0!==o&&void 0!==o.onClose&&o.onClose(e,r)},a=GD(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:n.id,role:"listbox"}},behaviours:yf.augment(e.sandboxBehaviours,[hf.config({store:{mode:"memory",initialValue:t}}),Bh.config({onOpen:r,onClose:s,isPartOf:(e,o,n)=>cd(o,n)||cd(t,n),getAttachPoint:()=>a().getOrDie()}),Fb.config({find:e=>Bh.getState(e).bind((e=>Fb.getCurrent(e)))}),zu.config({channels:{...Vh({isExtraPart:M}),...zh({doReposition:$D})}})])}},KD=e=>{const t=TD.getCoupled(e,"sandbox");$D(t)},XD=()=>[Qs("sandboxClasses",[]),yf.field("sandboxBehaviours",[Fb,zu,Bh,hf])],YD=k([Fs("dom"),Fs("fetch"),Ed("onOpen"),Dd("onExecute"),Qs("getHotspot",F.some),Qs("getAnchorOverrides",k({})),ng(),ff("dropdownBehaviours",[Rw,TD,Gx,fw]),Fs("toggleClass"),Qs("eventOrder",{}),js("lazySink"),Qs("matchWidth",!1),Qs("useMinWidth",!1),js("role")].concat(XD())),JD=k([Xf({schema:[Od(),Qs("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),VD()]),ZD=(e,t,o,n)=>{const r=t=>Ce(e.dom,"attributes").bind((e=>Ce(e,t))),s=e=>{Bh.getState(e).each((e=>{TS.highlightPrimary(e)}))},a=(t,o,r)=>WD(e,C,t,n,o,r),i=e=>{const t=s;a(e,t,wS.HighlightMenuAndItem).get(y)},l={expand:e=>{Rw.isOn(e)||a(e,y,wS.HighlightNone).get(y)},open:e=>{Rw.isOn(e)||a(e,y,wS.HighlightMenuAndItem).get(y)},refetch:t=>{const o=TD.getExistingCoupled(t,"sandbox");return o.fold((()=>a(t,y,wS.HighlightMenuAndItem).map(y)),(o=>LD(e,C,t,o,n,y,wS.HighlightMenuAndItem).map(y)))},isOpen:Rw.isOn,close:e=>{Rw.isOn(e)&&a(e,y,wS.HighlightMenuAndItem).get(y)},repositionMenus:e=>{Rw.isOn(e)&&KD(e)}},c=(e,t)=>(Ei(e),F.some(!0));return{uid:e.uid,dom:e.dom,components:t,behaviours:vf(e.dropdownBehaviours,[Rw.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),TD.config({others:{sandbox:t=>qD(e,t,{onOpen:()=>Rw.on(t),onClose:()=>Rw.off(t)})}}),Gx.config({mode:"special",onSpace:c,onEnter:c,onDown:(e,t)=>{if(QD.isOpen(e)){const t=TD.getCoupled(e,"sandbox");s(t)}else QD.open(e);return F.some(!0)},onEscape:(e,t)=>QD.isOpen(e)?(QD.close(e),F.some(!0)):F.none()}),fw.config({})]),events:Vw(F.some(i)),eventOrder:{...e.eventOrder,[si()]:["disabling","toggling","alloy.base.behaviour"]},apis:l,domModification:{attributes:{"aria-haspopup":"true",...e.role.fold((()=>({})),(e=>({role:e}))),..."button"===e.dom.tag?{type:r("type").getOr("button")}:{}}}}},QD=Eb({name:"Dropdown",configFields:YD(),partFields:JD(),factory:ZD,apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),eM=e=>{switch(e.searchMode){case"no-search":return{menuType:"normal"};default:return{menuType:"searchable",searchMode:e}}},tM=e=>{const t=hf.getValue(e),o=GC(e).map(KC);QD.refetch(t).get((()=>{const e=TD.getCoupled(t,"sandbox");o.each((t=>GC(e).each((e=>qC(e,t)))))}))},oM=(e,t)=>{nM(e).each((o=>{Ai(e,o.element,t.event.eventType,t.event.interactionEvent)}))},nM=e=>Bh.getState(e).bind(vv.getHighlighted).bind(vv.getHighlighted),rM=e=>pc(e.element,JC)?F.some(e.element):nd(e.element,"."+JC),sM=(e,t,o)=>{$C(e).each((e=>{XC(e,o);const n=rM(t);n.each((t=>{no(t,"id").each((t=>eo(e.element,"aria-controls",t)))}))})),eo(o.element,"aria-selected","true")},aM=(e,t,o)=>{eo(o.element,"aria-selected","false")},iM=e=>{$C(e).each((e=>fw.focus(e)))},lM=e=>{const t=TD.getExistingCoupled(e,"sandbox");return t.bind(GC).map(KC).map((e=>e.fetchPattern)).getOr("")};var cM;(function(e){e[e["ContentFocus"]=0]="ContentFocus",e[e["UiFocus"]=1]="UiFocus"})(cM||(cM={}));const dM=(e,t,o,n,r)=>{const s=o.shared.providers,a=e=>r?{...e,shortcut:F.none(),icon:e.text.isSome()?F.none():e.icon}:e;switch(e.type){case"menuitem":return O_(e).fold(cO,(e=>F.some(fD(a(e),t,s,n))));case"nestedmenuitem":return T_(e).fold(cO,(e=>F.some(bD(a(e),t,s,n,r))));case"togglemenuitem":return D_(e).fold(cO,(e=>F.some(vD(a(e),t,s,n))));case"separator":return UO(e).fold(cO,(e=>F.some(hD(e))));case"fancymenuitem":return k_(e).fold(cO,(e=>yD(e,o)));default:return console.error("Unknown item in general menu",e),F.none()}},uM=(e,t,o,n,r,s,a)=>{const i=1===n,l=!i||lO(e);return De(W(e,(e=>{switch(e.type){case"separator":return jO(e).fold(cO,(e=>F.some(hD(e))));case"cardmenuitem":return f_(e).fold(cO,(e=>F.some(xD({...e,onAction:t=>{e.onAction(t),o(e.value,e.meta)}},r,s,{itemBehaviours:_T(e.meta,s),cardText:{matchText:t,highlightOn:a}}))));case"autocompleteitem":default:return GO(e).fold(cO,(e=>F.some(pD(e,t,i,"normal",o,r,s,l))))}})))},mM=(e,t,o,n,r,s)=>{const a=lO(t),i=De(W(t,(e=>{const t=e=>r?!Oe(e,"text"):a,s=e=>dM(e,o,n,t(e),r);return"nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?s({...e,enabled:!1}):s(e)}))),l=eM(s),c=r?dO:uO;return c(e,a,i,1,l)},gM=e=>TS.singleData(e.value,e),pM=(e,t,o,n)=>{const r=YE(t,n),s=BC(n);return{data:gM({...e,movement:r,menuBehaviours:F_.unnamedEvents("auto"!==t?[]:[qi(((e,t)=>{M_(e,4,s.item).each((({numColumns:t,numRows:o})=>{Gx.setGridSize(e,o,t)}))}))])}),menu:{markers:BC(n),fakeFocus:o===cM.ContentFocus}}},hM=(e,t)=>nC(Qe.fromDom(t.startContainer)).map((t=>{const o=e.createRng();return o.selectNode(t.dom),o})),fM=(e,t)=>{const o=ca(!1),n=ca(!1),r=qc(MS.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Fu([iw("dismissAutocompleter",[Vi(vi(),(()=>c()))])]),lazySink:t.getSink})),s=()=>MS.isOpen(r),a=n.get,i=()=>{s()&&MS.hide(r)},l=()=>MS.getContent(r).bind((e=>ie(e.components(),0))),c=()=>e.execCommand("mceAutocompleterClose"),d=n=>{const r=ue(n,(e=>F.from(e.columns))).getOr(1);return ee(n,(n=>{const s=n.items;return uM(s,n.matchText,((t,r)=>{const s=e.selection.getRng();hM(e.dom,s).each((s=>{const a={hide:()=>c(),reload:t=>{i(),e.execCommand("mceAutocompleterReload",!1,{fetchOptions:t})}};o.set(!0),n.onAction(a,s,t,r),o.set(!1)}))}),r,lC.BUBBLE_TO_SANDBOX,t,n.highlightOn)}))},u=(t,o)=>{rC(Qe.fromDom(e.getBody())).each((n=>{const s=ue(t,(e=>F.from(e.columns))).getOr(1);MS.showMenuAt(r,{anchor:{type:"node",root:Qe.fromDom(e.getBody()),node:F.from(n)}},pM(uO("autocompleter-value",!0,o,s,{menuType:"normal"}),s,cM.ContentFocus,"normal"))})),l().each(vv.highlightFirst)},m=e=>{const t=d(e);t.length>0?u(e,t):i()};e.on("AutocompleterStart",(({lookupData:e})=>{n.set(!0),o.set(!1),m(e)})),e.on("AutocompleterUpdate",(({lookupData:e})=>m(e))),e.on("AutocompleterEnd",(()=>{i(),n.set(!1),o.set(!1)}));const g={cancelIfNecessary:c,isMenuOpen:s,isActive:a,isProcessingAction:o.get,getMenu:l};aC.setup(g,e)},bM={register:fM},vM=(e,t,o)=>rd(e,t,o).isSome(),yM=(e,t)=>{let o=null;const n=(...n)=>{o=setTimeout((()=>{e.apply(null,n),o=null}),t)},r=()=>{null!==o&&(clearTimeout(o),o=null)};return{cancel:r,schedule:n}},xM=5,wM=400,SM=e=>{const t=e.raw;return void 0===t.touches||1!==t.touches.length?F.none():F.some(t.touches[0])},kM=(e,t)=>{const o=Math.abs(e.clientX-t.x),n=Math.abs(e.clientY-t.y);return o>xM||n>xM},CM=e=>{const t=wm(),o=ca(!1),n=yM((t=>{e.triggerEvent(li(),t),o.set(!0)}),wM),r=e=>(SM(e).each((r=>{n.cancel();const s={x:r.clientX,y:r.clientY,target:e.target};n.schedule(e),o.set(!1),t.set(s)})),F.none()),s=e=>(n.cancel(),SM(e).each((e=>{t.on((o=>{kM(e,o)&&t.clear()}))})),F.none()),a=r=>{n.cancel();const s=e=>Ot(e.target,r.target);return t.get().filter(s).map((t=>o.get()?(r.prevent(),!1):e.triggerEvent(ii(),r)))},i=va([{key:Fa(),value:r},{key:Ia(),value:s},{key:Ra(),value:a}]),l=(e,t)=>Ce(i,t).bind((t=>t(e)));return{fireIfReady:l}},OM=e=>{const t=e.raw;return t.which===yv[0]&&!z(["input","textarea"],mt(e.target))&&!vM(e.target,'[contenteditable="true"]')},_M=(e,t)=>{const o={stopBackspace:!0,...t},n=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],r=CM(o),s=W(n.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(t=>km(e,t,(e=>{r.fireIfReady(e,t).each((t=>{t&&e.kill()}));const n=o.triggerEvent(t,e);n&&e.kill()})))),a=wm(),i=km(e,"paste",(e=>{r.fireIfReady(e,"paste").each((t=>{t&&e.kill()}));const t=o.triggerEvent("paste",e);t&&e.kill(),a.set(setTimeout((()=>{o.triggerEvent(ni(),e)}),0))})),l=km(e,"keydown",(e=>{const t=o.triggerEvent("keydown",e);t?e.kill():o.stopBackspace&&OM(e)&&e.prevent()})),c=km(e,"focusin",(e=>{const t=o.triggerEvent("focusin",e);t&&e.kill()})),d=wm(),u=km(e,"focusout",(e=>{const t=o.triggerEvent("focusout",e);t&&e.kill(),d.set(setTimeout((()=>{o.triggerEvent(oi(),e)}),0))})),m=()=>{j(s,(e=>{e.unbind()})),l.unbind(),c.unbind(),u.unbind(),i.unbind(),a.on(clearTimeout),d.on(clearTimeout)};return{unbind:m}},TM=(e,t)=>{const o=Ce(e,"target").getOr(t);return ca(o)},EM=(e,t)=>{const o=ca(!1),n=ca(!1),r=()=>{o.set(!0)},s=()=>{n.set(!0)};return{stop:r,cut:s,isStopped:o.get,isCut:n.get,event:e,setSource:t.set,getSource:t.get}},DM=e=>{const t=ca(!1),o=()=>{t.set(!0)};return{stop:o,cut:y,isStopped:t.get,isCut:M,event:e,setSource:E("Cannot set source of a broadcasted event"),getSource:E("Cannot get source of a broadcasted event")}},MM=ua.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),AM=(e,t,o,n,r,s)=>{const a=e(t,n),i=EM(o,r);return a.fold((()=>(s.logEventNoHandlers(t,n),MM.complete())),(e=>{const o=e.descHandler,n=Wl(o);return n(i),i.isStopped()?(s.logEventStopped(t,e.element,o.purpose),MM.stopped()):i.isCut()?(s.logEventCut(t,e.element,o.purpose),MM.complete()):At(e.element).fold((()=>(s.logNoParent(t,e.element,o.purpose),MM.complete())),(n=>(s.logEventResponse(t,e.element,o.purpose),MM.resume(n))))}))},BM=(e,t,o,n,r,s)=>AM(e,t,o,n,r,s).fold(A,(n=>BM(e,t,o,n,r,s)),M),FM=(e,t,o,n,r)=>{const s=TM(o,n);return AM(e,t,o,n,s,r)},IM=(e,t,o)=>{const n=DM(t);return j(e,(e=>{const t=e.descHandler,o=Wl(t);o(n)})),n.isStopped()},RM=(e,t,o,n)=>NM(e,t,o,o.target,n),NM=(e,t,o,n,r)=>{const s=TM(o,n);return BM(e,t,o,n,s,r)},VM=(e,t)=>({element:e,descHandler:t}),HM=(e,t)=>({id:e,descHandler:t}),zM=()=>{const e={},t=(t,o,n)=>{pe(n,((n,r)=>{const s=void 0!==e[r]?e[r]:{};s[o]=Ul(n,t),e[r]=s}))},o=(e,t)=>fl(t).bind((t=>Ce(e,t))).map((e=>VM(t,e))),n=t=>Ce(e,t).map((e=>we(e,((e,t)=>HM(t,e))))).getOr([]),r=(t,n,r)=>Ce(e,n).bind((e=>Ca(r,(t=>o(e,t)),t))),s=t=>{pe(e,((e,o)=>{Oe(e,t)&&delete e[t]}))};return{registerId:t,unregisterId:s,filterByType:n,find:r}},PM=()=>{const e=zM(),t={},o=e=>{const t=e.element;return fl(t).getOrThunk((()=>pl("uid-",e.element)))},n=(e,o)=>{const n=t[o];if(n!==e)throw new Error('The tagId "'+o+'" is already used by: '+rl(n.element)+"\nCannot use it for: "+rl(e.element)+"\nThe conflicting element is"+(Yt(n.element)?" ":" not ")+"already in the DOM");s(e)},r=r=>{const s=o(r);_e(t,s)&&n(r,s);const a=[r];e.registerId(a,s,r.events),t[s]=r},s=o=>{fl(o.element).each((o=>{delete t[o],e.unregisterId(o)}))},a=t=>e.filterByType(t),i=(t,o,n)=>e.find(t,o,n),l=e=>Ce(t,e);return{find:i,filter:a,register:r,unregister:s,getById:l}},LM=e=>{const{attributes:t,...o}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...o},components:e.components,behaviours:bf(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},UM=Tb({name:"Container",factory:LM,configFields:[Qs("components",[]),ff("containerBehaviours",[]),Qs("events",{}),Qs("domModification",{}),Qs("eventOrder",{})]}),WM=e=>{const t=t=>At(e.element).fold(A,(e=>Ot(t,e))),o=PM(),n=(e,n)=>o.find(t,e,n),r=_M(e.element,{triggerEvent:(e,t)=>vd(e,t.target,(o=>RM(n,e,t,o)))}),s={debugInfo:k("real"),triggerEvent:(e,t,o)=>{vd(e,t,(r=>NM(n,e,o,t,r)))},triggerFocus:(e,t)=>{fl(e).fold((()=>{Uu(e)}),(o=>{vd(ti(),e,(o=>(FM(n,ti(),{originator:t,kill:y,prevent:y,target:e},e,o),!1)))}))},triggerEscape:(e,t)=>{s.triggerEvent("keydown",e.element,t.event)},getByUid:e=>h(e),getByDom:e=>f(e),build:qc,buildOrPatch:$c,addToGui:e=>{l(e)},removeFromGui:e=>{c(e)},addToWorld:e=>{a(e)},removeFromWorld:e=>{i(e)},broadcast:e=>{m(e)},broadcastOn:(e,t)=>{g(e,t)},broadcastEvent:(e,t)=>{p(e,t)},isConnected:A},a=e=>{e.connect(s),bt(e.element)||(o.register(e),j(e.components(),a),s.triggerEvent(ui(),e.element,{target:e.element}))},i=e=>{bt(e.element)||(j(e.components(),i),o.unregister(e)),e.disconnect()},l=t=>{rh(e,t)},c=e=>{ih(e)},d=()=>{r.unbind(),zn(e.element)},u=e=>{const t=o.filter(ri());j(t,(t=>{const o=t.descHandler,n=Wl(o);n(e)}))},m=e=>{u({universal:!0,data:e})},g=(e,t)=>{u({universal:!1,channels:e,data:t})},p=(e,t)=>{const n=o.filter(e);return IM(n,t)},h=e=>o.getById(e).fold((()=>ir.error(new Error('Could not find component with uid: "'+e+'" in system.'))),ir.value),f=e=>{const t=fl(e).getOr("not found");return h(t)};return a(e),{root:e,element:e.element,destroy:d,add:l,remove:c,getByUid:h,getByDom:f,addToWorld:a,removeFromWorld:i,broadcast:m,broadcastOn:g,broadcastEvent:p}},jM=(e,t)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(e.items,t.interpreter)}),GM=k([Qs("prefix","form-field"),ff("fieldBehaviours",[Fb,hf])]),$M=k([Yf({schema:[Fs("dom")],name:"label"}),Yf({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[Fs("text")],name:"aria-descriptor"}),Kf({factory:{sketch:e=>{const t=fa(e,["factory"]);return e.factory.sketch(t)}},schema:[Fs("factory")],name:"field"})]),qM=(e,t,o,n)=>{const r=vf(e.fieldBehaviours,[Fb.config({find:t=>cb(t,e,"field")}),hf.config({store:{mode:"manual",getValue:e=>Fb.getCurrent(e).bind(hf.getValue),setValue:(e,t)=>{Fb.getCurrent(e).each((e=>{hf.setValue(e,t)}))}}})]),s=Fi([qi(((t,o)=>{const n=ub(t,e,["label","field","aria-descriptor"]);n.field().each((t=>{const o=cl(e.prefix);n.label().each((e=>{eo(e.element,"for",o),eo(t.element,"id",o)})),n["aria-descriptor"]().each((o=>{const n=cl(e.prefix);eo(o.element,"id",n),eo(t.element,"aria-describedby",n)}))}))}))]),a={getField:t=>cb(t,e,"field"),getLabel:t=>cb(t,e,"label")};return{uid:e.uid,dom:e.dom,components:t,behaviours:r,events:s,apis:a}},KM=Eb({name:"FormField",configFields:GM(),partFields:$M(),factory:qM,apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}}),XM=(e,t)=>Nl({attributes:va([{key:t.tabAttr,value:"true"}])});var YM=Object.freeze({__proto__:null,exhibit:XM}),JM=[Qs("tabAttr","data-alloy-tabstop")];const ZM=Ru({fields:JM,name:"tabstopping",active:YM});var QM=tinymce.util.Tools.resolve("tinymce.html.Entities");const eA=(e,t,o,n)=>{const r=oA(e,t,o,n);return KM.sketch(r)},tA=(e,t)=>eA(e,t,[],[]),oA=(e,t,o,n)=>({dom:rA(o),components:e.toArray().concat([t]),fieldBehaviours:Fu(n)}),nA=()=>rA([]),rA=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),sA=(e,t)=>KM.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[Uc(t.translate(e))]}),aA=cl("form-component-change"),iA=cl("form-close"),lA=cl("form-cancel"),cA=cl("form-action"),dA=cl("form-submit"),uA=cl("form-block"),mA=cl("form-unblock"),gA=cl("form-tabchange"),pA=cl("form-resize"),hA=(e,t,o)=>{const n=e.label.map((e=>sA(e,t))),r=e=>(t,o)=>{rd(o.event.target,"[data-collection-item-value]").each((n=>{e(t,o,n,oo(n,"data-collection-item-value"))}))},s=(o,n)=>{const r=W(n,(o=>{const n=RS.translate(o.text),r=1===e.columns?`<div class="tox-collection__item-label">${n}</div>`:"",s=`<div class="tox-collection__item-icon">${o.icon}</div>`,a={_:" "," - ":" ","-":" "},i=n.replace(/\_| \- |\-/g,(e=>a[e])),l=t.isDisabled()?" tox-collection__item--state-disabled":"";return`<div class="tox-collection__item${l}" tabindex="-1" data-collection-item-value="${QM.encodeAllRaw(o.value)}" title="${i}" aria-label="${i}">${s}${r}</div>`})),s="auto"!==e.columns&&e.columns>1?U(r,e.columns):[r],a=W(s,(e=>`<div class="tox-collection__group">${e.join("")}</div>`));Qi(o.element,a.join(""))},a=r(((o,n,r,s)=>{n.stop(),t.isDisabled()||Ti(o,cA,{name:e.name,value:s})})),i=[Vi(La(),r(((e,t,o)=>{Uu(o)}))),Vi(Ka(),a),Vi(ii(),a),Vi(Ua(),r(((e,t,o)=>{nd(e.element,"."+xC).each((e=>{gc(e,xC)})),uc(o,xC)}))),Vi(Wa(),r((e=>{nd(e.element,"."+xC).each((e=>{gc(e,xC)}))}))),Yi(r(((t,o,n,r)=>{Ti(t,cA,{name:e.name,value:r})})))],l=(e,t)=>W(op(e.element,".tox-collection__item"),t),c=KM.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:C},behaviours:Fu([Zb.config({disabled:t.isDisabled,onDisabled:e=>{l(e,(e=>{uc(e,"tox-collection__item--state-disabled"),eo(e,"aria-disabled",!0)}))},onEnabled:e=>{l(e,(e=>{gc(e,"tox-collection__item--state-disabled"),so(e,"aria-disabled")}))}}),J_(),sw.config({}),hf.config({store:{mode:"memory",initialValue:o.getOr([])},onSetValue:(t,o)=>{s(t,o),"auto"===e.columns&&M_(t,5,"tox-collection__item").each((({numRows:e,numColumns:o})=>{Gx.setGridSize(t,e,o)})),_i(t,pA)}}),ZM.config({}),Gx.config(JE(e.columns,"normal")),iw("collection-events",i)]),eventOrder:{[si()]:["disabling","alloy.base.behaviour","collection-events"]}}),d=["tox-form__group--collection"];return eA(n,c,d,[])},fA=["input","textarea"],bA=e=>{const t=mt(e);return z(fA,t)},vA=(e,t)=>{const o=t.getRoot(e).getOr(e.element);gc(o,t.invalidClass),t.notify.each((t=>{bA(e.element)&&eo(e.element,"aria-invalid",!1),t.getContainer(e).each((e=>{Qi(e,t.validHtml)})),t.onValid(e)}))},yA=(e,t,o,n)=>{const r=t.getRoot(e).getOr(e.element);uc(r,t.invalidClass),t.notify.each((t=>{bA(e.element)&&eo(e.element,"aria-invalid",!0),t.getContainer(e).each((e=>{Qi(e,n)})),t.onInvalid(e,n)}))},xA=(e,t,o)=>t.validator.fold((()=>RD.pure(ir.value(!0))),(t=>t.validate(e))),wA=(e,t,o)=>(t.notify.each((t=>{t.onValidate(e)})),xA(e,t).map((n=>e.getSystem().isConnected()?n.fold((n=>(yA(e,t,o,n),ir.error(n))),(o=>(vA(e,t),ir.value(o)))):ir.error("No longer in system")))),SA=(e,t)=>{const o=t.getRoot(e).getOr(e.element);return pc(o,t.invalidClass)};var kA=Object.freeze({__proto__:null,markValid:vA,markInvalid:yA,query:xA,run:wA,isInvalid:SA});const CA=(e,t)=>e.validator.map((o=>Fi([Vi(o.onEvent,(o=>{wA(o,e,t).get(C)}))].concat(o.validateOnLoad?[qi((o=>{wA(o,e,t).get(y)}))]:[])))).getOr({});var OA=Object.freeze({__proto__:null,events:CA}),_A=[Fs("invalidClass"),Qs("getRoot",F.none),Js("notify",[Qs("aria","alert"),Qs("getContainer",F.none),Qs("validHtml",""),Ed("onValid"),Ed("onInvalid"),Ed("onValidate")]),Js("validator",[Fs("validate"),Qs("onEvent","input"),Qs("validateOnLoad",!0)])];const TA=Ru({fields:_A,name:"invalidating",active:OA,apis:kA,extra:{validation:e=>t=>{const o=hf.getValue(t);return RD.pure(e(o))}}}),EA=()=>Nl({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}}),DA=()=>Fi([Ii(Za(),A)]);var MA=Object.freeze({__proto__:null,events:DA,exhibit:EA});const AA=Ru({fields:[],name:"unselecting",active:MA}),BA=(e,t)=>QD.sketch({dom:e.dom,components:e.components,toggleClass:"mce-active",dropdownBehaviours:Fu([oT.button(t.providers.isDisabled),J_(),AA.config({}),ZM.config({})]),layouts:e.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:o=>RD.nu((t=>e.fetch(t))).map((n=>F.from(gM(_r(KE(cl("menu-value"),n,(t=>{e.onItemAction(o,t)}),e.columns,e.presets,lC.CLOSE_ON_EXECUTE,M,t.providers),{movement:YE(e.columns,e.presets)}))))),parts:{menu:RC(!1,1,e.presets)}}),FA=cl("color-input-change"),IA=cl("color-swatch-change"),RA=cl("color-picker-cancel"),NA=(e,t,o,n)=>{const r=KM.parts.field({factory:LC,inputClasses:["tox-textfield"],data:n,onSetValue:e=>TA.run(e).get(y),inputBehaviours:Fu([Zb.config({disabled:t.providers.isDisabled}),J_(),ZM.config({}),TA.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>Bt(e.element),notify:{onValid:e=>{const t=hf.getValue(e);Ti(e,FA,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{const t=hf.getValue(e);if(0===t.length)return RD.pure(ir.value(!0));{const e=Qe.fromTag("span");co(e,"background-color",t);const o=ho(e,"background-color").fold((()=>ir.error("blah")),(e=>ir.value(t)));return RD.pure(o)}}}})]),selectOnFocus:!1}),s=e.label.map((e=>sA(e,t.providers))),a=(e,t)=>{Ti(e,IA,{value:t})},i=(t,n)=>{l.getOpt(t).each((t=>{"custom"===n?o.colorPicker((o=>{o.fold((()=>_i(t,RA)),(o=>{a(t,o),bE(e.storageKey,o)}))}),"#ffffff"):a(t,"remove"===n?"":n)}))},l=IS(BA({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:()=>[cu,lu,gu],onLtr:()=>[lu,cu,gu]},components:[],fetch:UE(o.getColors(e.storageKey),e.storageKey,o.hasCustomColors()),columns:o.getColorCols(e.storageKey),presets:"color",onItemAction:i},t));return KM.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:s.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,l.asSpec()]}]),fieldBehaviours:Fu([iw("form-field-events",[Vi(FA,((t,o)=>{l.getOpt(t).each((e=>{co(e.element,"background-color",o.event.color)})),Ti(t,aA,{name:e.name})})),Vi(IA,((e,t)=>{KM.getField(e).each((o=>{hf.setValue(o,t.event.value),Fb.getCurrent(e).each(fw.focus)}))})),Vi(RA,((e,t)=>{KM.getField(e).each((t=>{Fb.getCurrent(e).each(fw.focus)}))}))])])})},VA=Yf({schema:[Fs("dom")],name:"label"}),HA=e=>Yf({name:e+"-edge",overrides:t=>{const o=t.model.manager.edgeActions[e];return o.fold((()=>({})),(e=>({events:Fi([Hi(Fa(),((t,o,n)=>e(t,n)),[t]),Hi(Va(),((t,o,n)=>e(t,n)),[t]),Hi(Ha(),((t,o,n)=>{n.mouseIsDown.get()&&e(t,n)}),[t])])})))}}),zA=HA("top-left"),PA=HA("top"),LA=HA("top-right"),UA=HA("right"),WA=HA("bottom-right"),jA=HA("bottom"),GA=HA("bottom-left"),$A=HA("left"),qA=Kf({name:"thumb",defaults:k({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:Fi([Ui(Fa(),e,"spectrum"),Ui(Ia(),e,"spectrum"),Ui(Ra(),e,"spectrum"),Ui(Va(),e,"spectrum"),Ui(Ha(),e,"spectrum"),Ui(Pa(),e,"spectrum")])})}),KA=Kf({schema:[As("mouseIsDown",(()=>ca(!1)))],name:"spectrum",overrides:e=>{const t=e.model,o=t.manager,n=(t,n)=>o.getValueFromEvent(n).map((n=>o.setValueFrom(t,e,n)));return{behaviours:Fu([Gx.config({mode:"special",onLeft:t=>o.onLeft(t,e),onRight:t=>o.onRight(t,e),onUp:t=>o.onUp(t,e),onDown:t=>o.onDown(t,e)}),fw.config({})]),events:Fi([Vi(Fa(),n),Vi(Ia(),n),Vi(Va(),n),Vi(Ha(),((t,o)=>{e.mouseIsDown.get()&&n(t,o)}))])}}});var XA=[VA,$A,UA,PA,jA,zA,LA,GA,WA,qA,KA];const YA="slider.change.value",JA=k(YA),ZA=e=>-1!==e.type.indexOf("touch"),QA=e=>{const t=e.event.raw;if(ZA(t)){const e=t;return void 0!==e.touches&&1===e.touches.length?F.some(e.touches[0]).map((e=>_o(e.clientX,e.clientY))):F.none()}{const e=t;return void 0!==e.clientX?F.some(e).map((e=>_o(e.clientX,e.clientY))):F.none()}},eB="top",tB="right",oB="bottom",nB="left",rB=e=>e.model.minX,sB=e=>e.model.minY,aB=e=>e.model.minX-1,iB=e=>e.model.minY-1,lB=e=>e.model.maxX,cB=e=>e.model.maxY,dB=e=>e.model.maxX+1,uB=e=>e.model.maxY+1,mB=(e,t,o)=>t(e)-o(e),gB=e=>mB(e,lB,rB),pB=e=>mB(e,cB,sB),hB=e=>gB(e)/2,fB=e=>pB(e)/2,bB=e=>e.stepSize,vB=e=>e.snapToGrid,yB=e=>e.snapStart,xB=e=>e.rounded,wB=(e,t)=>void 0!==e[t+"-edge"],SB=e=>wB(e,nB),kB=e=>wB(e,tB),CB=e=>wB(e,eB),OB=e=>wB(e,oB),_B=e=>e.model.value.get(),TB=(e,t)=>({x:e,y:t}),EB=(e,t)=>{Ti(e,JA(),{value:t})},DB=(e,t)=>{EB(e,TB(aB(t),iB(t)))},MB=(e,t)=>{EB(e,iB(t))},AB=(e,t)=>{EB(e,TB(hB(t),iB(t)))},BB=(e,t)=>{EB(e,TB(dB(t),iB(t)))},FB=(e,t)=>{EB(e,dB(t))},IB=(e,t)=>{EB(e,TB(dB(t),fB(t)))},RB=(e,t)=>{EB(e,TB(dB(t),uB(t)))},NB=(e,t)=>{EB(e,uB(t))},VB=(e,t)=>{EB(e,TB(hB(t),uB(t)))},HB=(e,t)=>{EB(e,TB(aB(t),uB(t)))},zB=(e,t)=>{EB(e,aB(t))},PB=(e,t)=>{EB(e,TB(aB(t),fB(t)))},LB=(e,t,o,n)=>e<t?e:e>o?o:e===t?t-1:Math.max(t,e-n),UB=(e,t,o,n)=>e>o?e:e<t?t:e===o?o+1:Math.min(o,e+n),WB=(e,t,o)=>Math.max(t,Math.min(o,e)),jB=(e,t,o,n,r)=>r.fold((()=>{const r=e-t,s=Math.round(r/n)*n;return WB(t+s,t-1,o+1)}),(t=>{const r=(e-t)%n,s=Math.round(r/n),a=Math.floor((e-t)/n),i=Math.floor((o-t)/n),l=Math.min(i,a+s),c=t+l*n;return Math.max(t,c)})),GB=(e,t,o)=>Math.min(o,Math.max(e,t))-t,$B=e=>{const{min:t,max:o,range:n,value:r,step:s,snap:a,snapStart:i,rounded:l,hasMinEdge:c,hasMaxEdge:d,minBound:u,maxBound:m,screenRange:g}=e,p=c?t-1:t,h=d?o+1:o;if(r<u)return p;if(r>m)return h;{const e=GB(r,u,m),c=WB(e/g*n+t,p,h);return a&&c>=t&&c<=o?jB(c,t,o,s,i):l?Math.round(c):c}},qB=e=>{const{min:t,max:o,range:n,value:r,hasMinEdge:s,hasMaxEdge:a,maxBound:i,maxOffset:l,centerMinEdge:c,centerMaxEdge:d}=e;return r<t?s?0:c:r>o?a?i:d:(r-t)/n*l},KB="top",XB="right",YB="bottom",JB="left",ZB="width",QB="height",eF=e=>e.element.dom.getBoundingClientRect(),tF=(e,t)=>e[t],oF=e=>{const t=eF(e);return tF(t,JB)},nF=e=>{const t=eF(e);return tF(t,XB)},rF=e=>{const t=eF(e);return tF(t,KB)},sF=e=>{const t=eF(e);return tF(t,YB)},aF=e=>{const t=eF(e);return tF(t,ZB)},iF=e=>{const t=eF(e);return tF(t,QB)},lF=(e,t,o)=>(e+t)/2-o,cF=(e,t)=>{const o=eF(e),n=eF(t),r=tF(o,JB),s=tF(o,XB),a=tF(n,JB);return lF(r,s,a)},dF=(e,t)=>{const o=eF(e),n=eF(t),r=tF(o,KB),s=tF(o,YB),a=tF(n,KB);return lF(r,s,a)},uF=(e,t)=>{Ti(e,JA(),{value:t})},mF=(e,t,o)=>{const n={min:rB(t),max:lB(t),range:gB(t),value:o,step:bB(t),snap:vB(t),snapStart:yB(t),rounded:xB(t),hasMinEdge:SB(t),hasMaxEdge:kB(t),minBound:oF(e),maxBound:nF(e),screenRange:aF(e)};return $B(n)},gF=(e,t,o)=>{const n=mF(e,t,o),r=n;return uF(e,r),n},pF=(e,t)=>{const o=rB(t);uF(e,o)},hF=(e,t)=>{const o=lB(t);uF(e,o)},fF=(e,t,o)=>{const n=e>0?UB:LB,r=n(_B(o),rB(o),lB(o),bB(o));return uF(t,r),F.some(r)},bF=e=>(t,o)=>fF(e,t,o).map(A),vF=e=>{const t=QA(e);return t.map((e=>e.left))},yF=(e,t,o,n,r)=>{const s=0,a=aF(e),i=n.bind((t=>F.some(cF(t,e)))).getOr(s),l=r.bind((t=>F.some(cF(t,e)))).getOr(a),c={min:rB(t),max:lB(t),range:gB(t),value:o,hasMinEdge:SB(t),hasMaxEdge:kB(t),minBound:oF(e),minOffset:s,maxBound:nF(e),maxOffset:a,centerMinEdge:i,centerMaxEdge:l};return qB(c)},xF=(e,t,o,n,r,s)=>{const a=yF(t,s,o,n,r);return oF(t)-oF(e)+a},wF=(e,t,o,n)=>{const r=_B(o),s=xF(e,n.getSpectrum(e),r,n.getLeftEdge(e),n.getRightEdge(e),o),a=Fo(t.element)/2;co(t.element,"left",s-a+"px")},SF=bF(-1),kF=bF(1),CF=F.none,OF=F.none,_F={"top-left":F.none(),top:F.none(),"top-right":F.none(),right:F.some(FB),"bottom-right":F.none(),bottom:F.none(),"bottom-left":F.none(),left:F.some(zB)};var TF=Object.freeze({__proto__:null,setValueFrom:gF,setToMin:pF,setToMax:hF,findValueOfOffset:mF,getValueFromEvent:vF,findPositionOfValue:xF,setPositionFromValue:wF,onLeft:SF,onRight:kF,onUp:CF,onDown:OF,edgeActions:_F});const EF=(e,t)=>{Ti(e,JA(),{value:t})},DF=(e,t,o)=>{const n={min:sB(t),max:cB(t),range:pB(t),value:o,step:bB(t),snap:vB(t),snapStart:yB(t),rounded:xB(t),hasMinEdge:CB(t),hasMaxEdge:OB(t),minBound:rF(e),maxBound:sF(e),screenRange:iF(e)};return $B(n)},MF=(e,t,o)=>{const n=DF(e,t,o),r=n;return EF(e,r),n},AF=(e,t)=>{const o=sB(t);EF(e,o)},BF=(e,t)=>{const o=cB(t);EF(e,o)},FF=(e,t,o)=>{const n=e>0?UB:LB,r=n(_B(o),sB(o),cB(o),bB(o));return EF(t,r),F.some(r)},IF=e=>(t,o)=>FF(e,t,o).map(A),RF=e=>{const t=QA(e);return t.map((e=>e.top))},NF=(e,t,o,n,r)=>{const s=0,a=iF(e),i=n.bind((t=>F.some(dF(t,e)))).getOr(s),l=r.bind((t=>F.some(dF(t,e)))).getOr(a),c={min:sB(t),max:cB(t),range:pB(t),value:o,hasMinEdge:CB(t),hasMaxEdge:OB(t),minBound:rF(e),minOffset:s,maxBound:sF(e),maxOffset:a,centerMinEdge:i,centerMaxEdge:l};return qB(c)},VF=(e,t,o,n,r,s)=>{const a=NF(t,s,o,n,r);return rF(t)-rF(e)+a},HF=(e,t,o,n)=>{const r=_B(o),s=VF(e,n.getSpectrum(e),r,n.getTopEdge(e),n.getBottomEdge(e),o),a=So(t.element)/2;co(t.element,"top",s-a+"px")},zF=F.none,PF=F.none,LF=IF(-1),UF=IF(1),WF={"top-left":F.none(),top:F.some(MB),"top-right":F.none(),right:F.none(),"bottom-right":F.none(),bottom:F.some(NB),"bottom-left":F.none(),left:F.none()};var jF=Object.freeze({__proto__:null,setValueFrom:MF,setToMin:AF,setToMax:BF,findValueOfOffset:DF,getValueFromEvent:RF,findPositionOfValue:VF,setPositionFromValue:HF,onLeft:zF,onRight:PF,onUp:LF,onDown:UF,edgeActions:WF});const GF=(e,t)=>{Ti(e,JA(),{value:t})},$F=(e,t)=>({x:e,y:t}),qF=(e,t,o)=>{const n=mF(e,t,o.left),r=DF(e,t,o.top),s=$F(n,r);return GF(e,s),s},KF=(e,t,o,n)=>{const r=e>0?UB:LB,s=t?_B(n).x:r(_B(n).x,rB(n),lB(n),bB(n)),a=t?r(_B(n).y,sB(n),cB(n),bB(n)):_B(n).y;return GF(o,$F(s,a)),F.some(s)},XF=(e,t)=>(o,n)=>KF(e,t,o,n).map(A),YF=(e,t)=>{const o=rB(t),n=sB(t);GF(e,$F(o,n))},JF=(e,t)=>{const o=lB(t),n=cB(t);GF(e,$F(o,n))},ZF=e=>QA(e),QF=(e,t,o,n)=>{const r=_B(o),s=xF(e,n.getSpectrum(e),r.x,n.getLeftEdge(e),n.getRightEdge(e),o),a=VF(e,n.getSpectrum(e),r.y,n.getTopEdge(e),n.getBottomEdge(e),o),i=Fo(t.element)/2,l=So(t.element)/2;co(t.element,"left",s-i+"px"),co(t.element,"top",a-l+"px")},eI=XF(-1,!1),tI=XF(1,!1),oI=XF(-1,!0),nI=XF(1,!0),rI={"top-left":F.some(DB),top:F.some(AB),"top-right":F.some(BB),right:F.some(IB),"bottom-right":F.some(RB),bottom:F.some(VB),"bottom-left":F.some(HB),left:F.some(PB)};var sI=Object.freeze({__proto__:null,setValueFrom:qF,setToMin:YF,setToMax:JF,getValueFromEvent:ZF,setPositionFromValue:QF,onLeft:eI,onRight:tI,onUp:oI,onDown:nI,edgeActions:rI});const aI=[Qs("stepSize",1),Qs("onChange",y),Qs("onChoose",y),Qs("onInit",y),Qs("onDragStart",y),Qs("onDragEnd",y),Qs("snapToGrid",!1),Qs("rounded",!0),js("snapStart"),Is("model",Es("mode",{x:[Qs("minX",0),Qs("maxX",100),As("value",(e=>ca(e.mode.minX))),Fs("getInitialValue"),Bd("manager",TF)],y:[Qs("minY",0),Qs("maxY",100),As("value",(e=>ca(e.mode.minY))),Fs("getInitialValue"),Bd("manager",jF)],xy:[Qs("minX",0),Qs("maxX",100),Qs("minY",0),Qs("maxY",100),As("value",(e=>ca({x:e.mode.minX,y:e.mode.minY}))),Fs("getInitialValue"),Bd("manager",sI)]})),ff("sliderBehaviours",[Gx,hf]),As("mouseIsDown",(()=>ca(!1)))],iI=(e,t,o,n)=>{const r=t=>db(t,e,"thumb"),s=t=>db(t,e,"spectrum"),a=t=>cb(t,e,"left-edge"),i=t=>cb(t,e,"right-edge"),l=t=>cb(t,e,"top-edge"),c=t=>cb(t,e,"bottom-edge"),d=e.model,u=d.manager,m=(t,o)=>{u.setPositionFromValue(t,o,e,{getLeftEdge:a,getRightEdge:i,getTopEdge:l,getBottomEdge:c,getSpectrum:s})},g=(e,t)=>{d.value.set(t);const o=r(e);m(e,o)},p=(t,o)=>{g(t,o);const n=r(t);return e.onChange(t,n,o),F.some(!0)},h=t=>{u.setToMin(t,e)},f=t=>{u.setToMax(t,e)},b=t=>{const o=()=>{cb(t,e,"thumb").each((o=>{const n=d.value.get();e.onChoose(t,o,n)}))},n=e.mouseIsDown.get();e.mouseIsDown.set(!1),n&&o()},v=(t,o)=>{o.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,r(t))},y=(t,o)=>{o.stop(),e.onDragEnd(t,r(t)),b(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:vf(e.sliderBehaviours,[Gx.config({mode:"special",focusIn:t=>cb(t,e,"spectrum").map(Gx.focusIn).map(A)}),hf.config({store:{mode:"manual",getValue:e=>d.value.get(),setValue:g}}),zu.config({channels:{[Rh()]:{onReceive:b}}})]),events:Fi([Vi(JA(),((e,t)=>{p(e,t.event.value)})),qi(((t,o)=>{const n=d.getInitialValue();d.value.set(n);const a=r(t);m(t,a);const i=s(t);e.onInit(t,a,i,d.value.get())})),Vi(Fa(),v),Vi(Ra(),y),Vi(Va(),v),Vi(Pa(),y)]),apis:{resetToMin:h,resetToMax:f,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},lI=Eb({name:"Slider",configFields:aI,partFields:XA,factory:iI,apis:{setValue:(e,t,o)=>{e.setValue(t,o)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),cI=cl("rgb-hex-update"),dI=cl("slider-update"),uI=cl("palette-update"),mI=(e,t)=>{const o=lI.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),n=lI.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return lI.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:k(0)},components:[o,n],sliderBehaviours:Fu([fw.config({})]),onChange:(e,t,o)=>{Ti(e,dI,{value:o})}})},gI="form",pI=[ff("formBehaviours",[hf])],hI=e=>"<alloy.field."+e+">",fI=e=>{const t=(()=>{const e=[],t=(t,o)=>(e.push(t),rb(gI,hI(t),o));return{field:t,record:k(e)}})(),o=e(t),n=t.record(),r=W(n,(e=>Kf({name:e,pname:hI(e)})));return wb(gI,pI,r,vI,o)},bI=(e,t)=>e.fold((()=>ir.error(t)),ir.value),vI=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:vf(e.formBehaviours,[hf.config({store:{mode:"manual",getValue:t=>{const o=mb(t,e);return he(o,((e,t)=>e().bind((e=>{const o=Fb.getCurrent(e);return bI(o,new Error(`Cannot find a current component to extract the value from for form part '${t}': `+rl(e.element)))})).map(hf.getValue)))},setValue:(t,o)=>{pe(o,((o,n)=>{cb(t,e,n).each((e=>{Fb.getCurrent(e).each((e=>{hf.setValue(e,o)}))}))}))}}})]),apis:{getField:(t,o)=>cb(t,e,o).bind(Fb.getCurrent)}}),yI={getField:Dl(((e,t,o)=>e.getField(t,o))),sketch:fI},xI=cl("valid-input"),wI=cl("invalid-input"),SI=cl("validating-input"),kI="colorcustom.rgb.",CI=(e,t,o,n)=>{const r=(o,n)=>TA.config({invalidClass:t("invalid"),notify:{onValidate:e=>{Ti(e,SI,{type:o})},onValid:e=>{Ti(e,xI,{type:o,value:hf.getValue(e)})},onInvalid:e=>{Ti(e,wI,{type:o,value:hf.getValue(e)})}},validator:{validate:t=>{const o=hf.getValue(t),r=n(o)?ir.value(!0):ir.error(e("aria.input.invalid"));return RD.pure(r)},validateOnLoad:!1}}),s=(o,n,s,a,i)=>{const l=e(kI+"range"),c=KM.parts.label({dom:{tag:"label",attributes:{"aria-label":a}},components:[Uc(s)]}),d=KM.parts.field({data:i,factory:LC,inputAttributes:{type:"text",..."hex"===n?{"aria-live":"polite"}:{}},inputClasses:[t("textfield")],inputBehaviours:Fu([r(n,o),ZM.config({})]),onSetValue:e=>{if(TA.isInvalid(e)){const t=TA.run(e);t.get(y)}}}),u=[c,d],m="hex"!==n?[KM.parts["aria-descriptor"]({text:l})]:[],g=u.concat(m);return{dom:{tag:"div",attributes:{role:"presentation"}},components:g}},a=(e,t)=>{const o=WT(t);return yI.getField(e,"hex").each((t=>{fw.isFocused(t)||hf.setValue(e,{hex:o.value})})),o},i=(e,t)=>{const o=t.red,n=t.green,r=t.blue;hf.setValue(e,{red:o,green:n,blue:r})},l=IS({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=(e,t)=>{l.getOpt(e).each((e=>{co(e.element,"background-color","#"+t.value)}))},d=()=>{const r={red:ca(F.some(255)),green:ca(F.some(255)),blue:ca(F.some(255)),hex:ca(F.some("ffffff"))},d=(e,t)=>{const o=ZT(t);i(e,o),p(o)},u=e=>r[e].get(),m=(e,t)=>{r[e].set(t)},g=()=>u("red").bind((e=>u("green").bind((t=>u("blue").map((o=>XT(e,t,o,1))))))),p=e=>{const t=e.red,o=e.green,n=e.blue;m("red",F.some(t)),m("green",F.some(o)),m("blue",F.some(n))},h=(e,t)=>{const o=t.event;"hex"!==o.type?m(o.type,F.none()):n(e)},f=(e,t)=>{o(e);const n=IT(t);m("hex",F.some(t));const r=ZT(n);i(e,r),p(r),Ti(e,cI,{hex:n}),c(e,n)},b=(e,t,o)=>{const n=parseInt(o,10);m(t,F.some(n)),g().each((t=>{const o=a(e,t);Ti(e,cI,{hex:o}),c(e,o)}))},v=e=>"hex"===e.type,y=(e,t)=>{const o=t.event;v(o)?f(e,o.value):b(e,o.type,o.value)},x=t=>({label:e(kI+t+".label"),description:e(kI+t+".description")}),w=x("red"),S=x("green"),k=x("blue"),C=x("hex");return _r(yI.sketch((o=>({dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[o.field("red",KM.sketch(s(YT,"red",w.label,w.description,255))),o.field("green",KM.sketch(s(YT,"green",S.label,S.description,255))),o.field("blue",KM.sketch(s(YT,"blue",k.label,k.description,255))),o.field("hex",KM.sketch(s(VT,"hex",C.label,C.description,"ffffff"))),l.asSpec()],formBehaviours:Fu([TA.config({invalidClass:t("form-invalid")}),iw("rgb-form-events",[Vi(xI,y),Vi(wI,h),Vi(SI,h)])])}))),{apis:{updateHex:(e,t)=>{hf.setValue(e,{hex:t.value}),d(e,t),c(e,t)}}})},u=Tb({factory:d,name:"RgbForm",configFields:[],apis:{updateHex:(e,t,o)=>{e.updateHex(t,o)}},extraApis:{}});return u},OI=(e,t)=>{const o=lI.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),n=lI.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:`<div class=${t("sv-palette-inner-thumb")} role="presentation"></div>`}}),r=(e,t)=>{const{width:o,height:n}=e,r=e.getContext("2d");if(null===r)return;r.fillStyle=t,r.fillRect(0,0,o,n);const s=r.createLinearGradient(0,0,o,0);s.addColorStop(0,"rgba(255,255,255,1)"),s.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=s,r.fillRect(0,0,o,n);const a=r.createLinearGradient(0,0,0,n);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=a,r.fillRect(0,0,o,n)},s=(e,t)=>{const o=e.components()[0].element.dom,n=vE(t,100,100),s=JT(n);r(o,tE(s))},a=(e,t)=>{const o=yE(ZT(t));lI.setValue(e,{x:o.saturation,y:100-o.value})},i=e=>{const s=k({x:0,y:0}),a=(e,t,o)=>{Ti(e,uI,{value:o})},i=(e,t,o,n)=>{r(o.element.dom,tE(oE))},l=Fu([Fb.config({find:F.some}),fw.config({})]);return lI.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:s},rounded:!1,components:[o,n],onChange:a,onInit:i,sliderBehaviours:l})},l=Tb({factory:i,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,o)=>{s(t,o)},setThumb:(e,t,o)=>{a(t,o)}},extraApis:{}});return l},_I=(e,t)=>{const o=o=>{const n=CI(e,t,o.onValidHex,o.onInvalidHex),r=OI(e,t),s=e=>(100-e)/100*360,a=e=>100-e/360*100,i={paletteRgba:ca(oE),paletteHue:ca(0)},l=IS(mI(e,t)),c=IS(r.sketch({})),d=IS(n.sketch({})),u=(e,t,o)=>{c.getOpt(e).each((e=>{r.setHue(e,o)}))},m=(e,t)=>{d.getOpt(e).each((e=>{n.updateHex(e,t)}))},g=(e,t,o)=>{l.getOpt(e).each((e=>{lI.setValue(e,a(o))}))},p=(e,t)=>{c.getOpt(e).each((e=>{r.setThumb(e,t)}))},h=(e,t)=>{const o=ZT(e);i.paletteRgba.set(o),i.paletteHue.set(t)},f=(e,t,o,n)=>{h(t,o),j(n,(n=>{n(e,t,o)}))},b=()=>{const e=[m];return(t,o)=>{const n=o.event.value,r=i.paletteHue.get(),s=vE(r,n.x,100-n.y),a=wE(s);f(t,a,r,e)}},v=()=>{const e=[u,m];return(t,o)=>{const n=s(o.event.value),r=i.paletteRgba.get(),a=yE(r),l=vE(n,a.saturation,a.value),c=wE(l);f(t,c,n,e)}},y=()=>{const e=[u,g,p];return(t,o)=>{const n=o.event.hex,r=xE(n);f(t,n,r.hue,e)}};return{uid:o.uid,dom:o.dom,components:[c.asSpec(),l.asSpec(),d.asSpec()],behaviours:Fu([iw("colour-picker-events",[Vi(cI,y()),Vi(uI,b()),Vi(dI,v())]),Fb.config({find:e=>d.getOpt(e)}),Gx.config({mode:"acyclic"})])}},n=Tb({name:"ColourPicker",configFields:[Fs("dom"),Qs("onValidHex",y),Qs("onInvalidHex",y)],factory:o});return n},TI=()=>Fb.config({find:F.some}),EI=e=>Fb.config({find:e.getOpt}),DI=e=>Fb.config({find:t=>Nt(t.element,e).bind((e=>t.getSystem().getByDom(e).toOptional()))}),MI={self:TI,memento:EI,childAt:DI},AI=rs([Qs("preprocess",C),Qs("postprocess",C)]),BI=(e,t)=>{const o=_s("RepresentingConfigs.memento processors",AI,t);return hf.config({store:{mode:"manual",getValue:t=>{const n=e.get(t),r=hf.getValue(n);return o.postprocess(r)},setValue:(t,n)=>{const r=o.preprocess(n),s=e.get(t);hf.setValue(s,r)}}})},FI=(e,t,o)=>hf.config({store:{mode:"manual",...e.map((e=>({initialValue:e}))).getOr({}),getValue:t,setValue:o}}),II=(e,t,o)=>FI(e,(e=>t(e.element)),((e,t)=>o(e.element,t))),RI=e=>II(e,xc,wc),NI=e=>II(e,Zi,Qi),VI=e=>hf.config({store:{mode:"memory",initialValue:e}}),HI={memento:BI,withElement:II,withComp:FI,domValue:RI,domHtml:NI,memory:VI},zI={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},PI=e=>t=>e.translate(zI[t]),LI=(e,t,o)=>{const n=e=>"tox-"+e,r=_I(PI(t),n),s=e=>{Ti(e,cA,{name:"hex-valid",value:!0})},a=e=>{Ti(e,cA,{name:"hex-valid",value:!1})},i=IS(r.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:s,onInvalidHex:a}));return{dom:{tag:"div"},components:[i.asSpec()],behaviours:Fu([HI.withComp(o,(e=>{const t=i.get(e),o=Fb.getCurrent(t),n=o.bind((e=>{const t=hf.getValue(e);return t.hex}));return n.map((e=>"#"+e)).getOr("")}),((e,t)=>{const o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,n=F.from(o.exec(t)).bind((e=>ie(e,1))),r=i.get(e),s=Fb.getCurrent(r);s.fold((()=>{console.log("Can not find form")}),(e=>{hf.setValue(e,{hex:n.getOr("")}),yI.getField(e,"hex").each((e=>{_i(e,$a())}))}))})),MI.self()])}};var UI=tinymce.util.Tools.resolve("tinymce.Resource");const WI=e=>Oe(e,"init"),jI=e=>{const t=wm(),o=IS({dom:{tag:e.tag}}),n=wm();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Fu([iw("custom-editor-events",[qi((r=>{o.getOpt(r).each((o=>{(WI(e)?e.init(o.element.dom):UI.load(e.scriptId,e.scriptUrl).then((t=>t(o.element.dom,e.settings)))).then((e=>{n.on((t=>{e.setValue(t)})),n.clear(),t.set(e)}))}))}))]),HI.withComp(F.none(),(()=>t.get().fold((()=>n.get().getOr("")),(e=>e.getValue()))),((e,o)=>{t.get().fold((()=>n.set(o)),(e=>e.setValue(o)))})),MI.self()]),components:[o.asSpec()]}};var GI=tinymce.util.Tools.resolve("tinymce.util.Tools");const $I=(e,t)=>{const o=GI.explode(t.getOption("images_file_types")),n=e=>P(o,(t=>Ue(e.name.toLowerCase(),`.${t.toLowerCase()}`)));return q(de(e),n)},qI=(e,t,o)=>{const n=(e,t)=>{t.stop()},r=e=>(t,o)=>{j(e,(e=>{e(t,o)}))},s=(e,t)=>{var o;if(!Zb.isDisabled(e)){const n=t.event.raw;i(e,null===(o=n.dataTransfer)||void 0===o?void 0:o.files)}},a=(e,t)=>{const o=t.event.raw.target;i(e,o.files)},i=(o,n)=>{n&&(hf.setValue(o,$I(n,t)),Ti(o,aA,{name:e.name}))},l=IS({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Fu([iw("input-file-events",[ji(Ka()),ji(ii())])])}),c=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Fu([HI.memory(o.getOr([])),MI.self(),Zb.config({}),Rw.config({toggleClass:"dragenter",toggleOnExecute:!1}),iw("dropzone-events",[Vi("dragenter",r([n,Rw.toggle])),Vi("dragleave",r([n,Rw.toggle])),Vi("dragover",n),Vi("drop",r([n,s])),Vi(qa(),a)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[Uc(t.translate("Drop an image here"))]},FS.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[Uc(t.translate("Browse for an image")),l.asSpec()],action:e=>{const t=l.get(e);t.element.dom.click()},buttonBehaviours:Fu([ZM.config({}),oT.button(t.isDisabled),J_()])})]}]}),d=e.label.map((e=>sA(e,t))),u=KM.parts.field({factory:{sketch:c}});return eA(d,u,["tox-form__group--stretched"],[])},KI=(e,t)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:W(e.items,t.interpreter)}),XI=cl("alloy-fake-before-tabstop"),YI=cl("alloy-fake-after-tabstop"),JI=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:Fu([fw.config({ignore:!0}),ZM.config({})])}),ZI=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[JI([XI]),e,JI([YI])],behaviours:Fu([MI.childAt(1)])}),QI=(e,t)=>{Ti(e,ja(),{raw:{which:9,shiftKey:t}})},eR=(e,t)=>{const o=t.element;pc(o,XI)?QI(e,!0):pc(o,YI)&&QI(e,!1)},tR=e=>vM(e,["."+XI,"."+YI].join(","),M),oR=e=>{const t=ca(e.getOr(""));return{getValue:e=>t.get(),setValue:(e,o)=>{t.get()!==o&&eo(e.element,"srcdoc",o),t.set(o)}}},nR=(e,t,o)=>{const n=e.sandboxed,r=e.transparent,s="tox-dialog__iframe",a={...e.label.map((e=>({title:e}))).getOr({}),...o.map((e=>({srcdoc:e}))).getOr({}),...n?{sandbox:"allow-scripts allow-same-origin"}:{}},i=oR(o),l=e.label.map((e=>sA(e,t))),c=e=>ZI({uid:e.uid,dom:{tag:"iframe",attributes:a,classes:r?[s]:[s,`${s}--opaque`]},behaviours:Fu([ZM.config({}),fw.config({}),HI.withComp(o,i.getValue,i.setValue)])}),d=KM.parts.field({factory:{sketch:c}});return eA(l,d,["tox-form__group--stretched"],[])},rR=e=>new Promise(((t,o)=>{const n=()=>{s(),t(e)},r=[km(e,"load",n),km(e,"error",(()=>{s(),o("Unable to load data from image: "+e.dom.src)}))],s=()=>j(r,(e=>e.unbind()));e.dom.complete&&n()})),sR=(e,t,o,n,r)=>{const s=o*r,a=n*r,i=Math.max(0,e/2-s/2),l=Math.max(0,t/2-a/2);return{left:i.toString()+"px",top:l.toString()+"px",width:s.toString()+"px",height:a.toString()+"px"}},aR=(e,t,o)=>{const n=Fo(e),r=So(e);return Math.min(n/t,r/o,1)},iR=(e,t)=>{const o=ca(t.getOr({url:""})),n=IS({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:t.map((e=>({src:e.url}))).getOr({})}}),r=IS({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[n.asSpec()]}),s=(e,t)=>{const s={url:t.url};t.zoom.each((e=>s.zoom=e)),t.cachedWidth.each((e=>s.cachedWidth=e)),t.cachedHeight.each((e=>s.cachedHeight=e)),o.set(s);const a=()=>{const{cachedWidth:t,cachedHeight:o,zoom:n}=s;if(!g(t)&&!g(o)){if(g(n)){const n=aR(e.element,t,o);s.zoom=n}const a=sR(Fo(e.element),So(e.element),t,o,s.zoom);r.getOpt(e).each((e=>{uo(e.element,a)}))}};n.getOpt(e).each((o=>{const n=o.element;t.url!==oo(n,"src")&&(eo(n,"src",t.url),gc(e.element,"tox-imagepreview__loaded")),a(),rR(n).then((t=>{e.getSystem().isConnected()&&(uc(e.element,"tox-imagepreview__loaded"),s.cachedWidth=t.dom.naturalWidth,s.cachedHeight=t.dom.naturalHeight,a())}))}))},a={};e.height.each((e=>a.height=e));const i=t.map((e=>({url:e.url,zoom:F.from(e.zoom),cachedWidth:F.from(e.cachedWidth),cachedHeight:F.from(e.cachedHeight)})));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:a,attributes:{role:"presentation"}},components:[r.asSpec()],behaviours:Fu([MI.self(),HI.withComp(i,(()=>o.get()),s)])}},lR=(e,t)=>{const o={dom:{tag:"label",classes:["tox-label"]},components:[Uc(t.providers.translate(e.label))]},n=W(e.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[o,...n],behaviours:Fu([MI.self(),sw.config({}),HI.domHtml(F.none()),Gx.config({mode:"acyclic"})])}},cR=cl("toolbar.button.execute"),dR=e=>Yi(((t,o)=>{nT(e,t)((o=>{Ti(t,cR,{buttonApi:o}),e.onAction(o)}))})),uR={[si()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},mR=(e,t,o)=>$S(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:o},t),gR=(e,t)=>mR(e,t,[]),pR=(e,t)=>mR(e,t,[sw.config({})]),hR=(e,t,o)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[Uc(o.translate(e))],behaviours:Fu([sw.config({})])}),fR=cl("update-menu-text"),bR=cl("update-menu-icon"),vR=(e,t,o)=>{const n=ca(y),r=e.text.map((e=>IS(hR(e,t,o.providers)))),s=e.icon.map((e=>IS(pR(e,o.providers.icons)))),a=(e,t)=>{const o=hf.getValue(e);return fw.focus(o),Ti(o,"keydown",{raw:t.event.raw}),QD.close(o),F.some(!0)},i=e.role.fold((()=>({})),(e=>({role:e}))),l=e.tooltip.fold((()=>({})),(e=>{const t=o.providers.translate(e);return{title:t,"aria-label":t}})),c=$S("chevron-down",{tag:"div",classes:[`${t}__select-chevron`]},o.providers.icons),d=IS(QD.sketch({...e.uid?{uid:e.uid}:{},...i,dom:{tag:"button",classes:[t,`${t}--select`].concat(W(e.classes,(e=>`${t}--${e}`))),attributes:{...l}},components:lT([s.map((e=>e.asSpec())),r.map((e=>e.asSpec())),F.some(c)]),matchWidth:!0,useMinWidth:!0,onOpen:(t,o,n)=>{e.searchable&&iM(n)},dropdownBehaviours:Fu([...e.dropdownBehaviours,oT.button((()=>e.disabled||o.providers.isDisabled())),J_(),AA.config({}),sw.config({}),iw("dropdown-events",[rT(e,n),sT(e,n)]),iw("menubutton-update-display-text",[Vi(fR,((e,t)=>{r.bind((t=>t.getOpt(e))).each((e=>{sw.set(e,[Uc(o.providers.translate(t.event.text))])}))})),Vi(bR,((e,t)=>{s.bind((t=>t.getOpt(e))).each((e=>{sw.set(e,[pR(t.event.icon,o.providers.icons)])}))}))])]),eventOrder:_r(uR,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Fu([Gx.config({mode:"special",onLeft:a,onRight:a}),iw("dropdown-sandbox-events",[Vi(UC,((e,t)=>{tM(e),t.stop()})),Vi(WC,((e,t)=>{oM(e,t),t.stop()}))])]),lazySink:o.getSink,toggleClass:`${t}--active`,parts:{menu:{...RC(!1,e.columns,e.presets),fakeFocus:e.searchable,onHighlightItem:sM,onCollapseMenu:(e,t,o)=>{vv.getHighlighted(o).each((t=>{sM(e,o,t)}))},onDehighlightItem:aM}},fetch:t=>RD.nu(_(e.fetch,t))}));return d.asSpec()},yR=e=>i(e),xR=e=>"separator"===e.type,wR=e=>Oe(e,"getSubmenuItems"),SR={type:"separator"},kR=(e,t)=>{const o=X(e,((e,o)=>yR(o)?""===o?e:"|"===o?e.length>0&&!xR(e[e.length-1])?e.concat([SR]):e:Oe(t,o.toLowerCase())?e.concat([t[o.toLowerCase()]]):e:e.concat([o])),[]);return o.length>0&&xR(o[o.length-1])&&o.pop(),o},CR=(e,t)=>{const o=e.getSubmenuItems(),n=_R(o,t),r=_r(n.menus,{[e.value]:n.items}),s=_r(n.expansions,{[e.value]:e.value});return{item:e,menus:r,expansions:s}},OR=e=>{const t=Ce(e,"value").getOrThunk((()=>cl("generated-menu-item")));return _r({value:t},e)},_R=(e,t)=>{const o=kR(i(e)?e.split(" "):e,t);return K(o,((e,o)=>{if(wR(o)){const n=OR(o),r=CR(n,t);return{menus:_r(e.menus,r.menus),items:[r.item,...e.items],expansions:_r(e.expansions,r.expansions)}}return{...e,items:[o,...e.items]}}),{menus:{},expansions:{},items:[]})},TR=e=>e.search.fold((()=>({searchMode:"no-search"})),(e=>({searchMode:"search-with-field",placeholder:e.placeholder}))),ER=e=>e.search.fold((()=>({searchMode:"no-search"})),(e=>({searchMode:"search-with-results"}))),DR=(e,t,o,n)=>{const r=cl("primary-menu"),s=_R(e,o.shared.providers.menuItems());if(0===s.items.length)return F.none();const a=TR(n),i=mM(r,s.items,t,o,n.isHorizontalMenu,a),l=ER(n),c=he(s.menus,((e,n)=>mM(n,e,t,o,!1,l))),d=_r(c,ba(r,i));return F.from(TS.tieredData(r,d,s.expansions))},MR=e=>!Oe(e,"items"),AR="data-value",BR=(e,t,o,n)=>W(o,(o=>MR(o)?{type:"togglemenuitem",text:o.text,value:o.value,active:o.value===n,onAction:()=>{hf.setValue(e,o.value),Ti(e,aA,{name:t}),fw.focus(e)}}:{type:"nestedmenuitem",text:o.text,getSubmenuItems:()=>BR(e,t,o.items,n)})),FR=(e,t)=>ue(e,(e=>MR(e)?Ie(e.value===t,e):FR(e.items,t))),IR=(e,t,o)=>{const n=t.shared.providers,r=o.bind((t=>FR(e.items,t))).orThunk((()=>le(e.items).filter(MR))),s=e.label.map((e=>sA(e,n))),a=KM.parts.field({dom:{},factory:{sketch:o=>vR({uid:o.uid,text:r.map((e=>e.text)),icon:F.none(),tooltip:e.label,role:F.none(),fetch:(o,n)=>{const r=BR(o,e.name,e.items,hf.getValue(o));n(DR(r,lC.CLOSE_ON_EXECUTE,t,{isHorizontalMenu:!1,search:F.none()}))},onSetup:k(y),getApi:k({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[ZM.config({}),HI.withComp(r.map((e=>e.value)),(e=>oo(e.element,AR)),((t,o)=>{FR(e.items,o).each((e=>{eo(t.element,AR,e.value),Ti(t,fR,{text:e.text})}))}))]},"tox-listbox",t.shared)}}),i={dom:{tag:"div",classes:["tox-listboxfield"]},components:[a]};return KM.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([s.toArray(),[i]]),fieldBehaviours:Fu([Zb.config({disabled:k(!e.enabled),onDisabled:e=>{KM.getField(e).each(Zb.disable)},onEnabled:e=>{KM.getField(e).each(Zb.enable)}})])})},RR=(e,t)=>({dom:{tag:"div",classes:e.classes},components:W(e.items,t.shared.interpreter)}),NR=(e,t)=>{const o=W(e.options,(e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}}))),n=e.data.map((e=>ba("initialValue",e))).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:o,behaviours:vf(e.selectBehaviours,[fw.config({}),hf.config({store:{mode:"manual",getValue:e=>xc(e.element),setValue:(t,o)=>{const n=J(e.options,(e=>e.value===o));n.isSome()&&wc(t.element,o)},...n}})])}},VR=Tb({name:"HtmlSelect",configFields:[Fs("options"),ff("selectBehaviours",[fw,hf]),Qs("selectClasses",[]),Qs("selectAttributes",{}),js("data")],factory:NR}),HR=(e,t,o)=>{const n=W(e.items,(e=>({text:t.translate(e.text),value:e.value}))),r=e.label.map((e=>sA(e,t))),s=KM.parts.field({dom:{},...o.map((e=>({data:e}))).getOr({}),selectAttributes:{size:e.size},options:n,factory:VR,selectBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||t.isDisabled()}),ZM.config({}),iw("selectbox-change",[Vi(qa(),((t,o)=>{Ti(t,aA,{name:e.name})}))])])}),a=e.size>1?F.none():F.some($S("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},t.icons)),i={dom:{tag:"div",classes:["tox-selectfield"]},components:Q([[s],a.toArray()])};return KM.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([r.toArray(),[i]]),fieldBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{KM.getField(e).each(Zb.disable)},onEnabled:e=>{KM.getField(e).each(Zb.enable)}}),J_()])})},zR=k([Qs("field1Name","field1"),Qs("field2Name","field2"),Md("onLockedChange"),_d(["lockClass"]),Qs("locked",!1),yf.field("coupledFieldBehaviours",[Fb,hf])]),PR=(e,t,o)=>cb(e,t,o).bind(Fb.getCurrent),LR=(e,t)=>Kf({factory:KM,name:e,overrides:e=>({fieldBehaviours:Fu([iw("coupled-input-behaviour",[Vi($a(),(o=>{PR(o,e,t).each((t=>{cb(o,e,"lock").each((n=>{Rw.isOn(n)&&e.onLockedChange(o,t,n)}))}))}))])])})}),UR=k([LR("field1","field2"),LR("field2","field1"),Kf({factory:FS,schema:[Fs("dom")],name:"lock",overrides:e=>({buttonBehaviours:Fu([Rw.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),WR=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:yf.augment(e.coupledFieldBehaviours,[Fb.config({find:F.some}),hf.config({store:{mode:"manual",getValue:t=>{const o=pb(t,e,["field1","field2"]);return{[e.field1Name]:hf.getValue(o.field1()),[e.field2Name]:hf.getValue(o.field2())}},setValue:(t,o)=>{const n=pb(t,e,["field1","field2"]);_e(o,e.field1Name)&&hf.setValue(n.field1(),o[e.field1Name]),_e(o,e.field2Name)&&hf.setValue(n.field2(),o[e.field2Name])}}})]),apis:{getField1:t=>cb(t,e,"field1"),getField2:t=>cb(t,e,"field2"),getLock:t=>cb(t,e,"lock")}}),jR=Eb({name:"FormCoupledInputs",configFields:zR(),partFields:UR(),factory:WR,apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),GR=e=>{const t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=e=>e in t?t[e]:1;let n=e.value.toFixed(o(e.unit));return-1!==n.indexOf(".")&&(n=n.replace(/\.?0*$/,"")),n+e.unit},$R=e=>{const t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,o=t.exec(e);if(null!==o){const e=parseFloat(o[1]),t=o[2];return ir.value({value:e,unit:t})}return ir.error(e)},qR=(e,t)=>{const o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=e=>Oe(o,e);return e.unit===t?F.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?F.some(e.value):F.some(e.value/o[e.unit]*o[t]):F.none()},KR=e=>F.none(),XR=(e,t)=>o=>qR(o,t).map((o=>({value:o*e,unit:t}))),YR=(e,t)=>{const o=$R(e).toOptional(),n=$R(t).toOptional();return Ae(o,n,((e,t)=>qR(e,t.unit).map((e=>t.value/e)).map((e=>XR(e,t.unit))).getOr(KR))).getOr(KR)},JR=(e,t)=>{let o=KR;const n=cl("ratio-event"),r=e=>$S(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons),s=jR.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||t.isDisabled()}),J_(),ZM.config({})])}),a=e=>({dom:{tag:"div",classes:["tox-form__group"]},components:e}),i=o=>KM.parts.field({factory:LC,inputClasses:["tox-textfield"],inputBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||t.isDisabled()}),J_(),ZM.config({}),iw("size-input-events",[Vi(Ua(),((e,t)=>{Ti(e,n,{isField1:o})})),Vi(qa(),((t,o)=>{Ti(t,aA,{name:e.name})}))])]),selectOnFocus:!1}),l=e=>({dom:{tag:"label",classes:["tox-label"]},components:[Uc(t.translate(e))]}),c=jR.parts.field1(a([KM.parts.label(l("Width")),i(!0)])),d=jR.parts.field2(a([KM.parts.label(l("Height")),i(!1)]));return jR.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,d,a([l(Cg),s])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t,n)=>{$R(hf.getValue(e)).each((e=>{o(e).each((e=>{hf.setValue(t,GR(e))}))}))},coupledFieldBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{jR.getField1(e).bind(KM.getField).each(Zb.disable),jR.getField2(e).bind(KM.getField).each(Zb.disable),jR.getLock(e).each(Zb.disable)},onEnabled:e=>{jR.getField1(e).bind(KM.getField).each(Zb.enable),jR.getField2(e).bind(KM.getField).each(Zb.enable),jR.getLock(e).each(Zb.enable)}}),J_(),iw("size-input-events2",[Vi(n,((e,t)=>{const n=t.event.isField1,r=n?jR.getField1(e):jR.getField2(e),s=n?jR.getField2(e):jR.getField1(e),a=r.map(hf.getValue).getOr(""),i=s.map(hf.getValue).getOr("");o=YR(a,i)}))])])})},ZR=(e,t,o)=>{const n=lI.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[Uc(t.translate(e.label))]}),r=lI.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=lI.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return lI.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e.min,maxX:e.max,getInitialValue:k(o.getOrThunk((()=>(Math.abs(e.max)-Math.abs(e.min))/2)))},components:[n,r,s],sliderBehaviours:Fu([MI.self(),fw.config({})]),onChoose:(t,o,n)=>{Ti(t,aA,{name:e.name,value:n})}})},QR=(e,t)=>{const o=e=>({dom:{tag:"th",innerHtml:t.translate(e)}}),n=e=>({dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(e,o)}]}),r=e=>({dom:{tag:"td",innerHtml:t.translate(e)}}),s=e=>({dom:{tag:"tr"},components:W(e,r)}),a=e=>({dom:{tag:"tbody"},components:W(e,s)});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[n(e.header),a(e.cells)],behaviours:Fu([ZM.config({}),fw.config({})])}},eN=(e,t)=>{const o=e.label.map((e=>sA(e,t))),n=[Zb.config({disabled:()=>e.disabled||t.isDisabled()}),J_(),Gx.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:e=>(_i(e,dA),F.some(!0))}),iw("textfield-change",[Vi($a(),((t,o)=>{Ti(t,aA,{name:e.name})})),Vi(ni(),((t,o)=>{Ti(t,aA,{name:e.name})}))]),ZM.config({})],r=e.validation.map((e=>TA.config({getRoot:e=>Bt(e.element),invalidClass:"tox-invalid",validator:{validate:t=>{const o=hf.getValue(t),n=e.validator(o);return RD.pure(!0===n?ir.value(o):ir.error(n))},validateOnLoad:e.validateOnLoad}}))).toArray(),s=e.placeholder.fold(k({}),(e=>({placeholder:t.translate(e)}))),a=e.inputMode.fold(k({}),(e=>({inputmode:e}))),i={...s,...a},l=KM.parts.field({tag:!0===e.multiline?"textarea":"input",...e.data.map((e=>({data:e}))).getOr({}),inputAttributes:i,inputClasses:[e.classname],inputBehaviours:Fu(Q([n,r])),selectOnFocus:!1,factory:LC}),c=e.flex?["tox-form__group--stretched"]:[],d=c.concat(e.maximized?["tox-form-group--maximize"]:[]),u=[Zb.config({disabled:()=>e.disabled||t.isDisabled(),onDisabled:e=>{KM.getField(e).each(Zb.disable)},onEnabled:e=>{KM.getField(e).each(Zb.enable)}}),J_()];return eA(o,l,d,u)},tN=(e,t,o)=>eN({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:!e.enabled,classname:"tox-textfield",validation:F.none(),maximized:e.maximized,data:o},t),oN=(e,t,o)=>eN({name:e.name,multiline:!0,label:e.label,inputMode:F.none(),placeholder:e.placeholder,flex:!0,disabled:!e.enabled,classname:"tox-textarea",validation:F.none(),maximized:e.maximized,data:o},t),nN=(e,t)=>{const o=e.stream.streams,n=o.setup(e,t);return Fi([Vi(e.event,n),Ki((()=>t.cancel()))].concat(e.cancelEvent.map((e=>[Vi(e,(()=>t.cancel()))])).getOr([])))};var rN=Object.freeze({__proto__:null,events:nN});const sN=(e,t)=>{let o=null;const n=()=>{u(o)||(clearTimeout(o),o=null)},r=(...n)=>{u(o)&&(o=setTimeout((()=>{o=null,e.apply(null,n)}),t))};return{cancel:n,throttle:r}},aN=(e,t)=>{let o=null;const n=()=>{u(o)||(clearTimeout(o),o=null)},r=(...r)=>{n(),o=setTimeout((()=>{o=null,e.apply(null,r)}),t)};return{cancel:n,throttle:r}},iN=e=>{const t=ca(null),o=()=>({timer:null!==t.get()?"set":"unset"}),n=e=>{t.set(e)},r=()=>{const e=t.get();null!==e&&e.cancel()};return Al({readState:o,setTimer:n,cancel:r})},lN=e=>e.stream.streams.state(e);var cN=Object.freeze({__proto__:null,throttle:iN,init:lN});const dN=(e,t)=>{const o=e.stream,n=aN(e.onStream,o.delay);return t.setTimer(n),(e,t)=>{n.throttle(e,t),o.stopEvent&&t.stop()}};var uN=[Is("stream",Es("mode",{throttle:[Fs("delay"),Qs("stopEvent",!0),Bd("streams",{setup:dN,state:iN})]})),Qs("event","input"),js("cancelEvent"),Md("onStream")];const mN=Ru({fields:uN,name:"streaming",active:rN,state:cN}),gN=(e,t,o)=>{const n=hf.getValue(o);hf.setValue(t,n),hN(t)},pN=(e,t)=>{const o=e.element,n=xc(o),r=o.dom;"number"!==oo(o,"type")&&t(r,n)},hN=e=>{pN(e,((e,t)=>e.setSelectionRange(t.length,t.length)))},fN=(e,t)=>{pN(e,((e,o)=>e.setSelectionRange(t,o.length)))},bN=(e,t,o)=>{if(e.selectsOver){const n=hf.getValue(t),r=e.getDisplayText(n),s=hf.getValue(o),a=e.getDisplayText(s);return 0===a.indexOf(r)?F.some((()=>{gN(e,t,o),fN(t,r.length)})):F.none()}return F.none()},vN=k("alloy.typeahead.itemexecute"),yN=(e,t,o,n)=>{const r=(t,o,r)=>{e.previewing.set(!1);const s=TD.getCoupled(t,"sandbox");if(Bh.isOpen(s))Fb.getCurrent(s).each((e=>{vv.getHighlighted(e).fold((()=>{r(e)}),(()=>{Bi(s,e.element,"keydown",o)}))}));else{const o=e=>{Fb.getCurrent(e).each(r)};LD(e,a(t),t,s,n,o,wS.HighlightMenuAndItem).get(y)}},s=VC(e),a=e=>t=>t.map((t=>{const o=ke(t.menus),n=ee(o,(e=>q(e.items,(e=>"item"===e.type)))),r=hf.getState(e);return r.update(W(n,(e=>e.data))),t})),i=e=>Fb.getCurrent(e),l="typeaheadevents",c=[fw.config({}),hf.config({onSetValue:e.onSetValue,store:{mode:"dataset",getDataKey:e=>xc(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(t,o)=>{wc(t.element,e.model.getDisplayText(o))},...e.initialData.map((e=>ba("initialValue",e))).getOr({})}}),mN.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:(t,o)=>{const r=TD.getCoupled(t,"sandbox"),s=fw.isFocused(t);if(s&&xc(t.element).length>=e.minChars){const o=i(r).bind((e=>vv.getHighlighted(e).map(hf.getValue)));e.previewing.set(!0);const s=t=>{i(r).each((t=>{o.fold((()=>{e.model.selectsOver&&vv.highlightFirst(t)}),(e=>{vv.highlightBy(t,(t=>{const o=hf.getValue(t);return o.value===e.value})),vv.getHighlighted(t).orThunk((()=>(vv.highlightFirst(t),F.none())))}))}))};LD(e,a(t),t,r,n,s,wS.HighlightJustMenu).get(y)}},cancelEvent:di()}),Gx.config({mode:"special",onDown:(e,t)=>(r(e,t,vv.highlightFirst),F.some(!0)),onEscape:e=>{const t=TD.getCoupled(e,"sandbox");return Bh.isOpen(t)?(Bh.close(t),F.some(!0)):F.none()},onUp:(e,t)=>(r(e,t,vv.highlightLast),F.some(!0)),onEnter:t=>{const o=TD.getCoupled(t,"sandbox"),n=Bh.isOpen(o);if(n&&!e.previewing.get())return i(o).bind((e=>vv.getHighlighted(e))).map((e=>(Ti(t,vN(),{item:e}),!0)));{const r=hf.getValue(t);return _i(t,di()),e.onExecute(o,t,r),n&&Bh.close(o),F.some(!0)}}}),Rw.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),TD.config({others:{sandbox:t=>qD(e,t,{onOpen:()=>Rw.on(t),onClose:()=>Rw.off(t)})}}),iw(l,[qi((t=>{e.lazyTypeaheadComp.set(F.some(t))})),Ki((t=>{e.lazyTypeaheadComp.set(F.none())})),Yi((t=>{const o=y;WD(e,a(t),t,n,o,wS.HighlightMenuAndItem).get(y)})),Vi(vN(),((t,o)=>{const n=TD.getCoupled(t,"sandbox");gN(e.model,t,o.event.item),_i(t,di()),e.onItemExecute(t,n,o.event.item,hf.getValue(t)),Bh.close(n),hN(t)}))].concat(e.dismissOnBlur?[Vi(oi(),(e=>{const t=TD.getCoupled(e,"sandbox");$u(t.element).isNone()&&Bh.close(t)}))]:[]))],d={[bi()]:[hf.name(),mN.name(),l],...e.eventOrder};return{uid:e.uid,dom:zC(_r(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...s,...vf(e.typeaheadBehaviours,c)},eventOrder:d}},xN=k([js("lazySink"),Fs("fetch"),Qs("minChars",5),Qs("responseTime",1e3),Ed("onOpen"),Qs("getHotspot",F.some),Qs("getAnchorOverrides",k({})),Qs("layouts",F.none()),Qs("eventOrder",{}),la("model",{},[Qs("getDisplayText",(e=>void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value)),Qs("selectsOver",!0),Qs("populateFromBrowse",!0)]),Ed("onSetValue"),Dd("onExecute"),Ed("onItemExecute"),Qs("inputClasses",[]),Qs("inputAttributes",{}),Qs("inputStyles",{}),Qs("matchWidth",!0),Qs("useMinWidth",!1),Qs("dismissOnBlur",!0),_d(["openClass"]),js("initialData"),ff("typeaheadBehaviours",[fw,hf,mN,Gx,Rw,TD]),As("lazyTypeaheadComp",(()=>ca(F.none))),As("previewing",(()=>ca(!0)))].concat(NC()).concat(XD())),wN=k([Xf({schema:[Od()],name:"menu",overrides:e=>({fakeFocus:!0,onHighlightItem:(t,o,n)=>{e.previewing.get()?e.lazyTypeaheadComp.get().each((t=>{bN(e.model,t,n).fold((()=>{e.model.selectsOver?(vv.dehighlight(o,n),e.previewing.set(!0)):e.previewing.set(!1)}),(t=>{t(),e.previewing.set(!1)}))})):e.lazyTypeaheadComp.get().each((t=>{e.model.populateFromBrowse&&gN(e.model,t,n)}))},onExecute:(t,o)=>e.lazyTypeaheadComp.get().map((e=>(Ti(e,vN(),{item:o}),!0))),onHover:(t,o)=>{e.previewing.set(!1),e.lazyTypeaheadComp.get().each((t=>{e.model.populateFromBrowse&&gN(e.model,t,o)}))}})})]),SN=Eb({name:"Typeahead",configFields:xN(),partFields:wN(),factory:yN}),kN=e=>{const t=()=>kN(e.toCached()),o=t=>kN(e.bind((e=>e.fold((e=>RD.pure(ir.error(e))),(e=>t(e)))))),n=t=>kN(e.map((e=>e.bind(t)))),r=t=>kN(e.map((e=>e.map(t)))),s=t=>kN(e.map((e=>e.mapError(t)))),a=(t,o)=>e.map((e=>e.fold(t,o))),i=(t,o)=>kN(RD.nu((n=>{let r=!1;const s=setTimeout((()=>{r=!0,n(ir.error(o()))}),t);e.get((e=>{r||(clearTimeout(s),n(e))}))})));return{...e,toCached:t,bindFuture:o,bindResult:n,mapResult:r,mapError:s,foldResult:a,withTimeout:i}},CN=e=>kN(RD.nu(e)),ON=e=>kN(RD.pure(ir.value(e))),_N=e=>kN(RD.pure(ir.error(e))),TN=e=>kN(RD.pure(e)),EN=e=>kN(e.map(ir.value)),DN=e=>CN((t=>{e.then((e=>{t(ir.value(e))}),(e=>{t(ir.error(e))}))})),MN={nu:CN,wrap:kN,pure:ON,value:ON,error:_N,fromResult:TN,fromFuture:EN,fromPromise:DN},AN=e=>({isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t),setActive:t=>{const o=e.element;t?(uc(o,"tox-tbtn--enabled"),eo(o,"aria-pressed",!0)):(gc(o,"tox-tbtn--enabled"),so(o,"aria-pressed"))},isActive:()=>pc(e.element,"tox-tbtn--enabled")}),BN=(e,t,o,n)=>vR({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:n,fetch:(t,n)=>{const r={pattern:e.search.isSome()?lM(t):""};e.fetch((t=>{n(DR(t,lC.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:e.search}))}),r)},onSetup:e.onSetup,getApi:AN,columns:1,presets:"normal",classes:[],dropdownBehaviours:[ZM.config({})]},t,o.shared),FN=(e,t,o)=>{const n=e=>n=>{const r=!n.isActive();n.setActive(r),e.storage.set(r),o.shared.getSink().each((o=>{t().getOpt(o).each((t=>{Uu(t.element),Ti(t,cA,{name:e.name,value:e.storage.get()})}))}))},r=e=>t=>{t.setActive(e.storage.get())};return t=>{t(W(e,(e=>{const t=e.text.fold((()=>({})),(e=>({text:e})));return{type:e.type,active:!1,...t,onAction:n(e),onSetup:r(e)}})))}},IN=(e,t,o=[],n,r,s)=>{const a=t.fold((()=>({})),(e=>({action:e}))),i={buttonBehaviours:Fu([oT.button((()=>!e.enabled||s.isDisabled())),J_(),ZM.config({}),iw("button press",[Ni("click"),Ni("mousedown")])].concat(o)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...a},l=_r(i,{dom:n});return _r(l,{components:r})},RN=(e,t,o,n=[])=>{const r=e.tooltip.map((e=>({"aria-label":o.translate(e),title:o.translate(e)}))).getOr({}),s={tag:"button",classes:["tox-tbtn"],attributes:r},a=e.icon.map((e=>gR(e,o.icons))),i=lT([a]);return IN(e,t,n,s,i,o)},NN=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];case"secondary":default:return["tox-button","tox-button--secondary"]}},VN=(e,t,o,n=[],r=[])=>{const s=o.translate(e.text),a=e.icon.map((e=>gR(e,o.icons))),i=[a.getOrThunk((()=>Uc(s)))],l=e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary"),c=NN(l),d=[...c,...a.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...r],u={tag:"button",classes:d,attributes:{title:s}};return IN(e,t,n,u,i,o)},HN=(e,t,o,n=[],r=[])=>{const s=VN(e,F.some(t),o,n,r);return FS.sketch(s)},zN=(e,t)=>o=>{"custom"===t?Ti(o,cA,{name:e,value:{}}):"submit"===t?_i(o,dA):"cancel"===t?_i(o,lA):console.error("Unknown button type: ",t)},PN=(e,t)=>"menu"===t,LN=(e,t)=>"custom"===t||"cancel"===t||"submit"===t,UN=(e,t,o)=>{if(PN(e,t)){const t=()=>s,n=e,r={...e,type:"menubutton",search:F.none(),onSetup:t=>(t.setEnabled(e.enabled),y),fetch:FN(n.items,t,o)},s=IS(BN(r,"tox-tbtn",o,F.none()));return s.asSpec()}if(LN(e,t)){const n=zN(e.name,t),r={...e,borderless:!1};return HN(r,n,o.shared.providers,[])}throw console.error("Unknown footer button type: ",t),new Error("Unknown footer button type")},WN=(e,t)=>{const o=zN(e.name,"custom");return tA(F.none(),KM.parts.field({factory:FS,...VN(e,F.some(o),t,[HI.memory(""),MI.self()])}))},jN={type:"separator"},GN=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:y}),$N=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:y}),qN=e=>W(e,GN),KN=(e,t)=>q(t,(t=>t.type===e)),XN=(e,t)=>qN(KN(e,t)),YN=e=>XN("header",e.targets),JN=e=>XN("anchor",e.targets),ZN=e=>F.from(e.anchorTop).map((e=>$N("<top>",e))).toArray(),QN=e=>F.from(e.anchorBottom).map((e=>$N("<bottom>",e))).toArray(),eV=e=>W(e,(e=>$N(e,e))),tV=e=>X(e,((e,t)=>{const o=0===e.length||0===t.length;return o?e.concat(t):e.concat(jN,t)}),[]),oV=(e,t)=>{const o=e.toLowerCase();return q(t,(e=>{var t;const n=void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text,r=null!==(t=e.value)&&void 0!==t?t:"";return Pe(n.toLowerCase(),o)||Pe(r.toLowerCase(),o)}))},nV=(e,t,o)=>{const n=hf.getValue(t),r=void 0!==n.meta.text?n.meta.text:n.value,s=o.getLinkInformation();return s.fold((()=>[]),(t=>{const n=oV(r,eV(o.getHistory(e)));return"file"===e?tV([n,oV(r,YN(t)),oV(r,Q([ZN(t),JN(t),QN(t)]))]):n}))},rV=cl("aria-invalid"),sV=(e,t,o,n)=>{const r=t.shared.providers,s=t=>{const n=hf.getValue(t);o.addToHistory(n.value,e.filetype)},a={...n.map((e=>({initialData:e}))).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":rV,type:"url"},minChars:0,responseTime:0,fetch:n=>{const r=nV(e.filetype,n,o),s=DR(r,lC.BUBBLE_TO_SANDBOX,t,{isHorizontalMenu:!1,search:F.none()});return RD.pure(s)},getHotspot:e=>p.getOpt(e),onSetValue:(e,t)=>{e.hasConfigured(TA)&&TA.run(e).get(y)},typeaheadBehaviours:Fu([...o.getValidationHandler().map((t=>TA.config({getRoot:e=>Bt(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{d.getOpt(e).each((e=>{eo(e.element,"title",r.translate(t))}))}},validator:{validate:o=>{const n=hf.getValue(o);return MN.nu((o=>{t({type:e.filetype,url:n.value},(e=>{if("invalid"===e.status){const t=ir.error(e.message);o(t)}else{const t=ir.value(e.message);o(t)}}))}))},validateOnLoad:!1}}))).toArray(),Zb.config({disabled:()=>!e.enabled||r.isDisabled()}),ZM.config({}),iw("urlinput-events",[Vi($a(),(t=>{const o=xc(t.element),n=o.trim();n!==o&&wc(t.element,n),"file"===e.filetype&&Ti(t,aA,{name:e.name})})),Vi(qa(),(t=>{Ti(t,aA,{name:e.name}),s(t)})),Vi(ni(),(t=>{Ti(t,aA,{name:e.name}),s(t)}))])]),eventOrder:{[$a()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:RC(!1,1,"normal")},onExecute:(e,t,o)=>{Ti(t,dA,{})},onItemExecute:(t,o,n,r)=>{s(t),Ti(t,aA,{name:e.name})}},i=KM.parts.field({...a,factory:SN}),l=e.label.map((e=>sA(e,r))),c=(e,t,o=e,n=e)=>$S(o,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:r.translate(n),"aria-live":"polite",...t.fold((()=>({})),(e=>({id:e})))}},r.icons),d=IS(c("invalid",F.some(rV),"warning")),u=IS({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[d.asSpec()]}),m=o.getUrlPicker(e.filetype),g=cl("browser.url.event"),p=IS({dom:{tag:"div",classes:["tox-control-wrap"]},components:[i,u.asSpec()],behaviours:Fu([Zb.config({disabled:()=>!e.enabled||r.isDisabled()})])}),h=IS(HN({name:e.name,icon:F.some("browse"),text:e.label.getOr(""),enabled:e.enabled,primary:!1,buttonType:F.none(),borderless:!0},(e=>_i(e,g)),r,[],["tox-browse-url"])),f=()=>({dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Q([[p.asSpec()],m.map((()=>h.asSpec())).toArray()])}),b=t=>{Fb.getCurrent(t).each((o=>{const n=hf.getValue(o),r={fieldname:e.name,...n};m.each((n=>{n(r).get((n=>{hf.setValue(o,n),Ti(t,aA,{name:e.name})}))}))}))};return KM.sketch({dom:nA(),components:l.toArray().concat([f()]),fieldBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||r.isDisabled(),onDisabled:e=>{KM.getField(e).each(Zb.disable),h.getOpt(e).each(Zb.disable)},onEnabled:e=>{KM.getField(e).each(Zb.enable),h.getOpt(e).each(Zb.enable)}}),J_(),iw("url-input-events",[Vi(g,b)])])})},aV=(e,t)=>UM.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${e.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[FS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:LS(e.icon,t.icons),attributes:{title:t.translate(e.iconTooltip)}},action:t=>{Ti(t,cA,{name:"alert-banner",value:e.url})},buttonBehaviours:Fu([jS()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]}),iV=(e,t)=>{e.dom.checked=t},lV=e=>e.dom.checked,cV=(e,t,o)=>{const n=e=>(e.element.dom.click(),F.some(!0)),r=KM.parts.field({factory:{sketch:C},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Fu([MI.self(),Zb.config({disabled:()=>!e.enabled||t.isDisabled()}),ZM.config({}),fw.config({}),HI.withElement(o,lV,iV),Gx.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),iw("checkbox-events",[Vi(qa(),((t,o)=>{Ti(t,aA,{name:e.name})}))])])}),s=KM.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[Uc(t.translate(e.label))],behaviours:Fu([AA.config({})])}),a=e=>{const o="checked"===e?"selected":"unselected";return $S(o,{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},t.icons)},i=IS({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return KM.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,i.asSpec(),s],fieldBehaviours:Fu([Zb.config({disabled:()=>!e.enabled||t.isDisabled(),disableClass:"tox-checkbox--disabled",onDisabled:e=>{KM.getField(e).each(Zb.disable)},onEnabled:e=>{KM.getField(e).each(Zb.enable)}}),J_()])})},dV=e=>"presentation"===e.presets?UM.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):UM.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:Fu([ZM.config({}),fw.config({})])}),uV=e=>(t,o,n,r)=>Ce(o,"name").fold((()=>e(o,r,F.none())),(s=>t.field(s,e(o,r,Ce(n,s))))),mV=e=>(t,o,n,r)=>{const s=_r(o,{source:"dynamic"});return uV(e)(t,s,n,r)},gV={bar:uV(((e,t)=>jM(e,t.shared))),collection:uV(((e,t,o)=>hA(e,t.shared.providers,o))),alertbanner:uV(((e,t)=>aV(e,t.shared.providers))),input:uV(((e,t,o)=>tN(e,t.shared.providers,o))),textarea:uV(((e,t,o)=>oN(e,t.shared.providers,o))),label:uV(((e,t)=>lR(e,t.shared))),iframe:mV(((e,t,o)=>nR(e,t.shared.providers,o))),button:uV(((e,t)=>WN(e,t.shared.providers))),checkbox:uV(((e,t,o)=>cV(e,t.shared.providers,o))),colorinput:uV(((e,t,o)=>NA(e,t.shared,t.colorinput,o))),colorpicker:uV(((e,t,o)=>LI(e,t.shared.providers,o))),dropzone:uV(((e,t,o)=>qI(e,t.shared.providers,o))),grid:uV(((e,t)=>KI(e,t.shared))),listbox:uV(((e,t,o)=>IR(e,t,o))),selectbox:uV(((e,t,o)=>HR(e,t.shared.providers,o))),sizeinput:uV(((e,t)=>JR(e,t.shared.providers))),slider:uV(((e,t,o)=>ZR(e,t.shared.providers,o))),urlinput:uV(((e,t,o)=>sV(e,t,t.urlinput,o))),customeditor:uV(jI),htmlpanel:uV(dV),imagepreview:uV(((e,t,o)=>iR(e,o))),table:uV(((e,t)=>QR(e,t.shared.providers))),panel:uV(((e,t)=>RR(e,t)))},pV={field:(e,t)=>t,record:k([])},hV=(e,t,o,n)=>{const r=_r(n,{shared:{interpreter:t=>fV(e,t,o,r)}});return fV(e,t,o,r)},fV=(e,t,o,n)=>Ce(gV,t.type).fold((()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t)),(r=>r(e,t,o,n))),bV=(e,t,o)=>fV(pV,e,t,o),vV="layout-inset",yV=e=>e.x,xV=(e,t)=>e.x+e.width/2-t.width/2,wV=(e,t)=>e.x+e.width-t.width,SV=e=>e.y,kV=(e,t)=>e.y+e.height-t.height,CV=(e,t)=>e.y+e.height/2-t.height/2,OV=(e,t,o)=>Rd(wV(e,t),kV(e,t),o.insetSouthwest(),Wd(),"southwest",Jd(e,{right:0,bottom:3}),vV),_V=(e,t,o)=>Rd(yV(e),kV(e,t),o.insetSoutheast(),Ud(),"southeast",Jd(e,{left:1,bottom:3}),vV),TV=(e,t,o)=>Rd(wV(e,t),SV(e),o.insetNorthwest(),Ld(),"northwest",Jd(e,{right:0,top:2}),vV),EV=(e,t,o)=>Rd(yV(e),SV(e),o.insetNortheast(),Pd(),"northeast",Jd(e,{left:1,top:2}),vV),DV=(e,t,o)=>Rd(xV(e,t),SV(e),o.insetNorth(),jd(),"north",Jd(e,{top:2}),vV),MV=(e,t,o)=>Rd(xV(e,t),kV(e,t),o.insetSouth(),Gd(),"south",Jd(e,{bottom:3}),vV),AV=(e,t,o)=>Rd(wV(e,t),CV(e,t),o.insetEast(),qd(),"east",Jd(e,{right:0}),vV),BV=(e,t,o)=>Rd(yV(e),CV(e,t),o.insetWest(),$d(),"west",Jd(e,{left:1}),vV),FV=e=>{switch(e){case"north":return DV;case"northeast":return EV;case"northwest":return TV;case"south":return MV;case"southeast":return _V;case"southwest":return OV;case"east":return AV;case"west":return BV}},IV=(e,t,o,n,r)=>{const s=dm(n).map(FV).getOr(DV);return s(e,t,o,n,r)},RV=e=>{switch(e){case"north":return MV;case"northeast":return _V;case"northwest":return OV;case"south":return DV;case"southeast":return EV;case"southwest":return TV;case"east":return BV;case"west":return AV}},NV=(e,t,o,n,r)=>{const s=dm(n).map(RV).getOr(DV);return s(e,t,o,n,r)},VV={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},HV=(e,t,o)=>{const n=12,r={maxHeightFunction:jm()},s=()=>({type:"node",root:jt(Wt(e())),node:F.from(e()),bubble:Xm(n,n,VV),layouts:{onRtl:()=>[EV],onLtr:()=>[TV]},overrides:r}),a=()=>({type:"hotspot",hotspot:t(),bubble:Xm(-n,n,VV),layouts:{onRtl:()=>[lu],onLtr:()=>[cu]},overrides:r});return()=>o()?s():a()},zV=(e,t,o)=>{const n=()=>({type:"node",root:jt(Wt(e())),node:F.from(e()),layouts:{onRtl:()=>[DV],onLtr:()=>[DV]}}),r=()=>({type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[gu],onLtr:()=>[gu]}});return()=>o()?n():r()},PV=(e,t)=>()=>({type:"selection",root:t(),getSelection:()=>{const t=e.selection.getRng();return F.some(Ug.range(Qe.fromDom(t.startContainer),t.startOffset,Qe.fromDom(t.endContainer),t.endOffset))}}),LV=e=>t=>({type:"node",root:e(),node:t}),UV=(e,t,o)=>{const n=Yk(e),r=()=>Qe.fromDom(e.getBody()),s=()=>Qe.fromDom(e.getContentAreaContainer()),a=()=>n||!o();return{inlineDialog:HV(s,t,a),banner:zV(s,t,a),cursor:PV(e,r),node:LV(r)}},WV=e=>(t,o)=>{const n=$E(e);n(t,o)},jV=e=>()=>AE(e),GV=e=>t=>BE(e,t),$V=e=>t=>ME(e,t),qV=e=>({colorPicker:WV(e),hasCustomColors:jV(e),getColors:GV(e),getColorCols:$V(e)}),KV=e=>()=>Fk(e),XV=e=>({isDraggableModal:KV(e)}),YV=e=>{const t=ca(Kk(e)?"bottom":"top");return{isPositionedAtTop:()=>"top"===t.get(),getDockingMode:t.get,setDockingMode:t.set}},JV=e=>_e(e,"items"),ZV=e=>_e(e,"format"),QV=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],eH=e=>Oe(e,"items"),tH=e=>Oe(e,"block"),oH=e=>Oe(e,"inline"),nH=e=>Oe(e,"selector"),rH=e=>X(e,((e,t)=>{if(eH(t)){const o=rH(t.items);return{customFormats:e.customFormats.concat(o.customFormats),formats:e.formats.concat([{title:t.title,items:o.formats}])}}if(oH(t)||tH(t)||nH(t)){const o=i(t.name)?t.name:t.title.toLowerCase(),n=`custom-${o}`;return{customFormats:e.customFormats.concat([{name:n,format:t}]),formats:e.formats.concat([{title:t.title,format:n,icon:t.icon}])}}return{...e,formats:e.formats.concat(t)}}),{customFormats:[],formats:[]}),sH=(e,t)=>{const o=rH(t),n=t=>{j(t,(t=>{e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))};return e.formatter?n(o.customFormats):e.on("init",(()=>{n(o.customFormats)})),o.formats},aH=e=>gk(e).map((t=>{const o=sH(e,t);return pk(e)?QV.concat(o):o})).getOr(QV),iH=e=>{const t=me(e);return 1===t.length&&z(t,"title")},lH=(e,t,o)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:o(e.format)}),cH=(e,t,o,n)=>{const r=e=>lH(e,o,n),s=e=>{const t=l(e.items);return{...e,type:"submenu",getStyleItems:k(t)}},a=t=>{const r=i(t.name)?t.name:cl(t.title),s=`custom-${r}`,a={...t,type:"formatter",format:s,isSelected:o(s),getStylePreview:n(s)};return e.formatter.register(r,a),a},l=e=>W(e,(e=>JV(e)?s(e):ZV(e)?r(e):iH(e)?{...e,type:"separator"}:a(e)));return l(t)},dH=e=>{const t=t=>()=>e.formatter.match(t),o=t=>()=>{const o=e.formatter.get(t);return void 0!==o?F.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):F.none()},n=ca([]),r=ca([]),s=ca(!1);e.on("PreInit",(r=>{const s=aH(e),a=cH(e,s,t,o);n.set(a)})),e.on("addStyleModifications",(n=>{const a=cH(e,n.items,t,o);r.set(a),s.set(n.replace)}));const a=()=>{const e=s.get()?[]:n.get(),t=r.get();return e.concat(t)};return{getData:a}},uH=e=>h(e)&&1===e.nodeType,mH=GI.trim,gH=e=>t=>{if(uH(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1},pH=gH("true"),hH=gH("false"),fH=(e,t,o,n,r)=>({type:e,title:t,url:o,level:n,attach:r}),bH=e=>{let t=e;while(t=t.parentNode){const e=t.contentEditable;if(e&&"inherit"!==e)return pH(t)}return!1},vH=(e,t)=>W(op(Qe.fromDom(t),e),(e=>e.dom)),yH=e=>e.innerText||e.textContent,xH=e=>e.id?e.id:cl("h"),wH=e=>e&&"A"===e.nodeName&&void 0!==(e.id||e.name),SH=e=>wH(e)&&CH(e),kH=e=>e&&/^(H[1-6])$/.test(e.nodeName),CH=e=>bH(e)&&!hH(e),OH=e=>kH(e)&&CH(e),_H=e=>kH(e)?parseInt(e.nodeName.substr(1),10):0,TH=e=>{var t;const o=xH(e),n=()=>{e.id=o};return fH("header",null!==(t=yH(e))&&void 0!==t?t:"","#"+o,_H(e),n)},EH=e=>{const t=e.id||e.name,o=yH(e);return fH("anchor",o||"#"+t,"#"+t,0,y)},DH=e=>W(q(e,OH),TH),MH=e=>W(q(e,SH),EH),AH=e=>{const t=vH("h1,h2,h3,h4,h5,h6,a:not([href])",e);return t},BH=e=>mH(e.title).length>0,FH=e=>{const t=AH(e);return q(DH(t).concat(MH(t)),BH)},IH={find:FH},RH="tinymce-url-history",NH=5,VH=e=>i(e)&&/^https?/.test(e),HH=e=>d(e)&&e.length<=NH&&te(e,VH),zH=e=>l(e)&&Se(e,(e=>!HH(e))).isNone(),PH=()=>{const e=mE.getItem(RH);if(null===e)return{};let t;try{t=JSON.parse(e)}catch(o){if(o instanceof SyntaxError)return console.log("Local storage "+RH+" was not valid JSON",o),{};throw o}return zH(t)?t:(console.log("Local storage "+RH+" was not valid format",t),{})},LH=e=>{if(!zH(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));mE.setItem(RH,JSON.stringify(e))},UH=e=>{const t=PH();return Ce(t,e).getOr([])},WH=(e,t)=>{if(!VH(e))return;const o=PH(),n=Ce(o,t).getOr([]),r=q(n,(t=>t!==e));o[t]=[e].concat(r).slice(0,NH),LH(o)},jH=e=>!!e,GH=e=>he(GI.makeMap(e,/[, ]/),jH),$H=e=>F.from(Tk(e)),qH=e=>{const t=F.from(Dk(e)).filter(jH).map(GH);return $H(e).fold(M,(e=>t.fold(A,(e=>me(e).length>0&&e))))},KH=(e,t)=>{const o=qH(e);return m(o)?o?$H(e):F.none():o[t]?$H(e):F.none()},XH=(e,t)=>KH(e,t).map((o=>n=>RD.nu((r=>{const s=(e,t)=>{if(!i(e))throw new Error("Expected value to be string");if(void 0!==t&&!l(t))throw new Error("Expected meta to be a object");const o={value:e,meta:t};r(o)},a={filetype:t,fieldname:n.fieldname,...F.from(n.meta).getOr({})};o.call(e,s,n.value,a)})))),YH=e=>F.from(e).filter(i).getOrUndefined(),JH=e=>Mk(e)?F.some({targets:IH.find(e.getBody()),anchorTop:YH(Ak(e)),anchorBottom:YH(Bk(e))}):F.none(),ZH=e=>F.from(Ek(e)),QH=e=>({getHistory:UH,addToHistory:WH,getLinkInformation:()=>JH(e),getValidationHandler:()=>ZH(e),getUrlPicker:t=>XH(e,t)}),ez=(e,t,o)=>{const n=ca(!1),r=YV(t),s={icons:()=>t.ui.registry.getAll().icons,menuItems:()=>t.ui.registry.getAll().menuItems,translate:RS.translate,isDisabled:()=>t.mode.isReadOnly()||!t.ui.isEnabled(),getOption:t.options.get},a=QH(t),i=dH(t),l=qV(t),c=XV(t),d=()=>n.get(),u=e=>n.set(e),m={shared:{providers:s,anchors:UV(t,o,r.isPositionedAtTop),header:r},urlinput:a,styles:i,colorinput:l,dialog:c,isContextMenuOpen:d,setContextMenuState:u},g={...m,shared:{...m.shared,interpreter:e=>bV(e,{},g),getSink:e.popup}},p={...m,shared:{...m.shared,interpreter:e=>bV(e,{},p),getSink:e.dialog}};return{popup:g,dialog:p}},tz=(e,t,o)=>{const n=(e,n)=>{j([t,...o],(t=>{t.broadcastEvent(e,n)}))},r=(e,n)=>{j([t,...o],(t=>{t.broadcastOn([e],n)}))},s=e=>r(Fh(),{target:e.target}),a=Gn(),i=km(a,"touchstart",s),l=km(a,"touchmove",(e=>n(mi(),e))),c=km(a,"touchend",(e=>n(gi(),e))),d=km(a,"mousedown",s),u=km(a,"mouseup",(e=>{0===e.raw.button&&r(Rh(),{target:e.target})})),m=e=>r(Fh(),{target:Qe.fromDom(e.target)}),g=e=>{0===e.button&&r(Rh(),{target:Qe.fromDom(e.target)})},p=()=>{j(e.editorManager.get(),(t=>{e!==t&&t.dispatch("DismissPopups",{relatedTarget:e})}))},h=e=>n(pi(),Om(e)),f=e=>{r(Ih(),{}),n(hi(),Om(e))},b=()=>r(Ih(),{}),v=t=>{t.state&&r(Fh(),{target:Qe.fromDom(e.getContainer())})},y=e=>{r(Fh(),{target:Qe.fromDom(e.relatedTarget.getContainer())})};e.on("PostRender",(()=>{e.on("click",m),e.on("tap",m),e.on("mouseup",g),e.on("mousedown",p),e.on("ScrollWindow",h),e.on("ResizeWindow",f),e.on("ResizeEditor",b),e.on("AfterProgressState",v),e.on("DismissPopups",y)})),e.on("remove",(()=>{e.off("click",m),e.off("tap",m),e.off("mouseup",g),e.off("mousedown",p),e.off("ScrollWindow",h),e.off("ResizeWindow",f),e.off("ResizeEditor",b),e.off("AfterProgressState",v),e.off("DismissPopups",y),d.unbind(),i.unbind(),l.unbind(),c.unbind(),u.unbind()})),e.on("detach",(()=>{j([t,...o],mh),j([t,...o],(e=>e.destroy()))}))},oz=bb,nz=Qf,rz=k([Qs("shell",!1),Fs("makeItem"),Qs("setupItem",y),yf.field("listBehaviours",[sw])]),sz=()=>({behaviours:Fu([sw.config({})])}),az=Yf({name:"items",overrides:sz}),iz=k([az]),lz=k("CustomList"),cz=(e,t,o,n)=>{const r=(t,o)=>{a(t).fold((()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(n=>{const r=sw.contents(n),s=o.length,a=s-r.length,i=a>0?L(a,(()=>e.makeItem())):[],l=r.slice(s);j(l,(e=>sw.remove(n,e))),j(i,(e=>sw.append(n,e)));const c=sw.contents(n);j(c,((n,r)=>{e.setupItem(t,n,o[r],r)}))}))},s=e.shell?{behaviours:[sw.config({})],components:[]}:{behaviours:[],components:t},a=t=>e.shell?F.some(t):cb(t,e,"items");return{uid:e.uid,dom:e.dom,components:s.components,behaviours:vf(e.listBehaviours,s.behaviours),apis:{setItems:r}}},dz=Eb({name:lz(),configFields:rz(),partFields:iz(),factory:cz,apis:{setItems:(e,t,o)=>{e.setItems(t,o)}}}),uz=k([Fs("dom"),Qs("shell",!0),ff("toolbarBehaviours",[sw])]),mz=()=>({behaviours:Fu([sw.config({})])}),gz=k([Yf({name:"groups",overrides:mz})]),pz=(e,t,o,n)=>{const r=(e,t)=>{s(e).fold((()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(e=>{sw.set(e,t)}))},s=t=>e.shell?F.some(t):cb(t,e,"groups"),a=e.shell?{behaviours:[sw.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:a.components,behaviours:vf(e.toolbarBehaviours,a.behaviours),apis:{setGroups:r},domModification:{attributes:{role:"group"}}}},hz=Eb({name:"Toolbar",configFields:uz(),partFields:gz(),factory:pz,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)}}}),fz=y,bz=M,vz=k([]);var yz=Object.freeze({__proto__:null,setup:fz,isDocked:bz,getBehaviours:vz});const xz=e=>{const t=Te(ho(e,"position"),"fixed"),o=t?F.none():Ft(e);return o.orThunk((()=>{const t=Qe.fromTag("span");return At(e).bind((e=>{Rn(e,t);const o=Ft(t);return zn(t),o}))}))},wz=e=>xz(e).map(Do).getOrThunk((()=>_o(0,0))),Sz=ua.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),kz=(e,t)=>{const o=e.element;uc(o,t.transitionClass),gc(o,t.fadeOutClass),uc(o,t.fadeInClass),t.onShow(e)},Cz=(e,t)=>{const o=e.element;uc(o,t.transitionClass),gc(o,t.fadeInClass),uc(o,t.fadeOutClass),t.onHide(e)},Oz=(e,t)=>e.y<t.bottom&&e.bottom>t.y,_z=(e,t)=>e.y>=t.y,Tz=(e,t)=>e.bottom<=t.bottom,Ez=(e,t,o)=>te(e,(e=>{switch(e){case"bottom":return Tz(t,o);case"top":return _z(t,o)}})),Dz=(e,t)=>t.getInitialPos().map((t=>er(t.bounds.x,t.bounds.y,Fo(e),So(e)))),Mz=(e,t,o)=>{o.setInitialPos({style:fo(e),position:go(e,"position")||"static",bounds:t})},Az=(e,t,o)=>o.getInitialPos().bind((n=>{switch(o.clearInitialPos(),n.position){case"static":return F.some(Sz.static());case"absolute":const o=xz(e).map(tr).getOrThunk((()=>tr(Jt())));return F.some(Sz.absolute(Ku("absolute",Ce(n.style,"left").map((e=>t.x-o.x)),Ce(n.style,"top").map((e=>t.y-o.y)),Ce(n.style,"right").map((e=>o.right-t.right)),Ce(n.style,"bottom").map((e=>o.bottom-t.bottom)))));default:return F.none()}})),Bz=(e,t,o)=>Dz(e,o).filter((e=>Ez(o.getModes(),e,t))).bind((t=>Az(e,t,o))),Fz=(e,t,o)=>{const n=tr(e);if(Ez(o.getModes(),n,t))return F.none();{Mz(e,n,o);const r=nr(),s=n.x-r.x,a=t.y-r.y,i=r.bottom-t.bottom,l=n.y<=t.y;return F.some(Sz.fixed(Ku("fixed",F.some(s),l?F.some(a):F.none(),F.none(),l?F.none():F.some(i))))}},Iz=(e,t,o)=>{const n=e.element,r=Te(ho(n,"position"),"fixed");return r?Bz(n,t,o):Fz(n,t,o)},Rz=(e,t)=>{const o=e.element;return Dz(o,t).bind((e=>Az(o,e,t)))},Nz=(e,t,o)=>{o.setDocked(!1),j(["left","right","top","bottom","position"],(t=>vo(e.element,t))),t.onUndocked(e)},Vz=(e,t,o,n)=>{const r="fixed"===n.position;o.setDocked(r),Yu(e.element,n);const s=r?t.onDocked:t.onUndocked;s(e)},Hz=(e,t,o,n,r=!1)=>{t.contextual.each((t=>{t.lazyContext(e).each((s=>{const a=Oz(s,n);if(a!==o.isVisible())if(o.setVisible(a),r&&!a)hc(e.element,[t.fadeOutClass]),t.onHide(e);else{const o=a?kz:Cz;o(e,t)}}))}))},zz=(e,t,o)=>{const n=t.lazyViewport(e),r=o.isDocked();r&&Hz(e,t,o,n),Iz(e,n,o).each((r=>{r.fold((()=>Nz(e,t,o)),(n=>Vz(e,t,o,n)),(r=>{Hz(e,t,o,n,!0),Vz(e,t,o,r)}))}))},Pz=(e,t,o)=>{const n=e.element;o.setDocked(!1),Rz(e,o).each((n=>{n.fold((()=>Nz(e,t,o)),(n=>Vz(e,t,o,n)),y)})),o.setVisible(!0),t.contextual.each((t=>{fc(n,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)})),Lz(e,t,o)},Lz=(e,t,o)=>{e.getSystem().isConnected()&&zz(e,t,o)},Uz=(e,t,o)=>{o.isDocked()&&Pz(e,t,o)},Wz=(e,t,o)=>o.isDocked(),jz=(e,t,o,n)=>o.setModes(n),Gz=(e,t,o)=>o.getModes();var $z=Object.freeze({__proto__:null,refresh:Lz,reset:Uz,isDocked:Wz,getModes:Gz,setModes:jz});const qz=(e,t)=>Fi([$i(Ya(),((o,n)=>{e.contextual.each((e=>{if(pc(o.element,e.transitionClass)){fc(o.element,[e.transitionClass,e.fadeInClass]);const n=t.isVisible()?e.onShown:e.onHidden;n(o)}n.stop()}))})),Vi(pi(),((o,n)=>{Lz(o,e,t)})),Vi(hi(),((o,n)=>{Uz(o,e,t)}))]);var Kz=Object.freeze({__proto__:null,events:qz}),Xz=[Js("contextual",[Ns("fadeInClass"),Ns("fadeOutClass"),Ns("transitionClass"),zs("lazyContext"),Ed("onShow"),Ed("onShown"),Ed("onHide"),Ed("onHidden")]),sa("lazyViewport",nr),ia("modes",["top","bottom"],gs),Ed("onDocked"),Ed("onUndocked")];const Yz=e=>{const t=ca(!1),o=ca(!0),n=wm(),r=ca(e.modes),s=()=>`docked:  ${t.get()}, visible: ${o.get()}, modes: ${r.get().join(",")}`;return Al({isDocked:t.get,setDocked:t.set,getInitialPos:n.get,setInitialPos:n.set,clearInitialPos:n.clear,isVisible:o.get,setVisible:o.set,getModes:r.get,setModes:r.set,readState:s})};var Jz=Object.freeze({__proto__:null,init:Yz});const Zz=Ru({fields:Xz,name:"docking",active:Kz,apis:$z,state:Jz}),Qz=k(cl("toolbar-height-change")),eP={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},tP="tox-tinymce--toolbar-sticky-on",oP="tox-tinymce--toolbar-sticky-off",nP=(e,t)=>{const o=Tt(t),n=Mt(t),r=n.dom.innerHeight,s=Pn(o),a=Qe.fromDom(e.elm),i=or(a),l=So(a),c=i.y,d=c+l,u=Do(t),m=So(t),g=u.top,p=g+m,h=Math.abs(g-s.top)<2,f=Math.abs(p-(s.top+r))<2;if(h&&c<p)Ln(s.left,c-m,o);else if(f&&d>g){const e=c-r+l+m;Ln(s.left,e,o)}},rP=(e,t)=>z(Zz.getModes(e),t),sP=e=>{const t=e=>ko(e)+(parseInt(go(e,"margin-top"),10)||0)+(parseInt(go(e,"margin-bottom"),10)||0),o=e.element;Bt(o).each((n=>{const r="padding-"+Zz.getModes(e)[0];if(Zz.isDocked(e)){const e=Fo(n);co(o,"width",e+"px"),co(n,r,t(o)+"px")}else vo(o,"width"),vo(n,r)}))},aP=(e,t)=>{t?(gc(e,eP.fadeOutClass),hc(e,[eP.transitionClass,eP.fadeInClass])):(gc(e,eP.fadeInClass),hc(e,[eP.fadeOutClass,eP.transitionClass]))},iP=(e,t)=>{const o=Qe.fromDom(e.getContainer());t?(uc(o,tP),gc(o,oP)):(uc(o,oP),gc(o,tP))},lP=(e,t)=>{const o=Tt(t);Gu(o).filter((e=>!Ot(t,e))).filter((t=>Ot(t,Qe.fromDom(o.dom.body))||_t(e,t))).each((()=>Uu(t)))},cP=(e,t)=>$u(e).orThunk((()=>t().toOptional().bind((e=>$u(e.element))))),dP=(e,t,o)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",(()=>{o().each(Zz.reset)})),e.on("ResizeWindow ResizeEditor",(()=>{o().each(sP)})),e.on("SkinLoaded",(()=>{o().each((e=>{Zz.isDocked(e)?Zz.reset(e):Zz.refresh(e)}))})),e.on("FullscreenStateChanged",(()=>{o().each(Zz.reset)}))),e.on("AfterScrollIntoView",(e=>{o().each((t=>{Zz.refresh(t);const o=t.element;gy(o)&&nP(e,o)}))})),e.on("PostRender",(()=>{iP(e,!1)}))},uP=e=>e().map(Zz.isDocked).getOr(!1),mP=()=>[zu.config({channels:{[Qz()]:{onReceive:sP}}})],gP=(e,t)=>{const o=wm(),n=t.getSink,r=e=>{n().each((t=>e(t.element)))},s=t=>{e.inline||sP(t),iP(e,Zz.isDocked(t)),t.getSystem().broadcastOn([Ih()],{}),n().each((e=>e.getSystem().broadcastOn([Ih()],{})))},a=e.inline?[]:mP();return[fw.config({}),Zz.config({contextual:{lazyContext:t=>{const o=ko(t.element),n=e.inline?e.getContentAreaContainer():e.getContainer(),r=tr(Qe.fromDom(n)),s=r.height-o,a=r.y+(rP(t,"top")?0:o);return F.some(er(r.x,a,r.width,s))},onShow:()=>{r((e=>aP(e,!0)))},onShown:e=>{r((e=>fc(e,[eP.transitionClass,eP.fadeInClass]))),o.get().each((t=>{lP(e.element,t),o.clear()}))},onHide:e=>{cP(e.element,n).fold(o.clear,o.set),r((e=>aP(e,!1)))},onHidden:()=>{r((e=>fc(e,[eP.transitionClass])))},...eP},lazyViewport:t=>{const o=nr(),n=Ck(e),r=o.y+(rP(t,"top")?n:0),s=o.height-(rP(t,"bottom")?n:0);return er(o.x,r,o.width,s)},modes:[t.header.getDockingMode()],onDocked:s,onUndocked:s}),...a]};var pP=Object.freeze({__proto__:null,setup:dP,isDocked:uP,getBehaviours:gP});const hP=e=>{const t=e.editor,o=e.sticky?gP:vz;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:Fu(o(t,e.sharedBackstage))}},fP=rs([mO,Is("items",as([cs([gO,Ws("items",gs)]),gs]))].concat($O)),bP=e=>Cs("GroupToolbarButton",fP,e),vP=[qs("text"),qs("tooltip"),qs("icon"),ea("search",!1,as([ps,rs([qs("placeholder")])],(e=>m(e)?e?F.some({placeholder:F.none()}):F.none():F.some(e)))),zs("fetch"),sa("onSetup",(()=>y))],yP=rs([mO,...vP]),xP=e=>Cs("menubutton",yP,e),wP=rs([mO,TO,_O,OO,MO,yO,kO,na("presets","normal",["normal","color","listpreview"]),RO(1),wO,SO]),SP=e=>Cs("SplitButton",wP,e),kP=(e,t)=>{const o=(e,o)=>{const n=W(o,(e=>{const o={type:"menubutton",text:e.text,fetch:t=>{t(e.getItems())}},n=xP(o).mapError((e=>Ts(e))).getOrDie();return BN(n,"tox-mbtn",t.backstage,F.some("menuitem"))}));sw.set(e,n)},n={focus:Gx.focusIn,setMenus:o};return{uid:e.uid,dom:e.dom,components:[],behaviours:Fu([sw.config({}),iw("menubar-events",[qi((t=>{e.onSetup(t)})),Vi(La(),((e,t)=>{nd(e.element,".tox-mbtn--active").each((o=>{rd(t.event.target,".tox-mbtn").each((t=>{Ot(o,t)||e.getSystem().getByDom(o).each((o=>{e.getSystem().getByDom(t).each((e=>{QD.expand(e),QD.close(o),fw.focus(e)}))}))}))}))})),Vi(xi(),((e,t)=>{t.event.prevFocus.bind((t=>e.getSystem().getByDom(t).toOptional())).each((o=>{t.event.newFocus.bind((t=>e.getSystem().getByDom(t).toOptional())).each((e=>{QD.isOpen(o)&&(QD.expand(e),QD.close(o))}))}))}))]),Gx.config({mode:"flow",selector:".tox-mbtn",onEscape:t=>(e.onEscape(t),F.some(!0))}),ZM.config({})]),apis:n,domModification:{attributes:{role:"menubar"}}}};var CP=Tb({factory:kP,name:"silver.Menubar",configFields:[Fs("dom"),Fs("uid"),Fs("onEscape"),Fs("backstage"),Qs("onSetup",y)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,o)=>{e.setMenus(t,o)}}});const OP="⚡️Upgrade",_P="https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",TP=e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:_P,rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:OP}}]}),EP=(e,t)=>t.getAnimationRoot.fold((()=>e.element),(t=>t(e))),DP=e=>e.dimension.property,MP=(e,t)=>e.dimension.getDimension(t),AP=(e,t)=>{const o=EP(e,t);fc(o,[t.shrinkingClass,t.growingClass])},BP=(e,t)=>{gc(e.element,t.openClass),uc(e.element,t.closedClass),co(e.element,DP(t),"0px"),yo(e.element)},FP=(e,t)=>{gc(e.element,t.closedClass),uc(e.element,t.openClass),vo(e.element,DP(t))},IP=(e,t,o,n)=>{o.setCollapsed(),co(e.element,DP(t),MP(t,e.element)),AP(e,t),BP(e,t),t.onStartShrink(e),t.onShrunk(e)},RP=(e,t,o,n)=>{const r=n.getOrThunk((()=>MP(t,e.element)));o.setCollapsed(),co(e.element,DP(t),r),yo(e.element);const s=EP(e,t);gc(s,t.growingClass),uc(s,t.shrinkingClass),BP(e,t),t.onStartShrink(e)},NP=(e,t,o)=>{const n=MP(t,e.element),r="0px"===n?IP:RP;r(e,t,o,F.some(n))},VP=(e,t,o)=>{const n=EP(e,t),r=pc(n,t.shrinkingClass),s=MP(t,e.element);FP(e,t);const a=MP(t,e.element),i=()=>{co(e.element,DP(t),s),yo(e.element)},l=()=>{BP(e,t)},c=r?i:l;c(),gc(n,t.shrinkingClass),uc(n,t.growingClass),FP(e,t),co(e.element,DP(t),a),o.setExpanded(),t.onStartGrow(e)},HP=(e,t,o)=>{if(o.isExpanded()){vo(e.element,DP(t));const o=MP(t,e.element);co(e.element,DP(t),o)}},zP=(e,t,o)=>{o.isExpanded()||VP(e,t,o)},PP=(e,t,o)=>{o.isExpanded()&&NP(e,t,o)},LP=(e,t,o)=>{o.isExpanded()&&IP(e,t,o)},UP=(e,t,o)=>o.isExpanded(),WP=(e,t,o)=>o.isCollapsed(),jP=(e,t,o)=>{const n=EP(e,t);return!0===pc(n,t.growingClass)},GP=(e,t,o)=>{const n=EP(e,t);return!0===pc(n,t.shrinkingClass)},$P=(e,t,o)=>jP(e,t)||GP(e,t),qP=(e,t,o)=>{const n=o.isExpanded()?NP:VP;n(e,t,o)},KP=(e,t,o)=>{o.isExpanded()||(FP(e,t),co(e.element,DP(t),MP(t,e.element)),AP(e,t),o.setExpanded(),t.onStartGrow(e),t.onGrown(e))};var XP=Object.freeze({__proto__:null,refresh:HP,grow:zP,shrink:PP,immediateShrink:LP,hasGrown:UP,hasShrunk:WP,isGrowing:jP,isShrinking:GP,isTransitioning:$P,toggleGrow:qP,disableTransitions:AP,immediateGrow:KP});const YP=(e,t,o)=>{const n=t.expanded;return Nl(n?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:ba(t.dimension.property,"0px")})},JP=(e,t)=>Fi([$i(Ya(),((o,n)=>{const r=n.event.raw;if(r.propertyName===e.dimension.property){AP(o,e),t.isExpanded()&&vo(o.element,e.dimension.property);const n=t.isExpanded()?e.onGrown:e.onShrunk;n(o)}}))]);var ZP=Object.freeze({__proto__:null,exhibit:YP,events:JP}),QP=[Fs("closedClass"),Fs("openClass"),Fs("shrinkingClass"),Fs("growingClass"),js("getAnimationRoot"),Ed("onShrunk"),Ed("onStartShrink"),Ed("onGrown"),Ed("onStartGrow"),Qs("expanded",!1),Is("dimension",Es("property",{width:[Bd("property","width"),Bd("getDimension",(e=>Fo(e)+"px"))],height:[Bd("property","height"),Bd("getDimension",(e=>So(e)+"px"))]}))];const eL=e=>{const t=ca(e.expanded),o=()=>"expanded: "+t.get();return Al({isExpanded:()=>!0===t.get(),isCollapsed:()=>!1===t.get(),setCollapsed:_(t.set,!1),setExpanded:_(t.set,!0),readState:o})};var tL=Object.freeze({__proto__:null,init:eL});const oL=Ru({fields:QP,name:"sliding",active:ZP,apis:XP,state:tL}),nL="container",rL=[ff("slotBehaviours",[])],sL=e=>"<alloy.field."+e+">",aL=e=>{const t=(()=>{const e=[],t=(t,o)=>(e.push(t),rb(nL,sL(t),o));return{slot:t,record:k(e)}})(),o=e(t),n=t.record(),r=W(n,(e=>Kf({name:e,pname:sL(e)})));return wb(nL,rL,r,iL,o)},iL=(e,t)=>{const o=t=>gb(e),n=(t,o)=>cb(t,e,o),r=(t,o)=>(n,r)=>cb(n,e,r).map((e=>t(e,r))).getOr(o),s=e=>(t,o)=>{j(o,(o=>e(t,o)))},a=(e,t)=>"true"!==oo(e.element,"aria-hidden"),i=(e,t)=>{if(!a(e)){const o=e.element;vo(o,"display"),so(o,"aria-hidden"),Ti(e,wi(),{name:t,visible:!0})}},l=(e,t)=>{if(a(e)){const o=e.element;co(o,"display","none"),eo(o,"aria-hidden","true"),Ti(e,wi(),{name:t,visible:!1})}},c=r(a,!1),d=r(l),u=s(d),m=e=>u(e,o()),g=r(i),p={getSlotNames:o,getSlot:n,isShowing:c,hideSlot:d,hideAllSlots:m,showSlot:g};return{uid:e.uid,dom:e.dom,components:t,behaviours:bf(e.slotBehaviours),apis:p}},lL=he({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,o)=>e.getSlot(t,o),isShowing:(e,t,o)=>e.isShowing(t,o),hideSlot:(e,t,o)=>e.hideSlot(t,o),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,o)=>e.showSlot(t,o)},(e=>Dl(e))),cL={...lL,sketch:aL},dL=rs([_O,TO,sa("onShow",y),sa("onHide",y),kO]),uL=e=>Cs("sidebar",dL,e),mL=e=>{const{sidebars:t}=e.ui.registry.getAll();j(me(t),(o=>{const n=t[o],r=()=>Te(F.from(e.queryCommandValue("ToggleSidebar")),o);e.ui.registry.addToggleButton(o,{icon:n.icon,tooltip:n.tooltip,onAction:t=>{e.execCommand("ToggleSidebar",!1,o),t.setActive(r())},onSetup:t=>{t.setActive(r());const o=()=>t.setActive(r());return e.on("ToggleSidebar",o),()=>{e.off("ToggleSidebar",o)}}})}))},gL=e=>({element:()=>e.element.dom}),pL=(e,t)=>{const o=W(me(t),(e=>{const o=t[e],n=Os(uL(o));return{name:e,getApi:gL,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}}));return W(o,(t=>{const n=ca(y);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:F_.unnamedEvents([rT(t,n),sT(t,n),Vi(wi(),((e,t)=>{const n=t.event,r=J(o,(e=>e.name===n.name));r.each((t=>{const o=n.visible?t.onShow:t.onHide;o(t.getApi(e))}))}))])})}))},hL=e=>cL.sketch((t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:pL(t,e),slotBehaviours:F_.unnamedEvents([qi((e=>cL.hideAllSlots(e)))])}))),fL=(e,t,o)=>{const n=Fb.getCurrent(e);n.each((e=>{sw.set(e,[hL(t)]);const n=null===o||void 0===o?void 0:o.toLowerCase();i(n)&&Oe(t,n)&&Fb.getCurrent(e).each((t=>{cL.showSlot(t,n),oL.immediateGrow(e),vo(e.element,"width")}))}))},bL=(e,t)=>{const o=Fb.getCurrent(e);o.each((e=>{const o=Fb.getCurrent(e);o.each((o=>{oL.hasGrown(e)?cL.isShowing(o,t)?oL.shrink(e):(cL.hideAllSlots(o),cL.showSlot(o,t)):(cL.hideAllSlots(o),cL.showSlot(o,t),oL.grow(e))}))}))},vL=e=>{const t=Fb.getCurrent(e);return t.bind((e=>{const t=oL.isGrowing(e)||oL.hasGrown(e);if(t){const t=Fb.getCurrent(e);return t.bind((e=>J(cL.getSlotNames(e),(t=>cL.isShowing(e,t)))))}return F.none()}))},yL=cl("FixSizeEvent"),xL=cl("AutoSizeEvent"),wL=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Fu([ZM.config({}),fw.config({}),oL.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{const t=Fb.getCurrent(e);t.each(cL.hideAllSlots),_i(e,xL)},onGrown:e=>{_i(e,xL)},onStartGrow:e=>{Ti(e,yL,{width:ho(e.element,"width").getOr("")})},onStartShrink:e=>{Ti(e,yL,{width:Fo(e.element)+"px"})}}),sw.config({}),Fb.config({find:e=>{const t=sw.contents(e);return le(t)}})])}],behaviours:Fu([MI.childAt(0),iw("sidebar-sliding-events",[Vi(yL,((e,t)=>{co(e.element,"width",t.event.width)})),Vi(xL,((e,t)=>{vo(e.element,"width")}))])])}),SL=(e,t,o,n)=>{eo(e.element,"aria-busy",!0);const r=t.getRoot(e).getOr(e),s=Fu([Gx.config({mode:"special",onTab:()=>F.some(!0),onShiftTab:()=>F.some(!0)}),fw.config({})]),a=n(r,s),i=r.getSystem().build(a);sw.append(r,Kc(i)),i.hasConfigured(Gx)&&t.focus&&Gx.focusIn(i),o.isBlocked()||t.onBlock(e),o.blockWith((()=>sw.remove(r,i)))},kL=(e,t,o)=>{so(e.element,"aria-busy"),o.isBlocked()&&t.onUnblock(e),o.clear()};var CL=Object.freeze({__proto__:null,block:SL,unblock:kL}),OL=[sa("getRoot",F.none),ra("focus",!0),Ed("onBlock"),Ed("onUnblock")];const _L=()=>{const e=ym(),t=t=>{e.set({destroy:t})};return Al({readState:e.isSet,blockWith:t,clear:e.clear,isBlocked:e.isSet})};var TL=Object.freeze({__proto__:null,init:_L});const EL=Ru({fields:OL,name:"blocking",apis:CL,state:TL}),DL=e=>{const t=void 0!==e.dom.attributes?e.dom.attributes:[];return X(t,((e,t)=>"class"===t.name?e:{...e,[t.name]:t.value}),{})},ML=e=>Array.prototype.slice.call(e.dom.classList,0),AL=e=>{const t=Qe.fromHtml(e),o=Rt(t),n=DL(t),r=ML(t),s=0===o.length?{}:{innerHtml:Zi(t)};return{tag:mt(t),classes:r,attributes:n,...s}},BL=e=>(t,o)=>({dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:AL('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),FL=e=>Fb.getCurrent(e).each((e=>Uu(e.element))),IL=(e,t)=>{const o="tabindex",n=`data-mce-${o}`;F.from(e.iframeElement).map(Qe.fromDom).each((e=>{t?(no(e,o).each((t=>eo(e,n,t))),eo(e,o,-1)):(so(e,o),no(e,n).each((t=>{eo(e,o,t),so(e,n)})))}))},RL=(e,t,o,n)=>{const r=t.element;if(IL(e,o),o)EL.block(t,BL(n)),vo(r,"display"),so(r,"aria-hidden"),e.hasFocus()&&FL(t);else{const o=Fb.getCurrent(t).exists((e=>ju(e.element)));EL.unblock(t),co(r,"display","none"),eo(r,"aria-hidden","true"),o&&e.focus()}},NL=e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Fu([sw.config({}),EL.config({focus:!1}),Fb.config({find:e=>le(e.components())})]),components:[]}),VL=e=>"focusin"===e.type,HL=e=>{if(VL(e)){const t=e.composed?le(e.composedPath()):F.from(e.target);return t.map(Qe.fromDom).filter(ft).exists((e=>pc(e,"mce-pastebin")))}return!1},zL=(e,t,o)=>{const n=ca(!1),r=wm(),s=o=>{n.get()&&!HL(o)&&(o.preventDefault(),FL(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",(()=>{e.dom.bind(e.getWin(),"focusin",s),e.on("BeforeExecCommand",(e=>{"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&s(e)}))}));const a=r=>{r!==n.get()&&(n.set(r),RL(e,t(),r,o.providers),cE(e,r))};e.on("ProgressState",(t=>{if(r.on(clearTimeout),b(t.time)){const o=AS.setEditorTimeout(e,(()=>a(t.state)),t.time);r.set(o)}else a(t.state),r.clear()}))},PL=(e,t)=>{const o={len:0,list:[]},n=X(e,((e,o)=>{const n=t(o,e.len);return n.fold(k(e),(t=>({len:t.finish,list:e.list.concat([t])})))}),o);return n.list},LL=(e,t,o)=>({within:e,extra:t,withinWidth:o}),UL=(e,t,o)=>{const n=PL(e,((e,t)=>{const n=o(e);return F.some({element:e,start:t,finish:t+n,width:n})})),r=q(n,(e=>e.finish<=t)),s=K(r,((e,t)=>e+t.width),0),a=n.slice(r.length);return{within:r,extra:a,withinWidth:s}},WL=e=>W(e,(e=>e.element)),jL=(e,t,o)=>{const n=WL(e.concat(t));return LL(n,[],o)},GL=(e,t,o,n)=>{const r=WL(e).concat([o]);return LL(r,WL(t),n)},$L=(e,t,o)=>LL(WL(e),[],o),qL=(e,t,o)=>{const n=UL(t,e,o);return 0===n.extra.length?F.some(n):F.none()},KL=(e,t,o,n)=>{const r=qL(e,t,o).getOrThunk((()=>UL(t,e-o(n),o))),s=r.within,a=r.extra,i=r.withinWidth;return 1===a.length&&a[0].width<=o(n)?jL(s,a,i):a.length>=1?GL(s,a,n,i):$L(s,a,i)},XL=(e,t)=>{const o=W(t,(e=>Kc(e)));hz.setGroups(e,o)},YL=e=>ue(e,(e=>$u(e.element).bind((t=>e.getSystem().getByDom(t).toOptional())))),JL=(e,t,o)=>{const n=t.builtGroups.get();if(0===n.length)return;const r=db(e,t,"primary"),s=TD.getCoupled(e,"overflowGroup");co(r.element,"visibility","hidden");const a=n.concat([s]),i=YL(a);o([]),XL(r,a);const l=Fo(r.element),c=KL(l,t.builtGroups.get(),(e=>Fo(e.element)),s);0===c.extra.length?(sw.remove(r,s),o([])):(XL(r,c.within),o(c.extra)),vo(r.element,"visibility"),yo(r.element),i.each(fw.focus)},ZL=k([ff("splitToolbarBehaviours",[TD]),As("builtGroups",(()=>ca([])))]),QL=k([_d(["overflowToggledClass"]),Xs("getOverflowBounds"),Fs("lazySink"),As("overflowGroups",(()=>ca([]))),Ed("onOpened"),Ed("onClosed")].concat(ZL())),eU=k([Kf({factory:hz,schema:uz(),name:"primary"}),Xf({schema:uz(),name:"overflow"}),Xf({name:"overflow-button"}),Xf({name:"overflow-group"})]),tU=k(((e,t)=>{Ro(e,Math.floor(t))})),oU=k([_d(["toggledClass"]),Fs("lazySink"),zs("fetch"),Xs("getBounds"),Js("fireDismissalEventInstead",[Qs("event",vi())]),ng(),Ed("onToggled")]),nU=k([Xf({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Fu([Rw.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),Xf({factory:hz,schema:uz(),name:"toolbar",overrides:e=>({toolbarBehaviours:Fu([Gx.config({mode:"cyclic",onEscape:t=>(cb(t,e,"button").each(fw.focus),F.none())})])})})]),rU=(e,t)=>{const o=TD.getCoupled(e,"toolbarSandbox");Bh.isOpen(o)?Bh.close(o):Bh.open(o,t.toolbar())},sU=(e,t,o,n)=>{const r=o.getBounds.map((e=>e())),s=o.lazySink(e).getOrDie();Kp.positionWithinBounds(s,t,{anchor:{type:"hotspot",hotspot:e,layouts:n,overrides:{maxWidthFunction:tU()}}},r)},aU=(e,t,o,n,r)=>{hz.setGroups(t,r),sU(e,t,o,n),Rw.on(e)},iU=(e,t,o)=>{const n=id(),r=(r,s)=>{o.fetch().get((r=>{aU(e,s,o,t.layouts,r),n.link(e.element),Gx.focusIn(s)}))},s=()=>{Rw.off(e),fw.focus(e),n.unlink(e.element)};return{dom:{tag:"div",attributes:{id:n.id}},behaviours:Fu([Gx.config({mode:"special",onEscape:e=>(Bh.close(e),F.some(!0))}),Bh.config({onOpen:r,onClose:s,isPartOf:(t,o,n)=>cd(o,n)||cd(e,n),getAttachPoint:()=>o.lazySink(e).getOrDie()}),zu.config({channels:{...Vh({isExtraPart:M,...o.fireDismissalEventInstead.map((e=>({fireEventInstead:{event:e.event}}))).getOr({})}),...zh({doReposition:()=>{Bh.getState(TD.getCoupled(e,"toolbarSandbox")).each((n=>{sU(e,n,o,t.layouts)}))}})}})])}},lU=(e,t,o,n)=>({...FS.sketch({...n.button(),action:e=>{rU(e,n)},buttonBehaviours:yf.augment({dump:n.button().buttonBehaviours},[TD.config({others:{toolbarSandbox:t=>iU(t,o,e)}})])}),apis:{setGroups:(t,n)=>{Bh.getState(TD.getCoupled(t,"toolbarSandbox")).each((r=>{aU(t,r,e,o.layouts,n)}))},reposition:t=>{Bh.getState(TD.getCoupled(t,"toolbarSandbox")).each((n=>{sU(t,n,e,o.layouts)}))},toggle:e=>{rU(e,n)},getToolbar:e=>Bh.getState(TD.getCoupled(e,"toolbarSandbox")),isOpen:e=>Bh.isOpen(TD.getCoupled(e,"toolbarSandbox"))}}),cU=Eb({name:"FloatingToolbarButton",factory:lU,configFields:oU(),partFields:nU(),apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),dU=k([Fs("items"),_d(["itemSelector"]),ff("tgroupBehaviours",[Gx])]),uU=k([Jf({name:"items",unit:"item"})]),mU=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:vf(e.tgroupBehaviours,[Gx.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}),gU=Eb({name:"ToolbarGroup",configFields:dU(),partFields:uU(),factory:mU}),pU=e=>W(e,(e=>Kc(e))),hU=(e,t,o)=>{JL(e,o,(n=>{o.overflowGroups.set(n),t.getOpt(e).each((e=>{cU.setGroups(e,pU(n))}))}))},fU=(e,t,o,n)=>{const r=IS(cU.sketch({fetch:()=>RD.nu((t=>{t(pU(e.overflowGroups.get()))})),layouts:{onLtr:()=>[cu,lu],onRtl:()=>[lu,cu],onBottomLtr:()=>[uu,du],onBottomRtl:()=>[du,uu]},getBounds:o.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:n["overflow-button"](),toolbar:n.overflow()},onToggled:(t,o)=>e[o?"onOpened":"onClosed"](t)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:vf(e.splitToolbarBehaviours,[TD.config({others:{overflowGroup:()=>gU.sketch({...n["overflow-group"](),items:[r.asSpec()]})}})]),apis:{setGroups:(t,o)=>{e.builtGroups.set(W(o,t.getSystem().build)),hU(t,r,e)},refresh:t=>hU(t,r,e),toggle:e=>{r.getOpt(e).each((e=>{cU.toggle(e)}))},isOpen:e=>r.getOpt(e).map(cU.isOpen).getOr(!1),reposition:e=>{r.getOpt(e).each((e=>{cU.reposition(e)}))},getOverflow:e=>r.getOpt(e).bind(cU.getToolbar)},domModification:{attributes:{role:"group"}}}},bU=Eb({name:"SplitFloatingToolbar",configFields:QL(),partFields:eU(),factory:fU,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),vU=k([_d(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ed("onOpened"),Ed("onClosed")].concat(ZL())),yU=k([Kf({factory:hz,schema:uz(),name:"primary"}),Kf({factory:hz,schema:uz(),name:"overflow",overrides:e=>({toolbarBehaviours:Fu([oL.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:t=>{cb(t,e,"overflow-button").each((e=>{Rw.off(e),fw.focus(e)})),e.onClosed(t)},onGrown:t=>{Gx.focusIn(t),e.onOpened(t)},onStartGrow:t=>{cb(t,e,"overflow-button").each(Rw.on)}}),Gx.config({mode:"acyclic",onEscape:t=>(cb(t,e,"overflow-button").each(fw.focus),F.some(!0))})])})}),Xf({name:"overflow-button",overrides:e=>({buttonBehaviours:Fu([Rw.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),Xf({name:"overflow-group"})]),xU=(e,t)=>cb(e,t,"overflow").map(oL.hasGrown).getOr(!1),wU=(e,t)=>{cb(e,t,"overflow-button").bind((()=>cb(e,t,"overflow"))).each((o=>{SU(e,t),oL.toggleGrow(o)}))},SU=(e,t)=>{cb(e,t,"overflow").each((o=>{JL(e,t,(e=>{const t=W(e,(e=>Kc(e)));hz.setGroups(o,t)})),cb(e,t,"overflow-button").each((e=>{oL.hasGrown(o)&&Rw.on(e)})),oL.refresh(o)}))},kU=(e,t,o,n)=>{const r="alloy.toolbar.toggle",s=(t,o)=>{const n=W(o,t.getSystem().build);e.builtGroups.set(n)};return{uid:e.uid,dom:e.dom,components:t,behaviours:vf(e.splitToolbarBehaviours,[TD.config({others:{overflowGroup:e=>gU.sketch({...n["overflow-group"](),items:[FS.sketch({...n["overflow-button"](),action:t=>{_i(e,r)}})]})}}),iw("toolbar-toggle-events",[Vi(r,(t=>{wU(t,e)}))])]),apis:{setGroups:(t,o)=>{s(t,o),SU(t,e)},refresh:t=>SU(t,e),toggle:t=>wU(t,e),isOpen:t=>xU(t,e)},domModification:{attributes:{role:"group"}}}},CU=Eb({name:"SplitSlidingToolbar",configFields:vU(),partFields:yU(),factory:kU,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),OU=e=>{const t=e.title.fold((()=>({})),(e=>({attributes:{title:e}})));return{dom:{tag:"div",classes:["tox-toolbar__group"],...t},components:[gU.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Fu([ZM.config({}),fw.config({})])}},_U=e=>gU.sketch(OU(e)),TU=(e,t)=>{const o=qi((t=>{const o=W(e.initGroups,_U);hz.setGroups(t,o)}));return Fu([oT.toolbarButton(e.providers.isDisabled),J_(),Gx.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),iw("toolbar-events",[o])])},EU=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":OU({title:F.none(),items:[]}),"overflow-button":RN({name:"more",icon:F.some("more-drawer"),enabled:!0,tooltip:F.some("More..."),primary:!1,buttonType:F.none(),borderless:!1},F.none(),e.providers)},splitToolbarBehaviours:TU(e,t)}},DU=e=>{const t=EU(e),o=4,n=bU.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return bU.sketch({...t,lazySink:e.getSink,getOverflowBounds:()=>{const t=e.moreDrawerData.lazyHeader().element,n=or(t),r=Dt(t),s=or(r),a=Math.max(r.dom.scrollHeight,s.height);return er(n.x+o,s.y,n.width-2*o,a)},parts:{...t.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}},components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>e.onToggled(t,!0),onClosed:t=>e.onToggled(t,!1)})},MU=e=>{const t=CU.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=CU.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),n=EU(e);return CU.sketch({...n,components:[t,o],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>{t.getSystem().broadcastOn([Qz()],{type:"opened"}),e.onToggled(t,!0)},onClosed:t=>{t.getSystem().broadcastOn([Qz()],{type:"closed"}),e.onToggled(t,!1)}})},AU=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return hz.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===JS.scrolling?["tox-toolbar--scrolling"]:[])},components:[hz.parts.groups({})],toolbarBehaviours:TU(e,t)})},BU=[Vs("type",["button"]),hO,na("buttonType","secondary",["primary","secondary"]),zs("onAction")],FU=Es("type",{button:BU}),IU=rs([ia("buttons",[],FU),zs("onShow"),zs("onHide")]),RU=e=>Cs("view",IU,e),NU=(e,t)=>HN({text:e.text,enabled:!0,primary:!1,name:"name",icon:F.none(),borderless:!1,buttonType:F.some(e.buttonType)},(t=>{e.onAction()}),t),VU=e=>{const t=W(e.buttons,(t=>NU(t,e.providers)));return{uid:e.uid,dom:{tag:"div",classes:["tox-view__header"]},components:[UM.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),UM.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:t})]}},HU=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}}),zU=(e,t,o,n)=>{const r={getPane:t=>oz.getPart(t,e,"pane"),getOnShow:t=>e.viewConfig.onShow,getOnHide:t=>e.viewConfig.onHide};return{uid:e.uid,dom:e.dom,components:t,apis:r}};var PU=Eb({name:"silver.View",configFields:[Fs("viewConfig")],partFields:[Yf({factory:{sketch:VU},schema:[Fs("buttons"),Fs("providers")],name:"header"}),Yf({factory:{sketch:HU},schema:[],name:"pane"})],factory:zU,apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});const LU=(e,t,o)=>we(t,((t,n)=>{const r=Os(RU(t));return e.slot(n,PU.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:r,components:[...r.buttons.length>0?[PU.parts.header({buttons:r.buttons,providers:o})]:[],PU.parts.pane({})]}))})),UU=(e,t)=>cL.sketch((o=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:LU(o,e,t),slotBehaviours:F_.unnamedEvents([qi((e=>cL.hideAllSlots(e)))])}))),WU=e=>J(cL.getSlotNames(e),(t=>cL.isShowing(e,t))),jU=e=>{const t=e.element;co(t,"display","none"),eo(t,"aria-hidden","true")},GU=e=>{const t=e.element;vo(t,"display"),so(t,"aria-hidden")},$U=e=>({getContainer:k(e)}),qU=(e,t,o)=>{cL.getSlot(e,t).each((e=>{PU.getPane(e).each((t=>{const n=o(e);n($U(t.element.dom))}))}))},KU=(e,t)=>qU(e,t,PU.getOnShow),XU=(e,t)=>qU(e,t,PU.getOnHide),YU=(e,t)=>{const o=(e,o)=>{sw.set(e,[UU(o,t.backstage.shared.providers)])},n=e=>Fb.getCurrent(e).bind(WU),r=(e,t,o,n)=>Fb.getCurrent(e).exists((r=>{const s=WU(r),a=s.exists((e=>n===e)),i=cL.getSlot(r,n).isSome();return i&&(cL.hideAllSlots(r),a?(jU(e),t()):(o(),GU(e),cL.showSlot(r,n),KU(r,n)),s.each((e=>XU(r,e)))),i})),s={setViews:o,whichView:n,toggleView:r};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:Fu([sw.config({}),Fb.config({find:e=>{const t=sw.contents(e);return le(t)}})]),apis:s}};var JU=Tb({factory:YU,name:"silver.ViewWrapper",configFields:[Fs("backstage")],apis:{setViews:(e,t,o)=>e.setViews(t,o),toggleView:(e,t,o,n,r)=>e.toggleView(t,o,n,r),whichView:(e,t)=>e.whichView(t)}});const ZU=(e,t,o)=>{let n=!1;const r={getSocket:t=>oz.getPart(t,e,"socket"),setSidebar:(t,o,n)=>{oz.getPart(t,e,"sidebar").each((e=>fL(e,o,n)))},toggleSidebar:(t,o)=>{oz.getPart(t,e,"sidebar").each((e=>bL(e,o)))},whichSidebar:t=>oz.getPart(t,e,"sidebar").bind(vL).getOrNull(),getHeader:t=>oz.getPart(t,e,"header"),getToolbar:t=>oz.getPart(t,e,"toolbar"),setToolbar:(t,o)=>{oz.getPart(t,e,"toolbar").each((e=>{const t=W(o,_U);e.getApis().setGroups(e,t)}))},setToolbars:(t,o)=>{oz.getPart(t,e,"multiple-toolbar").each((e=>{const t=W(o,(e=>W(e,_U)));dz.setItems(e,t)}))},refreshToolbar:t=>{const o=oz.getPart(t,e,"toolbar");o.each((e=>e.getApis().refresh(e)))},toggleToolbarDrawer:t=>{oz.getPart(t,e,"toolbar").each((e=>{Fe(e.getApis().toggle,(t=>t(e)))}))},isToolbarDrawerToggled:t=>oz.getPart(t,e,"toolbar").bind((e=>F.from(e.getApis().isOpen).map((t=>t(e))))).getOr(!1),getThrobber:t=>oz.getPart(t,e,"throbber"),focusToolbar:t=>{const o=oz.getPart(t,e,"toolbar").orThunk((()=>oz.getPart(t,e,"multiple-toolbar")));o.each((e=>{Gx.focusIn(e)}))},setMenubar:(t,o)=>{oz.getPart(t,e,"menubar").each((e=>{CP.setMenus(e,o)}))},focusMenubar:t=>{oz.getPart(t,e,"menubar").each((e=>{CP.focus(e)}))},setViews:(t,o)=>{oz.getPart(t,e,"viewWrapper").each((e=>{JU.setViews(e,o)}))},toggleView:(t,o)=>oz.getPart(t,e,"viewWrapper").exists((e=>JU.toggleView(e,(()=>r.showMainView(t)),(()=>r.hideMainView(t)),o))),whichView:t=>oz.getPart(t,e,"viewWrapper").bind(JU.whichView).getOrNull(),hideMainView:t=>{n=r.isToolbarDrawerToggled(t),n&&r.toggleToolbarDrawer(t),oz.getPart(t,e,"editorContainer").each((e=>{const t=e.element;co(t,"display","none"),eo(t,"aria-hidden","true")}))},showMainView:t=>{n&&r.toggleToolbarDrawer(t),oz.getPart(t,e,"editorContainer").each((e=>{const t=e.element;vo(t,"display"),so(t,"aria-hidden")}))}};return{uid:e.uid,dom:e.dom,components:t,apis:r,behaviours:e.behaviours}},QU=nz.optional({factory:CP,name:"menubar",schema:[Fs("backstage")]}),eW=e=>e.type===JS.sliding?MU:e.type===JS.floating?DU:AU,tW=nz.optional({factory:{sketch:e=>dz.sketch({uid:e.uid,dom:e.dom,listBehaviours:Fu([Gx.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>AU({type:e.type,uid:cl("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),F.some(!0))}),setupItem:(e,t,o,n)=>{hz.setGroups(t,o)},shell:!0})},name:"multiple-toolbar",schema:[Fs("dom"),Fs("onEscape")]}),oW=nz.optional({factory:{sketch:e=>{const t=eW(e),o={type:e.type,uid:e.uid,onEscape:()=>(e.onEscape(),F.some(!0)),onToggled:(t,o)=>e.onToolbarToggled(o),cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes};return t(o)}},name:"toolbar",schema:[Fs("dom"),Fs("onEscape"),Fs("getSink")]}),nW=nz.optional({factory:{sketch:hP},name:"header",schema:[Fs("dom")]}),rW=nz.optional({factory:{sketch:TP},name:"promotion",schema:[Fs("dom")]}),sW=nz.optional({name:"socket",schema:[Fs("dom")]}),aW=nz.optional({factory:{sketch:wL},name:"sidebar",schema:[Fs("dom")]}),iW=nz.optional({factory:{sketch:NL},name:"throbber",schema:[Fs("dom")]}),lW=nz.optional({factory:JU,name:"viewWrapper",schema:[Fs("backstage")]}),cW=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components}),dW=nz.optional({factory:{sketch:cW},name:"editorContainer",schema:[]});var uW=Eb({name:"OuterContainer",factory:ZU,configFields:[Fs("dom"),Fs("behaviours")],partFields:[nW,QU,oW,tW,sW,aW,rW,iW,lW,dW],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,o,n)=>{e.setSidebar(t,o,n)},toggleSidebar:(e,t,o)=>{e.toggleSidebar(t,o)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,o)=>{e.setToolbar(t,o)},setToolbars:(e,t,o)=>{e.setToolbars(t,o)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,o)=>{e.setMenubar(t,o)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,o)=>{e.setViews(t,o)},toggleView:(e,t,o)=>e.toggleView(t,o),whichView:(e,t)=>e.whichView(t)}});const mW="file edit view insert format tools table help",gW={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},pW=(e,t,o)=>{const n=bk(o).split(/[ ,]/);return{text:e.title,getItems:()=>ee(e.items,(e=>{const o=e.toLowerCase();return 0===o.trim().length||P(n,(e=>e===o))?[]:"separator"===o||"|"===o?[{type:"separator"}]:t.menuItems[o]?[t.menuItems[o]]:[]}))}},hW=e=>e.split(" "),fW=(e,t)=>{const o={...gW,...t.menus},n=me(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?hW(mW):hW(!1===t.menubar?"":t.menubar),s=q(r,(e=>{const o=Oe(gW,e);return n?o||Ce(t.menus,e).exists((e=>Oe(e,"items"))):o})),a=W(s,(n=>{const r=o[n];return pW({title:r.title,items:hW(r.items)},t,e)}));return q(a,(e=>{const t=e=>i(e)||"separator"!==e.type;return e.getItems().length>0&&P(e.getItems(),t)}))},bW=e=>{const t=()=>{e._skinLoaded=!0,nE(e)};return()=>{e.initialized?t():e.on("init",t)}},vW=(e,t)=>()=>rE(e,{message:t}),yW=(e,t,o)=>(e.on("remove",(()=>o.unload(t))),o.load(t)),xW=(e,t)=>{const o=t+"/skin.min.css";return yW(e,o,e.ui.styleSheetLoader)},wW=(e,t)=>{const o=Gt(Qe.fromDom(e.getElement()));if(o){const o=t+"/skin.shadowdom.min.css";return yW(e,o,ek.DOM.styleSheetLoader)}return Promise.resolve()},SW=(e,t)=>{const o=Wk(t);o&&t.contentCSS.push(o+(e?"/content.inline":"/content")+".min.css"),!Lk(t)&&i(o)?Promise.all([xW(t,o),wW(t,o)]).then(bW(t),vW(t,"Skin could not be loaded")):bW(t)()},kW=_(SW,!1),CW=_(SW,!0),OW=(e,t)=>o=>{const n=xm(),r=()=>{o.setActive(e.formatter.match(t));const r=e.formatter.formatChanged(t,o.setActive);n.set(r)};return e.initialized?r():e.once("init",r),()=>{e.off("init",r),n.clear()}},_W=(e,t,o)=>n=>{const r=()=>o(n),s=()=>{o(n),e.on(t,r)};return e.initialized?s():e.once("init",s),()=>{e.off("init",s),e.off(t,r)}},TW=e=>t=>()=>{e.undoManager.transact((()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)}))},EW=(e,t)=>()=>e.execCommand(t),DW=(e,t,o)=>{const n=(e,n,s,a)=>{const i=t.shared.providers.translate(e.title);if("separator"===e.type)return F.some({type:"separator",text:i});if("submenu"===e.type){const t=ee(e.getStyleItems(),(e=>r(e,n,a)));return 0===n&&t.length<=0?F.none():F.some({type:"nestedmenuitem",text:i,enabled:t.length>0,getSubmenuItems:()=>ee(e.getStyleItems(),(e=>r(e,n,a)))})}return F.some({type:"togglemenuitem",text:i,icon:e.icon,active:e.isSelected(a),enabled:!s,onAction:o.onAction(e),...e.getStylePreview().fold((()=>({})),(e=>({meta:{style:e}})))})},r=(e,t,r)=>{const s="formatter"===e.type&&o.isInvalid(e);return 0===t?s?[]:n(e,t,!1,r).toArray():n(e,t,s,r).toArray()},s=e=>{const t=o.getCurrentValue(),n=o.shouldHide?0:1;return ee(e,(e=>r(e,n,t)))},a=(e,t)=>(o,n)=>{const r=t(),a=s(r),i=DR(a,lC.CLOSE_ON_EXECUTE,e,{isHorizontalMenu:!1,search:F.none()});n(i)};return{validateItems:s,getFetch:a}},MW=(e,t,o)=>{const n=o.dataset,r="basic"===n.type?()=>W(n.data,(e=>lH(e,o.isSelectedFor,o.getPreviewFor))):n.getData;return{items:DW(e,t,o),getStyleItems:r}},AW=(e,t,o)=>{const{items:n,getStyleItems:r}=MW(e,t,o),s=e=>({getComponent:k(e)}),a=_W(e,"NodeChange",(e=>{const t=e.getComponent();o.updateText(t)}));return vR({text:o.icon.isSome()?F.none():o.text,icon:o.icon,tooltip:F.from(o.tooltip),role:F.none(),fetch:n.getFetch(t,r),onSetup:a,getApi:s,columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},BW=e=>W(e,(e=>{let t=e,o=e;const n=e.split("=");return n.length>1&&(t=n[0],o=n[1]),{title:t,format:o}})),FW=e=>({type:"basic",data:e});var IW;(function(e){e[e["SemiColon"]=0]="SemiColon",e[e["Space"]=1]="Space"})(IW||(IW={}));const RW=(e,t)=>t===IW.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),NW=(e,t,o)=>{const n=e.options.get(t),r=BW(RW(n,o));return{type:"basic",data:r}},VW=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],HW=e=>{const t=()=>J(VW,(t=>e.formatter.match(t.format))),o=t=>()=>e.formatter.match(t),n=e=>F.none,r=e=>{const o=t(),n=o.fold(k("left"),(e=>e.title.toLowerCase()));Ti(e,bR,{icon:`align-${n}`})},s=FW(VW),a=t=>()=>J(VW,(e=>e.format===t.format)).each((t=>e.execCommand(t.command)));return{tooltip:"Align",text:F.none(),icon:F.some("align-left"),isSelectedFor:o,getCurrentValue:F.none,getPreviewFor:n,onAction:a,updateText:r,dataset:s,shouldHide:!1,isInvalid:t=>!e.formatter.canApply(t.format)}},zW=(e,t)=>AW(e,t,HW(e)),PW=(e,t)=>{const o=MW(e,t,HW(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},LW=(e,t)=>{const o=t(),n=W(o,(e=>e.format));return F.from(e.formatter.closest(n)).bind((e=>J(o,(t=>t.format===e)))).orThunk((()=>Ie(e.formatter.match("p"),{title:"Paragraph",format:"p"})))},UW=e=>{const t="Paragraph",o=t=>()=>e.formatter.match(t),n=t=>()=>{const o=e.formatter.get(t);return o?F.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):F.none()},r=o=>{const n=LW(e,(()=>s.data)),r=n.fold(k(t),(e=>e.title));Ti(o,fR,{text:r})},s=NW(e,"block_formats",IW.SemiColon);return{tooltip:"Blocks",text:F.some(t),icon:F.none(),isSelectedFor:o,getCurrentValue:F.none,getPreviewFor:n,onAction:TW(e),updateText:r,dataset:s,shouldHide:!1,isInvalid:t=>!e.formatter.canApply(t.format)}},WW=(e,t)=>AW(e,t,UW(e)),jW=(e,t)=>{const o=MW(e,t,UW(e));e.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},GW=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],$W=e=>{const t=e.split(/\s*,\s*/);return W(t,(e=>e.replace(/^['"]+|['"]+$/g,"")))},qW=e=>{const t=()=>{const t=$W(e.toLowerCase());return te(GW,(e=>t.indexOf(e.toLowerCase())>-1))};return 0===e.indexOf("-apple-system")&&t()},KW=e=>{const t="System Font",o=()=>{const o=e=>e?$W(e)[0]:"",n=e.queryCommandValue("FontName"),r=l.data,s=n?n.toLowerCase():"",a=J(r,(e=>{const t=e.format;return t.toLowerCase()===s||o(t).toLowerCase()===o(s).toLowerCase()})).orThunk((()=>Ie(qW(s),{title:t,format:s})));return{matchOpt:a,font:n}},n=e=>t=>t.exists((t=>t.format===e)),r=()=>{const{matchOpt:e}=o();return e},s=e=>()=>F.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}}),a=t=>()=>{e.undoManager.transact((()=>{e.focus(),e.execCommand("FontName",!1,t.format)}))},i=e=>{const{matchOpt:t,font:n}=o(),r=t.fold(k(n),(e=>e.title));Ti(e,fR,{text:r})},l=NW(e,"font_family_formats",IW.SemiColon);return{tooltip:"Fonts",text:F.some(t),icon:F.none(),isSelectedFor:n,getCurrentValue:r,getPreviewFor:s,onAction:a,updateText:i,dataset:l,shouldHide:!1,isInvalid:M}},XW=(e,t)=>AW(e,t,KW(e)),YW=(e,t)=>{const o=MW(e,t,KW(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},JW={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},ZW={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},QW=(e,t)=>{const o=Math.pow(10,t);return Math.round(e*o)/o},ej=(e,t)=>/[0-9.]+px$/.test(e)?QW(72*parseInt(e,10)/96,t||0)+"pt":Ce(ZW,e).getOr(e),tj=e=>Ce(JW,e).getOr(""),oj=e=>{const t=()=>{let t=F.none();const o=i.data,n=e.queryCommandValue("FontSize");if(n)for(let e=3;t.isNone()&&e>=0;e--){const r=ej(n,e),s=tj(r);t=J(o,(e=>e.format===n||e.format===r||e.format===s))}return{matchOpt:t,size:n}},o=e=>t=>t.exists((t=>t.format===e)),n=()=>{const{matchOpt:e}=t();return e},r=k(F.none),s=t=>()=>{e.undoManager.transact((()=>{e.focus(),e.execCommand("FontSize",!1,t.format)}))},a=e=>{const{matchOpt:o,size:n}=t(),r=o.fold(k(n),(e=>e.title));Ti(e,fR,{text:r})},i=NW(e,"font_size_formats",IW.Space);return{tooltip:"Font sizes",text:F.some("12pt"),icon:F.none(),isSelectedFor:o,getPreviewFor:r,getCurrentValue:n,onAction:s,updateText:a,dataset:i,shouldHide:!1,isInvalid:M}},nj=(e,t)=>AW(e,t,oj(e)),rj=(e,t)=>{const o=MW(e,t,oj(e));e.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},sj=(e,t)=>{const o="Paragraph",n=t=>()=>e.formatter.match(t),r=t=>()=>{const o=e.formatter.get(t);return void 0!==o?F.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):F.none()},s=t=>{const n=e=>JV(e)?ee(e.items,n):ZV(e)?[{title:e.title,format:e.format}]:[],r=ee(aH(e),n),s=LW(e,k(r)),a=s.fold(k(o),(e=>e.title));Ti(t,fR,{text:a})};return{tooltip:"Formats",text:F.some(o),icon:F.none(),isSelectedFor:n,getCurrentValue:F.none,getPreviewFor:r,onAction:TW(e),updateText:s,shouldHide:hk(e),isInvalid:t=>!e.formatter.canApply(t.format),dataset:t}},aj=(e,t)=>{const o={type:"advanced",...t.styles};return AW(e,t,sj(e,o))},ij=(e,t)=>{const o={type:"advanced",...t.styles},n=MW(e,t,sj(e,o));e.ui.registry.addNestedMenuItem("styles",{text:"Formats",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},lj=(e,t)=>{const o=(o,n)=>{e.updateState.each((e=>{const r=e(o,n);t.set(r)})),e.renderComponents.each((r=>{const s=r(n,t.get()),a=e.reuseDom?qx:$x;a(o,s)}))};return Fi([Vi(ri(),((t,n)=>{const r=n;if(!r.universal){const n=e.channel;z(r.channels,n)&&o(t,r.data)}})),qi(((t,n)=>{e.initialData.each((e=>{o(t,e)}))}))])};var cj=Object.freeze({__proto__:null,events:lj});const dj=(e,t,o)=>o;var uj=Object.freeze({__proto__:null,getState:dj}),mj=[Fs("channel"),js("renderComponents"),js("updateState"),js("initialData"),ra("reuseDom",!0)];const gj=()=>{const e=ca(F.none()),t=()=>e.set(F.none()),o=()=>e.get().getOr("none");return{readState:o,get:e.get,set:e.set,clear:t}};var pj=Object.freeze({__proto__:null,init:gj});const hj=Ru({fields:mj,name:"reflecting",active:cj,apis:uj,state:pj}),fj=k([Fs("toggleClass"),Fs("fetch"),Md("onExecute"),Qs("getHotspot",F.some),Qs("getAnchorOverrides",k({})),ng(),Md("onItemExecute"),js("lazySink"),Fs("dom"),Ed("onOpen"),ff("splitDropdownBehaviours",[TD,Gx,fw]),Qs("matchWidth",!1),Qs("useMinWidth",!1),Qs("eventOrder",{}),js("role")].concat(XD())),bj=Kf({factory:FS,schema:[Fs("dom")],name:"arrow",defaults:()=>({buttonBehaviours:Fu([fw.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(Ei)},buttonBehaviours:Fu([Rw.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),vj=Kf({factory:FS,schema:[Fs("dom")],name:"button",defaults:()=>({buttonBehaviours:Fu([fw.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each((o=>{e.onExecute(o,t)}))}})}),yj=k([bj,vj,Yf({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[Fs("text")],name:"aria-descriptor"}),Xf({schema:[Od()],name:"menu",defaults:e=>({onExecute:(t,o)=>{t.getSystem().getByUid(e.uid).each((n=>{e.onItemExecute(n,t,o)}))}})}),VD()]),xj=(e,t,o,n)=>{const r=e=>{Fb.getCurrent(e).each((e=>{vv.highlightFirst(e),Gx.focusIn(e)}))},s=t=>{const o=r;WD(e,C,t,n,o,wS.HighlightMenuAndItem).get(y)},a=e=>(s(e),F.some(!0)),i=t=>{const o=db(t,e,"button");return Ei(o),F.some(!0)},l={...Fi([qi(((t,o)=>{const n=cb(t,e,"aria-descriptor");n.each((e=>{const o=cl("aria");eo(e.element,"id",o),eo(t.element,"aria-describedby",o)}))}))]),...Vw(F.some(s))},c={repositionMenus:e=>{Rw.isOn(e)&&KD(e)}};return{uid:e.uid,dom:e.dom,components:t,apis:c,eventOrder:{...e.eventOrder,[si()]:["disabling","toggling","alloy.base.behaviour"]},events:l,behaviours:vf(e.splitDropdownBehaviours,[TD.config({others:{sandbox:t=>{const o=db(t,e,"arrow"),n={onOpen:()=>{Rw.on(o),Rw.on(t)},onClose:()=>{Rw.off(o),Rw.off(t)}};return qD(e,t,n)}}}),Gx.config({mode:"special",onSpace:i,onEnter:i,onDown:a}),fw.config({}),Rw.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},wj=Eb({name:"SplitDropdown",configFields:fj(),partFields:yj(),factory:xj,apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),Sj=e=>({isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t)}),kj=e=>({setActive:t=>{Rw.set(e,t)},isActive:()=>Rw.isOn(e),isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t)}),Cj=(e,t)=>e.map((e=>({"aria-label":t.translate(e),title:t.translate(e)}))).getOr({}),Oj=cl("focus-button"),_j=(e,t,o,n,r,s)=>({dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:Cj(o,s)},components:lT([e.map((e=>gR(e,s.icons))),t.map((e=>hR(e,"tox-tbtn",s)))]),eventOrder:{[Va()]:["focusing","alloy.base.behaviour","common-button-display-events"]},buttonBehaviours:Fu([oT.toolbarButton(s.isDisabled),J_(),iw("common-button-display-events",[Vi(Va(),((e,t)=>{t.event.prevent(),_i(e,Oj)}))])].concat(n.map((o=>hj.config({channel:o,initialData:{icon:e,text:t},renderComponents:(e,t)=>lT([e.icon.map((e=>gR(e,s.icons))),e.text.map((e=>hR(e,"tox-tbtn",s)))])}))).toArray()).concat(r.getOr([])))}),Tj=(e,t,o,n)=>{const r=t.shared;return cU.sketch({lazySink:r.getSink,fetch:()=>RD.nu((t=>{t(W(o(e.items),_U))})),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:_j(e.icon,e.text,e.tooltip,F.none(),F.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n}}}})},Ej=(e,t,o)=>{const n=ca(y),r=_j(e.icon,e.text,e.tooltip,F.none(),F.none(),o);return FS.sketch({dom:r.dom,components:r.components,eventOrder:uR,buttonBehaviours:Fu([iw("toolbar-button-events",[dR({onAction:e.onAction,getApi:t.getApi}),rT(t,n),sT(t,n)]),oT.toolbarButton((()=>!e.enabled||o.isDisabled())),J_()].concat(t.toolbarButtonBehaviours))})},Dj=(e,t)=>Mj(e,t,[]),Mj=(e,t,o)=>Ej(e,{toolbarButtonBehaviours:o.length>0?[iw("toolbarButtonWith",o)]:[],getApi:Sj,onSetup:e.onSetup},t),Aj=(e,t)=>Bj(e,t,[]),Bj=(e,t,o)=>Ej(e,{toolbarButtonBehaviours:[sw.config({}),Rw.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(o.length>0?[iw("toolbarToggleButtonWith",o)]:[]),getApi:kj,onSetup:e.onSetup},t),Fj=(e,t,o)=>n=>RD.nu((e=>t.fetch(e))).map((r=>F.from(gM(_r(KE(cl("menu-value"),r,(o=>{t.onItemAction(e(n),o)}),t.columns,t.presets,lC.CLOSE_ON_EXECUTE,t.select.getOr(M),o),{movement:YE(t.columns,t.presets),menuBehaviours:F_.unnamedEvents("auto"!==t.columns?[]:[qi(((e,o)=>{M_(e,4,DC(t.presets)).each((({numRows:t,numColumns:o})=>{Gx.setGridSize(e,t,o)}))}))])}))))),Ij=(e,t)=>{const o=cl("channel-update-split-dropdown-display"),n=e=>({isEnabled:()=>!Zb.isDisabled(e),setEnabled:t=>Zb.set(e,!t),setIconFill:(t,o)=>{nd(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((e=>{eo(e,"fill",o)}))},setActive:t=>{eo(e.element,"aria-pressed",t),nd(e.element,"span").each((o=>{e.getSystem().getByDom(o).each((e=>Rw.set(e,t)))}))},isActive:()=>nd(e.element,"span").exists((t=>e.getSystem().getByDom(t).exists(Rw.isOn)))}),r=ca(y),s={getApi:n,onSetup:e.onSetup};return wj.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...Cj(e.tooltip,t.providers)}},onExecute:t=>{e.onAction(n(t))},onItemExecute:(e,t,o)=>{},splitDropdownBehaviours:Fu([oT.splitButton(t.providers.isDisabled),J_(),iw("split-dropdown-events",[Vi(Oj,fw.focus),rT(s,r),sT(s,r)]),AA.config({})]),eventOrder:{[fi()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:Fj(n,e,t.providers),parts:{menu:RC(!1,e.columns,e.presets)},components:[wj.parts.button(_j(e.icon,e.text,F.none(),F.some(o),F.some([Rw.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),wj.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:LS("chevron-down",t.providers.icons)},buttonBehaviours:Fu([oT.splitButton(t.providers.isDisabled),J_(),jS()])}),wj.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},Rj=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Nj=(e,t)=>(o,n,r)=>{const s=e(o).mapError((e=>Ts(e))).getOrDie();return t(s,n,r)},Vj={button:Nj(KO,((e,t)=>Dj(e,t.shared.providers))),togglebutton:Nj(JO,((e,t)=>Aj(e,t.shared.providers))),menubutton:Nj(xP,((e,t)=>BN(e,"tox-tbtn",t,F.none()))),splitbutton:Nj(SP,((e,t)=>Ij(e,t.shared))),grouptoolbarbutton:Nj(bP,((e,t,o)=>{const n=o.ui.registry.getAll().buttons,r=e=>Gj(o,{buttons:n,toolbar:e,allowToolbarGroups:!1},t,F.none()),s={[tg]:t.shared.header.isPositionedAtTop()?eg.TopToBottom:eg.BottomToTop};switch(vk(o)){case JS.floating:return Tj(e,t,r,s);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}))},Hj=(e,t,o)=>Ce(Vj,e.type).fold((()=>(console.error("skipping button defined by",e),F.none())),(n=>F.some(n(e,t,o)))),zj={styles:aj,fontsize:nj,fontfamily:XW,blocks:WW,align:zW},Pj=e=>{const t=W(Rj,(t=>{const o=q(t.items,(t=>Oe(e,t)||Oe(zj,t)));return{name:t.name,items:o}}));return q(t,(e=>e.items.length>0))},Lj=e=>{const t=e.split("|");return W(t,(e=>({items:e.trim().split(" ")})))},Uj=e=>v(e,(e=>Oe(e,"name")&&Oe(e,"items"))),Wj=e=>{const t=e.toolbar,o=e.buttons;return!1===t?[]:void 0===t||!0===t?Pj(o):i(t)?Lj(t):Uj(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},jj=(e,t,o,n,r,s)=>Ce(t,o.toLowerCase()).orThunk((()=>s.bind((e=>ue(e,(e=>Ce(t,e+o.toLowerCase()))))))).fold((()=>Ce(zj,o.toLowerCase()).map((t=>t(e,r)))),(t=>"grouptoolbarbutton"!==t.type||n?Hj(t,r,e):(console.warn(`Ignoring the '${o}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),F.none()))),Gj=(e,t,o,n)=>{const r=Wj(t),s=W(r,(r=>{const s=ee(r.items,(r=>0===r.trim().length?[]:jj(e,t.buttons,r,t.allowToolbarGroups,o,n).toArray()));return{title:F.from(e.translate(r.name)),items:s}}));return q(s,(e=>e.items.length>0))},$j=(e,t,o,n)=>{const r=t.mainUi.outerContainer,s=o.toolbar,a=o.buttons;if(v(s,i)){const t=s.map((t=>{const r={toolbar:t,buttons:a,allowToolbarGroups:o.allowToolbarGroups};return Gj(e,r,n,F.none())}));uW.setToolbars(r,t)}else uW.setToolbar(r,Gj(e,o,n,F.none()))},qj=Cn(),Kj=qj.os.isiOS()&&qj.os.version.major<=12,Xj=(e,t)=>{const{uiMotherships:o}=t,n=e.dom;let r=e.getWin();const s=e.getDoc().documentElement,a=ca(_o(r.innerWidth,r.innerHeight)),i=ca(_o(s.offsetWidth,s.offsetHeight)),l=()=>{const t=a.get();t.left===r.innerWidth&&t.top===r.innerHeight||(a.set(_o(r.innerWidth,r.innerHeight)),aE(e))},c=()=>{const t=e.getDoc().documentElement,o=i.get();o.left===t.offsetWidth&&o.top===t.offsetHeight||(i.set(_o(t.offsetWidth,t.offsetHeight)),aE(e))},d=t=>{iE(e,t)};n.bind(r,"resize",l),n.bind(r,"scroll",d);const u=Cm(Qe.fromDom(e.getBody()),"load",c);e.on("hide",(()=>{j(o,(e=>{co(e.element,"display","none")}))})),e.on("show",(()=>{j(o,(e=>{vo(e.element,"display")}))})),e.on("NodeChange",c),e.on("remove",(()=>{u.unbind(),n.unbind(r,"resize",l),n.unbind(r,"scroll",d),r=null}))},Yj=(e,t)=>{ch(e,t.dialogUi.mothership)},Jj=(e,t,o,n,r)=>{const{mainUi:s,uiMotherships:a}=t,i=ca(0),l=s.outerContainer;kW(e);const c=Qe.fromDom(r.targetNode),d=jt(Wt(c));dh(c,s.mothership),Yj(d,t),e.on("PostRender",(()=>{uW.setSidebar(l,o.sidebar,zk(e)),$j(e,t,o,n),i.set(e.getWin().innerWidth),uW.setMenubar(l,fW(e,o)),uW.setViews(l,o.views),Xj(e,t)}));const m=uW.getSocket(l).getOrDie("Could not find expected socket element");if(Kj){uo(m.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});const t=sN((()=>{e.dispatch("ScrollContent")}),20),o=km(m.element,"scroll",t.throttle);e.on("remove",o.unbind)}Y_(e,t),e.addCommand("ToggleSidebar",((t,o)=>{uW.toggleSidebar(l,o),e.dispatch("ToggleSidebar")})),e.addQueryValueHandler("ToggleSidebar",(()=>{var e;return null!==(e=uW.whichSidebar(l))&&void 0!==e?e:""})),e.addCommand("ToggleView",((t,o)=>{if(uW.toggleView(l,o)){const t=l.element;s.mothership.broadcastOn([Fh()],{target:t}),j(a,(e=>{e.broadcastOn([Fh()],{target:t})})),u(uW.whichView(l))&&(e.focus(),e.nodeChanged())}})),e.addQueryValueHandler("ToggleView",(()=>{var e;return null!==(e=uW.whichView(l))&&void 0!==e?e:""}));const g=vk(e),p=()=>{uW.refreshToolbar(t.mainUi.outerContainer)};g!==JS.sliding&&g!==JS.floating||e.on("ResizeWindow ResizeEditor ResizeContent",(()=>{const t=e.getWin().innerWidth;t!==i.get()&&(p(),i.set(t))}));const h={setEnabled:e=>{X_(t,!e)},isEnabled:()=>!Zb.isDisabled(l)};return{iframeContainer:m.element.dom,editorContainer:l.element.dom,api:h}};var Zj=Object.freeze({__proto__:null,render:Jj});const Qj=e=>{const t=/^[0-9\.]+(|px)$/i;return t.test(""+e)?F.some(parseInt(""+e,10)):F.none()},eG=e=>b(e)?e+"px":e,tG=(e,t,o)=>{const n=t.filter((t=>e<t)),r=o.filter((t=>e>t));return n.or(r).getOr(e)},oG=e=>{const t=ik(e),o=dk(e),n=mk(e);return Qj(t).map((e=>tG(e,o,n)))},nG=e=>{const t=oG(e);return t.getOr(ik(e))},rG=e=>{const t=lk(e),o=ck(e),n=uk(e);return Qj(t).map((e=>tG(e,o,n)))},sG=e=>{const t=rG(e);return t.getOr(lk(e))},{ToolbarLocation:aG,ToolbarMode:iG}=tC,lG=(e,t,o,n,r)=>{const{mainUi:s,uiMotherships:a}=o,i=ek.DOM,l=Yk(e),c=Qk(e),d=uk(e).or(rG(e)),u=n.shared.header,m=u.isPositionedAtTop,g=vk(e),p=g===iG.sliding||g===iG.floating,h=ca(!1),f=()=>h.get()&&!e.removed,b=e=>p?e.fold(k(0),(e=>e.components().length>1?So(e.components()[1].element):0)):0,v=o=>{switch(xk(e)){case aG.auto:const e=uW.getToolbar(s.outerContainer),n=b(e),r=So(o.element)-n,a=tr(t),i=a.y>r;if(i)return"top";{const e=Dt(t),o=Math.max(e.dom.scrollHeight,So(e)),n=a.bottom<o-r;if(n)return"bottom";{const e=nr(),t=e.bottom<a.bottom-r;return t?"bottom":"top"}}case aG.bottom:return"bottom";case aG.top:default:return"top"}},y=e=>{r.on((t=>{Zz.setModes(t,[e]),u.setDockingMode(e);const o=m()?eg.TopToBottom:eg.BottomToTop;eo(t.element,tg,o)}))},x=()=>{r.on((e=>{const o=d.getOrThunk((()=>{const e=Qj(go(Jt(),"margin-left")).getOr(0);return Fo(Jt())-Do(t).left+e}));co(e.element,"max-width",o+"px")}))},w=()=>{r.on((e=>{const o=uW.getToolbar(s.outerContainer),n=b(o),r=tr(t),a=m()?Math.max(r.y-So(e.element)+n,0):r.bottom;uo(s.outerContainer.element,{position:"absolute",top:Math.round(a)+"px",left:Math.round(r.x)+"px"})}))},S=()=>{j(a,(e=>{e.broadcastOn([Ih()],{})}))},C=(e=!1)=>{if(f()){if(l||x(),p&&uW.refreshToolbar(s.outerContainer),l||w(),c){const t=e?Zz.reset:Zz.refresh;r.on(t)}S()}},O=(e=!0)=>{!l&&c&&f()&&r.on((t=>{const o=u.getDockingMode(),n=v(t);n!==o&&(y(n),e&&C(!0))}))},_=()=>{h.set(!0),co(s.outerContainer.element,"display","flex"),i.addClass(e.getBody(),"mce-edit-focus"),j(a,(e=>{vo(e.element,"display")})),O(!1),C()},T=()=>{h.set(!1),co(s.outerContainer.element,"display","none"),i.removeClass(e.getBody(),"mce-edit-focus"),j(a,(e=>{co(e.element,"display","none")}))};return{isVisible:f,isPositionedAtTop:m,show:_,hide:T,update:C,updateMode:O,repositionPopups:S}},cG=(e,t)=>{const o=tr(e);return{pos:t?o.y:o.bottom,bounds:o}},dG=(e,t,o,n)=>{const r=ca(cG(t,o.isPositionedAtTop())),s=n=>{const{pos:s,bounds:a}=cG(t,o.isPositionedAtTop()),{pos:i,bounds:l}=r.get(),c=a.height!==l.height||a.width!==l.width;r.set({pos:s,bounds:a}),c&&aE(e,n),o.isVisible()&&(i!==s?o.update(!0):c&&(o.updateMode(),o.repositionPopups()))};n||(e.on("activate",o.show),e.on("deactivate",o.hide)),e.on("SkinLoaded ResizeWindow",(()=>o.update(!0))),e.on("NodeChange keydown",(e=>{requestAnimationFrame((()=>s(e)))})),e.on("ScrollWindow",(()=>o.updateMode()));const a=xm();a.set(Cm(Qe.fromDom(e.getBody()),"load",(e=>s(e.raw)))),e.on("remove",(()=>{a.clear()}))},uG=(e,t)=>{ch(e,t.dialogUi.mothership)},mG=(e,t,o,n,r)=>{const{mainUi:s}=t,a=wm(),i=Qe.fromDom(r.targetNode),l=lG(e,i,t,n,a),c=kk(e);CW(e);const d=()=>{if(a.isSet())return void l.show();a.set(uW.getHeader(s.outerContainer).getOrDie());const r=Jk(e);ch(r,s.mothership),uG(r,t),$j(e,t,o,n),uW.setMenubar(s.outerContainer,fW(e,o)),l.show(),dG(e,i,l,c),e.nodeChanged()};e.on("show",d),e.on("hide",l.hide),c||(e.on("focus",d),e.on("blur",l.hide)),e.on("init",(()=>{(e.hasFocus()||c)&&d()})),Y_(e,t);const u={show:d,hide:l.hide,setEnabled:e=>{X_(t,!e)},isEnabled:()=>!Zb.isDisabled(s.outerContainer)};return{editorContainer:s.outerContainer.element.dom,api:u}};var gG=Object.freeze({__proto__:null,render:mG});const pG=()=>{const e=wm(),t=wm(),o=wm(),n=t=>{e.set(t)},r=(e,t)=>()=>o.get().bind((e=>t(e.outerContainer))).getOrDie(`Could not find ${e} element in OuterContainer`);return{dialogUi:e,popupUi:t,mainUi:o,getUiMotherships:()=>[...e.get().map((e=>e.mothership)).toArray()],setupDialogUi:n,lazyGetInOuterOrDie:r}},hG="contexttoolbar-show",fG="contexttoolbar-hide",bG=e=>({hide:()=>_i(e,ci()),getValue:()=>hf.getValue(e)}),vG=(e,t)=>Vi(cR,((o,n)=>{const r=e.get(o),s=bG(r);t.onAction(s,n.event.buttonApi)})),yG=(e,t,o)=>{const{primary:n,...r}=t.original,s=Os(KO({...r,type:"button",onAction:y}));return Mj(s,o,[vG(e,t)])},xG=(e,t,o)=>{const{primary:n,...r}=t.original,s=Os(JO({...r,type:"togglebutton",onAction:y}));return Bj(s,o,[vG(e,t)])},wG=e=>"contextformtogglebutton"===e.type,SG=(e,t,o)=>wG(t)?xG(e,t,o):yG(e,t,o),kG=(e,t,o)=>{const n=W(t,(t=>IS(SG(e,t,o)))),r=()=>W(n,(e=>e.asSpec())),s=e=>ue(t,((t,o)=>t.primary?F.from(n[o]).bind((t=>t.getOpt(e))).filter(T(Zb.isDisabled)):F.none()));return{asSpecs:r,findPrimary:s}},CG=(e,t)=>{const o=e.label.fold((()=>({})),(e=>({"aria-label":e}))),n=IS(LC.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:o,selectOnFocus:!0,inputBehaviours:Fu([Gx.config({mode:"special",onEnter:e=>r.findPrimary(e).map((e=>(Ei(e),!0))),onLeft:(e,t)=>(t.cut(),F.none()),onRight:(e,t)=>(t.cut(),F.none())})])})),r=kG(n,e.commands,t);return[{title:F.none(),items:[n.asSpec()]},{title:F.none(),items:r.asSpecs()}]},OG=(e,t,o)=>AU({type:e,uid:cl("context-toolbar"),initGroups:CG(t,o),onEscape:F.none,cyclicKeying:!0,providers:o}),_G={renderContextForm:OG,buildInitGroups:CG},TG=(e,t,o)=>t.bottom-e.y>=o&&e.bottom-t.y>=o,EG=e=>{const t=e.getBoundingClientRect();if(t.height<=0&&t.width<=0){const o=zt(Qe.fromDom(e.startContainer),e.startOffset).element,n=bt(o)?At(o):F.some(o);return n.filter(ft).map((e=>e.dom.getBoundingClientRect())).getOr(t)}return t},DG=e=>{const t=e.selection.getRng(),o=EG(t);if(e.inline){const e=Pn();return er(e.left+o.left,e.top+o.top,o.width,o.height)}{const t=or(Qe.fromDom(e.getBody()));return er(t.x+o.left,t.y+o.top,o.width,o.height)}},MG=(e,t)=>t.filter((e=>Yt(e)&&ht(e))).map(or).getOrThunk((()=>DG(e))),AG=(e,t,o)=>{const n=Math.max(e.x+o,t.x),r=Math.min(e.right-o,t.right);return{x:n,width:r-n}},BG=(e,t,o,n,r,s)=>{const a=Qe.fromDom(e.getContainer()),i=nd(a,".tox-editor-header").getOr(a),l=tr(i),c=l.y>=t.bottom,d=n&&!c;if(e.inline&&d)return{y:Math.max(l.bottom+s,o.y),bottom:o.bottom};if(e.inline&&!d)return{y:o.y,bottom:Math.min(l.y-s,o.bottom)};const u="line"===r?tr(a):t;return d?{y:Math.max(l.bottom+s,o.y),bottom:Math.min(u.bottom-s,o.bottom)}:{y:Math.max(u.y+s,o.y),bottom:Math.min(l.y-s,o.bottom)}},FG=(e,t,o,n=0)=>{const r=jn(window),s=tr(Qe.fromDom(e.getContentAreaContainer())),a=Uk(e)||Gk(e)||qk(e),{x:i,width:l}=AG(s,r,n);if(e.inline&&!a)return er(i,r.y,l,r.height);{const a=t.header.isPositionedAtTop(),{y:c,bottom:d}=BG(e,s,r,a,o,n);return er(i,c,l,d-c)}},IG=12,RG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},NG={maxHeightFunction:jm(),maxWidthFunction:tU()},VG=(e,t)=>{const o=e.selection.getRng(),n=zt(Qe.fromDom(o.startContainer),o.startOffset);return o.startContainer===o.endContainer&&o.startOffset===o.endOffset-1&&Ot(n.element,t)},HG=(e,t,o)=>{const n=ho(e,"position");co(e,"position",t);const r=o(e);return n.each((t=>co(e,"position",t))),r},zG=e=>"node"===e,PG=(e,t,o,n,r)=>{const s=DG(e),a=n.lastElement().exists((e=>Ot(o,e)));if(VG(e,o))return a?IV:DV;if(a)return HG(t,n.getMode(),(()=>{const e=TG(s,tr(t),-20);return e&&!n.isReposition()?NV:IV}));{const e="fixed"===n.getMode()?r.y+Pn().top:r.y,o=So(t)+IG;return e+o<=s.y?DV:MV}},LG=(e,t,o,n)=>{const r=t=>(n,r,s,a,i)=>{const l=PG(e,a,t,o,i),c={...n,y:i.y,height:i.height};return{...l(c,r,s,a,i),alwaysFit:!0}},s=e=>zG(n)?[r(e)]:[],a={onLtr:e=>[mu,gu,du,lu,uu,cu].concat(s(e)),onRtl:e=>[mu,gu,uu,cu,du,lu].concat(s(e))},i={onLtr:e=>[gu,lu,cu,du,uu,mu].concat(s(e)),onRtl:e=>[gu,cu,lu,uu,du,mu].concat(s(e))};return t?i:a},UG=(e,t,o,n)=>"line"===t?{bubble:Xm(IG,0,RG),layouts:{onLtr:()=>[pu],onRtl:()=>[hu]},overrides:NG}:{bubble:Xm(0,IG,RG,1/IG),layouts:LG(e,o,n,t),overrides:NG},WG=(e,t)=>{const o=q(t,(t=>t.predicate(e.dom))),{pass:n,fail:r}=$(o,(e=>"contexttoolbar"===e.type));return{contextToolbars:n,contextForms:r}},jG=e=>{if(e.length<=1)return e;{const t=t=>P(e,(e=>e.position===t)),o=t=>q(e,(e=>e.position===t)),n=t("selection"),r=t("node");if(n||r){if(r&&n){const e=o("node"),t=W(o("selection"),(e=>({...e,position:"node"})));return e.concat(t)}return o(n?"selection":"node")}return o("line")}},GG=e=>{if(e.length<=1)return e;{const t=t=>J(e,(e=>e.position===t)),o=t("selection").orThunk((()=>t("node"))).orThunk((()=>t("line"))).map((e=>e.position));return o.fold((()=>[]),(t=>q(e,(e=>e.position===t))))}},$G=(e,t,o)=>{const n=WG(e,t);if(n.contextForms.length>0)return F.some({elem:e,toolbars:[n.contextForms[0]]});{const t=WG(e,o);if(t.contextForms.length>0)return F.some({elem:e,toolbars:[t.contextForms[0]]});if(n.contextToolbars.length>0||t.contextToolbars.length>0){const o=jG(n.contextToolbars.concat(t.contextToolbars));return F.some({elem:e,toolbars:o})}return F.none()}},qG=(e,t,o)=>e(t)?F.none():ka(t,(e=>{if(ft(e)){const{contextToolbars:t,contextForms:n}=WG(e,o.inNodeScope),r=n.length>0?n:GG(t);return r.length>0?F.some({elem:e,toolbars:r}):F.none()}return F.none()}),e),KG=(e,t)=>{const o=Qe.fromDom(t.getBody()),n=e=>Ot(e,o),r=e=>!n(e)&&!_t(o,e),s=Qe.fromDom(t.selection.getNode());return r(s)?F.none():$G(s,e.inNodeScope,e.inEditorScope).orThunk((()=>qG(n,s,e)))},XG=(e,t)=>{const o={},n=[],r=[],s={},a={},i=(e,i)=>{const l=Os(s_(i));o[e]=l,l.launch.map((o=>{s["form:"+e]={...i.launch,type:"contextformtogglebutton"===o.type?"togglebutton":"button",onAction:()=>{t(l)}}})),"editor"===l.scope?r.push(l):n.push(l),a[e]=l},l=(e,t)=>{i_(t).each((o=>{"editor"===t.scope?r.push(o):n.push(o),a[e]=o}))},c=me(e);return j(c,(t=>{const o=e[t];"contextform"===o.type?i(t,o):"contexttoolbar"===o.type&&l(t,o)})),{forms:o,inNodeScope:n,inEditorScope:r,lookupTable:a,formNavigators:s}},YG=cl("forward-slide"),JG=cl("backward-slide"),ZG=cl("change-slide-event"),QG="tox-pop--resizing",e$=e=>{const t=ca([]);return MS.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{t.set([]),MS.getContent(e).each((e=>{vo(e.element,"visibility")})),gc(e.element,QG),vo(e.element,"width")},inlineBehaviours:Fu([iw("context-toolbar-events",[$i(Ya(),((e,t)=>{"width"===t.event.raw.propertyName&&(gc(e.element,QG),vo(e.element,"width"))})),Vi(ZG,((e,t)=>{const o=e.element;vo(o,"width");const n=Fo(o);MS.setContent(e,t.event.contents),uc(o,QG);const r=Fo(o);co(o,"width",n+"px"),MS.getContent(e).each((e=>{t.event.focus.bind((e=>(Uu(e),$u(o)))).orThunk((()=>(Gx.focusIn(e),Gu(Wt(o)))))})),setTimeout((()=>{co(e.element,"width",r+"px")}),0)})),Vi(YG,((e,o)=>{MS.getContent(e).each((o=>{t.set(t.get().concat([{bar:o,focus:Gu(Wt(e.element))}]))})),Ti(e,ZG,{contents:o.event.forwardContents,focus:F.none()})})),Vi(JG,((e,o)=>{ce(t.get()).each((o=>{t.set(t.get().slice(0,t.get().length-1)),Ti(e,ZG,{contents:Kc(o.bar),focus:o.focus})}))}))]),Gx.config({mode:"special",onEscape:o=>ce(t.get()).fold((()=>e.onEscape()),(e=>(_i(o,JG),F.some(!0))))})]),lazySink:()=>ir.value(e.sink)})},t$="tox-pop--transition",o$=(e,t,o,n)=>{const r=n.backstage,s=r.shared,a=Cn().deviceType.isTouch,i=wm(),l=wm(),c=wm(),d=qc(e$({sink:o,onEscape:()=>(e.focus(),F.some(!0))})),u=()=>{const t=c.get().getOr("node"),o=zG(t)?1:0;return FG(e,s,t,o)},m=()=>!e.removed&&!(a()&&r.isContextMenuOpen()),g=e=>Te(Ae(e,i.get(),Ot),!0),p=()=>{if(m()){const t=u(),o=Te(c.get(),"node")?MG(e,i.get()):DG(e);return t.height<=0||!TG(o,t,.01)}return!0},h=()=>{i.clear(),l.clear(),c.clear(),MS.hide(d)},f=()=>{if(MS.isOpen(d)){const e=d.element;vo(e,"display"),p()?co(e,"display","none"):(l.set(0),MS.reposition(d))}},b=t=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Fu([Gx.config({mode:"acyclic"}),iw("pop-dialog-wrap-events",[qi((t=>{e.shortcuts.add("ctrl+F9","focus statusbar",(()=>Gx.focusIn(t)))})),Ki((t=>{e.shortcuts.remove("ctrl+F9")}))])])}),v=No((()=>XG(t,(e=>{const t=S([e]);Ti(d,YG,{forwardContents:b(t)})})))),x=(t,o)=>Gj(e,{buttons:t,toolbar:o.items,allowToolbarGroups:!1},n.backstage,F.some(["form:"])),w=(e,t)=>_G.buildInitGroups(e,t),S=t=>{const{buttons:o}=e.ui.registry.getAll(),n=v(),r={...o,...n.formNavigators},a=vk(e)===JS.scrolling?JS.scrolling:JS.default,i=Q(W(t,(e=>"contexttoolbar"===e.type?x(r,e):w(e,s.providers))));return AU({type:a,uid:cl("context-toolbar"),initGroups:i,onEscape:F.none,cyclicKeying:!0,providers:s.providers})},k=(t,n)=>{const r="node"===t?s.anchors.node(n):s.anchors.cursor(),c=UG(e,t,a(),{lastElement:i.get,isReposition:()=>Te(l.get(),0),getMode:()=>Kp.getMode(o)});return _r(r,c)},C=(e,t)=>{if(O.cancel(),!m())return;const n=S(e),r=e[0].position,s=k(r,t);c.set(r),l.set(1);const a=d.element;vo(a,"display"),g(t)||(gc(a,t$),Kp.reset(o,d)),MS.showWithinBounds(d,b(n),{anchor:s,transition:{classes:[t$],mode:"placement"}},(()=>F.some(u()))),t.fold(i.clear,i.set),p()&&co(a,"display","none")},O=aN((()=>{if(e.hasFocus()&&!e.removed)if(pc(d.element,t$))O.throttle();else{const t=v();KG(t,e).fold(h,(e=>{C(e.toolbars,F.some(e.elem))}))}}),17);e.on("init",(()=>{e.on("remove",h),e.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",f),e.on("click keyup focus SetContent",O.throttle),e.on(fG,h),e.on(hG,(t=>{const o=v();Ce(o.lookupTable,t.toolbarKey).each((o=>{C([o],Ie(t.target!==e,t.target)),MS.getContent(d).each(Gx.focusIn)}))})),e.on("focusout",(t=>{AS.setEditorTimeout(e,(()=>{$u(o.element).isNone()&&$u(d.element).isNone()&&h()}),0)})),e.on("SwitchMode",(()=>{e.mode.isReadOnly()&&h()})),e.on("AfterProgressState",(t=>{t.state?h():e.hasFocus()&&O.throttle()})),e.on("NodeChange",(e=>{$u(d.element).fold(O.throttle,y)}))}))},n$=e=>{const t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];j(t,(t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:EW(e,t.cmd),onSetup:OW(e,t.name)})})),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:EW(e,"JustifyNone")})},r$={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},s$=(()=>{const e="[0-9]+",t="[+-]?"+e,o="[eE]"+t,n="\\.",r=e=>`(?:${e})?`,s=["Infinity",e+n+r(e)+r(o),n+e+r(o),e+r(o)].join("|"),a=`[+-]?(?:${s})`;return new RegExp(`^(${a})(.*)$`)})(),a$=(e,t)=>P(t,(t=>P(r$[t],(t=>e===t)))),i$=(e,t)=>{const o=F.from(s$.exec(e));return o.bind((e=>{const o=Number(e[1]),n=e[2];return a$(n,t)?F.some({value:o,unit:n}):F.none()}))},l$=(e,t)=>i$(e,t).map((({value:e,unit:t})=>e+t)),c$=(e,t)=>{const o=()=>{const o=t.getOptions(e),n=t.getCurrent(e).map(t.hash),r=wm();return W(o,(o=>({type:"togglemenuitem",text:t.display(o),onSetup:s=>{const a=e=>{e&&(r.on((e=>e.setActive(!1))),r.set(s)),s.setActive(e)};a(Te(n,t.hash(o)));const i=t.watcher(e,o,a);return()=>{r.clear(),i()}},onAction:()=>t.setCurrent(e,o)})))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:e=>e(o()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:o,onSetup:t.onMenuSetup})},d$={name:"lineheight",text:"Line height",icon:"line-height",getOptions:jk,hash:e=>l$(e,["fixed","relative","empty"]).getOr(e),display:C,watcher:(e,t,o)=>e.formatter.formatChanged("lineheight",o,!1,{value:t}).unbind,getCurrent:e=>F.from(e.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t)},u$=e=>{const t=F.from(fk(e));return t.map((t=>({name:"language",text:"Language",icon:"language",getOptions:k(t),hash:e=>g(e.customCode)?e.code:`${e.code}/${e.customCode}`,display:e=>e.title,watcher:(e,t,o)=>{var n;return e.formatter.formatChanged("lang",o,!1,{value:t.code,customValue:null!==(n=t.customCode)&&void 0!==n?n:null}).unbind},getCurrent:e=>{const t=Qe.fromDom(e.selection.getNode());return Ca(t,(e=>F.some(e).filter(ft).bind((e=>{const t=no(e,"lang");return t.map((t=>{const o=no(e,"data-mce-lang").getOrUndefined();return{code:t,customCode:o,title:""}}))}))))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:t=>{const o=xm();return t.setActive(e.formatter.match("lang",{},void 0,!0)),o.set(e.formatter.formatChanged("lang",t.setActive,!0)),o.clear}})))},m$=e=>{c$(e,d$),u$(e).each((t=>c$(e,t)))},g$=(e,t)=>{PW(e,t),YW(e,t),ij(e,t),jW(e,t),rj(e,t)},p$=e=>_W(e,"NodeChange",(t=>{t.setEnabled(e.queryCommandState("outdent"))})),h$=e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:p$(e),onAction:EW(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:EW(e,"indent")})},f$=e=>{h$(e)},b$=(e,t)=>o=>{o.setActive(t.get());const n=e=>{t.set(e.state),o.setActive(e.state)};return e.on("PastePlainTextToggle",n),()=>e.off("PastePlainTextToggle",n)},v$=e=>{const t=ca(Hk(e)),o=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:b$(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:b$(e,t)})},y$=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},x$=e=>{GI.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],((t,o)=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:OW(e,t.name),onAction:y$(e,t.name)})}));for(let t=1;t<=6;t++){const o="h"+t;e.ui.registry.addToggleButton(o,{text:o.toUpperCase(),tooltip:"Heading "+t,onSetup:OW(e,o),onAction:y$(e,o)})}},w$=e=>{GI.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"print",text:"Print",action:"mcePrint",icon:"print"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],(t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:EW(e,t.action)})}))},S$=e=>{GI.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:EW(e,t.action),onSetup:OW(e,t.name)})}))},k$=e=>{x$(e),w$(e),S$(e)},C$=e=>{GI.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],(t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:EW(e,t.action)})})),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:y$(e,"code")})},O$=e=>{k$(e),C$(e)},_$=(e,t)=>_W(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(o=>{o.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())})),T$=e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:_$(e,"hasUndo"),onAction:EW(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:_$(e,"hasRedo"),onAction:EW(e,"redo")})},E$=e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:_$(e,"hasUndo"),onAction:EW(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:_$(e,"hasRedo"),onAction:EW(e,"redo")})},D$=e=>{T$(e),E$(e)},M$=e=>_W(e,"VisualAid",(t=>{t.setActive(e.hasVisual)})),A$=e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:M$(e),onAction:EW(e,"mceToggleVisualAid")})},B$=e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:EW(e,"mceToggleVisualAid")})},F$=e=>{B$(e),A$(e)},I$=(e,t)=>{n$(e),O$(e),g$(e,t),D$(e),qE(e),F$(e),f$(e),m$(e),v$(e)},R$=e=>i(e)?e.split(/[ ,]/):e,N$=e=>t=>t.options.get(e),V$=e=>{const t=e.options.register;t("contextmenu_avoid_overlap",{processor:"string",default:""}),t("contextmenu_never_use_native",{processor:"boolean",default:!1}),t("contextmenu",{processor:e=>!1===e?{value:[],valid:!0}:i(e)||v(e,i)?{value:R$(e),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})},H$=N$("contextmenu_never_use_native"),z$=N$("contextmenu_avoid_overlap"),P$=e=>0===L$(e).length,L$=e=>{const t=e.ui.registry.getAll().contextMenus,o=e.options.get("contextmenu");return e.options.isSet("contextmenu")?o:q(o,(e=>Oe(t,e)))},U$=(e,t)=>({type:"makeshift",x:e,y:t}),W$=(e,t,o)=>U$(e.x+t,e.y+o),j$=e=>"longpress"===e.type||0===e.type.indexOf("touch"),G$=e=>{if(j$(e)){const t=e.touches[0];return U$(t.pageX,t.pageY)}return U$(e.pageX,e.pageY)},$$=e=>{if(j$(e)){const t=e.touches[0];return U$(t.clientX,t.clientY)}return U$(e.clientX,e.clientY)},q$=(e,t)=>{const o=ek.DOM.getPos(e);return W$(t,o.x,o.y)},K$=(e,t)=>"contextmenu"===t.type||"longpress"===t.type?e.inline?G$(t):q$(e.getContentAreaContainer(),$$(t)):X$(e),X$=e=>({type:"selection",root:Qe.fromDom(e.selection.getNode())}),Y$=e=>({type:"node",node:F.some(Qe.fromDom(e.selection.getNode())),root:Qe.fromDom(e.getBody())}),J$=(e,t,o)=>{switch(o){case"node":return Y$(e);case"point":return K$(e,t);case"selection":return X$(e)}},Z$=(e,t,o,n,r,s)=>{const a=o(),i=J$(e,t,s);DR(a,lC.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:F.none()}).map((e=>{t.preventDefault(),MS.showMenuAt(r,{anchor:i},{menu:{markers:BC("normal")},data:e})}))},Q$={onLtr:()=>[gu,lu,cu,du,uu,mu,DV,MV,EV,_V,TV,OV],onRtl:()=>[gu,cu,lu,uu,du,mu,DV,MV,TV,OV,EV,_V]},eq=12,tq={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},oq=(e,t)=>{const o=e.selection;if(o.isCollapsed()||t.touches.length<1)return!1;{const n=t.touches[0],r=o.getRng(),s=cp(e.getWin(),Ug.domRange(r));return s.exists((e=>e.left<=n.clientX&&e.right>=n.clientX&&e.top<=n.clientY&&e.bottom>=n.clientY))}},nq=e=>{const t=e.selection.getRng(),o=()=>{AS.setEditorTimeout(e,(()=>{e.selection.setRng(t)}),10),s()};e.once("touchend",o);const n=e=>{e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",n,!0);const r=()=>s();e.once("longpresscancel",r);const s=()=>{e.off("touchend",o),e.off("longpresscancel",r),e.off("mousedown",n)}},rq=(e,t,o)=>{const n=J$(e,t,o),r="point"===o?eq:0;return{bubble:Xm(0,r,tq),layouts:Q$,overrides:{maxWidthFunction:tU(),maxHeightFunction:jm()},...n}},sq=(e,t,o,n,r,s,a)=>{const i=rq(e,t,s);DR(o,lC.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!0,search:F.none()}).map((o=>{t.preventDefault();const l=a?wS.HighlightMenuAndItem:wS.HighlightNone;MS.showMenuWithinBounds(r,{anchor:i},{menu:{markers:BC("normal"),highlightOnOpen:l},data:o,type:"horizontal"},(()=>F.some(FG(e,n.shared,"node"===s?"node":"selection")))),e.dispatch(fG)}))},aq=(e,t,o,n,r,s)=>{const a=Cn(),i=a.os.isiOS(),l=a.os.isMacOS(),c=a.os.isAndroid(),d=a.deviceType.isTouch(),u=()=>!(c||i||l&&d),m=()=>{const a=o();sq(e,t,a,n,r,s,u())};if((l||i)&&"node"!==s){const o=()=>{nq(e),m()};oq(e,t)?o():(e.once("selectionchange",o),e.once("touchend",(()=>e.off("selectionchange",o))))}else m()},iq=e=>i(e)?"|"===e:"separator"===e.type,lq={type:"separator"},cq=e=>{const t=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(i(e))return e;switch(e.type){case"separator":return lq;case"submenu":return{type:"nestedmenuitem",...t(e),getSubmenuItems:()=>{const t=e.getSubmenuItems();return i(t)?t:W(t,cq)}};default:const o=e;return{type:"menuitem",...t(o),onAction:x(o.onAction)}}},dq=(e,t)=>{if(0===t.length)return e;const o=ce(e).filter((e=>!iq(e))),n=o.fold((()=>[]),(e=>[lq]));return e.concat(n).concat(t).concat([lq])},uq=(e,t,o)=>{const n=X(t,((t,n)=>Ce(e,n.toLowerCase()).map((e=>{const n=e.update(o);if(i(n))return dq(t,n.split(" "));if(n.length>0){const e=W(n,cq);return dq(t,e)}return t})).getOrThunk((()=>t.concat([n])))),[]);return n.length>0&&iq(n[n.length-1])&&n.pop(),n},mq=(e,t)=>t.ctrlKey&&!H$(e),gq=e=>"longpress"===e.type||Oe(e,"touches"),pq=(e,t)=>!gq(t)&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType),hq=(e,t)=>pq(e,t)?e.selection.getStart(!0):t.target,fq=(e,t)=>{const o=z$(e),n=pq(e,t)?"selection":"point";if(Ge(o)){const r=hq(e,t),s=vM(Qe.fromDom(r),o);return s?"node":n}return n},bq=(e,t,o)=>{const n=Cn(),r=n.deviceType.isTouch,s=qc(MS.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>o.setContextMenuState(!0),onHide:()=>o.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:Fu([iw("dismissContextMenu",[Vi(vi(),((t,o)=>{Bh.close(t),e.focus()}))])])})),a=()=>MS.hide(s),i=t=>{if(H$(e)&&t.preventDefault(),mq(e,t)||P$(e))return;const n=fq(e,t),a=()=>{const o=hq(e,t),n=e.ui.registry.getAll(),r=L$(e);return uq(n.contextMenus,r,o)},i=r()?aq:Z$;i(e,t,a,o,s,n)};e.on("init",(()=>{const t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");e.on(t,a),e.on("longpress contextmenu",i)}))},vq=ua.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),yq=e=>t=>t.translate(-e.left,-e.top),xq=e=>t=>t.translate(e.left,e.top),wq=e=>(t,o)=>X(e,((e,t)=>t(e)),_o(t,o)),Sq=(e,t,o)=>e.fold(wq([xq(o),yq(t)]),wq([yq(t)]),wq([])),kq=(e,t,o)=>e.fold(wq([xq(o)]),wq([]),wq([xq(t)])),Cq=(e,t,o)=>e.fold(wq([]),wq([yq(o)]),wq([xq(t),yq(o)])),Oq=(e,t,o,n,r,s)=>{const a=kq(e,r,s),i=kq(t,r,s);return Math.abs(a.left-i.left)<=o&&Math.abs(a.top-i.top)<=n},_q=(e,t,o,n,r,s)=>{const a=kq(e,r,s),i=kq(t,r,s),l=Math.abs(a.left-i.left),c=Math.abs(a.top-i.top);return _o(l,c)},Tq=(e,t,o)=>{const n=e.fold(((e,t)=>({position:F.some("absolute"),left:F.some(e+"px"),top:F.some(t+"px")})),((e,t)=>({position:F.some("absolute"),left:F.some(e-o.left+"px"),top:F.some(t-o.top+"px")})),((e,t)=>({position:F.some("fixed"),left:F.some(e+"px"),top:F.some(t+"px")})));return{right:F.none(),bottom:F.none(),...n}},Eq=(e,t,o)=>e.fold(((e,n)=>Mq(e+t,n+o)),((e,n)=>Aq(e+t,n+o)),((e,n)=>Bq(e+t,n+o))),Dq=(e,t,o,n)=>{const r=(e,r)=>(s,a)=>{const i=e(t,o,n);return r(s.getOr(i.left),a.getOr(i.top))};return e.fold(r(Cq,Mq),r(kq,Aq),r(Sq,Bq))},Mq=vq.offset,Aq=vq.absolute,Bq=vq.fixed,Fq=(e,t)=>{const o=oo(e,t);return g(o)?NaN:parseInt(o,10)},Iq=(e,t)=>{const o=e.element,n=Fq(o,t.leftAttr),r=Fq(o,t.topAttr);return isNaN(n)||isNaN(r)?F.none():F.some(_o(n,r))},Rq=(e,t,o)=>{const n=e.element;eo(n,t.leftAttr,o.left+"px"),eo(n,t.topAttr,o.top+"px")},Nq=(e,t)=>{const o=e.element;so(o,t.leftAttr),so(o,t.topAttr)},Vq=(e,t,o,n)=>Iq(e,t).fold((()=>o),(e=>Bq(e.left+n.left,e.top+n.top))),Hq=(e,t,o,n,r,s)=>{const a=Vq(e,t,o,n),i=t.mustSnap?Lq(e,t,a,r,s):Uq(e,t,a,r,s),l=Sq(a,r,s);return Rq(e,t,l),i.fold((()=>({coord:Bq(l.left,l.top),extra:F.none()})),(e=>({coord:e.output,extra:e.extra})))},zq=(e,t)=>{Nq(e,t)},Pq=(e,t,o,n)=>ue(e,(e=>{const r=e.sensor,s=Oq(t,r,e.range.left,e.range.top,o,n);return s?F.some({output:Dq(e.output,t,o,n),extra:e.extra}):F.none()})),Lq=(e,t,o,n,r)=>{const s=t.getSnapPoints(e),a=Pq(s,o,n,r);return a.orThunk((()=>{const e=X(s,((e,t)=>{const s=t.sensor,a=_q(o,s,t.range.left,t.range.top,n,r);return e.deltas.fold((()=>({deltas:F.some(a),snap:F.some(t)})),(o=>{const n=(a.left+a.top)/2,r=(o.left+o.top)/2;return n<=r?{deltas:F.some(a),snap:F.some(t)}:e}))}),{deltas:F.none(),snap:F.none()});return e.snap.map((e=>({output:Dq(e.output,o,n,r),extra:e.extra})))}))},Uq=(e,t,o,n,r)=>{const s=t.getSnapPoints(e);return Pq(s,o,n,r)},Wq=(e,t,o)=>({coord:Dq(e.output,e.output,t,o),extra:e.extra}),jq=(e,t,o,n)=>{const r=t.getTarget(e.element);if(t.repositionTarget){const t=Tt(e.element),o=Pn(t),s=wz(r),a=Wq(n,o,s),i=Tq(a.coord,o,s);mo(r,i)}};var Gq=Object.freeze({__proto__:null,snapTo:jq});const $q="data-initial-z-index",qq=e=>{At(e.element).filter(ft).each((e=>{no(e,$q).fold((()=>vo(e,"z-index")),(t=>co(e,"z-index",t))),so(e,$q)}))},Kq=e=>{At(e.element).filter(ft).each((t=>{ho(t,"z-index").each((e=>{eo(t,$q,e)})),co(t,"z-index",go(e.element,"z-index"))}))},Xq=(e,t)=>{e.getSystem().addToGui(t),Kq(t)},Yq=e=>{qq(e),e.getSystem().removeFromGui(e)},Jq=(e,t,o)=>e.getSystem().build(UM.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:o}));var Zq=Js("snaps",[Fs("getSnapPoints"),Ed("onSensor"),Fs("leftAttr"),Fs("topAttr"),Qs("lazyViewport",nr),Qs("mustSnap",!1)]);const Qq=[Qs("useFixed",M),Fs("blockerClass"),Qs("getTarget",C),Qs("onDrag",y),Qs("repositionTarget",!0),Qs("onDrop",y),sa("getBounds",nr),Zq],eK=e=>Be(ho(e,"left"),ho(e,"top"),ho(e,"position"),((e,t,o)=>{const n="fixed"===o?Bq:Mq;return n(parseInt(e,10),parseInt(t,10))})).getOrThunk((()=>{const t=Do(e);return Aq(t.left,t.top)})),tK=(e,t,o,n,r)=>{const s=r.bounds,a=kq(t,o,n),i=Xd(a.left,s.x,s.x+s.width-r.width),l=Xd(a.top,s.y,s.y+s.height-r.height),c=Aq(i,l);return t.fold((()=>{const e=Cq(c,o,n);return Mq(e.left,e.top)}),k(c),(()=>{const e=Sq(c,o,n);return Bq(e.left,e.top)}))},oK=(e,t,o,n,r,s,a)=>{const i=t.fold((()=>{const e=Eq(o,s.left,s.top),t=Sq(e,n,r);return Bq(t.left,t.top)}),(t=>{const a=Hq(e,t,o,s,n,r);return a.extra.each((o=>{t.onSensor(e,o)})),a.coord}));return tK(e,i,n,r,a)},nK=(e,t,o,n)=>{const r=t.getTarget(e.element);if(t.repositionTarget){const s=Tt(e.element),a=Pn(s),i=wz(r),l=eK(r),c=oK(e,t.snaps,l,a,i,n,o),d=Tq(c,a,i);mo(r,d)}t.onDrag(e,r,n)},rK=(e,t)=>({bounds:e.getBounds(),height:ko(t.element),width:Io(t.element)}),sK=(e,t,o,n,r)=>{const s=o.update(n,r),a=o.getStartData().getOrThunk((()=>rK(t,e)));s.each((o=>{nK(e,t,a,o)}))},aK=(e,t,o,n)=>{t.each(Yq),o.snaps.each((t=>{zq(e,t)}));const r=o.getTarget(e.element);n.reset(),o.onDrop(e,r)},iK=e=>(t,o)=>{const n=e=>{o.setStartData(rK(t,e))};return Fi([Vi(pi(),(e=>{o.getStartData().each((()=>n(e)))})),...e(t,o,n)])},lK=e=>Fi([Vi(Va(),e.forceDrop),Vi(Pa(),e.drop),Vi(Ha(),((t,o)=>{e.move(o.event)})),Vi(za(),e.delayDrop)]),cK=e=>F.from(_o(e.x,e.y)),dK=(e,t)=>_o(t.left-e.left,t.top-e.top);var uK=Object.freeze({__proto__:null,getData:cK,getDelta:dK});const mK=(e,t,o)=>[Vi(Va(),((n,r)=>{const s=r.event.raw;if(0!==s.button)return;r.stop();const a=()=>aK(n,F.some(c),e,t),i=yM(a,200),l={drop:a,delayDrop:i.schedule,forceDrop:a,move:o=>{i.cancel(),sK(n,e,t,uK,o)}},c=Jq(n,e.blockerClass,lK(l)),d=()=>{o(n),Xq(n,c)};d()}))],gK=[...Qq,Bd("dragger",{handlers:iK(mK)})],pK=e=>Fi([Vi(Fa(),e.forceDrop),Vi(Ra(),e.drop),Vi(Na(),e.drop),Vi(Ia(),((t,o)=>{e.move(o.event)}))]),hK=e=>{const t=e[0];return F.some(_o(t.clientX,t.clientY))},fK=e=>{const t=e.raw,o=t.touches;return 1===o.length?hK(o):F.none()},bK=(e,t)=>_o(t.left-e.left,t.top-e.top);var vK=Object.freeze({__proto__:null,getData:fK,getDelta:bK});const yK=(e,t,o)=>{const n=wm(),r=o=>{aK(o,n.get(),e,t),n.clear()};return[Vi(Fa(),((s,a)=>{a.stop();const i=()=>r(s),l={drop:i,delayDrop:y,forceDrop:i,move:o=>{sK(s,e,t,vK,o)}},c=Jq(s,e.blockerClass,pK(l));n.set(c);const d=()=>{o(s),Xq(s,c)};d()})),Vi(Ia(),((o,n)=>{n.stop(),sK(o,e,t,vK,n.event)})),Vi(Ra(),((e,t)=>{t.stop(),r(e)})),Vi(Na(),r)]},xK=[...Qq,Bd("dragger",{handlers:iK(yK)})],wK=(e,t,o)=>[...mK(e,t,o),...yK(e,t,o)],SK=[...Qq,Bd("dragger",{handlers:iK(wK)})],kK=gK,CK=xK,OK=SK;var _K=Object.freeze({__proto__:null,mouse:kK,touch:CK,mouseOrTouch:OK});const TK=()=>{let e=F.none(),t=F.none();const o=()=>{e=F.none(),t=F.none()},n=(t,o)=>{const n=e.map((e=>t.getDelta(e,o)));return e=F.some(o),n},r=(e,t)=>e.getData(t).bind((t=>n(e,t))),s=e=>{t=F.some(e)},a=()=>t,i=k({});return Al({readState:i,reset:o,update:r,getStartData:a,setStartData:s})};var EK=Object.freeze({__proto__:null,init:TK});const DK=Vu({branchKey:"mode",branches:_K,name:"dragging",active:{events:(e,t)=>{const o=e.dragger;return o.handlers(e,t)}},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:F.from(e.extra)})},state:EK,apis:Gq}),MK=40,AK=MK/2,BK=(e,t,o,n,r,s)=>e.fold((()=>DK.snap({sensor:Aq(o-AK,n-AK),range:_o(r,s),output:Aq(F.some(o),F.some(n)),extra:{td:t}})),(e=>{const r=o-AK,s=n-AK,a=MK,i=MK,l=e.element.dom.getBoundingClientRect();return DK.snap({sensor:Aq(r,s),range:_o(a,i),output:Aq(F.some(o-l.width/2),F.some(n-l.height/2)),extra:{td:t}})})),FK=(e,t,o)=>{const n=(e,t)=>e.exists((e=>Ot(e,t)));return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,r)=>{const s=r.td;n(t.get(),s)||(t.set(s),o(s))},mustSnap:!0}},IK=e=>IS(FS.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Fu([DK.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),AA.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),RK=(e,t)=>{const o=ca([]),n=ca([]),r=ca(!1),s=wm(),a=wm(),i=e=>{const o=or(e);return BK(g.getOpt(t),e,o.x,o.y,o.width,o.height)},l=()=>W(o.get(),(e=>i(e))),c=e=>{const o=or(e);return BK(p.getOpt(t),e,o.right,o.bottom,o.width,o.height)},d=()=>W(n.get(),(e=>c(e))),u=FK(l,s,(t=>{a.get().each((o=>{e.dispatch("TableSelectorChange",{start:t,finish:o})}))})),m=FK(d,a,(t=>{s.get().each((o=>{e.dispatch("TableSelectorChange",{start:o,finish:t})}))})),g=IK(u),p=IK(m),h=qc(g.asSpec()),f=qc(p.asSpec()),b=(t,o,n,r)=>{const s=o.dom.getBoundingClientRect();vo(t.element,"display");const a=Mt(Qe.fromDom(e.getBody())).dom.innerHeight,i=n(s),l=r(s,a);(i||l)&&co(t.element,"display","none")},v=(e,t,o,n)=>{const r=o(t);DK.snapTo(e,r);const s=e=>e[n]<0,a=(e,t)=>e[n]>t;b(e,t,s,a)},y=e=>v(h,e,i,"top"),x=()=>s.get().each(y),w=e=>v(f,e,c,"bottom"),S=()=>a.get().each(w);Cn().deviceType.isTouch()&&(e.on("TableSelectionChange",(e=>{r.get()||(rh(t,h),rh(t,f),r.set(!0)),s.set(e.start),a.set(e.finish),e.otherCells.each((t=>{o.set(t.upOrLeftCells),n.set(t.downOrRightCells),y(e.start),w(e.finish)}))})),e.on("ResizeEditor ResizeWindow ScrollContent",(()=>{x(),S()})),e.on("TableSelectionClear",(()=>{r.get()&&(ih(h),ih(f),r.set(!1)),s.clear(),a.clear()})))};var NK='<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n';const VK=e=>"BR"===e.nodeName||!!e.getAttribute("data-mce-bogus")||"bookmark"===e.getAttribute("data-mce-type"),HK=(e,t,o)=>{var n;const r=null!==(n=t.delimiter)&&void 0!==n?n:"›",s=(t,n,r)=>FS.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":r,"aria-level":r+1}},components:[Uc(t)],action:t=>{e.focus(),e.selection.select(n),e.nodeChanged()},buttonBehaviours:Fu([oT.button(o.isDisabled),J_()])}),a=()=>({dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[Uc(` ${r} `)]}),i=e=>X(e,((e,t,o)=>{const n=s(t.name,t.element,o);return 0===o?e.concat([n]):e.concat([a(),n])}),[]),l=t=>{const o=[];let n=t.length;while(n-- >0){const r=t[n];if(1===r.nodeType&&!VK(r)){const t=dE(e,r);if(t.isDefaultPrevented()||o.push({name:t.name,element:r}),t.isPropagationStopped())break}}return o};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Fu([Gx.config({mode:"flow",selector:"div[role=button]"}),Zb.config({disabled:o.isDisabled}),J_(),ZM.config({}),sw.config({}),iw("elementPathEvents",[qi(((t,o)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",(()=>Gx.focusIn(t))),e.on("NodeChange",(e=>{const o=l(e.parents),n=o.length>0?i(o):[];sw.set(t,n)}))}))])]),components:[]}};var zK;(function(e){e[e["None"]=0]="None",e[e["Both"]=1]="Both",e[e["Vertical"]=2]="Vertical"})(zK||(zK={}));const PK=(e,t,o,n,r)=>{const s={height:tG(n+t.top,dk(e),mk(e))};return o===zK.Both&&(s.width=tG(r+t.left,ck(e),uk(e))),s},LK=(e,t,o)=>{const n=Qe.fromDom(e.getContainer()),r=PK(e,t,o,So(n),Fo(n));pe(r,((e,t)=>{b(e)&&co(n,t,eG(e))})),sE(e)},UK=e=>{const t=Vk(e);return!1===t?zK.None:"both"===t?zK.Both:zK.Vertical},WK=(e,t,o,n)=>{const r=20,s=_o(o*r,n*r);return LK(e,s,t),F.some(!0)},jK=(e,t)=>{const o=UK(e);return o===zK.None?F.none():F.some($S("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},behaviours:[DK.config({mode:"mouse",repositionTarget:!1,onDrag:(t,n,r)=>LK(e,r,o),blockerClass:"tox-blocker"}),Gx.config({mode:"special",onLeft:()=>WK(e,o,-1,0),onRight:()=>WK(e,o,1,0),onUp:()=>WK(e,o,0,-1),onDown:()=>WK(e,o,0,1)}),ZM.config({}),fw.config({})]},t.icons))},GK=(e,t)=>{const o=(e,o,n)=>sw.set(e,[Uc(t.translate(["{0} "+n,o[n]]))]);return FS.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Fu([oT.button(t.isDisabled),J_(),ZM.config({}),sw.config({}),hf.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),iw("wordcount-events",[Yi((e=>{const t=hf.getValue(e),n="words"===t.mode?"characters":"words";hf.setValue(e,{mode:n,count:t.count}),o(e,t.count,n)})),qi((t=>{e.on("wordCountUpdate",(e=>{const{mode:n}=hf.getValue(t);hf.setValue(t,{mode:n,count:e.wordCount}),o(t,e.wordCount,n)}))}))])]),eventOrder:{[si()]:["disabling","alloy.base.behaviour","wordcount-events"]}})},$K=(e,t)=>{const o=()=>({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":RS.translate(["Powered by {0}","Tiny"])},innerHtml:NK.trim()},behaviours:Fu([fw.config({})])}]}),n=()=>{const n=[];return Rk(e)&&n.push(HK(e,{},t)),e.hasPlugin("wordcount")&&n.push(GK(e,t)),Nk(e)&&n.push(o()),n.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:n}]:[]},r=()=>{const o=n(),r=jK(e,t);return o.concat(r.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:r()}},qK=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),KK=e=>{const t=e.inline,o=t?gG:Zj,n=Qk(e)?pP:yz,r=pG(),s=wm(),a=wm(),i=Cn(),l=i.deviceType.isTouch(),c="tox-platform-touch",d=l?[c]:[],u=Kk(e),m=vk(e),g=IS({dom:{tag:"div",classes:["tox-anchorbar"]}}),p=()=>r.mainUi.get().map((e=>e.outerContainer)).bind(uW.getHeader),h=()=>ir.fromOption(r.dialogUi.get().map((e=>e.sink)),"UI has not been rendered"),f=()=>ir.fromOption(r.popupUi.get().map((e=>e.sink)),"(popup) UI has not been rendered"),b=r.lazyGetInOuterOrDie("anchor bar",g.getOpt),v=r.lazyGetInOuterOrDie("toolbar",uW.getToolbar),y=r.lazyGetInOuterOrDie("throbber",uW.getThrobber),x=ez({popup:f,dialog:h},e,b),w=()=>{const t={attributes:{[tg]:u?eg.BottomToTop:eg.TopToBottom}},o=uW.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:x.popup,onEscape:()=>{e.focus()}}),n=uW.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x.popup.shared.getSink,providers:x.popup.shared.providers,onEscape:()=>{e.focus()},onToolbarToggled:t=>{uE(e,t)},type:m,lazyToolbar:v,lazyHeader:()=>p().getOrDie("Could not find header element"),...t}),r=uW.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:x.popup.shared.providers,onEscape:()=>{e.focus()},type:m}),s=qk(e),a=Gk(e),i=Uk(e),l=Pk(e),c=S(),d=s||a||i,h=()=>s?[r]:a?[n]:[],f=l?[c,o]:[o];return uW.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(d?[]:["tox-editor-header--empty"]),...t},components:Q([i?f:[],h(),Yk(e)?[]:[g.asSpec()]]),sticky:Qk(e),editor:e,sharedBackstage:x.popup.shared})},S=()=>uW.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),k=()=>{const e=uW.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),t=uW.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}});return{dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[e,t]}},O=()=>{const t=Jk(e),o=Ot(Jt(),t)&&"grid"===go(t,"display"),r={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(d),attributes:{...RS.isRtl()?{dir:"rtl"}:{}}},behaviours:Fu([Kp.config({useFixed:()=>n.isDocked(p)})])},s={dom:{styles:{width:document.body.clientWidth+"px"}},events:Fi([Vi(hi(),(e=>{co(e.element,"width",document.body.clientWidth+"px")}))])},i=qc(_r(r,o?s:{})),l=WM(i);return a.set(l),{sink:i,mothership:l}},_=C,T=()=>{const o=w(),n=k(),r=uW.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:x.popup}),a=uW.parts.viewWrapper({backstage:x.popup}),i=Ik(e)&&!t?F.some($K(e,x.popup.shared.providers)):F.none(),l=Q([u?[]:[o],t?[]:[n],u?[o]:[]]),c=uW.parts.editorContainer({components:Q([l,t?[]:i.toArray()])}),m=Zk(e),g={role:"application",...RS.isRtl()?{dir:"rtl"}:{},...m?{"aria-hidden":"true"}:{}},p=qc(uW.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(t?["tox-tinymce-inline"]:[]).concat(u?["tox-tinymce--toolbar-bottom"]:[]).concat(d),styles:{visibility:"hidden",...m?{opacity:"0",border:"0"}:{}},attributes:g},components:[c,...t?[]:[a],r],behaviours:Fu([J_(),Zb.config({disableClass:"tox-tinymce--disabled"}),Gx.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),h=WM(p);return s.set(h),{mothership:h,outerContainer:p}},E=t=>{const o=eG(nG(e)),n=eG(sG(e));return e.inline||(bo("div","width",n)&&co(t.element,"width",n),bo("div","height",o)?co(t.element,"height",o):co(t.element,"height","400px")),o},D=t=>{e.addShortcut("alt+F9","focus menubar",(()=>{uW.focusMenubar(t)})),e.addShortcut("alt+F10","focus toolbar",(()=>{uW.focusToolbar(t)})),e.addCommand("ToggleToolbarDrawer",(()=>{uW.toggleToolbarDrawer(t)})),e.addQueryStateHandler("ToggleToolbarDrawer",(()=>uW.isToolbarDrawerToggled(t)))},M=t=>{const{mainUi:r,popupUi:s,uiMotherships:a}=t;he(yk(e),((t,o)=>{e.ui.registry.addGroupToolbarButton(o,t)}));const{buttons:i,menuItems:l,contextToolbars:c,sidebars:d,views:u}=e.ui.registry.getAll(),g=$k(e),h={menuItems:l,menus:eC(e),menubar:Ok(e),toolbar:g.getOrThunk((()=>_k(e))),allowToolbarGroups:m===JS.floating,buttons:i,sidebar:d,views:u};D(r.outerContainer),tz(e,r.mothership,a),n.setup(e,x.popup.shared,p),I$(e,x.popup),bq(e,x.popup.shared.getSink,x.popup),mL(e),zL(e,y,x.popup.shared),o$(e,c,s.sink,{backstage:x.popup}),RK(e,s.sink);const f=e.getElement(),b=E(r.outerContainer),v={targetNode:f,height:b};return o.render(e,t,h,x.popup,v)},A=()=>{const e=T(),t=O(),o=_(t);r.dialogUi.set(t),r.popupUi.set(o),r.mainUi.set(e);const n={popupUi:o,dialogUi:t,mainUi:e,uiMotherships:r.getUiMotherships()};return M(n)};return{popups:{backstage:x.popup,getMothership:()=>qK("popups",a)},dialogs:{backstage:x.dialog,getMothership:()=>qK("dialogs",a)},renderUI:A}},XK=(e,t)=>{const o=F.from(oo(e,"id")).fold((()=>{const e=cl("dialog-describe");return eo(t,"id",e),e}),C);eo(e,"aria-describedby",o)},YK=(e,t)=>{const o=no(e,"id").fold((()=>{const e=cl("dialog-label");return eo(t,"id",e),e}),C);eo(e,"aria-labelledby",o)},JK=k([Fs("lazySink"),js("dragBlockClass"),sa("getBounds",nr),Qs("useTabstopAt",A),Qs("eventOrder",{}),ff("modalBehaviours",[Gx]),Dd("onExecute"),Ad("onEscape")]),ZK={sketch:C},QK=k([Yf({name:"draghandle",overrides:(e,t)=>({behaviours:Fu([DK.config({mode:"mouse",getTarget:e=>td(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),Kf({schema:[Fs("dom")],name:"title"}),Kf({factory:ZK,schema:[Fs("dom")],name:"close"}),Kf({factory:ZK,schema:[Fs("dom")],name:"body"}),Yf({factory:ZK,schema:[Fs("dom")],name:"footer"}),Xf({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[Qs("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Qs("components",[])],name:"blocker"})]),eX=(e,t,o,n)=>{const r=wm(),s=t=>{r.set(t);const o=e.lazySink(t).getOrDie(),s=n.blocker(),a=o.getSystem().build({...s,components:s.components.concat([Kc(t)]),behaviours:Fu([fw.config({}),iw("dialog-blocker-events",[$i(Ua(),(()=>{Gx.focusIn(t)}))])])});rh(o,a),Gx.focusIn(t)},a=e=>{r.clear(),At(e.element).each((t=>{e.getSystem().getByDom(t).each((e=>{ih(e)}))}))},i=t=>db(t,e,"body"),l=t=>db(t,e,"footer"),c=(e,t)=>{EL.block(e,t)},d=e=>{EL.unblock(e)},u=cl("modal-events"),m={...e.eventOrder,[fi()]:[u].concat(e.eventOrder["alloy.system.attached"]||[])};return{uid:e.uid,dom:e.dom,components:t,apis:{show:s,hide:a,getBody:i,getFooter:l,setIdle:d,setBusy:c},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:vf(e.modalBehaviours,[sw.config({}),Gx.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),EL.config({getRoot:r.get}),iw(u,[qi((t=>{YK(t.element,db(t,e,"title").element),XK(t.element,db(t,e,"body").element)}))])])}},tX=Eb({name:"ModalDialog",configFields:JK(),partFields:QK(),factory:eX,apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,o)=>{e.setBusy(t,o)},setIdle:(e,t)=>{e.setIdle(t)}}}),oX=rs([mO,gO].concat(p_)),nX=ps,rX=[zO("button"),_O,na("align","end",["start","end"]),IO,FO,Ks("buttonType",["primary","secondary"])],sX=[...rX,hO],aX=[Vs("type",["submit","cancel","custom"]),...sX],iX=[Vs("type",["menu"]),OO,TO,_O,Ws("items",oX),...rX],lX=Es("type",{submit:aX,cancel:aX,custom:aX,menu:iX}),cX=[mO,hO,Vs("level",["info","warn","error","success"]),bO,Qs("url","")],dX=rs(cX),uX=e=>[mO,e],mX=[mO,hO,FO,zO("button"),_O,BO,Ks("buttonType",["primary","secondary","toolbar"]),IO],gX=rs(mX),pX=[mO,gO],hX=pX.concat([EO]),fX=pX.concat([pO,FO]),bX=rs(fX),vX=ps,yX=hX.concat([RO("auto")]),xX=rs(yX),wX=cs([vO,hO,bO]),SX=hX.concat([oa("storageKey","default")]),kX=rs(SX),CX=gs,OX=hX,_X=rs(OX),TX=gs,EX=pX.concat([oa("tag","textarea"),Ns("scriptId"),Ns("scriptUrl"),aa("settings",void 0)]),DX=pX.concat([oa("tag","textarea"),zs("init")]),MX=ws((e=>Cs("customeditor.old",ns(DX),e).orThunk((()=>Cs("customeditor.new",ns(EX),e))))),AX=gs,BX=hX,FX=rs(BX),IX=xs(),RX=e=>[mO,Rs("columns"),e],NX=[mO,Ns("html"),na("presets","presentation",["presentation","document"])],VX=rs(NX),HX=hX.concat([ra("sandboxed",!0),ra("transparent",!0)]),zX=rs(HX),PX=gs,LX=rs(pX.concat([qs("height")])),UX=rs([Ns("url"),$s("zoom"),$s("cachedWidth"),$s("cachedHeight")]),WX=hX.concat([qs("inputMode"),qs("placeholder"),ra("maximized",!1),FO]),jX=rs(WX),GX=gs,$X=e=>[mO,pO,e],qX=[hO,vO],KX=[hO,Ws("items",Ds("items",(()=>XX)))],XX=as([rs(qX),rs(KX)]),YX=hX.concat([Ws("items",XX),FO]),JX=rs(YX),ZX=gs,QX=hX.concat([Us("items",[hO,vO]),ta("size",1),FO]),eY=rs(QX),tY=gs,oY=hX.concat([ra("constrain",!0),FO]),nY=rs(oY),rY=rs([Ns("width"),Ns("height")]),sY=pX.concat([pO,ta("min",0),ta("max",0)]),aY=rs(sY),iY=ms,lY=[mO,Ws("header",gs),Ws("cells",ss(gs))],cY=rs(lY),dY=hX.concat([qs("placeholder"),ra("maximized",!1),FO]),uY=rs(dY),mY=gs,gY=hX.concat([na("filetype","file",["image","media","file"]),FO]),pY=rs(gY),hY=rs([vO,NO]),fY=e=>Ms("items","items",Er(),ss(ws((t=>Cs(`Checking item of ${e}`,bY,t).fold((e=>ir.error(Ts(e))),(e=>ir.value(e))))))),bY=ts((()=>ys("type",{alertbanner:dX,bar:rs(uX(fY("bar"))),button:gX,checkbox:bX,colorinput:kX,colorpicker:_X,dropzone:FX,grid:rs(RX(fY("grid"))),iframe:zX,input:jX,listbox:JX,selectbox:eY,sizeinput:nY,slider:aY,textarea:uY,urlinput:pY,customeditor:MX,htmlpanel:VX,imagepreview:LX,collection:xX,label:rs($X(fY("label"))),table:cY,panel:yY}))),vY=[mO,Qs("classes",[]),Ws("items",bY)],yY=rs(vY),xY=[zO("tab"),fO,Ws("items",bY)],wY=[mO,Us("tabs",xY)],SY=rs(wY),kY=sX,CY=lX,OY=rs([Ns("title"),Is("body",ys("type",{panel:yY,tabpanel:SY})),oa("size","normal"),Ws("buttons",CY),Qs("initialData",{}),sa("onAction",y),sa("onChange",y),sa("onSubmit",y),sa("onClose",y),sa("onCancel",y),sa("onTabChange",y)]),_Y=e=>Cs("dialog",OY,e),TY=rs([Vs("type",["cancel","custom"]),...kY]),EY=rs([Ns("title"),Ns("url"),$s("height"),$s("width"),Ys("buttons",TY),sa("onAction",y),sa("onCancel",y),sa("onClose",y),sa("onMessage",y)]),DY=e=>Cs("dialog",EY,e),MY=e=>l(e)?[e].concat(ee(ke(e),MY)):d(e)?ee(e,MY):[],AY=e=>i(e.type)&&i(e.name),BY={checkbox:vX,colorinput:CX,colorpicker:TX,dropzone:IX,input:GX,iframe:PX,imagepreview:UX,selectbox:tY,sizeinput:rY,slider:iY,listbox:ZX,size:rY,textarea:mY,urlinput:hY,customeditor:AX,collection:wX,togglemenuitem:nX},FY=e=>F.from(BY[e.type]),IY=e=>q(MY(e),AY),RY=e=>{const t=IY(e),o=ee(t,(e=>FY(e).fold((()=>[]),(t=>[Is(e.name,t)]))));return rs(o)},NY=e=>{var t;const o=Os(_Y(e)),n=RY(e),r=null!==(t=e.initialData)&&void 0!==t?t:{};return{internalDialog:o,dataValidator:n,initialData:r}},VY={open:(e,t)=>{const o=NY(t);return e(o.internalDialog,o.initialData,o.dataValidator)},openUrl:(e,t)=>{const o=Os(DY(t));return e(o)},redial:e=>NY(e)},HY=e=>{const t=[],o={};return pe(e,((e,n)=>{e.fold((()=>{t.push(n)}),(e=>{o[n]=e}))})),t.length>0?ir.error(t):ir.value(o)},zY=(e,t,o)=>{const n=IS(yI.sketch((n=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:W(e.items,(e=>hV(n,e,t,o)))}))));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[n.asSpec()]}],behaviours:Fu([Gx.config({mode:"acyclic",useTabstopAt:T(tR)}),MI.memento(n),HI.memento(n,{postprocess:e=>HY(e).fold((e=>(console.error(e),{})),C)})])}},PY=(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:Vw(e.action),behaviours:vf(e.tabButtonBehaviours,[fw.config({}),Gx.config({mode:"execution",useSpace:!0,useEnter:!0}),hf.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}),LY=Tb({name:"TabButton",configFields:[Qs("uid",void 0),Fs("value"),Ms("dom","dom",Br((()=>({attributes:{role:"tab",id:cl("aria"),"aria-selected":"false"}}))),ds()),js("action"),Qs("domModification",{}),ff("tabButtonBehaviours",[fw,Gx,hf]),Fs("view")],factory:PY}),UY=k([Fs("tabs"),Fs("dom"),Qs("clickToDismiss",!1),ff("tabbarBehaviours",[vv,Gx]),_d(["tabClass","selectedClass"])]),WY=Jf({factory:LY,name:"tabs",unit:"tab",overrides:e=>{const t=(e,t)=>{vv.dehighlight(e,t),Ti(e,ki(),{tabbar:e,button:t})},o=(e,t)=>{vv.highlight(e,t),Ti(e,Si(),{tabbar:e,button:t})};return{action:n=>{const r=n.getSystem().getByUid(e.uid).getOrDie(),s=vv.isHighlighted(r,n),a=(()=>s&&e.clickToDismiss?t:s?y:o)();a(r,n)},domModification:{classes:[e.markers.tabClass]}}}}),jY=k([WY]),GY=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:vf(e.tabbarBehaviours,[vv.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{eo(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{eo(t.element,"aria-selected","false")}}),Gx.config({mode:"flow",getInitial:e=>vv.getHighlighted(e).map((e=>e.element)),selector:"."+e.markers.tabClass,executeOnMove:!0})])}),$Y=Eb({name:"Tabbar",configFields:UY(),partFields:jY(),factory:GY}),qY=(e,t)=>({uid:e.uid,dom:e.dom,behaviours:vf(e.tabviewBehaviours,[sw.config({})]),domModification:{attributes:{role:"tabpanel"}}}),KY=Tb({name:"Tabview",configFields:[ff("tabviewBehaviours",[sw])],factory:qY}),XY=k([Qs("selectFirst",!0),Ed("onChangeTab"),Ed("onDismissTab"),Qs("tabs",[]),ff("tabSectionBehaviours",[])]),YY=Kf({factory:$Y,schema:[Fs("dom"),Ls("markers",[Fs("tabClass"),Fs("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),JY=Kf({factory:KY,name:"tabview"}),ZY=k([YY,JY]),QY=(e,t,o,n)=>{const r=t=>{const o=hf.getValue(t);cb(t,e,"tabview").each((n=>{const r=J(e.tabs,(e=>e.value===o));r.each((o=>{const r=o.view();no(t.element,"id").each((e=>{eo(n.element,"aria-labelledby",e)})),sw.set(n,r),e.onChangeTab(n,t,r)}))}))},s=(t,o)=>{cb(t,e,"tabbar").each((e=>{o(e).each(Ei)}))};return{uid:e.uid,dom:e.dom,components:t,behaviours:bf(e.tabSectionBehaviours),events:Fi(Q([e.selectFirst?[qi(((e,t)=>{s(e,vv.getFirst)}))]:[],[Vi(Si(),((e,t)=>{const o=t.event.button;r(o)})),Vi(ki(),((t,o)=>{const n=o.event.button;e.onDismissTab(t,n)}))]])),apis:{getViewItems:t=>cb(t,e,"tabview").map((e=>sw.contents(e))).getOr([]),showTab:(e,t)=>{const o=e=>{const o=vv.getCandidates(e),n=J(o,(e=>hf.getValue(e)===t));return n.filter((t=>!vv.isHighlighted(e,t)))};s(e,o)}}}},eJ=Eb({name:"TabSection",configFields:XY(),partFields:ZY(),factory:QY,apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,o)=>{e.showTab(t,o)}}}),tJ=(e,t,o)=>W(e,((n,r)=>{sw.set(o,e[r].view());const s=t.dom.getBoundingClientRect();return sw.set(o,[]),s.height})),oJ=e=>le(ae(e,((e,t)=>e>t?-1:e<t?1:0))),nJ=(e,t,o)=>{const n=Dt(e).dom,r=td(e,".tox-dialog-wrap").getOr(e),s="fixed"===go(r,"position");let a;a=s?Math.max(n.clientHeight,window.innerHeight):Math.max(n.offsetHeight,n.scrollHeight);const i=So(t),l=t.dom.offsetLeft>=o.dom.offsetLeft+Fo(o),c=l?Math.max(So(o),i):i,d=parseInt(go(e,"margin-top"),10)||0,u=parseInt(go(e,"margin-bottom"),10)||0,m=So(e)+d+u,g=m-c;return a-g},rJ=(e,t)=>{le(e).each((e=>eJ.showTab(t,e.value)))},sJ=(e,t)=>{co(e,"height",t+"px"),co(e,"flex-basis",t+"px")},aJ=(e,t,o)=>{td(e,'[role="dialog"]').each((e=>{nd(e,'[role="tablist"]').each((n=>{o.get().map((o=>(co(t,"height","0"),co(t,"flex-basis","0"),Math.min(o,nJ(e,t,n))))).each((e=>{sJ(t,e)}))}))}))},iJ=e=>nd(e,'[role="tabpanel"]'),lJ=e=>{const t=wm(),o=[qi((o=>{const n=o.element;iJ(n).each((r=>{co(r,"visibility","hidden"),o.getSystem().getByDom(r).toOptional().each((o=>{const n=tJ(e,r,o),s=oJ(n);s.fold(t.clear,t.set)})),aJ(n,r,t),vo(r,"visibility"),rJ(e,o),requestAnimationFrame((()=>{aJ(n,r,t)}))}))})),Vi(hi(),(e=>{const o=e.element;iJ(o).each((e=>{aJ(o,e,t)}))})),Vi(pA,((e,o)=>{const n=e.element;iJ(n).each((e=>{const o=Gu(Wt(e));co(e,"visibility","hidden");const r=ho(e,"height").map((e=>parseInt(e,10)));vo(e,"height"),vo(e,"flex-basis");const s=e.dom.getBoundingClientRect().height,a=r.forall((e=>s>e));a?(t.set(s),aJ(n,e,t)):r.each((t=>{sJ(e,t)})),vo(e,"visibility"),o.each(Uu)}))}))],n=!1;return{extraEvents:o,selectFirst:n}},cJ="send-data-to-section",dJ="send-data-to-view",uJ=(e,t,o)=>{const n=ca({}),r=e=>{const t=hf.getValue(e),o=HY(t).getOr({}),r=n.get(),s=_r(r,o);n.set(s)},s=e=>{const t=n.get();hf.setValue(e,t)},a=ca(null),i=W(e.tabs,(e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[Uc(o.shared.providers.translate(e.title))],view:()=>[yI.sketch((n=>({dom:{tag:"div",classes:["tox-form"]},components:W(e.items,(e=>hV(n,e,t,o))),formBehaviours:Fu([Gx.config({mode:"acyclic",useTabstopAt:T(tR)}),iw("TabView.form.events",[qi(s),Ki(r)]),zu.config({channels:va([{key:cJ,value:{onReceive:r}},{key:dJ,value:{onReceive:s}}])})])})))]}))),l=lJ(i);return eJ.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t,o)=>{const n=hf.getValue(t);Ti(e,gA,{name:n,oldName:a.get()}),a.set(n)},tabs:i,components:[eJ.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[$Y.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Fu([ZM.config({})])}),eJ.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:l.selectFirst,tabSectionBehaviours:Fu([iw("tabpanel",l.extraEvents),Gx.config({mode:"acyclic"}),Fb.config({find:e=>le(eJ.getViewItems(e))}),HI.withComp(F.none(),(e=>(e.getSystem().broadcastOn([cJ],{}),n.get())),((e,t)=>{n.set(t),e.getSystem().broadcastOn([dJ],{})}))])})},mJ=cl("update-dialog"),gJ=cl("update-title"),pJ=cl("update-body"),hJ=cl("update-footer"),fJ=cl("body-send-message"),bJ=(e,t,o,n,r)=>{const s=e=>{const t=e.body;switch(t.type){case"tabpanel":return[uJ(t,e.initialData,n)];default:return[zY(t,e.initialData,n)]}},a=(e,t)=>F.some({isTabPanel:()=>"tabpanel"===t.body.type}),i={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...o.map((e=>({id:e}))).getOr({}),...r?i:{}}},components:[],behaviours:Fu([MI.childAt(0),hj.config({channel:`${pJ}-${t}`,updateState:a,renderComponents:s,initialData:e})])}},vJ=(e,t,o,n,r)=>bJ(e,t,F.some(o),n,r),yJ=(e,t,o)=>{const n=bJ(e,t,F.none(),o,!1);return tX.parts.body(n)},xJ=e=>{const t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[ZI({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:Fu([ZM.config({}),fw.config({})])})]}],behaviours:Fu([Gx.config({mode:"acyclic",useTabstopAt:T(tR)})])};return tX.parts.body(t)};function wJ(e){return wJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wJ(e)}function SJ(e,t){return SJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},SJ(e,t)}function kJ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function CJ(e,t,o){return CJ=kJ()?Reflect.construct:function(e,t,o){var n=[null];n.push.apply(n,t);var r=Function.bind.apply(e,n),s=new r;return o&&SJ(s,o.prototype),s},CJ.apply(null,arguments)}function OJ(e){return _J(e)||TJ(e)||EJ(e)||MJ()}function _J(e){if(Array.isArray(e))return DJ(e)}function TJ(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function EJ(e,t){if(e){if("string"===typeof e)return DJ(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?DJ(e,t):void 0}}function DJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function MJ(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var AJ=Object.hasOwnProperty,BJ=Object.setPrototypeOf,FJ=Object.isFrozen,IJ=Object.getPrototypeOf,RJ=Object.getOwnPropertyDescriptor,NJ=Object.freeze,VJ=Object.seal,HJ=Object.create,zJ="undefined"!==typeof Reflect&&Reflect,PJ=zJ.apply,LJ=zJ.construct;PJ||(PJ=function(e,t,o){return e.apply(t,o)}),NJ||(NJ=function(e){return e}),VJ||(VJ=function(e){return e}),LJ||(LJ=function(e,t){return CJ(e,OJ(t))});var UJ=ZJ(Array.prototype.forEach),WJ=ZJ(Array.prototype.pop),jJ=ZJ(Array.prototype.push),GJ=ZJ(String.prototype.toLowerCase),$J=ZJ(String.prototype.match),qJ=ZJ(String.prototype.replace),KJ=ZJ(String.prototype.indexOf),XJ=ZJ(String.prototype.trim),YJ=ZJ(RegExp.prototype.test),JJ=QJ(TypeError);function ZJ(e){return function(t){for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];return PJ(e,t,n)}}function QJ(e){return function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return LJ(e,o)}}function eZ(e,t){BJ&&BJ(e,null);var o=t.length;while(o--){var n=t[o];if("string"===typeof n){var r=GJ(n);r!==n&&(FJ(t)||(t[o]=r),n=r)}e[n]=!0}return e}function tZ(e){var t,o=HJ(null);for(t in e)PJ(AJ,e,[t])&&(o[t]=e[t]);return o}function oZ(e,t){while(null!==e){var o=RJ(e,t);if(o){if(o.get)return ZJ(o.get);if("function"===typeof o.value)return ZJ(o.value)}e=IJ(e)}function n(e){return console.warn("fallback value for",e),null}return n}var nZ=NJ(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),rZ=NJ(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),sZ=NJ(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),aZ=NJ(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),iZ=NJ(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),lZ=NJ(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),cZ=NJ(["#text"]),dZ=NJ(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),uZ=NJ(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mZ=NJ(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),gZ=NJ(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pZ=VJ(/\{\{[\w\W]*|[\w\W]*\}\}/gm),hZ=VJ(/<%[\w\W]*|[\w\W]*%>/gm),fZ=VJ(/^data-[\-\w.\u00B7-\uFFFF]/),bZ=VJ(/^aria-[\-\w]+$/),vZ=VJ(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yZ=VJ(/^(?:\w+script|data):/i),xZ=VJ(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wZ=VJ(/^html$/i),SZ=function(){return"undefined"===typeof window?null:window},kZ=function(e,t){if("object"!==wJ(e)||"function"!==typeof e.createPolicy)return null;var o=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(o=t.currentScript.getAttribute(n));var r="dompurify"+(o?"#"+o:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(s){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function CZ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SZ(),t=function(e){return CZ(e)};if(t.version="2.3.8",t.removed=[],!e||!e.document||9!==e.document.nodeType)return t.isSupported=!1,t;var o=e.document,n=e.document,r=e.DocumentFragment,s=e.HTMLTemplateElement,a=e.Node,i=e.Element,l=e.NodeFilter,c=e.NamedNodeMap,d=void 0===c?e.NamedNodeMap||e.MozNamedAttrMap:c,u=e.HTMLFormElement,m=e.DOMParser,g=e.trustedTypes,p=i.prototype,h=oZ(p,"cloneNode"),f=oZ(p,"nextSibling"),b=oZ(p,"childNodes"),v=oZ(p,"parentNode");if("function"===typeof s){var y=n.createElement("template");y.content&&y.content.ownerDocument&&(n=y.content.ownerDocument)}var x=kZ(g,o),w=x?x.createHTML(""):"",S=n,k=S.implementation,C=S.createNodeIterator,O=S.createDocumentFragment,_=S.getElementsByTagName,T=o.importNode,E={};try{E=tZ(n).documentMode?n.documentMode:{}}catch(Le){}var D={};t.isSupported="function"===typeof v&&k&&"undefined"!==typeof k.createHTMLDocument&&9!==E;var M,A,B=pZ,F=hZ,I=fZ,R=bZ,N=yZ,V=xZ,H=vZ,z=null,P=eZ({},[].concat(OJ(nZ),OJ(rZ),OJ(sZ),OJ(iZ),OJ(cZ))),L=null,U=eZ({},[].concat(OJ(dZ),OJ(uZ),OJ(mZ),OJ(gZ))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,G=null,$=!0,q=!0,K=!1,X=!1,Y=!1,J=!1,Z=!1,Q=!1,ee=!1,te=!1,oe=!0,ne=!0,re=!1,se={},ae=null,ie=eZ({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),le=null,ce=eZ({},["audio","video","img","source","image","track"]),de=null,ue=eZ({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",pe="http://www.w3.org/1999/xhtml",he=pe,fe=!1,be=["application/xhtml+xml","text/html"],ve="text/html",ye=null,xe=n.createElement("form"),we=function(e){return e instanceof RegExp||e instanceof Function},Se=function(e){ye&&ye===e||(e&&"object"===wJ(e)||(e={}),e=tZ(e),z="ALLOWED_TAGS"in e?eZ({},e.ALLOWED_TAGS):P,L="ALLOWED_ATTR"in e?eZ({},e.ALLOWED_ATTR):U,de="ADD_URI_SAFE_ATTR"in e?eZ(tZ(ue),e.ADD_URI_SAFE_ATTR):ue,le="ADD_DATA_URI_TAGS"in e?eZ(tZ(ce),e.ADD_DATA_URI_TAGS):ce,ae="FORBID_CONTENTS"in e?eZ({},e.FORBID_CONTENTS):ie,j="FORBID_TAGS"in e?eZ({},e.FORBID_TAGS):{},G="FORBID_ATTR"in e?eZ({},e.FORBID_ATTR):{},se="USE_PROFILES"in e&&e.USE_PROFILES,$=!1!==e.ALLOW_ARIA_ATTR,q=!1!==e.ALLOW_DATA_ATTR,K=e.ALLOW_UNKNOWN_PROTOCOLS||!1,X=e.SAFE_FOR_TEMPLATES||!1,Y=e.WHOLE_DOCUMENT||!1,Q=e.RETURN_DOM||!1,ee=e.RETURN_DOM_FRAGMENT||!1,te=e.RETURN_TRUSTED_TYPE||!1,Z=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,ne=!1!==e.KEEP_CONTENT,re=e.IN_PLACE||!1,H=e.ALLOWED_URI_REGEXP||H,he=e.NAMESPACE||pe,e.CUSTOM_ELEMENT_HANDLING&&we(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&we(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),M=M=-1===be.indexOf(e.PARSER_MEDIA_TYPE)?ve:e.PARSER_MEDIA_TYPE,A="application/xhtml+xml"===M?function(e){return e}:GJ,X&&(q=!1),ee&&(Q=!0),se&&(z=eZ({},OJ(cZ)),L=[],!0===se.html&&(eZ(z,nZ),eZ(L,dZ)),!0===se.svg&&(eZ(z,rZ),eZ(L,uZ),eZ(L,gZ)),!0===se.svgFilters&&(eZ(z,sZ),eZ(L,uZ),eZ(L,gZ)),!0===se.mathMl&&(eZ(z,iZ),eZ(L,mZ),eZ(L,gZ))),e.ADD_TAGS&&(z===P&&(z=tZ(z)),eZ(z,e.ADD_TAGS)),e.ADD_ATTR&&(L===U&&(L=tZ(L)),eZ(L,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&eZ(de,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(ae===ie&&(ae=tZ(ae)),eZ(ae,e.FORBID_CONTENTS)),ne&&(z["#text"]=!0),Y&&eZ(z,["html","head","body"]),z.table&&(eZ(z,["tbody"]),delete j.tbody),NJ&&NJ(e),ye=e)},ke=eZ({},["mi","mo","mn","ms","mtext"]),Ce=eZ({},["foreignobject","desc","title","annotation-xml"]),Oe=eZ({},["title","style","font","a","script"]),_e=eZ({},rZ);eZ(_e,sZ),eZ(_e,aZ);var Te=eZ({},iZ);eZ(Te,lZ);var Ee=function(e){var t=v(e);t&&t.tagName||(t={namespaceURI:pe,tagName:"template"});var o=GJ(e.tagName),n=GJ(t.tagName);return e.namespaceURI===ge?t.namespaceURI===pe?"svg"===o:t.namespaceURI===me?"svg"===o&&("annotation-xml"===n||ke[n]):Boolean(_e[o]):e.namespaceURI===me?t.namespaceURI===pe?"math"===o:t.namespaceURI===ge?"math"===o&&Ce[n]:Boolean(Te[o]):e.namespaceURI===pe&&(!(t.namespaceURI===ge&&!Ce[n])&&(!(t.namespaceURI===me&&!ke[n])&&(!Te[o]&&(Oe[o]||!_e[o]))))},De=function(e){jJ(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch(Le){try{e.outerHTML=w}catch(Le){e.remove()}}},Me=function(e,o){try{jJ(t.removed,{attribute:o.getAttributeNode(e),from:o})}catch(Le){jJ(t.removed,{attribute:null,from:o})}if(o.removeAttribute(e),"is"===e&&!L[e])if(Q||ee)try{De(o)}catch(Le){}else try{o.setAttribute(e,"")}catch(Le){}},Ae=function(e){var t,o;if(Z)e="<remove></remove>"+e;else{var r=$J(e,/^[\r\n\t ]+/);o=r&&r[0]}"application/xhtml+xml"===M&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var s=x?x.createHTML(e):e;if(he===pe)try{t=(new m).parseFromString(s,M)}catch(Le){}if(!t||!t.documentElement){t=k.createDocument(he,"template",null);try{t.documentElement.innerHTML=fe?"":s}catch(Le){}}var a=t.body||t.documentElement;return e&&o&&a.insertBefore(n.createTextNode(o),a.childNodes[0]||null),he===pe?_.call(t,Y?"html":"body")[0]:Y?t.documentElement:a},Be=function(e){return C.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Fe=function(e){return e instanceof u&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof d)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore)},Ie=function(e){return"object"===wJ(a)?e instanceof a:e&&"object"===wJ(e)&&"number"===typeof e.nodeType&&"string"===typeof e.nodeName},Re=function(e,o,n){D[e]&&UJ(D[e],(function(e){e.call(t,o,n,ye)}))},Ne=function(e){var o;if(Re("beforeSanitizeElements",e,null),Fe(e))return De(e),!0;if(YJ(/[\u0080-\uFFFF]/,e.nodeName))return De(e),!0;var n=A(e.nodeName);if(Re("uponSanitizeElement",e,{tagName:n,allowedTags:z}),e.hasChildNodes()&&!Ie(e.firstElementChild)&&(!Ie(e.content)||!Ie(e.content.firstElementChild))&&YJ(/<[/\w]/g,e.innerHTML)&&YJ(/<[/\w]/g,e.textContent))return De(e),!0;if("select"===n&&YJ(/<template/i,e.innerHTML))return De(e),!0;if(!z[n]||j[n]){if(!j[n]&&He(n)){if(W.tagNameCheck instanceof RegExp&&YJ(W.tagNameCheck,n))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(n))return!1}if(ne&&!ae[n]){var r=v(e)||e.parentNode,s=b(e)||e.childNodes;if(s&&r)for(var a=s.length,l=a-1;l>=0;--l)r.insertBefore(h(s[l],!0),f(e))}return De(e),!0}return e instanceof i&&!Ee(e)?(De(e),!0):"noscript"!==n&&"noembed"!==n||!YJ(/<\/no(script|embed)/i,e.innerHTML)?(X&&3===e.nodeType&&(o=e.textContent,o=qJ(o,B," "),o=qJ(o,F," "),e.textContent!==o&&(jJ(t.removed,{element:e.cloneNode()}),e.textContent=o)),Re("afterSanitizeElements",e,null),!1):(De(e),!0)},Ve=function(e,t,o){if(oe&&("id"===t||"name"===t)&&(o in n||o in xe))return!1;if(q&&!G[t]&&YJ(I,t));else if($&&YJ(R,t));else if(!L[t]||G[t]){if(!(He(e)&&(W.tagNameCheck instanceof RegExp&&YJ(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))&&(W.attributeNameCheck instanceof RegExp&&YJ(W.attributeNameCheck,t)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(t))||"is"===t&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&YJ(W.tagNameCheck,o)||W.tagNameCheck instanceof Function&&W.tagNameCheck(o))))return!1}else if(de[t]);else if(YJ(H,qJ(o,V,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==KJ(o,"data:")||!le[e]){if(K&&!YJ(N,qJ(o,V,"")));else if(o)return!1}else;return!0},He=function(e){return e.indexOf("-")>0},ze=function(e){var t,o,n,r;Re("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L};r=s.length;while(r--){t=s[r];var i=t,l=i.name,c=i.namespaceURI;o="value"===l?t.value:XJ(t.value),n=A(l);var d=o;if(a.attrName=n,a.attrValue=o,a.keepAttr=!0,a.forceKeepAttr=void 0,Re("uponSanitizeAttribute",e,a),o=a.attrValue,!a.forceKeepAttr)if(a.keepAttr)if(YJ(/\/>/i,o))Me(l,e);else{X&&(o=qJ(o,B," "),o=qJ(o,F," "));var u=A(e.nodeName);if(Ve(u,n,o)){if(o!==d)try{c?e.setAttributeNS(c,l,o):e.setAttribute(l,o)}catch(Le){Me(l,e)}}else Me(l,e)}else Me(l,e)}Re("afterSanitizeAttributes",e,null)}},Pe=function e(t){var o,n=Be(t);Re("beforeSanitizeShadowDOM",t,null);while(o=n.nextNode())Re("uponSanitizeShadowNode",o,null),Ne(o)||(o.content instanceof r&&e(o.content),ze(o));Re("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(n,s){var i,l,c,d,u;if(fe=!n,fe&&(n="\x3c!--\x3e"),"string"!==typeof n&&!Ie(n)){if("function"!==typeof n.toString)throw JJ("toString is not a function");if(n=n.toString(),"string"!==typeof n)throw JJ("dirty is not a string, aborting")}if(!t.isSupported){if("object"===wJ(e.toStaticHTML)||"function"===typeof e.toStaticHTML){if("string"===typeof n)return e.toStaticHTML(n);if(Ie(n))return e.toStaticHTML(n.outerHTML)}return n}if(J||Se(s),t.removed=[],"string"===typeof n&&(re=!1),re){if(n.nodeName){var m=A(n.nodeName);if(!z[m]||j[m])throw JJ("root node is forbidden and cannot be sanitized in-place")}}else if(n instanceof a)i=Ae("\x3c!----\x3e"),l=i.ownerDocument.importNode(n,!0),1===l.nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?i=l:i.appendChild(l);else{if(!Q&&!X&&!Y&&-1===n.indexOf("<"))return x&&te?x.createHTML(n):n;if(i=Ae(n),!i)return Q?null:te?w:""}i&&Z&&De(i.firstChild);var g=Be(re?n:i);while(c=g.nextNode())3===c.nodeType&&c===d||Ne(c)||(c.content instanceof r&&Pe(c.content),ze(c),d=c);if(d=null,re)return n;if(Q){if(ee){u=O.call(i.ownerDocument);while(i.firstChild)u.appendChild(i.firstChild)}else u=i;return L.shadowroot&&(u=T.call(o,u,!0)),u}var p=Y?i.outerHTML:i.innerHTML;return Y&&z["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&YJ(wZ,i.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+p),X&&(p=qJ(p,B," "),p=qJ(p,F," ")),x&&te?x.createHTML(p):p},t.setConfig=function(e){Se(e),J=!0},t.clearConfig=function(){ye=null,J=!1},t.isValidAttribute=function(e,t,o){ye||Se({});var n=A(e),r=A(t);return Ve(n,r,o)},t.addHook=function(e,t){"function"===typeof t&&(D[e]=D[e]||[],jJ(D[e],t))},t.removeHook=function(e){if(D[e])return WJ(D[e])},t.removeHooks=function(e){D[e]&&(D[e]=[])},t.removeAllHooks=function(){D={}},t}var OZ=CZ();const _Z=e=>OZ().sanitize(e),TZ=ok.deviceType.isTouch(),EZ=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),DZ=(e,t)=>tX.parts.close(FS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:Fu([ZM.config({})])})),MZ=()=>tX.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),AZ=(e,t)=>tX.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:AL(`<p>${_Z(t.translate(e))}</p>`)}]}]}),BZ=e=>tX.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),FZ=(e,t)=>[UM.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),UM.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],IZ=e=>{const t="tox-dialog",o=t+"-wrap",n=o+"__backdrop",r=t+"__disable-scroll";return tX.sketch({lazySink:e.lazySink,onEscape:t=>(e.onEscape(t),F.some(!0)),useTabstopAt:e=>!tR(e),dom:{tag:"div",classes:[t].concat(e.extraClasses),styles:{position:"relative",...e.extraStyles}},components:[e.header,e.body,...e.footer.toArray()],parts:{blocker:{dom:AL(`<div class="${o}"></div>`),components:[{dom:{tag:"div",classes:TZ?[n,n+"--opaque"]:[n]}}]}},dragBlockClass:o,modalBehaviours:Fu([fw.config({}),iw("dialog-events",e.dialogEvents.concat([$i(Ua(),((e,t)=>{Gx.focusIn(e)}))])),iw("scroll-lock",[qi((()=>{uc(Jt(),r)})),Ki((()=>{gc(Jt(),r)}))]),...e.extraBehaviours]),eventOrder:{[si()]:["dialog-events"],[fi()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[bi()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...e.eventOrder}})},RZ=e=>FS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[$S("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:e=>{_i(e,lA)}}),NZ=(e,t,o,n)=>{const r=e=>[Uc(n.translate(e.title))];return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...o.map((e=>({id:e}))).getOr({})}},components:[],behaviours:Fu([hj.config({channel:`${gJ}-${t}`,initialData:e,renderComponents:r})])}},VZ=()=>({dom:AL('<div class="tox-dialog__draghandle"></div>')}),HZ=(e,t,o,n)=>UM.sketch({dom:AL('<div class="tox-dialog__header"></div>'),components:[NZ(e,t,F.some(o),n),VZ(),RZ(n)],containerBehaviours:Fu([DK.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>rd(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}),zZ=(e,t,o)=>{const n=tX.parts.title(NZ(e,t,F.none(),o)),r=tX.parts.draghandle(VZ()),s=tX.parts.close(RZ(o)),a=[n].concat(e.draggable?[r]:[]).concat([s]);return UM.sketch({dom:AL('<div class="tox-dialog__header"></div>'),components:a})},PZ=(e,t,o)=>zZ({title:o.shared.providers.translate(e),draggable:o.dialog.isDraggableModal()},t,o.shared.providers),LZ=(e,t,o)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":o.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:AL('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),UZ=(e,t,o)=>({onClose:()=>o.closeWindow(),onBlock:o=>{tX.setBusy(e(),((e,n)=>LZ(o.message,n,t)))},onUnblock:()=>{tX.setIdle(e())}}),WZ=(e,t,o,n)=>{const r=(e,t)=>F.some(t);return qc(IZ({...e,lazySink:n.shared.getSink,extraBehaviours:[hj.config({channel:`${mJ}-${e.id}`,updateState:r,initialData:t}),HI.memory({}),...e.extraBehaviours],onEscape:e=>{_i(e,lA)},dialogEvents:o,eventOrder:{[ri()]:[hj.name(),zu.name()],[fi()]:["scroll-lock",hj.name(),"messages","dialog-events","alloy.base.behaviour"],[bi()]:["alloy.base.behaviour","dialog-events","messages",hj.name(),"scroll-lock"]}}))},jZ=e=>{const t=e=>{const t=W(e.items,(e=>{const t=ca(!1);return{...e,storage:t}}));return{...e,items:t}};return W(e,(e=>"menu"===e.type?t(e):e))},GZ=e=>X(e,((e,t)=>{if("menu"===t.type){const o=t;return X(o.items,((e,t)=>(e[t.name]=t.storage,e)),e)}return e}),{}),$Z=(e,t)=>[Wi(Ua(),eR),e(iA,((e,o)=>{t.onClose(),o.onClose()})),e(lA,((e,t,o,n)=>{t.onCancel(e),_i(n,iA)})),Vi(mA,((e,o)=>t.onUnblock())),Vi(uA,((e,o)=>t.onBlock(o.event)))],qZ=(e,t)=>{const o=(t,o)=>Vi(t,((t,r)=>{n(t,((n,s)=>{o(e(),n,r.event,t)}))})),n=(e,t)=>{hj.getState(e).get().each((o=>{t(o,e)}))};return[...$Z(o,t),o(cA,((e,t,o)=>{t.onAction(e,{name:o.name})}))]},KZ=(e,t,o)=>{const n=(t,o)=>Vi(t,((t,n)=>{r(t,((r,s)=>{o(e(),r,n.event,t)}))})),r=(e,t)=>{hj.getState(e).get().each((o=>{t(o.internalDialog,e)}))};return[...$Z(n,t),n(dA,((e,t)=>t.onSubmit(e))),n(aA,((e,t,o)=>{t.onChange(e,{name:o.name})})),n(cA,((e,t,n,r)=>{const s=()=>Gx.focusIn(r),a=e=>ro(e,"disabled")||no(e,"aria-disabled").exists((e=>"true"===e)),i=Wt(r.element),l=Gu(i);t.onAction(e,{name:n.name,value:n.value}),Gu(i).fold(s,(e=>{a(e)||l.exists((t=>_t(e,t)&&a(t)))?s():o().toOptional().filter((t=>!_t(t.element,e))).each(s)}))})),n(gA,((e,t,o)=>{t.onTabChange(e,{newTabName:o.name,oldTabName:o.oldName})})),Ki((t=>{const o=e();hf.setValue(t,o.getData())}))]},XZ={initUrlDialog:qZ,initDialog:KZ},YZ=(e,t)=>UN(e,e.type,t),JZ=(e,t,o)=>J(t,(e=>e.name===o)).bind((t=>t.memento.getOpt(e))),ZZ=(e,t)=>{const o=t.map((e=>e.footerButtons)).getOr([]),n=$(o,(e=>"start"===e.align)),r=(e,t)=>UM.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${e}`]},components:W(t,(e=>e.memento.asSpec()))}),s=r("start",n.pass),a=r("end",n.fail);return[s,a]},QZ=(e,t,o)=>{const n=(e,t)=>{const n=W(t.buttons,(e=>{const t=IS(YZ(e,o));return{name:e.name,align:e.align,memento:t}})),r=t=>JZ(e,n,t);return F.some({lookupByName:r,footerButtons:n})};return{dom:AL('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Fu([hj.config({channel:`${hJ}-${t}`,initialData:e,updateState:n,renderComponents:ZZ})])}},eQ=(e,t,o)=>QZ(e,t,o),tQ=(e,t,o)=>tX.parts.footer(QZ(e,t,o)),oQ=(e,t)=>{const o=e.getRoot();if(o.getSystem().isConnected()){const o=Fb.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return yI.getField(o,t).orThunk((()=>{const o=e.getFooter(),n=hj.getState(o).get();return n.bind((e=>e.lookupByName(t)))}))}return F.none()},nQ=(e,t)=>{const o=e.getRoot();return hj.getState(o).get().map((e=>Os(Cs("data",e.dataValidator,t)))).getOr(t)},rQ=(e,t,o)=>{const n=t=>{const o=e.getRoot();o.getSystem().isConnected()&&t(o)},r=()=>{const t=e.getRoot(),n=t.getSystem().isConnected()?e.getFormWrapper():t,r=hf.getValue(n),s=he(o,(e=>e.get()));return{...r,...s}},s=t=>{n((n=>{const r=p.getData(),s=_r(r,t),a=nQ(e,s),i=e.getFormWrapper();hf.setValue(i,a),pe(o,((e,t)=>{Oe(s,t)&&e.set(s[t])}))}))},a=(t,o)=>{oQ(e,t).each(o?Zb.enable:Zb.disable)},l=t=>{oQ(e,t).each(fw.focus)},c=e=>{if(!i(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n((t=>{Ti(t,uA,{message:e})}))},d=()=>{n((e=>{_i(e,mA)}))},u=t=>{n((o=>{const n=e.getBody(),r=hj.getState(n);r.get().exists((e=>e.isTabPanel()))&&Fb.getCurrent(n).each((e=>{eJ.showTab(e,t)}))}))},m=o=>{n((n=>{const r=e.getId(),s=t(o);n.getSystem().broadcastOn([`${mJ}-${r}`],s),n.getSystem().broadcastOn([`${gJ}-${r}`],s.internalDialog),n.getSystem().broadcastOn([`${pJ}-${r}`],s.internalDialog),n.getSystem().broadcastOn([`${hJ}-${r}`],s.internalDialog),p.setData(s.initialData)}))},g=()=>{n((e=>{_i(e,iA)}))},p={getData:r,setData:s,setEnabled:a,focus:l,block:c,unblock:d,showTab:u,redial:m,close:g};return p},sQ=e=>{switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},aQ=(e,t,o)=>{const n=cl("dialog"),r=e.internalDialog,s=PZ(r.title,n,o),a=yJ({body:r.body,initialData:r.initialData},n,o),i=jZ(r.buttons),l=GZ(i),c=tQ({buttons:i},n,o),d=XZ.initDialog((()=>h),UZ((()=>g),o.shared.providers,t),o.shared.getSink),u=sQ(r.size),m={id:n,header:s,body:a,footer:F.some(c),extraClasses:u,extraBehaviours:[],extraStyles:{}},g=WZ(m,e,d,o),p=(()=>{const e=()=>{const e=tX.getBody(g);return Fb.getCurrent(e).getOr(e)};return{getId:k(n),getRoot:k(g),getBody:()=>tX.getBody(g),getFooter:()=>tX.getFooter(g),getFormWrapper:e}})(),h=rQ(p,t.redial,l);return{dialog:g,instanceApi:h}},iQ=(e,t,o,n)=>{const r=cl("dialog"),s=cl("dialog-label"),a=cl("dialog-content"),i=e.internalDialog,l=(e,t)=>F.some(t),c=IS(HZ({title:i.title,draggable:!0},r,s,o.shared.providers)),d=IS(vJ({body:i.body,initialData:i.initialData},r,a,o,n)),u=jZ(i.buttons),m=GZ(u),g=IS(eQ({buttons:u},r,o)),p=XZ.initDialog((()=>f),{onBlock:e=>{EL.block(h,((t,n)=>LZ(e.message,n,o.shared.providers)))},onUnblock:()=>{EL.unblock(h)},onClose:()=>t.closeWindow()},o.shared.getSink),h=qc({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:{role:"dialog",["aria-labelledby"]:s,["aria-describedby"]:a}},eventOrder:{[ri()]:[hj.name(),zu.name()],[si()]:["execute-on-form"],[fi()]:["reflecting","execute-on-form"]},behaviours:Fu([Gx.config({mode:"cyclic",onEscape:e=>(_i(e,iA),F.some(!0)),useTabstopAt:e=>!tR(e)&&("button"!==mt(e)||"disabled"!==oo(e,"disabled"))}),hj.config({channel:`${mJ}-${r}`,updateState:l,initialData:e}),fw.config({}),iw("execute-on-form",p.concat([$i(Ua(),((e,t)=>{Gx.focusIn(e)}))])),EL.config({getRoot:()=>F.some(h)}),sw.config({}),HI.memory({})]),components:[c.asSpec(),d.asSpec(),g.asSpec()]}),f=rQ({getId:k(r),getRoot:k(h),getFooter:()=>g.get(h),getBody:()=>d.get(h),getFormWrapper:()=>{const e=d.get(h);return Fb.getCurrent(e).getOr(e)}},t.redial,m);return{dialog:h,instanceApi:f}};var lQ=tinymce.util.Tools.resolve("tinymce.util.URI");const cQ=e=>{const t=t=>{e.getSystem().isConnected()&&t(e)},o=e=>{if(!i(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t((t=>{Ti(t,uA,{message:e})}))},n=()=>{t((e=>{_i(e,mA)}))},r=()=>{t((e=>{_i(e,iA)}))},s=e=>{t((t=>{t.getSystem().broadcastOn([fJ],e)}))};return{block:o,unblock:n,close:r,sendMessage:s}},dQ=["insertContent","setContent","execCommand","close","block","unblock"],uQ=e=>l(e)&&-1!==dQ.indexOf(e.mceAction),mQ=e=>!uQ(e)&&l(e)&&Oe(e,"mceAction"),gQ=(e,t,o)=>{switch(o.mceAction){case"insertContent":e.insertContent(o.content);break;case"setContent":e.setContent(o.content);break;case"execCommand":const n=!!m(o.ui)&&o.ui;e.execCommand(o.cmd,n,o.value);break;case"close":t.close();break;case"block":t.block(o.message);break;case"unblock":t.unblock();break}},pQ=(e,t,o,n)=>{const r=cl("dialog"),s=PZ(e.title,r,n),a=xJ(e),i=e.buttons.bind((e=>0===e.length?F.none():F.some(tQ({buttons:e},r,n)))),l=XZ.initUrlDialog((()=>v),UZ((()=>b),n.shared.providers,t)),c={...e.height.fold((()=>({})),(e=>({height:e+"px","max-height":e+"px"}))),...e.width.fold((()=>({})),(e=>({width:e+"px","max-width":e+"px"})))},d=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],u=new lQ(e.url,{base_uri:new lQ(window.location.href)}),m=`${u.protocol}://${u.host}${u.port?":"+u.port:""}`,g=xm(),p=[iw("messages",[qi((()=>{const t=km(Qe.fromDom(window),"message",(t=>{if(u.isSameOrigin(new lQ(t.raw.origin))){const n=t.raw.data;uQ(n)?gQ(o,v,n):mQ(n)&&e.onMessage(v,n)}}));g.set(t)})),Ki(g.clear)]),zu.config({channels:{[fJ]:{onReceive:(e,t)=>{nd(e.element,"iframe").each((e=>{const o=e.dom.contentWindow;h(o)&&o.postMessage(t,m)}))}}}})],f={id:r,header:s,body:a,footer:i,extraClasses:d,extraBehaviours:p,extraStyles:c},b=WZ(f,e,l,n),v=cQ(b);return{dialog:b,instanceApi:v}},hQ=e=>{const t=e.shared,o=(o,n)=>{const r=()=>{tX.hide(l),n()},s=IS(UN({name:"close-alert",text:"OK",primary:!0,buttonType:F.some("primary"),align:"end",enabled:!0,icon:F.none()},"cancel",e)),a=MZ(),i=DZ(r,t.providers),l=qc(IZ({lazySink:()=>t.getSink(),header:EZ(a,i),body:AZ(o,t.providers),footer:F.some(BZ(FZ([],[s.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Vi(lA,r)],eventOrder:{}}));tX.show(l);const c=s.get(l);fw.focus(c)};return{open:o}},fQ=e=>{const t=e.shared,o=(o,n)=>{const r=e=>{tX.hide(c),n(e)},s=IS(UN({name:"yes",text:"Yes",primary:!0,buttonType:F.some("primary"),align:"end",enabled:!0,icon:F.none()},"submit",e)),a=UN({name:"no",text:"No",primary:!1,buttonType:F.some("secondary"),align:"end",enabled:!0,icon:F.none()},"cancel",e),i=MZ(),l=DZ((()=>r(!1)),t.providers),c=qc(IZ({lazySink:()=>t.getSink(),header:EZ(i,l),body:AZ(o,t.providers),footer:F.some(BZ(FZ([],[a,s.asSpec()]))),onEscape:()=>r(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Vi(lA,(()=>r(!1))),Vi(dA,(()=>r(!0)))],eventOrder:{}}));tX.show(c);const d=s.get(c);fw.focus(d)};return{open:o}},bQ=(e,t)=>Os(Cs("data",t,e)),vQ=e=>vM(e,".tox-alert-dialog")||vM(e,".tox-confirm-dialog"),yQ=(e,t,o)=>t&&o?[]:[Zz.config({contextual:{lazyContext:()=>F.some(tr(Qe.fromDom(e.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})],xQ=e=>{const t=e.editor,o=Qk(t),n=hQ(e.backstages.dialog),r=fQ(e.backstages.dialog),s=(t,o,n)=>void 0!==o&&"toolbar"===o.inline?c(t,e.backstages.popup.shared.anchors.inlineDialog(),n,o.ariaAttrs):void 0!==o&&"cursor"===o.inline?c(t,e.backstages.popup.shared.anchors.cursor(),n,o.ariaAttrs):l(t,n),a=(e,t)=>i(e,t),i=(o,n)=>{const r=o=>{const r=pQ(o,{closeWindow:()=>{tX.hide(r.dialog),n(r.instanceApi)}},t,e.backstages.dialog);return tX.show(r.dialog),r.instanceApi};return VY.openUrl(r,o)},l=(t,o)=>{const n=(t,n,r)=>{const s=n,a={dataValidator:r,initialData:s,internalDialog:t},i=aQ(a,{redial:VY.redial,closeWindow:()=>{tX.hide(i.dialog),o(i.instanceApi)}},e.backstages.dialog);return tX.show(i.dialog),i.instanceApi.setData(s),i.instanceApi};return VY.open(n,t)},c=(n,r,s,a=!1)=>{const i=(n,i,l)=>{const c=bQ(i,l),d=wm(),u=e.backstages.popup.shared.header.isPositionedAtTop(),m={dataValidator:l,initialData:c,internalDialog:n},g=()=>d.on((e=>{MS.reposition(e),Zz.refresh(e)})),p=iQ(m,{redial:VY.redial,closeWindow:()=>{d.on(MS.hide),t.off("ResizeEditor",g),d.clear(),s(p.instanceApi)}},e.backstages.popup,a),h=qc(MS.sketch({lazySink:e.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},...u?{}:{fireRepositionEventInstead:{}},inlineBehaviours:Fu([iw("window-manager-inline-events",[Vi(vi(),((e,t)=>{_i(p.dialog,lA)}))]),...yQ(t,o,u)]),isExtraPart:(e,t)=>vQ(t)}));return d.set(h),MS.showWithin(h,Kc(p.dialog),{anchor:r},F.some(Jt())),o&&u||(Zz.refresh(h),t.on("ResizeEditor",g)),p.instanceApi.setData(c),Gx.focusIn(p.dialog),p.instanceApi};return VY.open(i,n)},d=(e,t)=>{r.open(e,t)},u=(e,t)=>{n.open(e,t)},m=e=>{e.close()};return{open:s,openUrl:a,alert:u,close:m,confirm:d}},wQ=e=>{sk(e),DE(e),V$(e)};var SQ=()=>{B.add("silver",(e=>{wQ(e);const{dialogs:t,popups:o,renderUI:n}=KK(e);bM.register(e,o.backstage.shared);const r=xQ({editor:e,backstages:{popup:o.backstage,dialog:t.backstage}}),s=()=>QS(e,{backstage:o.backstage},o.getMothership());return{renderUI:n,getWindowManagerImpl:k(r),getNotificationManagerImpl:s}}))};SQ()})();