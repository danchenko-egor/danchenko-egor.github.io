(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.ModelManager");const t=(e,t,o)=>{var n;return!!o(e,t.prototype)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name},o=e=>{const o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&t(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":o},n=e=>t=>o(t)===e,r=e=>t=>typeof t===e,s=e=>t=>e===t,l=n("string"),c=n("object"),a=n("array"),i=s(null),m=r("boolean"),d=s(void 0),u=e=>null===e||void 0===e,f=e=>!u(e),g=r("function"),h=r("number"),p=()=>{},b=(e,t)=>(...o)=>e(t.apply(null,o)),w=(e,t)=>o=>e(t(o)),v=e=>()=>e,y=e=>e,C=(e,t)=>e===t;function x(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const S=e=>t=>!e(t),T=e=>()=>{throw new Error(e)},R=e=>e(),D=v(!1),O=v(!0);class k{constructor(e,t){this.tag=e,this.value=t}static some(e){return new k(!0,e)}static none(){return k.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?k.some(e(this.value)):k.none()}bind(e){return this.tag?e(this.value):k.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:k.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!==e&&void 0!==e?e:"Called getOrDie on None")}static from(e){return f(e)?k.some(e):k.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}k.singletonNone=new k(!1);const E=Array.prototype.slice,N=Array.prototype.indexOf,A=Array.prototype.push,z=(e,t)=>N.call(e,t),B=(e,t)=>z(e,t)>-1,j=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];if(t(n,o))return!0}return!1},L=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},W=(e,t)=>{const o=e.length,n=new Array(o);for(let r=0;r<o;r++){const o=e[r];n[r]=t(o,r)}return n},_=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];t(n,o)}},M=(e,t)=>{for(let o=e.length-1;o>=0;o--){const n=e[o];t(n,o)}},I=(e,t)=>{const o=[],n=[];for(let r=0,s=e.length;r<s;r++){const s=e[r],l=t(s,r)?o:n;l.push(s)}return{pass:o,fail:n}},P=(e,t)=>{const o=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t(r,n)&&o.push(r)}return o},F=(e,t,o)=>(M(e,((e,n)=>{o=t(o,e,n)})),o),H=(e,t,o)=>(_(e,((e,n)=>{o=t(o,e,n)})),o),$=(e,t,o)=>{for(let n=0,r=e.length;n<r;n++){const r=e[n];if(t(r,n))return k.some(r);if(o(r,n))break}return k.none()},q=(e,t)=>$(e,t,D),V=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const n=e[o];if(t(n,o))return k.some(o)}return k.none()},U=e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!a(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);A.apply(t,e[o])}return t},G=(e,t)=>U(W(e,t)),K=(e,t)=>{for(let o=0,n=e.length;o<n;++o){const n=e[o];if(!0!==t(n,o))return!1}return!0},Y=e=>{const t=E.call(e,0);return t.reverse(),t},J=(e,t)=>{const o={};for(let n=0,r=e.length;n<r;n++){const r=e[n];o[String(r)]=t(r,n)}return o},Q=(e,t)=>{const o=E.call(e,0);return o.sort(t),o},X=(e,t)=>t>=0&&t<e.length?k.some(e[t]):k.none(),Z=e=>X(e,0),ee=e=>X(e,e.length-1),te=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return k.none()},oe=Object.keys,ne=Object.hasOwnProperty,re=(e,t)=>{const o=oe(e);for(let n=0,r=o.length;n<r;n++){const r=o[n],s=e[r];t(s,r)}},se=(e,t)=>le(e,((e,o)=>({k:o,v:t(e,o)}))),le=(e,t)=>{const o={};return re(e,((e,n)=>{const r=t(e,n);o[r.k]=r.v})),o},ce=e=>(t,o)=>{e[o]=t},ae=(e,t,o,n)=>{re(e,((e,r)=>{(t(e,r)?o:n)(e,r)}))},ie=(e,t)=>{const o={};return ae(e,t,ce(o),p),o},me=(e,t)=>{const o=[];return re(e,((e,n)=>{o.push(t(e,n))})),o},de=e=>me(e,y),ue=(e,t)=>fe(e,t)?k.from(e[t]):k.none(),fe=(e,t)=>ne.call(e,t),ge=(e,t)=>fe(e,t)&&void 0!==e[t]&&null!==e[t],he=e=>{for(const t in e)if(ne.call(e,t))return!1;return!0};"undefined"!==typeof window?window:Function("return this;")();const pe=8,be=9,we=11,ve=1,ye=3,Ce=e=>{const t=e.dom.nodeName;return t.toLowerCase()},xe=e=>e.dom.nodeType,Se=e=>t=>xe(t)===e,Te=e=>xe(e)===pe||"#comment"===Ce(e),Re=Se(ve),De=Se(ye),Oe=Se(be),ke=Se(we),Ee=e=>t=>Re(t)&&Ce(t)===e,Ne=(e,t,o)=>{if(!(l(o)||m(o)||h(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},Ae=(e,t,o)=>{Ne(e.dom,t,o)},ze=(e,t)=>{const o=e.dom;re(t,((e,t)=>{Ne(o,t,e)}))},Be=(e,t)=>{re(t,((t,o)=>{t.fold((()=>{We(e,o)}),(t=>{Ne(e.dom,o,t)}))}))},je=(e,t)=>{const o=e.dom.getAttribute(t);return null===o?void 0:o},Le=(e,t)=>k.from(je(e,t)),We=(e,t)=>{e.dom.removeAttribute(t)},_e=e=>H(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),Me=(e,t)=>{const o=t||document,n=o.createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return Fe(n.childNodes[0])},Ie=(e,t)=>{const o=t||document,n=o.createElement(e);return Fe(n)},Pe=(e,t)=>{const o=t||document,n=o.createTextNode(e);return Fe(n)},Fe=e=>{if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},He=(e,t,o)=>k.from(e.dom.elementFromPoint(t,o)).map(Fe),$e={fromHtml:Me,fromTag:Ie,fromText:Pe,fromDom:Fe,fromPoint:He},qe=(e,t)=>{const o=e.dom;if(o.nodeType!==ve)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Ve=e=>e.nodeType!==ve&&e.nodeType!==be&&e.nodeType!==we||0===e.childElementCount,Ue=(e,t)=>{const o=void 0===t?document:t.dom;return Ve(o)?[]:W(o.querySelectorAll(e),$e.fromDom)},Ge=(e,t)=>{const o=void 0===t?document:t.dom;return Ve(o)?k.none():k.from(o.querySelector(e)).map($e.fromDom)},Ke=(e,t)=>e.dom===t.dom,Ye=(e,t)=>{const o=e.dom,n=t.dom;return o!==n&&o.contains(n)},Je=qe,Qe=e=>$e.fromDom(e.dom.ownerDocument),Xe=e=>Oe(e)?e:Qe(e),Ze=e=>$e.fromDom(Xe(e).dom.documentElement),et=e=>$e.fromDom(Xe(e).dom.defaultView),tt=e=>k.from(e.dom.parentNode).map($e.fromDom),ot=e=>k.from(e.dom.parentElement).map($e.fromDom),nt=(e,t)=>{const o=g(t)?t:D;let n=e.dom;const r=[];while(null!==n.parentNode&&void 0!==n.parentNode){const e=n.parentNode,t=$e.fromDom(e);if(r.push(t),!0===o(t))break;n=e}return r},rt=e=>k.from(e.dom.previousSibling).map($e.fromDom),st=e=>k.from(e.dom.nextSibling).map($e.fromDom),lt=e=>W(e.dom.childNodes,$e.fromDom),ct=(e,t)=>{const o=e.dom.childNodes;return k.from(o[t]).map($e.fromDom)},at=e=>ct(e,0),it=(e,t)=>{const o=tt(e);o.each((o=>{o.dom.insertBefore(t.dom,e.dom)}))},mt=(e,t)=>{const o=st(e);o.fold((()=>{const o=tt(e);o.each((e=>{ut(e,t)}))}),(e=>{it(e,t)}))},dt=(e,t)=>{const o=at(e);o.fold((()=>{ut(e,t)}),(o=>{e.dom.insertBefore(t.dom,o.dom)}))},ut=(e,t)=>{e.dom.appendChild(t.dom)},ft=(e,t,o)=>{ct(e,o).fold((()=>{ut(e,t)}),(e=>{it(e,t)}))},gt=(e,t)=>{it(e,t),ut(t,e)},ht=(e,t)=>{_(t,((o,n)=>{const r=0===n?e:t[n-1];mt(r,o)}))},pt=(e,t)=>{_(t,(t=>{ut(e,t)}))},bt=e=>{e.dom.textContent="",_(lt(e),(e=>{wt(e)}))},wt=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},vt=e=>{const t=lt(e);t.length>0&&ht(e,t),wt(e)},yt=(e,t)=>$e.fromDom(e.dom.cloneNode(t)),Ct=e=>yt(e,!1),xt=e=>yt(e,!0),St=(e,t)=>{const o=$e.fromTag(t),n=_e(e);return ze(o,n),o},Tt=(e,t)=>{const o=St(e,t),n=lt(xt(e));return pt(o,n),o},Rt=(e,t)=>{const o=St(e,t);mt(e,o);const n=lt(e);return pt(o,n),wt(e),o},Dt=["tfoot","thead","tbody","colgroup"],Ot=e=>B(Dt,e),kt=(e,t)=>({rows:e,columns:t}),Et=(e,t)=>({row:e,column:t}),Nt=(e,t,o)=>({element:e,rowspan:t,colspan:o}),At=(e,t,o,n)=>({element:e,rowspan:t,colspan:o,isNew:n}),zt=(e,t,o,n,r,s)=>({element:e,rowspan:t,colspan:o,row:n,column:r,isLocked:s}),Bt=(e,t,o)=>({element:e,cells:t,section:o}),jt=(e,t,o,n)=>({element:e,cells:t,section:o,isNew:n}),Lt=(e,t,o)=>({element:e,isNew:t,isLocked:o}),Wt=(e,t,o,n)=>({element:e,cells:t,section:o,isNew:n}),_t=(e,t,o,n)=>({startRow:e,startCol:t,finishRow:o,finishCol:n}),Mt=(e,t,o)=>({element:e,colspan:t,column:o}),It=(e,t)=>({element:e,columns:t}),Pt=e=>ke(e)&&f(e.dom.host),Ft=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode),Ht=v(Ft),$t=Ft?e=>$e.fromDom(e.dom.getRootNode()):Xe,qt=e=>{const t=$t(e);return Pt(t)?k.some(t):k.none()},Vt=e=>$e.fromDom(e.dom.host),Ut=e=>{if(Ht()&&f(e.target)){const t=$e.fromDom(e.target);if(Re(t)&&Gt(t)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return Z(t)}}return k.from(e.target)},Gt=e=>f(e.dom.shadowRoot),Kt=e=>{const t=De(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return qt($e.fromDom(t)).fold((()=>o.body.contains(t)),w(Kt,Vt))},Yt=()=>Jt($e.fromDom(document)),Jt=e=>{const t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return $e.fromDom(t)},Qt=(e,t,o)=>P(nt(e,o),t),Xt=(e,t)=>P(lt(e),t),Zt=(e,t)=>{let o=[];return _(lt(e),(e=>{t(e)&&(o=o.concat([e])),o=o.concat(Zt(e,t))})),o},eo=(e,t,o)=>Qt(e,(e=>qe(e,t)),o),to=(e,t)=>Xt(e,(e=>qe(e,t))),oo=(e,t)=>Ue(t,e);var no=(e,t,o,n,r)=>e(o,n)?k.some(o):g(r)&&r(o)?k.none():t(o,n,r);const ro=(e,t,o)=>{let n=e.dom;const r=g(o)?o:D;while(n.parentNode){n=n.parentNode;const e=$e.fromDom(n);if(t(e))return k.some(e);if(r(e))break}return k.none()},so=(e,t,o)=>{const n=(e,t)=>t(e);return no(n,ro,e,t,o)},lo=(e,t)=>{const o=e=>t($e.fromDom(e)),n=q(e.dom.childNodes,o);return n.map($e.fromDom)},co=(e,t)=>{const o=e=>{for(let n=0;n<e.childNodes.length;n++){const r=$e.fromDom(e.childNodes[n]);if(t(r))return k.some(r);const s=o(e.childNodes[n]);if(s.isSome())return s}return k.none()};return o(e.dom)},ao=(e,t,o)=>ro(e,(e=>qe(e,t)),o),io=(e,t)=>lo(e,(e=>qe(e,t))),mo=(e,t)=>Ge(t,e),uo=(e,t,o)=>{const n=(e,t)=>qe(e,t);return no(n,ao,e,t,o)},fo=(e,t,o=C)=>e.exists((e=>o(e,t))),go=e=>{const t=[],o=e=>{t.push(e)};for(let n=0;n<e.length;n++)e[n].each(o);return t},ho=(e,t)=>void 0!==e&&null!==e?t(e):k.none(),po=(e,t)=>e?k.some(t):k.none(),bo=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,wo=(e,t,o=0,n)=>{const r=e.indexOf(t,o);return-1!==r&&(!!d(n)||r+t.length<=n)},vo=(e,t)=>bo(e,t,0),yo=(e,t)=>bo(e,t,e.length-t.length),Co=e=>t=>t.replace(e,""),xo=Co(/^\s+|\s+$/g),So=e=>e.length>0,To=e=>{const t=parseFloat(e);return isNaN(t)?k.none():k.some(t)},Ro=e=>void 0!==e.style&&g(e.style.getPropertyValue),Do=(e,t,o)=>{if(!l(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);Ro(e)&&e.style.setProperty(t,o)},Oo=(e,t)=>{Ro(e)&&e.style.removeProperty(t)},ko=(e,t,o)=>{const n=e.dom;Do(n,t,o)},Eo=(e,t)=>{const o=e.dom;re(t,((e,t)=>{Do(o,t,e)}))},No=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o),r=n.getPropertyValue(t);return""!==r||Kt(e)?r:Ao(o,t)},Ao=(e,t)=>Ro(e)?e.style.getPropertyValue(t):"",zo=(e,t)=>{const o=e.dom,n=Ao(o,t);return k.from(n).filter((e=>e.length>0))},Bo=(e,t)=>{const o=e.dom;Oo(o,t),fo(Le(e,"style").map(xo),"")&&We(e,"style")},jo=(e,t)=>{const o=e.dom,n=t.dom;Ro(o)&&Ro(n)&&(n.style.cssText=o.style.cssText)},Lo=(e,t,o=0)=>Le(e,t).map((e=>parseInt(e,10))).getOr(o),Wo=(e,t)=>Lo(e,t,1),_o=e=>Ee("col")(e)?Lo(e,"span",1)>1:Wo(e,"colspan")>1,Mo=e=>Wo(e,"rowspan")>1,Io=(e,t)=>parseInt(No(e,t),10),Po=v(10),Fo=v(10),Ho=(e,t)=>$o(e,t,O),$o=(e,t,o)=>G(lt(e),(e=>qe(e,t)?o(e)?[e]:[]:$o(e,t,o))),qo=(e,t,o=D)=>{if(o(t))return k.none();if(B(e,Ce(t)))return k.some(t);const n=e=>qe(e,"table")||o(e);return ao(t,e.join(","),n)},Vo=(e,t)=>qo(["td","th"],e,t),Uo=e=>Ho(e,"th,td"),Go=e=>qe(e,"colgroup")?to(e,"col"):G(Jo(e),(e=>to(e,"col"))),Ko=(e,t)=>uo(e,"table",t),Yo=e=>Ho(e,"tr"),Jo=e=>Ko(e).fold(v([]),(e=>to(e,"colgroup"))),Qo=(e,t)=>W(e,(e=>{if("colgroup"===Ce(e)){const t=W(Go(e),(e=>{const t=Lo(e,"span",1);return Nt(e,1,t)}));return Bt(e,t,"colgroup")}{const o=W(Uo(e),(e=>{const t=Lo(e,"rowspan",1),o=Lo(e,"colspan",1);return Nt(e,t,o)}));return Bt(e,o,t(e))}})),Xo=e=>tt(e).map((e=>{const t=Ce(e);return Ot(t)?t:"tbody"})).getOr("tbody"),Zo=e=>{const t=Yo(e),o=Jo(e),n=[...o,...t];return Qo(n,Xo)},en=(e,t)=>Qo(e,(()=>t)),tn=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},on=(e,t,o,n)=>{const r=e.isiOS()&&!0===/ipad/i.test(o),s=e.isiOS()&&!r,l=e.isiOS()||e.isAndroid(),c=l||n("(pointer:coarse)"),a=r||!s&&l&&n("(min-device-width:768px)"),i=s||l&&!a,m=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),d=!i&&!a&&!m;return{isiPad:v(r),isiPhone:v(s),isTablet:v(a),isPhone:v(i),isTouch:v(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:v(m),isDesktop:v(d)}},nn=(e,t)=>{for(let o=0;o<e.length;o++){const n=e[o];if(n.test(t))return n}},rn=(e,t)=>{const o=nn(e,t);if(!o)return{major:0,minor:0};const n=e=>Number(t.replace(o,"$"+e));return cn(n(1),n(2))},sn=(e,t)=>{const o=String(t).toLowerCase();return 0===e.length?ln():rn(e,o)},ln=()=>cn(0,0),cn=(e,t)=>({major:e,minor:t}),an={nu:cn,detect:sn,unknown:ln},mn=(e,t)=>te(t.brands,(t=>{const o=t.brand.toLowerCase();return q(e,(e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:an.nu(parseInt(t.version,10),0)})))})),dn=(e,t)=>{const o=String(t).toLowerCase();return q(e,(e=>e.search(o)))},un=(e,t)=>dn(e,t).map((e=>{const o=an.detect(e.versionRegexes,t);return{current:e.name,version:o}})),fn=(e,t)=>dn(e,t).map((e=>{const o=an.detect(e.versionRegexes,t);return{current:e.name,version:o}})),gn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,hn=e=>t=>wo(t,e),pn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>wo(e,"edge/")&&wo(e,"chrome")&&wo(e,"safari")&&wo(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,gn],search:e=>wo(e,"chrome")&&!wo(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>wo(e,"msie")||wo(e,"trident")},{name:"Opera",versionRegexes:[gn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:hn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:hn("firefox")},{name:"Safari",versionRegexes:[gn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(wo(e,"safari")||wo(e,"mobile/"))&&wo(e,"applewebkit")}],bn=[{name:"Windows",search:hn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>wo(e,"iphone")||wo(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:hn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:hn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:hn("linux"),versionRegexes:[]},{name:"Solaris",search:hn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:hn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:hn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],wn={browsers:v(pn),oses:v(bn)},vn="Edge",yn="Chromium",Cn="IE",xn="Opera",Sn="Firefox",Tn="Safari",Rn=()=>Dn({current:void 0,version:an.unknown()}),Dn=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(vn),isChromium:n(yn),isIE:n(Cn),isOpera:n(xn),isFirefox:n(Sn),isSafari:n(Tn)}},On={unknown:Rn,nu:Dn,edge:v(vn),chromium:v(yn),ie:v(Cn),opera:v(xn),firefox:v(Sn),safari:v(Tn)},kn="Windows",En="iOS",Nn="Android",An="Linux",zn="macOS",Bn="Solaris",jn="FreeBSD",Ln="ChromeOS",Wn=()=>_n({current:void 0,version:an.unknown()}),_n=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(kn),isiOS:n(En),isAndroid:n(Nn),isMacOS:n(zn),isLinux:n(An),isSolaris:n(Bn),isFreeBSD:n(jn),isChromeOS:n(Ln)}},Mn={unknown:Wn,nu:_n,windows:v(kn),ios:v(En),android:v(Nn),linux:v(An),macos:v(zn),solaris:v(Bn),freebsd:v(jn),chromeos:v(Ln)},In=(e,t,o)=>{const n=wn.browsers(),r=wn.oses(),s=t.bind((e=>mn(n,e))).orThunk((()=>un(n,e))).fold(On.unknown,On.nu),l=fn(r,e).fold(Mn.unknown,Mn.nu),c=on(l,s,e,o);return{browser:s,os:l,deviceType:c}},Pn={detect:In},Fn=e=>window.matchMedia(e).matches;let Hn=tn((()=>Pn.detect(navigator.userAgent,k.from(navigator.userAgentData),Fn)));const $n=()=>Hn(),qn=(e,t)=>{const o=(t,o)=>{if(!h(o)&&!o.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+o);const n=t.dom;Ro(n)&&(n.style[e]=o+"px")},n=o=>{const n=t(o);if(n<=0||null===n){const t=No(o,e);return parseFloat(t)||0}return n},r=n,s=(e,t)=>H(t,((t,o)=>{const n=No(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r}),0),l=(e,t,o)=>{const n=s(e,o),r=t>n?t-n:0;return r};return{set:o,get:n,getOuter:r,aggregate:s,max:l}},Vn=(e,t)=>To(e).getOr(t),Un=(e,t,o)=>Vn(No(e,t),o),Gn=(e,t,o,n)=>{const r=Un(e,`padding-${o}`,0),s=Un(e,`padding-${n}`,0),l=Un(e,`border-${o}-width`,0),c=Un(e,`border-${n}-width`,0);return t-r-s-l-c},Kn=(e,t)=>{const o=e.dom,n=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?n:Gn(e,n,"left","right")},Yn=e=>Un(e,"height",e.dom.offsetHeight),Jn=e=>Un(e,"width",e.dom.offsetWidth),Qn=e=>Kn(e,"content-box"),Xn=qn("width",(e=>e.dom.offsetWidth)),Zn=e=>Xn.get(e),er=e=>Xn.getOuter(e),tr=Qn,or=Jn,nr=(e,t,o)=>{const n=e.cells,r=n.slice(0,t),s=n.slice(t),l=r.concat(o).concat(s);return lr(e,l)},rr=(e,t,o)=>nr(e,t,[o]),sr=(e,t,o)=>{const n=e.cells;n[t]=o},lr=(e,t)=>Wt(e.element,t,e.section,e.isNew),cr=(e,t)=>{const o=e.cells,n=W(o,t);return Wt(e.element,n,e.section,e.isNew)},ar=(e,t)=>e.cells[t],ir=(e,t)=>ar(e,t).element,mr=e=>e.cells.length,dr=e=>{const t=I(e,(e=>"colgroup"===e.section));return{rows:t.fail,cols:t.pass}},ur=(e,t,o)=>{const n=W(e.cells,o);return Wt(t(e.element),n,e.section,!0)},fr="data-snooker-locked-cols",gr=e=>Le(e,fr).bind((e=>k.from(e.match(/\d+/g)))).map((e=>J(e,O))),hr=e=>{const t=H(dr(e).rows,((e,t)=>(_(t.cells,((t,o)=>{t.isLocked&&(e[o]=!0)})),e)),{}),o=me(t,((e,t)=>parseInt(t,10)));return Q(o)},pr=(e,t)=>e+","+t,br=(e,t,o)=>k.from(e.access[pr(t,o)]),wr=(e,t,o)=>{const n=vr(e,(e=>o(t,e.element)));return n.length>0?k.some(n[0]):k.none()},vr=(e,t)=>{const o=G(e.all,(e=>e.cells));return P(o,t)},yr=e=>{const t={};let o=0;return _(e.cells,(e=>{const n=e.colspan;L(n,(r=>{const s=o+r;t[s]=Mt(e.element,n,s)})),o+=n})),t},Cr=e=>{const t={},o=[],n=Z(e).map((e=>e.element)).bind(Ko),r=n.bind(gr).getOr({});let s=0,l=0,c=0;const{pass:a,fail:i}=I(e,(e=>"colgroup"===e.section));_(i,(e=>{const n=[];_(e.cells,(e=>{let o=0;while(void 0!==t[pr(c,o)])o++;const s=ge(r,o.toString()),a=zt(e.element,e.rowspan,e.colspan,c,o,s);for(let n=0;n<e.colspan;n++)for(let r=0;r<e.rowspan;r++){const e=c+r,s=o+n,i=pr(e,s);t[i]=a,l=Math.max(l,s+1)}n.push(a)})),s++,o.push(Bt(e.element,n,e.section)),c++}));const{columns:m,colgroups:d}=ee(a).map((e=>{const t=yr(e),o=It(e.element,de(t));return{colgroups:[o],columns:t}})).getOrThunk((()=>({colgroups:[],columns:{}}))),u=kt(s,l);return{grid:u,access:t,all:o,columns:m,colgroups:d}},xr=e=>{const t=Zo(e);return Cr(t)},Sr=e=>G(e.all,(e=>e.cells)),Tr=e=>de(e.columns),Rr=e=>oe(e.columns).length>0,Dr=(e,t)=>k.from(e.columns[t]),Or={fromTable:xr,generate:Cr,getAt:br,findItem:wr,filterItems:vr,justCells:Sr,justColumns:Tr,hasColumns:Rr,getColumnAt:Dr},kr=(e,t=O)=>{const o=e.grid,n=L(o.columns,y),r=L(o.rows,y);return W(n,(o=>{const n=()=>G(r,(t=>Or.getAt(e,t,o).filter((e=>e.column===o)).toArray())),s=e=>1===e.colspan&&t(e.element),l=()=>Or.getAt(e,0,o);return Er(n,s,l)}))},Er=(e,t,o)=>{const n=e(),r=q(n,t),s=r.orThunk((()=>k.from(n[0]).orThunk(o)));return s.map((e=>e.element))},Nr=e=>{const t=e.grid,o=L(t.rows,y),n=L(t.columns,y);return W(o,(t=>{const o=()=>G(n,(o=>Or.getAt(e,t,o).filter((e=>e.row===t)).fold(v([]),(e=>[e])))),r=e=>1===e.rowspan,s=()=>Or.getAt(e,t,0);return Er(o,r,s)}))},Ar=(e,t)=>{if(t<0||t>=e.length-1)return k.none();const o=e[t].fold((()=>{const o=Y(e.slice(0,t));return te(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>k.some({value:e,delta:0}))),n=e[t+1].fold((()=>{const o=e.slice(t+1);return te(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>k.some({value:e,delta:1})));return o.bind((e=>n.map((t=>{const o=t.delta+e.delta;return Math.abs(t.value-e.value)/o}))))},zr=(e,t)=>o=>"rtl"===Br(o)?t:e,Br=e=>"rtl"===No(e,"direction")?"rtl":"ltr",jr=qn("height",(e=>{const t=e.dom;return Kt(e)?t.getBoundingClientRect().height:t.offsetHeight})),Lr=e=>jr.get(e),Wr=e=>jr.getOuter(e),_r=Yn,Mr=(e,t)=>{const o=(o,n)=>Mr(e+o,t+n);return{left:e,top:t,translate:o}},Ir=Mr,Pr=e=>{const t=e.getBoundingClientRect();return Ir(t.left,t.top)},Fr=(e,t)=>void 0!==e?e:void 0!==t?t:0,Hr=e=>{const t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return Ir(o.offsetLeft,o.offsetTop);const s=Fr(null===n||void 0===n?void 0:n.pageYOffset,r.scrollTop),l=Fr(null===n||void 0===n?void 0:n.pageXOffset,r.scrollLeft),c=Fr(r.clientTop,o.clientTop),a=Fr(r.clientLeft,o.clientLeft);return $r(e).translate(l-a,s-c)},$r=e=>{const t=e.dom,o=t.ownerDocument,n=o.body;return n===t?Ir(n.offsetLeft,n.offsetTop):Kt(e)?Pr(t):Ir(0,0)},qr=(e,t)=>({row:e,y:t}),Vr=(e,t)=>({col:e,x:t}),Ur=e=>{const t=Hr(e);return t.left+er(e)},Gr=e=>Hr(e).left,Kr=(e,t)=>Vr(e,Gr(t)),Yr=(e,t)=>Vr(e,Ur(t)),Jr=e=>Hr(e).top,Qr=(e,t)=>qr(e,Jr(t)),Xr=(e,t)=>qr(e,Jr(t)+Wr(t)),Zr=(e,t,o)=>{if(0===o.length)return[];const n=W(o.slice(1),((t,o)=>t.map((t=>e(o,t))))),r=o[o.length-1].map((e=>t(o.length-1,e)));return n.concat([r])},es=e=>-e,ts={delta:y,positions:e=>Zr(Qr,Xr,e),edge:Jr},os={delta:y,edge:Gr,positions:e=>Zr(Kr,Yr,e)},ns={delta:es,edge:Ur,positions:e=>Zr(Yr,Kr,e)},rs=zr(os,ns),ss={delta:(e,t)=>rs(t).delta(e,t),positions:(e,t)=>rs(t).positions(e,t),edge:e=>rs(e).edge(e)},ls={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},cs=(()=>{const e="[0-9]+",t="[+-]?"+e,o="[eE]"+t,n="\\.",r=e=>`(?:${e})?`,s=["Infinity",e+n+r(e)+r(o),n+e+r(o),e+r(o)].join("|"),l=`[+-]?(?:${s})`;return new RegExp(`^(${l})(.*)$`)})(),as=(e,t)=>j(t,(t=>j(ls[t],(t=>e===t)))),is=(e,t)=>{const o=k.from(cs.exec(e));return o.bind((e=>{const o=Number(e[1]),n=e[2];return as(n,t)?k.some({value:o,unit:n}):k.none()}))},ms=/(\d+(\.\d+)?)%/,ds=/(\d+(\.\d+)?)px|em/,us=Ee("col"),fs=(e,t,o)=>{const n=ot(e).getOrThunk((()=>Jt(Qe(e))));return t(e)/o(n)*100},gs=(e,t)=>{ko(e,"width",t+"px")},hs=(e,t)=>{ko(e,"width",t+"%")},ps=(e,t)=>{ko(e,"height",t+"px")},bs=e=>_r(e)+"px",ws=(e,t,o,n)=>{const r=Ko(e).map((e=>{const n=o(e);return Math.floor(t/100*n)})).getOr(t);return n(e,r),r},vs=(e,t,o,n)=>{const r=parseFloat(e);return yo(e,"%")&&"table"!==Ce(t)?ws(t,r,o,n):r},ys=e=>{const t=bs(e);return t?vs(t,e,Lr,ps):Lr(e)},Cs=(e,t,o)=>{const n=o(e),r=Wo(e,t);return n/r},xs=(e,t)=>zo(e,t).orThunk((()=>Le(e,t).map((e=>e+"px")))),Ss=e=>xs(e,"width"),Ts=e=>xs(e,"height"),Rs=e=>fs(e,Zn,tr),Ds=e=>us(e)?Zn(e):or(e),Os=e=>Cs(e,"rowspan",ys),ks=e=>{const t=Ss(e);return t.bind((e=>is(e,["fixed","relative","empty"])))},Es=(e,t,o)=>{ko(e,"width",t+o)},Ns=e=>Zn(e)+"px",As=e=>fs(e,Zn,tr)+"%",zs=e=>Ss(e).exists((e=>ms.test(e))),Bs=e=>Ss(e).exists((e=>ds.test(e))),js=e=>Ss(e).isNone(),Ls=v(ms),Ws=Ee("col"),_s=e=>Ss(e).getOrThunk((()=>Ds(e)+"px")),Ms=e=>Ts(e).getOrThunk((()=>Os(e)+"px")),Is=e=>W(Or.justColumns(e),(e=>k.from(e.element))),Ps=e=>{const t=$n().browser,o=t.isChromium()||t.isFirefox();return!Ws(e)||o},Fs=(e,t,o,n,r,s)=>e.filter(n).fold((()=>s(Ar(o,t))),(e=>r(e))),Hs=(e,t,o,n)=>{const r=kr(e),s=Or.hasColumns(e)?Is(e):r,l=[k.some(ss.edge(t))].concat(W(ss.positions(r,t),(e=>e.map((e=>e.x))))),c=S(_o);return W(s,((e,t)=>Fs(e,t,l,c,(e=>{if(Ps(e))return o(e);{const e=ho(r[t],y);return Fs(e,t,l,c,(e=>n(k.some(Zn(e)))),n)}}),n)))},$s=e=>e.map((e=>e+"px")).getOr(""),qs=(e,t)=>Hs(e,t,_s,$s),Vs=(e,t,o)=>Hs(e,t,Rs,(e=>e.fold((()=>o.minCellWidth()),(e=>e/o.pixelWidth()*100)))),Us=(e,t,o)=>Hs(e,t,Ds,(e=>e.getOrThunk(o.minCellWidth))),Gs=(e,t,o,n,r)=>{const s=Nr(e),l=[k.some(o.edge(t))].concat(W(o.positions(s,t),(e=>e.map((e=>e.y)))));return W(s,((e,t)=>Fs(e,t,l,S(Mo),n,r)))},Ks=(e,t,o)=>Gs(e,t,o,Os,(e=>e.getOrThunk(Fo))),Ys=(e,t,o)=>Gs(e,t,o,Ms,$s),Js=(e,t)=>()=>Kt(e)?t(e):parseFloat(zo(e,"width").getOr("0")),Qs=e=>{const t=Js(e,Zn),o=v(0),n=(t,o)=>Us(t,e,o);return{width:t,pixelWidth:t,getWidths:n,getCellDelta:o,singleColumnWidth:v([0]),minCellWidth:o,setElementWidth:p,adjustTableWidth:p,isRelative:!0,label:"none"}},Xs=e=>{const t=Js(e,(e=>parseFloat(As(e)))),o=Js(e,Zn),n=e=>e/o()*100,r=(e,t)=>[100-e],s=()=>Po()/o()*100,l=o=>{const n=t(),r=o/100*n,s=n+r;hs(e,s)},c=(t,o)=>Vs(t,e,o);return{width:t,pixelWidth:o,getWidths:c,getCellDelta:n,singleColumnWidth:r,minCellWidth:s,setElementWidth:hs,adjustTableWidth:l,isRelative:!0,label:"percent"}},Zs=e=>{const t=Js(e,Zn),o=y,n=(e,t)=>{const o=Math.max(Po(),e+t);return[o-e]},r=o=>{const n=t()+o;gs(e,n)},s=(t,o)=>Us(t,e,o);return{width:t,pixelWidth:t,getWidths:s,getCellDelta:o,singleColumnWidth:n,minCellWidth:Po,setElementWidth:gs,adjustTableWidth:r,isRelative:!1,label:"pixel"}},el=(e,t)=>{const o=Ls().exec(t);return null!==o?Xs(e):Zs(e)},tl=e=>{const t=Ss(e);return t.fold((()=>Qs(e)),(t=>el(e,t)))},ol={getTableSize:tl,pixelSize:Zs,percentageSize:Xs,noneSize:Qs},nl=(e,t,o,n,r,s)=>({minRow:e,minCol:t,maxRow:o,maxCol:n,allCells:r,selectedCells:s}),rl=(e,t)=>{const o=e.grid.columns,n=e.grid.rows;let r=n,s=o,l=0,c=0;const a=[],i=[];return re(e.access,(e=>{if(a.push(e),t(e)){i.push(e);const t=e.row,o=t+e.rowspan-1,n=e.column,a=n+e.colspan-1;t<r?r=t:o>l&&(l=o),n<s?s=n:a>c&&(c=a)}})),nl(r,s,l,c,a,i)},sl=(e,t,o)=>{const n=e[o].element,r=$e.fromTag("td");ut(r,$e.fromTag("br"));const s=t?ut:dt;s(n,r)},ll=(e,t,o,n)=>{const r=P(e,(e=>"colgroup"!==e.section)),s=t.grid.columns,l=t.grid.rows;for(let c=0;c<l;c++){let e=!1;for(let l=0;l<s;l++)if(!(c<o.minRow||c>o.maxRow||l<o.minCol||l>o.maxCol)){const o=Or.getAt(t,c,l).filter(n).isNone();o?sl(r,e,c):e=!0}}},cl=(e,t,o,n)=>{re(o.columns,(e=>{(e.column<t.minCol||e.column>t.maxCol)&&wt(e.element)}));const r=P(Ho(e,"tr"),(e=>0===e.dom.childElementCount));_(r,wt),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||_(Ho(e,"th,td"),(e=>{We(e,"rowspan"),We(e,"colspan")})),We(e,fr),We(e,"data-snooker-col-series");const s=ol.getTableSize(e);s.adjustTableWidth(n)},al=(e,t,o,n)=>{if(0===n.minCol&&t.grid.columns===n.maxCol+1)return 0;const r=Us(t,e,o),s=H(r,((e,t)=>e+t),0),l=H(r.slice(n.minCol,n.maxCol+1),((e,t)=>e+t),0),c=l/s*o.pixelWidth(),a=c-o.pixelWidth();return o.getCellDelta(a)},il=(e,t)=>{const o=e=>qe(e.element,t),n=xt(e),r=Zo(n),s=ol.getTableSize(e),l=Or.generate(r),c=rl(l,o),a="th:not("+t+"),td:not("+t+")",i=$o(n,"th,td",(e=>qe(e,a)));_(i,wt),ll(r,l,c,o);const m=Or.fromTable(e),d=al(e,m,s,c);return cl(n,c,l,d),n},ml="Â ",dl=(e,t)=>{const o=o=>{if(!e(o))throw new Error("Can only get "+t+" value of a "+t+" node");return n(o).getOr("")},n=t=>e(t)?k.from(t.dom.nodeValue):k.none(),r=(o,n)=>{if(!e(o))throw new Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=n};return{get:o,getOption:n,set:r}},ul=dl(De,"text"),fl=e=>ul.get(e),gl=e=>ul.getOption(e),hl=(e,t)=>ul.set(e,t),pl=e=>"img"===Ce(e)?1:gl(e).fold((()=>lt(e).length),(e=>e.length)),bl=e=>gl(e).filter((e=>0!==e.trim().length||e.indexOf(ml)>-1)).isSome(),wl=["img","br"],vl=e=>{const t=bl(e);return t||B(wl,Ce(e))},yl=e=>co(e,vl),Cl=e=>xl(e,vl),xl=(e,t)=>{const o=e=>{const n=lt(e);for(let r=n.length-1;r>=0;r--){const e=n[r];if(t(e))return k.some(e);const s=o(e);if(s.isSome())return s}return k.none()};return o(e)},Sl={scope:["row","col"]},Tl=e=>()=>{const t=$e.fromTag("td",e.dom);return ut(t,$e.fromTag("br",e.dom)),t},Rl=e=>()=>$e.fromTag("col",e.dom),Dl=e=>()=>$e.fromTag("colgroup",e.dom),Ol=e=>()=>$e.fromTag("tr",e.dom),kl=(e,t,o)=>{const n=Tt(e,t);return re(o,((e,t)=>{null===e?We(n,t):Ae(n,t,e)})),n},El=e=>e,Nl=(e,t,o)=>{const n=yl(e);return n.map((n=>{const r=o.join(","),s=eo(n,r,(t=>Ke(t,e)));return F(s,((e,t)=>{const o=Ct(t);return We(o,"contenteditable"),ut(e,o),o}),t)})).getOr(t)},Al=(e,t)=>{re(Sl,((o,n)=>Le(e,n).filter((e=>B(o,e))).each((e=>Ae(t,n,e)))))},zl=(e,t,o)=>{const n=(e,t)=>{jo(e.element,t),Bo(t,"height"),1!==e.colspan&&Bo(t,"width")},r=r=>{const s=$e.fromTag(Ce(r.element),t.dom),l=o.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=l.length>0?Nl(r.element,s,l):s;return ut(c,$e.fromTag("br")),n(r,s),Al(r.element,s),e(r.element,s),s},s=o=>{const r=$e.fromTag(Ce(o.element),t.dom);return n(o,r),e(o.element,r),r};return{col:s,colgroup:Dl(t),row:Ol(t),cell:r,replace:kl,colGap:Rl(t),gap:Tl(t)}},Bl=e=>({col:Rl(e),colgroup:Dl(e),row:Ol(e),cell:Tl(e),replace:El,colGap:Rl(e),gap:Tl(e)}),jl=(e,t)=>{const o=t||document,n=o.createElement("div");return n.innerHTML=e,lt($e.fromDom(n))},Ll=e=>W(e,$e.fromDom),Wl=e=>$e.fromDom(e.getBody()),_l=e=>t=>Ke(t,Wl(e)),Ml=e=>{We(e,"data-mce-style");const t=e=>We(e,"data-mce-style");_(Uo(e),t),_(Go(e),t),_(Yo(e),t)},Il=e=>$e.fromDom(e.selection.getStart()),Pl=e=>e.getBoundingClientRect().width,Fl=e=>e.getBoundingClientRect().height,Hl=(e,t)=>{const o=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return k.from(o).filter(So)},$l=e=>/^(\d+(\.\d+)?)%$/.test(e),ql=e=>/^(\d+(\.\d+)?)px$/.test(e),Vl=(e,t)=>{const o=t.column,n=t.column+t.colspan-1,r=t.row,s=t.row+t.rowspan-1;return o<=e.finishCol&&n>=e.startCol&&r<=e.finishRow&&s>=e.startRow},Ul=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,Gl=(e,t)=>{let o=!0;const n=x(Ul,t);for(let r=t.startRow;r<=t.finishRow;r++)for(let s=t.startCol;s<=t.finishCol;s++)o=o&&Or.getAt(e,r,s).exists(n);return o?k.some(t):k.none()},Kl=(e,t)=>_t(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),Yl=(e,t,o)=>{const n=Or.findItem(e,t,Ke),r=Or.findItem(e,o,Ke);return n.bind((e=>r.map((t=>Kl(e,t)))))},Jl=(e,t,o)=>Yl(e,t,o).bind((t=>Gl(e,t))),Ql=(e,t,o,n)=>Or.findItem(e,t,Ke).bind((t=>{const r=o>0?t.row+t.rowspan-1:t.row,s=n>0?t.column+t.colspan-1:t.column,l=Or.getAt(e,r+o,s+n);return l.map((e=>e.element))})),Xl=(e,t,o)=>Yl(e,t,o).map((t=>{const o=Or.filterItems(e,x(Vl,t));return W(o,(e=>e.element))})),Zl=(e,t)=>{const o=(e,t)=>Ye(t,e);return Or.findItem(e,t,o).map((e=>e.element))},ec=(e,t,o)=>Ko(e).bind((n=>{const r=rc(n);return Ql(r,e,t,o)})),tc=(e,t,o)=>{const n=rc(e);return Xl(n,t,o)},oc=(e,t,o,n,r)=>{const s=rc(e),l=Ke(e,o)?k.some(t):Zl(s,t),c=Ke(e,r)?k.some(n):Zl(s,n);return l.bind((e=>c.bind((t=>Xl(s,e,t)))))},nc=(e,t,o)=>{const n=rc(e);return Jl(n,t,o)},rc=Or.fromTable;var sc=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],lc=()=>{const e=e=>$e.fromDom(e.dom.cloneNode(!1)),t=e=>Xe(e).dom,o=e=>!!Re(e)&&("body"===Ce(e)||B(sc,Ce(e))),n=e=>!!Re(e)&&B(["br","img","hr","input"],Ce(e)),r=e=>Re(e)&&"false"===je(e,"contenteditable"),s=(e,t)=>e.dom.compareDocumentPosition(t.dom),l=(e,t)=>{const o=_e(e);ze(t,o)},c=e=>{const t=Ce(e);return B(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},a=e=>Re(e)?Le(e,"lang"):k.none();return{up:v({selector:ao,closest:uo,predicate:ro,all:nt}),down:v({selector:oo,predicate:Zt}),styles:v({get:No,getRaw:zo,set:ko,remove:Bo}),attrs:v({get:je,set:Ae,remove:We,copyTo:l}),insert:v({before:it,after:mt,afterAll:ht,append:ut,appendAll:pt,prepend:dt,wrap:gt}),remove:v({unwrap:vt,remove:wt}),create:v({nu:$e.fromTag,clone:e,text:$e.fromText}),query:v({comparePosition:s,prevSibling:rt,nextSibling:st}),property:v({children:lt,name:Ce,parent:tt,document:t,isText:De,isComment:Te,isElement:Re,isSpecial:c,getLanguage:a,getText:fl,setText:hl,isBoundary:o,isEmptyTag:n,isNonEditable:r}),eq:Ke,is:Je}};const cc=(e,t,o,n)=>{const r=o[0],s=o.slice(1);return n(e,t,r,s)},ac=(e,t,o)=>o.length>0?cc(e,t,o,ic):k.none(),ic=(e,t,o,n)=>{const r=t(e,o);return F(n,((o,n)=>{const r=t(e,n);return mc(e,o,r)}),r)},mc=(e,t,o)=>t.bind((t=>o.filter(x(e.eq,t)))),dc=(e,t)=>x(e.eq,t),uc=(e,t,o,n=D)=>{const r=[t].concat(e.up().all(t)),s=[o].concat(e.up().all(o)),l=e=>{const t=V(e,n);return t.fold((()=>e),(t=>e.slice(0,t+1)))},c=l(r),a=l(s),i=q(c,(t=>j(a,dc(e,t))));return{firstpath:c,secondpath:a,shared:i}},fc=ac,gc=uc,hc=lc(),pc=(e,t)=>fc(hc,((t,o)=>e(o)),t),bc=(e,t,o)=>gc(hc,e,t,o),wc=e=>ao(e,"table"),vc=(e,t,o)=>{const n=e=>t=>void 0!==o&&o(t)||Ke(t,e);return Ke(e,t)?k.some({boxes:k.some([e]),start:e,finish:t}):wc(e).bind((r=>wc(t).bind((s=>{if(Ke(r,s))return k.some({boxes:tc(r,e,t),start:e,finish:t});if(Ye(r,s)){const o=eo(t,"td,th",n(r)),l=o.length>0?o[o.length-1]:t;return k.some({boxes:oc(r,e,r,t,s),start:e,finish:l})}if(Ye(s,r)){const o=eo(e,"td,th",n(s)),l=o.length>0?o[o.length-1]:e;return k.some({boxes:oc(s,e,r,t,s),start:e,finish:l})}return bc(e,t).shared.bind((l=>uo(l,"table",o).bind((o=>{const l=eo(t,"td,th",n(o)),c=l.length>0?l[l.length-1]:t,a=eo(e,"td,th",n(o)),i=a.length>0?a[a.length-1]:e;return k.some({boxes:oc(o,e,r,t,s),start:i,finish:c})}))))}))))},yc=(e,t)=>{const o=oo(e,t);return o.length>0?k.some(o):k.none()},Cc=(e,t)=>q(e,(e=>qe(e,t))),xc=(e,t,o)=>mo(e,t).bind((t=>mo(e,o).bind((e=>pc(wc,[t,e]).map((o=>({first:t,last:e,table:o}))))))),Sc=(e,t)=>ao(e,"table").bind((o=>mo(o,t).bind((t=>vc(t,e).bind((e=>e.boxes.map((t=>({boxes:t,start:e.start,finish:e.finish}))))))))),Tc=(e,t,o,n,r)=>Cc(e,r).bind((e=>ec(e,t,o).bind((e=>Sc(e,n))))),Rc=(e,t)=>yc(e,t),Dc=(e,t,o)=>xc(e,t,o).bind((t=>{const o=t=>Ke(e,t),n="thead,tfoot,tbody,table",r=ao(t.first,n,o),s=ao(t.last,n,o);return r.bind((e=>s.bind((o=>Ke(e,o)?nc(t.table,t.first,t.last):k.none()))))})),Oc=y,kc=e=>{const t=(e,t)=>Le(e,t).exists((e=>parseInt(e,10)>1)),o=e=>t(e,"rowspan")||t(e,"colspan");return e.length>0&&K(e,o)?k.some(e):k.none()},Ec=(e,t,o)=>t.length<=1?k.none():Dc(e,o.firstSelectedSelector,o.lastSelectedSelector).map((e=>({bounds:e,cells:t}))),Nc="data-mce-selected",Ac="td["+Nc+"],th["+Nc+"]",zc="["+Nc+"]",Bc="data-mce-first-selected",jc="td["+Bc+"],th["+Bc+"]",Lc="data-mce-last-selected",Wc="td["+Lc+"],th["+Lc+"]",_c=zc,Mc={selected:Nc,selectedSelector:Ac,firstSelected:Bc,firstSelectedSelector:jc,lastSelected:Lc,lastSelectedSelector:Wc},Ic=(e,t,o)=>({element:o,mergable:Ec(t,e,Mc),unmergable:kc(e),selection:Oc(e)}),Pc=(e,t,o)=>({element:e,clipboard:t,generators:o}),Fc=(e,t,o,n)=>({selection:Oc(e),clipboard:o,generators:n}),Hc=e=>Ko(e).bind((e=>Rc(e,Mc.firstSelectedSelector))).fold(v(e),(e=>e[0])),$c=e=>(t,o)=>{const n=Ce(t),r="col"===n||"colgroup"===n?Hc(t):t;return uo(r,e,o)},qc=$c("th,td,caption"),Vc=$c("th,td"),Uc=e=>Ll(e.model.table.getSelectedCells()),Gc=e=>P(Uc(e),(e=>qe(e,Mc.selectedSelector))),Kc=e=>Ko(e[0]).map((e=>{const t=il(e,_c);return Ml(t),[t]})),Yc=(e,t)=>W(t,(t=>e.selection.serializer.serialize(t.dom,{}))).join(""),Jc=e=>W(e,(e=>e.dom.innerText)).join(""),Qc=(e,t)=>{e.on("BeforeGetContent",(t=>{const o=o=>{t.preventDefault(),Kc(o).each((o=>{t.content="text"===t.format?Jc(o):Yc(e,o)}))};if(!0===t.selection){const t=Gc(e);t.length>=1&&o(t)}})),e.on("BeforeSetContent",(o=>{if(!0===o.selection&&!0===o.paste){const n=Uc(e);Z(n).each((n=>{Ko(n).each((r=>{const s=P(jl(o.content),(e=>"meta"!==Ce(e))),l=Ee("table");if(1===s.length&&l(s[0])){o.preventDefault();const l=$e.fromDom(e.getDoc()),c=Bl(l),a=Pc(n,s[0],c);t.pasteCells(r,a).each((()=>{e.focus()}))}}))}))}}))},Xc=(e,t)=>({element:e,offset:t}),Zc=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind((t=>Zc(e,t,o).orThunk((()=>k.some(t))))):k.none(),ea=(e,t)=>{if(e.property().isText(t))return e.property().getText(t).length;const o=e.property().children(t);return o.length},ta=(e,t)=>{const o=Zc(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return Xc(o,ea(e,o));const n=e.property().children(o);return n.length>0?ta(e,n[n.length-1]):Xc(o,ea(e,o))},oa=ta,na=lc(),ra=e=>oa(na,e),sa=(e,t)=>{if(!_o(e)){const o=ks(e);o.each((o=>{const n=o.value/2;Es(e,n,o.unit),Es(t,n,o.unit)}))}},la=e=>W(e,v(0)),ca=(e,t,o,n,r)=>r(e.slice(0,t)).concat(n).concat(r(e.slice(o))),aa=e=>(t,o,n,r)=>{if(e(n)){const e=Math.max(r,t[o]-Math.abs(n)),s=Math.abs(e-t[o]);return n>=0?s:-s}return n},ia=aa((e=>e<0)),ma=aa(O),da=()=>{const e=(e,t,o,n,r)=>{const s=ia(e,t,n,r);return ca(e,t,o+1,[s,0],la)},t=(e,t,o,n)=>{const r=(100+o)/100,s=Math.max(n,(e[t]+o)/r);return W(e,((e,o)=>{const n=o===t?s:e/r;return n-e}))},o=(o,n,r,s,l,c)=>c?t(o,n,s,l):e(o,n,r,s,l),n=(e,t,n,r,s,l,c)=>o(e,n,r,s,l,c),r=(e,t)=>e(t),s=(e,o,n,r,s,l)=>{if(l)return t(e,n,r,s);{const t=ia(e,n,r,s);return la(e.slice(0,n)).concat([t])}},l=(e,t,o,n)=>{if(n){const n=t+o,r=n/t,s=W(e,(e=>e/r));return{delta:100*r-100,newSizes:s}}return{delta:o,newSizes:e}};return{resizeTable:r,clampTableDelta:ia,calcLeftEdgeDeltas:o,calcMiddleDeltas:n,calcRightEdgeDeltas:s,calcRedestributedWidths:l}},ua=()=>{const e=(e,t,o,n,r)=>{const s=n>=0?o:t,l=ma(e,s,n,r);return ca(e,t,o+1,[l,-l],la)},t=(t,o,n,r,s,l)=>e(t,n,r,s,l),o=(e,t,o)=>{o&&e(t)},n=(e,t,o,n,r,s)=>{if(s)return la(e);{const t=n/e.length;return W(e,v(t))}},r=(e,t,o,n,r)=>{if(r){if(o>=0)return o;{const t=H(e,((e,t)=>e+t-n),0);return Math.max(-t,o)}}return ia(e,t,o,n)},s=(e,t,o,n)=>({delta:0,newSizes:e});return{resizeTable:o,clampTableDelta:r,calcLeftEdgeDeltas:e,calcMiddleDeltas:t,calcRightEdgeDeltas:n,calcRedestributedWidths:s}},fa=e=>{const t=Or.fromTable(e);return t.grid},ga=Ee("th"),ha=e=>K(e,(e=>ga(e.element))),pa=(e,t)=>e&&t?"sectionCells":e?"section":"cells",ba=e=>{const t="thead"===e.section,o=fo(wa(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:pa(t,o)}:{type:"body"}},wa=e=>{const t=P(e,(e=>ga(e.element)));return 0===t.length?k.some("td"):t.length===e.length?k.some("th"):k.none()},va=e=>{const t=W(e,(e=>ba(e).type)),o=B(t,"header"),n=B(t,"footer");if(o||n){const e=B(t,"body");return!o||e||n?o||e||!n?k.none():k.some("footer"):k.some("header")}return k.some("body")},ya=e=>te(e.all,(e=>{const t=ba(e);return"header"===t.type?k.from(t.subType):k.none()})),Ca=(e,t,o)=>Lt(o(e.element,t),!0,e.isLocked),xa=(e,t)=>e.section!==t?Wt(e.element,e.cells,t,e.isNew):e,Sa=()=>({transformRow:xa,transformCell:(e,t,o)=>{const n=o(e.element,t),r="td"!==Ce(n)?Rt(n,"td"):n;return Lt(r,e.isNew,e.isLocked)}}),Ta=()=>({transformRow:xa,transformCell:Ca}),Ra=()=>({transformRow:(e,t)=>{const o="thead"===t?"tbody":t;return xa(e,o)},transformCell:Ca}),Da=()=>({transformRow:y,transformCell:Ca}),Oa=(e,t)=>{const o=Or.fromTable(e),n=ya(o).getOr(t);switch(n){case"section":return Sa();case"sectionCells":return Ta();case"cells":return Ra()}},ka={getTableSectionType:Oa,section:Sa,sectionCells:Ta,cells:Ra,fallback:Da},Ea=e=>uo(e,"[contenteditable]"),Na=(e,t=!1)=>Kt(e)?e.dom.isContentEditable:Ea(e).fold(v(t),(e=>"true"===Aa(e))),Aa=e=>e.dom.contentEditable,za=(e,t,o,n)=>{o===n?We(e,t):Ae(e,t,o)},Ba=(e,t,o)=>{ee(to(e,t)).fold((()=>dt(e,o)),(e=>mt(e,o)))},ja=(e,t)=>{const o=io(e,t).getOrThunk((()=>{const o=$e.fromTag(t,Qe(e).dom);return"thead"===t?Ba(e,"caption,colgroup",o):"colgroup"===t?Ba(e,"caption",o):ut(e,o),o}));return bt(o),o},La=(e,t)=>{const o=[],n=[],r=e=>W(e,(e=>{e.isNew&&o.push(e.element);const t=e.element;return bt(t),_(e.cells,(e=>{e.isNew&&n.push(e.element),za(e.element,"colspan",e.colspan,1),za(e.element,"rowspan",e.rowspan,1),ut(t,e.element)})),t})),s=e=>G(e,(e=>W(e.cells,(e=>(za(e.element,"span",e.colspan,1),e.element))))),l=(t,o)=>{const n=ja(e,o),l="colgroup"===o?s:r,c=l(t);pt(n,c)},c=t=>{io(e,t).each(wt)},a=(e,t)=>{e.length>0?l(e,t):c(t)},i=[],m=[],d=[],u=[];return _(t,(e=>{switch(e.section){case"thead":i.push(e);break;case"tbody":m.push(e);break;case"tfoot":d.push(e);break;case"colgroup":u.push(e);break}})),a(u,"colgroup"),a(i,"thead"),a(m,"tbody"),a(d,"tfoot"),{newRows:o,newCells:n}},Wa=e=>W(e,(e=>{const t=Ct(e.element);return _(e.cells,(e=>{const o=xt(e.element);za(o,"colspan",e.colspan,1),za(o,"rowspan",e.rowspan,1),ut(t,o)})),t})),_a=(e,t)=>W(e,(e=>ar(e,t))),Ma=(e,t)=>e[t],Ia=(e,t)=>{if(0===e.length)return 0;const o=e[0],n=V(e,(e=>!t(o.element,e.element)));return n.getOr(e.length)},Pa=(e,t,o,n)=>{const r=Ma(e,t),s="colgroup"===r.section,l=Ia(r.cells.slice(o),n),c=s?1:Ia(_a(e.slice(t),o),n);return{colspan:l,rowspan:c}},Fa=(e,t)=>{const o=W(e,(e=>W(e.cells,D))),n=(e,t,n,r)=>{for(let s=e;s<e+n;s++)for(let e=t;e<t+r;e++)o[s][e]=!0};return W(e,((r,s)=>{const l=G(r.cells,((r,l)=>{if(!1===o[s][l]){const o=Pa(e,s,l,t);return n(s,l,o.rowspan,o.colspan),[At(r.element,o.rowspan,o.colspan,r.isNew)]}return[]}));return jt(r.element,l,r.section,r.isNew)}))},Ha=(e,t,o)=>{const n=[];_(e.colgroups,(r=>{const s=[];for(let n=0;n<e.grid.columns;n++){const r=Or.getColumnAt(e,n).map((e=>Lt(e.element,o,!1))).getOrThunk((()=>Lt(t.colGap(),!0,!1)));s.push(r)}n.push(Wt(r.element,s,"colgroup",o))}));for(let r=0;r<e.grid.rows;r++){const s=[];for(let n=0;n<e.grid.columns;n++){const l=Or.getAt(e,r,n).map((e=>Lt(e.element,o,e.isLocked))).getOrThunk((()=>Lt(t.gap(),!0,!1)));s.push(l)}const l=e.all[r],c=Wt(l.element,s,l.section,o);n.push(c)}return n},$a=(e,t)=>Ha(e,t,!1),qa=e=>Fa(e,Ke),Va=(e,t)=>te(e.all,(e=>q(e.cells,(e=>Ke(t,e.element))))),Ua=(e,t,o)=>{const n=W(t.selection,(t=>Vo(t).bind((t=>Va(e,t))).filter(o))),r=go(n);return po(r.length>0,r)},Ga=(e,t,o,n,r)=>(s,l,c,a)=>{const i=Or.fromTable(s),m=k.from(null===a||void 0===a?void 0:a.section).getOrThunk(ka.fallback),d=t(i,l).map((t=>{const o=$a(i,c),n=e(o,t,Ke,r(c),m),s=hr(n.grid),l=qa(n.grid);return{info:t,grid:l,cursor:n.cursor,lockedColumns:s}}));return d.bind((e=>{const t=La(s,e.grid),r=k.from(null===a||void 0===a?void 0:a.sizing).getOrThunk((()=>ol.getTableSize(s))),l=k.from(null===a||void 0===a?void 0:a.resize).getOrThunk(ua);return o(s,e.grid,e.info,{sizing:r,resize:l,section:m}),n(s),We(s,fr),e.lockedColumns.length>0&&Ae(s,fr,e.lockedColumns.join(",")),k.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))},Ka=(e,t)=>Vo(t.element).bind((o=>Va(e,o).map((e=>{const o={...e,generators:t.generators,clipboard:t.clipboard};return o})))),Ya=(e,t)=>Ua(e,t,O).map((e=>({cells:e,generators:t.generators,clipboard:t.clipboard}))),Ja=(e,t)=>t.mergable,Qa=(e,t)=>t.unmergable,Xa=(e,t)=>Ua(e,t,O),Za=(e,t)=>Ua(e,t,(e=>!e.isLocked)),ei=(e,t)=>Va(e,t).exists((e=>!e.isLocked)),ti=(e,t)=>K(t,(t=>ei(e,t))),oi=(e,t)=>Ja(e,t).filter((t=>ti(e,t.cells))),ni=(e,t)=>Qa(e,t).filter((t=>ti(e,t))),ri=(e,t,o,n)=>{const r=dr(e).rows;if(0===r.length)return e;for(let s=t.startRow;s<=t.finishRow;s++)for(let e=t.startCol;e<=t.finishCol;e++){const t=r[s],o=ar(t,e).isLocked;sr(t,e,Lt(n(),!1,o))}return e},si=(e,t,o,n)=>{const r=dr(e).rows;let s=!0;for(let l=0;l<r.length;l++)for(let e=0;e<mr(r[0]);e++){const c=r[l],a=ar(c,e),i=a.element,m=o(i,t);m&&!s?sr(c,e,Lt(n(),!0,a.isLocked)):m&&(s=!1)}return e},li=(e,t)=>H(e,((e,o)=>j(e,(e=>t(e.element,o.element)))?e:e.concat([o])),[]),ci=(e,t,o,n)=>(t>0&&t<e[0].cells.length&&_(e,(e=>{const r=e.cells[t-1];let s=0;const l=n();while(e.cells.length>t+s&&o(r.element,e.cells[t+s].element))sr(e,t+s,Lt(l,!0,e.cells[t+s].isLocked)),s++})),e),ai=(e,t,o,n)=>{const r=dr(e).rows;if(t>0&&t<r.length){const e=r[t-1].cells,s=li(e,o);_(s,(e=>{let s=k.none();for(let l=t;l<r.length;l++)for(let t=0;t<mr(r[0]);t++){const c=r[l],a=ar(c,t),i=o(a.element,e.element);i&&(s.isNone()&&(s=k.some(n())),s.each((e=>{sr(c,t,Lt(e,!0,a.isLocked))})))}}))}return e},ii=e=>{const t=t=>t(e),o=v(e),n=()=>r,r={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:O,isError:D,map:t=>ui.value(t(e)),mapError:n,bind:t,exists:t,forall:t,getOr:o,or:n,getOrThunk:o,orThunk:n,getOrDie:o,each:t=>{t(e)},toOptional:()=>k.some(e)};return r},mi=e=>{const t=()=>o,o={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:D,isError:O,map:t,mapError:t=>ui.error(t(e)),bind:t,exists:D,forall:O,getOr:y,or:y,getOrThunk:R,orThunk:R,getOrDie:T(String(e)),each:p,toOptional:k.none};return o},di=(e,t)=>e.fold((()=>mi(t)),ii),ui={value:ii,error:mi,fromOption:di},fi=(e,t,o)=>{if(e.row>=t.length||e.column>mr(t[0]))return ui.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);const n=t.slice(e.row),r=n[0].cells.slice(e.column),s=mr(o[0]),l=o.length;return ui.value({rowDelta:n.length-l,colDelta:r.length-s})},gi=(e,t)=>{const o=mr(e[0]),n=mr(t[0]);return{rowDelta:0,colDelta:o-n}},hi=(e,t)=>{const o=e.length,n=t.length;return{rowDelta:o-n,colDelta:0}},pi=(e,t,o,n)=>{const r="colgroup"===t.section?o.col:o.cell;return L(e,(e=>Lt(r(),!0,n(e))))},bi=(e,t,o,n)=>{const r=e[e.length-1];return e.concat(L(t,(()=>{const e="colgroup"===r.section?o.colgroup:o.row,t=ur(r,e,y),s=pi(t.cells.length,t,o,(e=>fe(n,e.toString())));return lr(t,s)})))},wi=(e,t,o,n)=>W(e,(e=>{const r=pi(t,e,o,D);return nr(e,n,r)})),vi=(e,t,o)=>W(e,(e=>H(o,((o,n)=>{const r=pi(1,e,t,O)[0];return rr(o,n,r)}),e))),yi=(e,t,o)=>{const n=t.colDelta<0?wi:y,r=t.rowDelta<0?bi:y,s=hr(e),l=mr(e[0]),c=j(s,(e=>e===l-1)),a=n(e,Math.abs(t.colDelta),o,c?l-1:l),i=hr(a);return r(a,Math.abs(t.rowDelta),o,J(i,O))},Ci=(e,t,o,n)=>{const r=ar(e[t],o),s=x(n,r.element),l=e[t];return e.length>1&&mr(l)>1&&(o>0&&s(ir(l,o-1))||o<l.cells.length-1&&s(ir(l,o+1))||t>0&&s(ir(e[t-1],o))||t<e.length-1&&s(ir(e[t+1],o)))},xi=(e,t,o,n,r,s)=>{const l=e.row,c=e.column,a=o.length,i=mr(o[0]),m=l+a,d=c+i+s.length,u=J(s,O);for(let f=l;f<m;f++){let e=0;for(let s=c;s<d;s++){if(u[s]){e++;continue}Ci(t,f,s,r)&&si(t,ir(t[f],s),r,n.cell);const a=s-c-e,i=ar(o[f-l],a),m=i.element,d=n.replace(m);sr(t[f],s,Lt(d,!0,i.isLocked))}}return t},Si=(e,t,o)=>{const n=mr(t[0]),r=dr(t).cols.length+e.row,s=L(n-e.column,(t=>t+e.column)),l=q(s,(e=>K(o,(t=>t!==e)))).getOr(n-1);return{row:r,column:l}},Ti=(e,t,o)=>P(o,(o=>o>=e.column&&o<=mr(t[0])+e.column)),Ri=(e,t,o,n,r)=>{const s=hr(t),l=Si(e,t,s),c=dr(o).rows,a=Ti(l,c,s),i=fi(l,t,c);return i.map((e=>{const o={...e,colDelta:e.colDelta-a.length},s=yi(t,o,n),i=hr(s),m=Ti(l,c,i);return xi(l,s,c,n,r,m)}))},Di=(e,t,o,n,r)=>{ci(t,e,r,n.cell);const s=hi(o,t),l=yi(o,s,n),c=hi(t,l),a=yi(t,c,n);return W(a,((t,o)=>nr(t,e,l[o].cells)))},Oi=(e,t,o,n,r)=>{ai(t,e,r,n.cell);const s=hr(t),l=gi(t,o),c={...l,colDelta:l.colDelta-s.length},a=yi(t,c,n),{cols:i,rows:m}=dr(a),d=hr(a),u=gi(o,t),f={...u,colDelta:u.colDelta+d.length},g=vi(o,n,d),h=yi(g,f,n);return[...i,...m.slice(0,e),...h,...m.slice(e,m.length)]},ki=(e,t,o,n)=>ur(e,(e=>n(e,o)),t),Ei=(e,t,o,n,r)=>{const{rows:s,cols:l}=dr(e),c=s.slice(0,t),a=s.slice(t),i=ki(s[o],((e,o)=>{const l=t>0&&t<s.length&&n(ir(s[t-1],o),ir(s[t],o)),c=l?ar(s[t],o):Lt(r(e.element,n),!0,e.isLocked);return c}),n,r);return[...l,...c,i,...a]},Ni=(e,t,o,n,r,s,l)=>{if("colgroup"!==o&&n)return ar(e,t);{const t=ar(e,r);return Lt(l(t.element,s),!0,!1)}},Ai=(e,t,o,n,r)=>W(e,(e=>{const s=t>0&&t<mr(e)&&n(ir(e,t-1),ir(e,t)),l=Ni(e,t,e.section,s,o,n,r);return rr(e,t,l)})),zi=(e,t)=>G(e,(e=>{const o=e.cells,n=F(t,((e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e),o);return n.length>0?[Wt(e.element,n,e.section,e.isNew)]:[]})),Bi=(e,t,o)=>{const{rows:n,cols:r}=dr(e);return[...r,...n.slice(0,t),...n.slice(o+1)]},ji=(e,t,o,n)=>void 0!==ir(e[t],o)&&t>0&&n(ir(e[t-1],o),ir(e[t],o)),Li=(e,t,o)=>t>0&&o(ir(e,t-1),ir(e,t)),Wi=(e,t,o,n)=>ji(e,t,o,n)||Li(e[t],o,n),_i=(e,t)=>{const o=K(t,y)&&ha(e.cells);return o?O:(e,o,n)=>{const r=Ce(e.element);return!("th"===r&&t[n])}},Mi=(e,t)=>{const o=K(t,y)&&ha(e);return o?O:(e,o,n)=>{const r=Ce(e.element);return!("th"===r&&t[o])}},Ii=(e,t,o,n)=>{const r=e=>"row"===e?Mo(t):_o(t),s=e=>r(e)?`${e}group`:e;if(e)return ga(t)?s(o):null;if(n&&ga(t)){const e="row"===o?"col":"row";return s(e)}return null},Pi=(e,t)=>(o,n,r)=>k.some(Ii(e,o.element,"col",t[r])),Fi=(e,t)=>(o,n)=>k.some(Ii(e,o.element,"row",t[n])),Hi=(e,t,o)=>Lt(o(e.element,t),!0,e.isLocked),$i=(e,t,o,n,r,s,l)=>{const c=e=>j(t,(t=>o(e.element,t.element)));return W(e,((e,t)=>cr(e,((e,a)=>{if(c(e)){const c=l(e,t,a)?r(e,o,n):e;return s(c,t,a).each((e=>{Be(c.element,{scope:k.from(e)})})),c}return e}))))},qi=(e,t,o)=>G(e,((n,r)=>Wi(e,r,t,o)?[]:[ar(n,t)])),Vi=(e,t,o)=>{const n=e[t];return G(n.cells,((n,r)=>Wi(e,t,r,o)?[]:[n]))},Ui=(e,t,o,n,r)=>{const s=dr(e).rows,l=G(t,(e=>qi(s,e,n))),c=W(s,(e=>ha(e.cells))),a=Mi(l,c),i=Fi(o,c);return $i(e,l,n,r,Hi,i,a)},Gi=(e,t,o,n,r,s,l)=>{const{cols:c,rows:a}=dr(e),i=a[t[0]],m=G(t,(e=>Vi(a,e,r))),d=W(i.cells,((e,t)=>ha(qi(a,t,r)))),u=[...a];_(t,(e=>{u[e]=l.transformRow(a[e],o)}));const f=[...c,...u],g=_i(i,d),h=Pi(n,d);return $i(f,m,r,s,l.transformCell,h,g)},Ki=(e,t,o,n)=>{const r=dr(e).rows,s=W(t,(e=>ar(r[e.row],e.column)));return $i(e,s,o,n,Hi,k.none,O)},Yi=e=>{if(!a(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],o={};return _(e,((n,r)=>{const s=oe(n);if(1!==s.length)throw new Error("one and only one name per case");const l=s[0],c=n[l];if(void 0!==o[l])throw new Error("duplicate key detected:"+l);if("cata"===l)throw new Error("cannot have a case named cata (sorry)");if(!a(c))throw new Error("case arguments must be an array");t.push(l),o[l]=(...o)=>{const n=o.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+l+". Expected "+c.length+" ("+c+"), got "+n);const s=e=>{const n=oe(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));const r=K(t,(e=>B(n,e)));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[l].apply(null,o)};return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);const n=t[r];return n.apply(null,o)},match:s,log:e=>{console.log(e,{constructors:t,constructor:l,params:o})}}}})),o},Ji={generate:Yi},Qi=Ji.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Xi={...Qi},Zi=(e,t)=>0===e.length?Xi.none():1===e.length?Xi.only(0):0===t?Xi.left(0,1):t===e.length-1?Xi.right(t-1,t):t>0&&t<e.length-1?Xi.middle(t-1,t,t+1):Xi.none(),em=(e,t,o,n,r)=>{const s=e.slice(0),l=Zi(e,t),c=v(W(s,v(0))),a=e=>n.singleColumnWidth(s[e],o),i=(e,t)=>r.calcLeftEdgeDeltas(s,e,t,o,n.minCellWidth(),n.isRelative),m=(e,t,l)=>r.calcMiddleDeltas(s,e,t,l,o,n.minCellWidth(),n.isRelative),d=(e,t)=>r.calcRightEdgeDeltas(s,e,t,o,n.minCellWidth(),n.isRelative);return l.fold(c,a,i,m,d)},tm=(e,t,o)=>{let n=0;for(let r=e;r<t;r++)n+=void 0!==o[r]?o[r]:0;return n},om=(e,t)=>{const o=Or.justCells(e);return W(o,(e=>{const o=tm(e.column,e.column+e.colspan,t);return{element:e.element,width:o,colspan:e.colspan}}))},nm=(e,t)=>{const o=Or.justColumns(e);return W(o,((e,o)=>({element:e.element,width:t[o],colspan:e.colspan})))},rm=(e,t)=>{const o=Or.justCells(e);return W(o,(e=>{const o=tm(e.row,e.row+e.rowspan,t);return{element:e.element,height:o,rowspan:e.rowspan}}))},sm=(e,t)=>W(e.all,((e,o)=>({element:e.element,height:t[o]}))),lm=e=>F(e,((e,t)=>e+t),0),cm=(e,t)=>Or.hasColumns(e)?nm(e,t):om(e,t),am=(e,t,o)=>{const n=cm(e,t);_(n,(e=>{o.setElementWidth(e.element,e.width)}))},im=(e,t,o,n,r)=>{const s=Or.fromTable(e),l=r.getCellDelta(t),c=r.getWidths(s,r),a=o===s.grid.columns-1,i=n.clampTableDelta(c,o,l,r.minCellWidth(),a),m=em(c,o,i,r,n),d=W(m,((e,t)=>e+c[t]));am(s,d,r),n.resizeTable(r.adjustTableWidth,i,a)},mm=(e,t,o,n)=>{const r=Or.fromTable(e),s=Ks(r,e,n),l=W(s,((e,n)=>o===n?Math.max(t+e,Fo()):e)),c=rm(r,l),a=sm(r,l);_(a,(e=>{ps(e.element,e.height)})),_(c,(e=>{ps(e.element,e.height)}));const i=lm(l);ps(e,i)},dm=(e,t,o,n,r)=>{const s=Or.generate(t),l=n.getWidths(s,n),c=n.pixelWidth(),{newSizes:a,delta:i}=r.calcRedestributedWidths(l,c,o.pixelDelta,n.isRelative);am(s,a,n),n.adjustTableWidth(i)},um=(e,t,o,n)=>{const r=Or.generate(t),s=n.getWidths(r,n);am(r,s,n)},fm=e=>{const t=(e,t)=>{const o=j(e,(e=>e.column===t.column));return o?e:e.concat([t])};return H(e,t,[]).sort(((e,t)=>e.column-t.column))},gm=Ee("col"),hm=Ee("colgroup"),pm=e=>"tr"===Ce(e)||hm(e),bm=e=>{const t=Lo(e,"colspan",1),o=Lo(e,"rowspan",1);return{element:e,colspan:t,rowspan:o}},wm=(e,t=bm)=>{const o=t=>gm(t.element)?e.col(t):e.cell(t),n=t=>hm(t.element)?e.colgroup(t):e.row(t),r=e=>{if(pm(e))return n({element:e});{const n=e,r=o(t(n));return s=k.some({item:n,replacement:r}),r}};let s=k.none();const l=(e,t)=>s.fold((()=>r(e)),(o=>t(e,o.item)?o.replacement:r(e)));return{getOrInit:l}},vm=e=>t=>{const o=[],n=(e,t)=>q(o,(o=>t(o.item,e))),r=n=>{const r="td"===e?{scope:null}:{},s=t.replace(n,e,r);return o.push({item:n,sub:s}),s},s=(e,t)=>{if(pm(e)||gm(e))return e;{const o=e;return n(o,t).fold((()=>r(o)),(n=>t(e,n.item)?n.sub:r(o)))}};return{replaceOrInit:s}},ym=e=>Le(e,"scope").map((e=>e.substr(0,3))),Cm=e=>{const t=t=>{const o=ym(t);return o.each((e=>Ae(t,"scope",e))),()=>{const n=e.cell({element:t,colspan:1,rowspan:1});return Bo(n,"width"),Bo(t,"width"),o.each((e=>Ae(n,"scope",e))),n}},o=e=>{const t=()=>{const t=go(W(e,ym));if(0===t.length)return k.none();{const e=t[0],o=["row","col"],n=j(t,(t=>t!==e&&B(o,t)));return n?k.none():k.from(e)}};return Bo(e[0],"width"),t().fold((()=>We(e[0],"scope")),(t=>Ae(e[0],"scope",t+"group"))),v(e[0])};return{unmerge:t,merge:o}},xm={modification:wm,transform:vm,merging:Cm},Sm=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Tm=(e,t)=>{const o=e.property().name(t);return B(["ol","ul"],o)},Rm=(e,t)=>{const o=e.property().name(t);return B(Sm,o)},Dm=(e,t)=>B(["br","img","hr","input"],e.property().name(t)),Om=lc(),km=e=>Rm(Om,e),Em=e=>Tm(Om,e),Nm=e=>Dm(Om,e),Am=e=>{const t=Ee("br"),o=e=>K(e,(e=>t(e)||De(e)&&0===fl(e).trim().length)),n=e=>"li"===Ce(e)||ro(e,Em).isSome(),r=e=>st(e).map((e=>!!km(e)||!!Nm(e)&&"img"!==Ce(e))).getOr(!1),s=e=>Cl(e).bind((o=>{const s=r(o);return tt(o).map((r=>!0===s||n(r)||t(o)||km(r)&&!Ke(e,r)?[]:[$e.fromTag("br")]))})).getOr([]),l=()=>{const t=G(e,(e=>{const t=lt(e);return o(t)?[]:t.concat(s(e))}));return 0===t.length?[$e.fromTag("br")]:t},c=l();bt(e[0]),pt(e[0],c)},zm=e=>Na(e,!0),Bm=e=>{const t=Uo(e);0===t.length&&wt(e)},jm=(e,t)=>({grid:e,cursor:t}),Lm=e=>te(e,(e=>te(e.cells,(e=>{const t=e.element;return po(zm(t),t)})))),Wm=(e,t,o)=>{var n,r;const s=dr(e).rows;return k.from(null===(r=null===(n=s[t])||void 0===n?void 0:n.cells[o])||void 0===r?void 0:r.element).filter(zm).orThunk((()=>Lm(s)))},_m=(e,t,o)=>{const n=Wm(e,t,o);return jm(e,n)},Mm=e=>{const t=(e,t)=>{const o=j(e,(e=>e.row===t.row));return o?e:e.concat([t])};return H(e,t,[]).sort(((e,t)=>e.row-t.row))},Im=(e,t,o,n)=>{const r=t[0].row,s=Mm(t),l=F(s,((e,t)=>{const s=Ei(e.grid,r,t.row+e.delta,o,n.getOrInit);return{grid:s,delta:e.delta+1}}),{grid:e,delta:0}).grid;return _m(l,r,t[0].column)},Pm=(e,t,o,n)=>{const r=Mm(t),s=r[r.length-1],l=s.row+s.rowspan,c=F(r,((e,t)=>Ei(e,l,t.row,o,n.getOrInit)),e);return _m(c,l,t[0].column)},Fm=(e,t,o,n)=>{const r=t.details,s=fm(r),l=s[0].column,c=F(s,((e,t)=>{const r=Ai(e.grid,l,t.column+e.delta,o,n.getOrInit);return{grid:r,delta:e.delta+1}}),{grid:e,delta:0}).grid;return _m(c,r[0].row,l)},Hm=(e,t,o,n)=>{const r=t.details,s=r[r.length-1],l=s.column+s.colspan,c=fm(r),a=F(c,((e,t)=>Ai(e,l,t.column,o,n.getOrInit)),e);return _m(a,r[0].row,l)},$m=(e,t,o,n)=>{const r=fm(t),s=W(r,(e=>e.column)),l=Ui(e,s,!0,o,n.replaceOrInit);return _m(l,t[0].row,t[0].column)},qm=(e,t,o,n)=>{const r=Ki(e,t,o,n.replaceOrInit);return _m(r,t[0].row,t[0].column)},Vm=(e,t,o,n)=>{const r=fm(t),s=W(r,(e=>e.column)),l=Ui(e,s,!1,o,n.replaceOrInit);return _m(l,t[0].row,t[0].column)},Um=(e,t,o,n)=>{const r=Ki(e,t,o,n.replaceOrInit);return _m(r,t[0].row,t[0].column)},Gm=(e,t)=>(o,n,r,s,l)=>{const c=Mm(n),a=W(c,(e=>e.row)),i=Gi(o,a,e,t,r,s.replaceOrInit,l);return _m(i,n[0].row,n[0].column)},Km=Gm("thead",!0),Ym=Gm("tbody",!1),Jm=Gm("tfoot",!1),Qm=(e,t,o,n)=>{const r=fm(t.details),s=zi(e,W(r,(e=>e.column))),l=s.length>0?s[0].cells.length-1:0;return _m(s,r[0].row,Math.min(r[0].column,l))},Xm=(e,t,o,n)=>{const r=Mm(t),s=Bi(e,r[0].row,r[r.length-1].row),l=s.length>0?s.length-1:0;return _m(s,Math.min(t[0].row,l),t[0].column)},Zm=(e,t,o,n)=>{const r=t.cells;Am(r);const s=ri(e,t.bounds,o,n.merge(r));return jm(s,k.from(r[0]))},ed=(e,t,o,n)=>{const r=(e,t)=>si(e,t,o,n.unmerge(t)),s=F(t,r,e);return jm(s,k.from(t[0]))},td=(e,t,o,n)=>{const r=(e,t)=>{const o=Or.fromTable(e);return Ha(o,t,!0)},s=r(t.clipboard,t.generators),l=Et(t.row,t.column),c=Ri(l,e,s,t.generators,o);return c.fold((()=>jm(e,k.some(t.element))),(e=>_m(e,t.row,t.column)))},od=(e,t,o)=>{const n=en(e,o.section),r=Or.generate(n);return Ha(r,t,!0)},nd=(e,t,o,n)=>{const r=dr(e).rows,s=t.cells[0].column,l=r[t.cells[0].row],c=od(t.clipboard,t.generators,l),a=Di(s,e,c,t.generators,o);return _m(a,t.cells[0].row,t.cells[0].column)},rd=(e,t,o,n)=>{const r=dr(e).rows,s=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,l=r[t.cells[0].row],c=od(t.clipboard,t.generators,l),a=Di(s,e,c,t.generators,o);return _m(a,t.cells[0].row,t.cells[0].column)},sd=(e,t,o,n)=>{const r=dr(e).rows,s=t.cells[0].row,l=r[s],c=od(t.clipboard,t.generators,l),a=Oi(s,e,c,t.generators,o);return _m(a,t.cells[0].row,t.cells[0].column)},ld=(e,t,o,n)=>{const r=dr(e).rows,s=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,l=r[t.cells[0].row],c=od(t.clipboard,t.generators,l),a=Oi(s,e,c,t.generators,o);return _m(a,t.cells[0].row,t.cells[0].column)},cd=(e,t)=>{const o=Or.fromTable(e),n=Xa(o,t);return n.bind((e=>{const t=e[e.length-1],n=e[0].column,r=t.column+t.colspan,s=U(W(o.all,(e=>P(e.cells,(e=>e.column>=n&&e.column<r)))));return wa(s)})).getOr("")},ad=(e,t)=>{const o=Or.fromTable(e),n=Xa(o,t);return n.bind(wa).getOr("")},id=(e,t)=>{const o=Or.fromTable(e),n=Xa(o,t);return n.bind((e=>{const t=e[e.length-1],n=e[0].row,r=t.row+t.rowspan,s=o.all.slice(n,r);return va(s)})).getOr("")},md=(e,t,o,n)=>um(e,t,o,n.sizing),dd=(e,t,o,n)=>dm(e,t,o,n.sizing,n.resize),ud=(e,t)=>j(t,(e=>0===e.column&&e.isLocked)),fd=(e,t)=>j(t,(t=>t.column+t.colspan>=e.grid.columns&&t.isLocked)),gd=(e,t)=>{const o=kr(e),n=fm(t);return H(n,((e,t)=>{const n=o[t.column],r=n.map(er).getOr(0);return e+r}),0)},hd=e=>(t,o)=>Xa(t,o).filter((o=>{const n=e?ud:fd;return!n(t,o)})).map((e=>({details:e,pixelDelta:gd(t,e)}))),pd=(e,t)=>Za(e,t).map((t=>({details:t,pixelDelta:-gd(e,t)}))),bd=e=>(t,o)=>Ya(t,o).filter((o=>{const n=e?ud:fd;return!n(t,o.cells)})),wd=xm.transform("th"),vd=xm.transform("td"),yd=Ga(Im,Xa,p,p,xm.modification),Cd=Ga(Pm,Xa,p,p,xm.modification),xd=Ga(Fm,hd(!0),dd,p,xm.modification),Sd=Ga(Hm,hd(!1),dd,p,xm.modification),Td=Ga(Qm,pd,dd,Bm,xm.modification),Rd=Ga(Xm,Xa,p,Bm,xm.modification),Dd=Ga($m,Za,p,p,wd),Od=Ga(Vm,Za,p,p,vd),kd=Ga(Km,Za,p,p,wd),Ed=Ga(Ym,Za,p,p,vd),Nd=Ga(Jm,Za,p,p,vd),Ad=Ga(qm,Za,p,p,wd),zd=Ga(Um,Za,p,p,vd),Bd=Ga(Zm,oi,md,p,xm.merging),jd=Ga(ed,ni,md,p,xm.merging),Ld=Ga(td,Ka,md,p,xm.modification),Wd=Ga(nd,bd(!0),p,p,xm.modification),_d=Ga(rd,bd(!1),p,p,xm.modification),Md=Ga(sd,Ya,p,p,xm.modification),Id=Ga(ld,Ya,p,p,xm.modification),Pd=cd,Fd=ad,Hd=id,$d=(e,t)=>e.dispatch("NewRow",{node:t}),qd=(e,t)=>e.dispatch("NewCell",{node:t}),Vd=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},Ud=(e,t,o,n,r)=>{e.dispatch("TableSelectionChange",{cells:t,start:o,finish:n,otherCells:r})},Gd=e=>{e.dispatch("TableSelectionClear")},Kd=(e,t,o,n,r)=>{e.dispatch("ObjectResizeStart",{target:t,width:o,height:n,origin:r})},Yd=(e,t,o,n,r)=>{e.dispatch("ObjectResized",{target:t,width:o,height:n,origin:r})},Jd={structure:!1,style:!0},Qd={structure:!0,style:!1},Xd={structure:!0,style:!0},Zd=e=>t=>t.options.get(e),eu="100%",tu=e=>{var t;const o=e.dom,n=null!==(t=o.getParent(e.selection.getStart(),o.isBlock))&&void 0!==t?t:e.getBody();return tr($e.fromDom(n))+"px"},ou=(e,t)=>gu(e)||!pu(e)?t:fu(e)?{...t,width:tu(e)}:{...t,width:eu},nu=(e,t)=>gu(e)||pu(e)?t:fu(e)?{...t,width:tu(e)}:{...t,width:eu},ru=e=>{const t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{const t=B(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{const t=B(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0})},su=e=>k.from(e.options.get("table_clone_elements")),lu=e=>{const t=e.options.get("object_resizing");return B(t.split(","),"table")},cu=Zd("table_header_type"),au=Zd("table_column_resizing"),iu=e=>"preservetable"===au(e),mu=e=>"resizetable"===au(e),du=Zd("table_sizing_mode"),uu=e=>"relative"===du(e),fu=e=>"fixed"===du(e),gu=e=>"responsive"===du(e),hu=Zd("table_resize_bars"),pu=Zd("table_style_by_css"),bu=e=>{const t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:nu(e,o)},wu=e=>{const t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:ou(e,o)},vu=Zd("table_use_colgroups"),yu=(e,t)=>uu(e)?ol.percentageSize(t):fu(e)?ol.pixelSize(t):ol.getTableSize(t),Cu=(e,t,o)=>{const n=e=>"table"===Ce(Wl(e)),r=t=>!n(e)||fa(t).rows>1,s=t=>!n(e)||fa(t).columns>1,l=su(e),c=mu(e)?p:sa,a=t=>{switch(cu(e)){case"section":return ka.section();case"sectionCells":return ka.sectionCells();case"cells":return ka.cells();default:return ka.getTableSectionType(t,"section")}},i=(t,n)=>n.cursor.fold((()=>{const n=Uo(t);return Z(n).filter(Kt).map((n=>{o.clearSelectedCells(t.dom);const r=e.dom.createRng();return r.selectNode(n.dom),e.selection.setRng(r),Ae(n,"data-mce-selected","1"),r}))}),(n=>{const r=ra(n),s=e.dom.createRng();return s.setStart(r.element.dom,r.offset),s.setEnd(r.element.dom,r.offset),e.selection.setRng(s),o.clearSelectedCells(t.dom),k.some(s)})),m=(o,n,r,s)=>(c,m,d=!1)=>{Ml(c);const u=$e.fromDom(e.getDoc()),f=zl(r,u,l),g={sizing:yu(e,c),resize:mu(e)?da():ua(),section:a(c)};return n(c)?o(c,m,f,g).bind((o=>{t.refresh(c.dom),_(o.newRows,(t=>{$d(e,t.dom)})),_(o.newCells,(t=>{qd(e,t.dom)}));const n=i(c,o);return Kt(c)&&(Ml(c),d||Vd(e,c.dom,s)),n.map((e=>({rng:e,effect:s})))})):k.none()},d=m(Rd,r,p,Qd),u=m(Td,s,p,Qd),f=m(yd,O,p,Qd),g=m(Cd,O,p,Qd),h=m(xd,O,c,Qd),b=m(Sd,O,c,Qd),w=m(Bd,O,p,Qd),v=m(jd,O,p,Qd),y=m(Wd,O,p,Qd),C=m(_d,O,p,Qd),x=m(Md,O,p,Qd),S=m(Id,O,p,Qd),T=m(Ld,O,p,Xd),R=m(Ad,O,p,Qd),D=m(zd,O,p,Qd),E=m(Dd,O,p,Qd),N=m(Od,O,p,Qd),A=m(kd,O,p,Qd),z=m(Ed,O,p,Qd),B=m(Nd,O,p,Qd),j=Fd,L=Pd,W=Hd;return{deleteRow:d,deleteColumn:u,insertRowsBefore:f,insertRowsAfter:g,insertColumnsBefore:h,insertColumnsAfter:b,mergeCells:w,unmergeCells:v,pasteColsBefore:y,pasteColsAfter:C,pasteRowsBefore:x,pasteRowsAfter:S,pasteCells:T,makeCellsHeader:R,unmakeCellsHeader:D,makeColumnsHeader:E,unmakeColumnsHeader:N,makeRowsHeader:A,makeRowsBody:z,makeRowsFooter:B,getTableRowType:W,getTableCellType:j,getTableColType:L}},xu=(e,t,o)=>{const n=Lo(e,t,1);1===o||n<=1?We(e,t):Ae(e,t,Math.min(o,n))},Su=(e,t)=>o=>{const n=o.column+o.colspan-1,r=o.column;return n>=e&&r<t},Tu=(e,t,o)=>{if(Or.hasColumns(e)){const n=P(Or.justColumns(e),Su(t,o)),r=W(n,(e=>{const n=xt(e.element);return xu(n,"span",o-t),n})),s=$e.fromTag("colgroup");return pt(s,r),[s]}return[]},Ru=(e,t,o)=>W(e.all,(e=>{const n=P(e.cells,Su(t,o)),r=W(n,(e=>{const n=xt(e.element);return xu(n,"colspan",o-t),n})),s=$e.fromTag("tr");return pt(s,r),s})),Du=(e,t)=>{const o=Or.fromTable(e),n=Za(o,t);return n.map((e=>{const t=e[e.length-1],n=e[0].column,r=t.column+t.colspan,s=Tu(o,n,r),l=Ru(o,n,r);return[...s,...l]}))},Ou=(e,t,o)=>{const n=Or.fromTable(e),r=Xa(n,t);return r.bind((e=>{const t=Ha(n,o,!1),r=dr(t).rows,s=r.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),l=G(s,(e=>{const t=P(e.cells,(e=>!e.isLocked));return t.length>0?[{...e,cells:t}]:[]})),c=qa(l);return po(c.length>0,c)})).map((e=>Wa(e)))},ku=Ji.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Eu=(e,t,o)=>{const n=o.substring(0,o.length-e.length),r=parseFloat(n);return n===r.toString()?t(r):ku.invalid(o)},Nu=e=>yo(e,"%")?Eu("%",ku.percent,e):yo(e,"px")?Eu("px",ku.pixels,e):ku.invalid(e),Au={...ku,from:Nu},zu=(e,t)=>W(e,(e=>{const o=Au.from(e);return o.fold((()=>e),(e=>{const o=e/t*100;return o+"%"}),(e=>e+"%"))})),Bu=(e,t,o)=>{const n=o/t;return W(e,(e=>{const t=Au.from(e);return t.fold((()=>e),(e=>e*n+"px"),(e=>e/100*o+"px"))}))},ju=(e,t)=>{const o=e.fold((()=>v("")),(e=>{const o=e/t;return v(o+"px")}),(()=>{const e=100/t;return v(e+"%")}));return L(t,o)},Lu=(e,t,o)=>e.fold((()=>t),(e=>Bu(t,o,e)),(e=>zu(t,o))),Wu=(e,t,o)=>{const n=Au.from(o),r=K(e,(e=>"0px"===e))?ju(n,e.length):Lu(n,e,t);return Pu(r)},_u=(e,t)=>0===e.length?t:F(e,((e,t)=>Au.from(t).fold(v(0),y,y)+e),0),Mu=(e,t)=>{const o=Math.floor(e);return{value:o+t,remainder:e-o}},Iu=(e,t)=>Au.from(e).fold(v(e),(e=>e+t+"px"),(e=>e+t+"%")),Pu=e=>{if(0===e.length)return e;const t=F(e,((e,t)=>{const o=Au.from(t).fold((()=>({value:t,remainder:0})),(e=>Mu(e,"px")),(e=>({value:e+"%",remainder:0})));return{output:[o.value].concat(e.output),remainder:e.remainder+o.remainder}}),{output:[],remainder:0}),o=t.output;return o.slice(0,o.length-1).concat([Iu(o[o.length-1],Math.round(t.remainder))])},Fu=Au.from,Hu=(e,t,o)=>{_(t,(t=>{const n=e.slice(t.column,t.colspan+t.column),r=_u(n,Po());ko(t.element,"width",r+o)}))},$u=(e,t,o)=>{_(t,((t,n)=>{const r=_u([e[n]],Po());ko(t.element,"width",r+o)}))},qu=(e,t,o,n)=>{_(o,(t=>{const o=e.slice(t.row,t.rowspan+t.row),r=_u(o,Fo());ko(t.element,"height",r+n)})),_(t,((t,o)=>{ko(t.element,"height",e[o])}))},Vu=e=>Fu(e).fold(v("px"),v("px"),v("%")),Uu=(e,t,o)=>{const n=Or.fromTable(e),r=n.all,s=Or.justCells(n),l=Or.justColumns(n);t.each((t=>{const o=Vu(t),r=Zn(e),c=qs(n,e),a=Wu(c,r,t);Or.hasColumns(n)?$u(a,l,o):Hu(a,s,o),ko(e,"width",t)})),o.each((t=>{const o=Vu(t),l=Lr(e),c=Ys(n,e,ts),a=Wu(c,l,t);qu(a,r,s,o),ko(e,"height",t)}))},Gu=zs,Ku=Bs,Yu=js,Ju=e=>{We(e,"width")},Qu=e=>{const t=As(e);Uu(e,k.some(t),k.none()),Ju(e)},Xu=e=>{const t=Ns(e);Uu(e,k.some(t),k.none()),Ju(e)},Zu=e=>{Bo(e,"width");const t=Go(e),o=t.length>0?t:Uo(e);_(o,(e=>{Bo(e,"width"),Ju(e)})),Ju(e)},ef={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},tf=()=>$e.fromTag("th"),of=()=>$e.fromTag("td"),nf=()=>$e.fromTag("col"),rf=(e,t,o,n)=>{const r=$e.fromTag("tr");for(let s=0;s<e;s++){const e=n<t||s<o?tf():of();s<o&&Ae(e,"scope","row"),n<t&&Ae(e,"scope","col"),ut(e,$e.fromTag("br")),ut(r,e)}return r},sf=e=>{const t=$e.fromTag("colgroup");return L(e,(()=>ut(t,nf()))),t},lf=(e,t,o,n)=>L(e,(e=>rf(t,o,n,e))),cf=(e,t,o,n,r,s=ef)=>{const l=$e.fromTag("table"),c="cells"!==r;Eo(l,s.styles),ze(l,s.attributes),s.colGroups&&ut(l,sf(t));const a=Math.min(e,o);if(c&&o>0){const e=$e.fromTag("thead");ut(l,e);const s="sectionCells"===r?a:0,c=lf(o,t,s,n);pt(e,c)}const i=$e.fromTag("tbody");ut(l,i);const m=c?e-a:e,d=c?0:o,u=lf(m,t,d,n);return pt(i,u),l},af=e=>e.dom.innerHTML,mf=e=>{const t=$e.fromTag("div"),o=$e.fromDom(e.dom.cloneNode(!0));return ut(t,o),af(t)},df=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},uf=(e,t)=>{mo(t,"td,th").each(x(df,e))},ff=(e,t)=>{_(oo(t,"tr"),(t=>{$d(e,t.dom),_(oo(t,"th,td"),(t=>{qd(e,t.dom)}))}))},gf=e=>l(e)&&-1!==e.indexOf("%"),hf=(e,t,o,n,r)=>{const s=wu(e),l={styles:s,attributes:bu(e),colGroups:vu(e)};return e.undoManager.ignore((()=>{const s=cf(o,t,r,n,cu(e),l);Ae(s,"data-mce-id","__mce");const c=mf(s);e.insertContent(c),e.addVisual()})),mo(Wl(e),'table[data-mce-id="__mce"]').map((t=>(fu(e)?Xu(t):gu(e)?Zu(t):(uu(e)||gf(s.width))&&Qu(t),Ml(t),We(t,"data-mce-id"),ff(e,t),uf(e,t),t.dom))).getOrNull()},pf=(e,t,o,n={})=>{const r=e=>h(e)&&e>0;if(r(t)&&r(o)){const r=n.headerRows||0,s=n.headerColumns||0;return hf(e,o,t,s,r)}return console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table."),null};var bf=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const wf="x-tinymce/dom-table-",vf=wf+"rows",yf=wf+"columns",Cf=e=>{const t=bf.FakeClipboardItem(e);bf.write([t])},xf=e=>{var t;const o=null!==(t=bf.read())&&void 0!==t?t:[];return te(o,(t=>k.from(t.getType(e))))},Sf=e=>{xf(e).isSome()&&bf.clear()},Tf=e=>{e.fold(Df,(e=>Cf({[vf]:e})))},Rf=()=>xf(vf),Df=()=>Sf(vf),Of=e=>{e.fold(Ef,(e=>Cf({[yf]:e})))},kf=()=>xf(yf),Ef=()=>Sf(yf),Nf=e=>qc(Il(e),_l(e)),Af=e=>Vc(Il(e),_l(e)),zf=(e,t)=>{const o=_l(e),n=()=>Nf(e).each((t=>{Ko(t,o).filter(S(o)).each((t=>{const o=$e.fromText("");if(mt(t,o),wt(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{const t=e.dom.createRng();t.setStart(o.dom,0),t.setEnd(o.dom,0),e.selection.setRng(t),e.nodeChanged()}}))})),r=t=>Nf(e).each((n=>{const r=gu(e)||fu(e)||uu(e);r||Ko(n,o).each((o=>{"relative"!==t||Gu(o)?"fixed"!==t||Ku(o)?"responsive"!==t||Yu(o)||Zu(o):Xu(o):Qu(o),Ml(o),Vd(e,o.dom,Qd)}))})),s=e=>Ko(e,o),a=t=>Af(e).bind((e=>s(e).map((o=>t(o,e))))),i=(t,o)=>{a((t=>{e.formatter.toggle("tableclass",{value:o},t.dom),Vd(e,t.dom,Jd)}))},m=(t,o)=>{a((t=>{const n=Uc(e),r=K(n,(t=>e.formatter.match("tablecellclass",{value:o},t.dom))),s=r?e.formatter.remove:e.formatter.apply;_(n,(e=>s("tablecellclass",{value:o},e.dom))),Vd(e,t.dom,Jd)}))},d=()=>{Nf(e).each((t=>{Ko(t,o).each((o=>{io(o,"caption").fold((()=>{const t=$e.fromTag("caption");ut(t,$e.fromText("Caption")),ft(o,t,0),e.selection.setCursorLocation(t.dom,0)}),(n=>{Ee("caption")(t)&&Ge("td",o).each((t=>e.selection.setCursorLocation(t.dom,0))),wt(n)})),Vd(e,o.dom,Qd)}))}))},u=t=>{e.focus()},f=(t,o=!1)=>a(((n,r)=>{const s=Ic(Uc(e),n,r);t(n,s,o).each(u)})),g=()=>a(((t,o)=>{const n=Ic(Uc(e),t,o),r=zl(p,$e.fromDom(e.getDoc()),k.none());return Ou(t,n,r)})),h=()=>a(((t,o)=>{const n=Ic(Uc(e),t,o);return Du(t,n)})),b=(t,o)=>o().each((o=>{const n=W(o,(e=>xt(e)));a(((o,r)=>{const s=Bl($e.fromDom(e.getDoc())),l=Fc(Uc(e),r,n,s);t(o,l).each(u)}))})),w=e=>(t,o)=>ue(o,"type").each((t=>{f(e(t),o.no_events)}));re({mceTableSplitCells:()=>f(t.unmergeCells),mceTableMergeCells:()=>f(t.mergeCells),mceTableInsertRowBefore:()=>f(t.insertRowsBefore),mceTableInsertRowAfter:()=>f(t.insertRowsAfter),mceTableInsertColBefore:()=>f(t.insertColumnsBefore),mceTableInsertColAfter:()=>f(t.insertColumnsAfter),mceTableDeleteCol:()=>f(t.deleteColumn),mceTableDeleteRow:()=>f(t.deleteRow),mceTableCutCol:()=>h().each((e=>{Of(e),f(t.deleteColumn)})),mceTableCutRow:()=>g().each((e=>{Tf(e),f(t.deleteRow)})),mceTableCopyCol:()=>h().each((e=>Of(e))),mceTableCopyRow:()=>g().each((e=>Tf(e))),mceTablePasteColBefore:()=>b(t.pasteColsBefore,kf),mceTablePasteColAfter:()=>b(t.pasteColsAfter,kf),mceTablePasteRowBefore:()=>b(t.pasteRowsBefore,Rf),mceTablePasteRowAfter:()=>b(t.pasteRowsAfter,Rf),mceTableDelete:n,mceTableCellToggleClass:m,mceTableToggleClass:i,mceTableToggleCaption:d,mceTableSizingMode:(e,t)=>r(t),mceTableCellType:w((e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader)),mceTableColType:w((e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader)),mceTableRowType:w((e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}}))},((t,o)=>e.addCommand(o,t))),e.addCommand("mceInsertTable",((t,o)=>{pf(e,o.rows,o.columns,o.options)})),e.addCommand("mceTableApplyCellStyle",((t,o)=>{const n=e=>"tablecell"+e.toLowerCase().replace("-","");if(!c(o))return;const r=Uc(e);if(0===r.length)return;const a=ie(o,((t,o)=>e.formatter.has(n(o))&&l(t)));he(a)||(re(a,((t,o)=>{const s=n(o);_(r,(o=>{""===t?e.formatter.remove(s,{value:null},o.dom,!0):e.formatter.apply(s,{value:t},o.dom)}))})),s(r[0]).each((t=>Vd(e,t.dom,Jd))))}))},Bf=(e,t)=>{const o=_l(e),n=t=>Vc(Il(e)).bind((n=>Ko(n,o).map((o=>{const r=Ic(Uc(e),o,n);return t(o,r)})))).getOr("");re({mceTableRowType:()=>n(t.getTableRowType),mceTableCellType:()=>n(t.getTableCellType),mceTableColType:()=>n(t.getTableColType)},((t,o)=>e.addQueryValueHandler(o,t)))},jf=Ji.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Lf=(e,t,o,n)=>e.fold(t,o,n),Wf=e=>e.fold(y,y,y),_f=jf.before,Mf=jf.on,If=jf.after,Pf={before:_f,on:Mf,after:If,cata:Lf,getStart:Wf},Ff=(e,t)=>({selection:e,kill:t}),Hf={create:Ff},$f=(e,t)=>{const o=e.document.createRange();return o.selectNode(t.dom),o},qf=(e,t)=>{const o=e.document.createRange();return Vf(o,t),o},Vf=(e,t)=>e.selectNodeContents(t.dom),Uf=(e,t)=>{t.fold((t=>{e.setStartBefore(t.dom)}),((t,o)=>{e.setStart(t.dom,o)}),(t=>{e.setStartAfter(t.dom)}))},Gf=(e,t)=>{t.fold((t=>{e.setEndBefore(t.dom)}),((t,o)=>{e.setEnd(t.dom,o)}),(t=>{e.setEndAfter(t.dom)}))},Kf=(e,t,o)=>{const n=e.document.createRange();return Uf(n,t),Gf(n,o),n},Yf=(e,t,o,n,r)=>{const s=e.document.createRange();return s.setStart(t.dom,o),s.setEnd(n.dom,r),s},Jf=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),Qf=e=>{const t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?k.some(o).map(Jf):k.none()},Xf=Ji.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Zf=(e,t,o)=>t($e.fromDom(o.startContainer),o.startOffset,$e.fromDom(o.endContainer),o.endOffset),eg=(e,t)=>t.match({domRange:e=>({ltr:v(e),rtl:k.none}),relative:(t,o)=>({ltr:tn((()=>Kf(e,t,o))),rtl:tn((()=>k.some(Kf(e,o,t))))}),exact:(t,o,n,r)=>({ltr:tn((()=>Yf(e,t,o,n,r))),rtl:tn((()=>k.some(Yf(e,n,r,t,o))))})}),tg=(e,t)=>{const o=t.ltr();if(o.collapsed){const n=t.rtl().filter((e=>!1===e.collapsed));return n.map((e=>Xf.rtl($e.fromDom(e.endContainer),e.endOffset,$e.fromDom(e.startContainer),e.startOffset))).getOrThunk((()=>Zf(e,Xf.ltr,o)))}return Zf(e,Xf.ltr,o)},og=(e,t)=>{const o=eg(e,t);return tg(e,o)},ng=(e,t)=>{const o=og(e,t);return o.match({ltr:(t,o,n,r)=>{const s=e.document.createRange();return s.setStart(t.dom,o),s.setEnd(n.dom,r),s},rtl:(t,o,n,r)=>{const s=e.document.createRange();return s.setStart(n.dom,r),s.setEnd(t.dom,o),s}})};Xf.ltr,Xf.rtl;const rg=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),sg={create:rg},lg=(e,t,o,n)=>({start:Pf.on(e,t),finish:Pf.on(o,n)}),cg={create:lg},ag=(e,t)=>{const o=ng(e,t);return sg.create($e.fromDom(o.startContainer),o.startOffset,$e.fromDom(o.endContainer),o.endOffset)},ig=cg.create,mg=(e,t,o,n,r,s,l)=>Ke(o,r)&&n===s?k.none():uo(o,"td,th",t).bind((o=>uo(r,"td,th",t).bind((n=>dg(e,t,o,n,l))))),dg=(e,t,o,n,r)=>Ke(o,n)?k.none():vc(o,n,t).bind((t=>{const n=t.boxes.getOr([]);return n.length>1?(r(e,n,t.start,t.finish),k.some(Hf.create(k.some(ig(o,0,o,pl(o))),!0))):k.none()})),ug=(e,t,o,n,r)=>{const s=e=>(r.clearBeforeUpdate(o),r.selectRange(o,e.boxes,e.start,e.finish),e.boxes);return Tc(n,e,t,r.firstSelectedSelector,r.lastSelectedSelector).map(s)},fg=(e,t)=>({item:e,mode:t}),gg=(e,t,o,n=hg)=>e.property().parent(t).map((e=>fg(e,n))),hg=(e,t,o,n=pg)=>o.sibling(e,t).map((e=>fg(e,n))),pg=(e,t,o,n=pg)=>{const r=e.property().children(t),s=o.first(r);return s.map((e=>fg(e,n)))},bg=[{current:gg,next:hg,fallback:k.none()},{current:hg,next:pg,fallback:k.some(gg)},{current:pg,next:pg,fallback:k.some(hg)}],wg=(e,t,o,n,r=bg)=>{const s=q(r,(e=>e.current===o));return s.bind((o=>o.current(e,t,n,o.next).orThunk((()=>o.fallback.bind((o=>wg(e,t,o,n)))))))},vg=()=>{const e=(e,t)=>e.query().prevSibling(t),t=e=>e.length>0?k.some(e[e.length-1]):k.none();return{sibling:e,first:t}},yg=()=>{const e=(e,t)=>e.query().nextSibling(t),t=e=>e.length>0?k.some(e[0]):k.none();return{sibling:e,first:t}},Cg={left:vg,right:yg},xg=(e,t,o,n,r,s)=>{const l=wg(e,t,n,r);return l.bind((t=>s(t.item)?k.none():o(t.item)?k.some(t.item):xg(e,t.item,o,t.mode,r,s)))},Sg=(e,t,o,n)=>xg(e,t,o,hg,Cg.left(),n),Tg=(e,t,o,n)=>xg(e,t,o,hg,Cg.right(),n),Rg=e=>t=>0===e.property().children(t).length,Dg=(e,t,o)=>kg(e,t,Rg(e),o),Og=(e,t,o)=>Eg(e,t,Rg(e),o),kg=Sg,Eg=Tg,Ng=lc(),Ag=(e,t)=>Dg(Ng,e,t),zg=(e,t)=>Og(Ng,e,t),Bg=(e,t,o)=>kg(Ng,e,t,o),jg=(e,t,o)=>Eg(Ng,e,t,o),Lg=(e,t,o)=>ro(e,t,o).isSome(),Wg=Ji.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),_g=(e,t,o)=>{const n=e.getRect(t),r=e.getRect(o);return r.right>n.left&&r.left<n.right},Mg=e=>uo(e,"tr"),Ig=(e,t,o,n,r,s,l)=>uo(n,"td,th",l).bind((o=>uo(t,"td,th",l).map((t=>Ke(o,t)?Ke(n,o)&&pl(o)===r?s(t):Wg.none("in same cell"):pc(Mg,[o,t]).fold((()=>_g(e,t,o)?Wg.success():s(t)),(e=>s(t))))))).getOr(Wg.none("default")),Pg=(e,t,o,n,r)=>e.fold(t,o,n,r),Fg={...Wg,verify:Ig,cata:Pg},Hg=(e,t,o,n)=>({parent:e,children:t,element:o,index:n}),$g=e=>tt(e).bind((t=>{const o=lt(t);return qg(o,e).map((n=>Hg(t,o,e,n)))})),qg=(e,t)=>V(e,x(Ke,t)),Vg=Ee("br"),Ug=(e,t,o)=>t(e,o).bind((e=>De(e)&&0===fl(e).trim().length?Ug(e,t,o):k.some(e))),Gg=(e,t,o)=>o.traverse(t).orThunk((()=>Ug(t,o.gather,e))).map(o.relative),Kg=(e,t)=>ct(e,t).filter(Vg).orThunk((()=>ct(e,t-1).filter(Vg))),Yg=(e,t,o,n)=>Kg(t,o).bind((t=>n.traverse(t).fold((()=>Ug(t,n.gather,e).map(n.relative)),(e=>$g(e).map((e=>Pf.on(e.parent,e.index))))))),Jg=(e,t,o,n)=>{const r=Vg(t)?Gg(e,t,n):Yg(e,t,o,n);return r.map((e=>({start:e,finish:e})))},Qg=e=>Fg.cata(e,(e=>k.none()),(()=>k.none()),(e=>k.some(Xc(e,0))),(e=>k.some(Xc(e,pl(e))))),Xg=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),Zg=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),eh=(e,t,o)=>({left:e.left+t,top:e.top+o,right:e.right+t,bottom:e.bottom+o}),th=e=>e.top,oh=e=>e.bottom,nh=(e,t,o)=>o>=0&&o<pl(t)?e.getRangedRect(t,o,t,o+1):o>0?e.getRangedRect(t,o-1,t,o):k.none(),rh=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),sh=(e,t)=>k.some(e.getRect(t)),lh=(e,t,o)=>Re(t)?sh(e,t).map(rh):De(t)?nh(e,t,o).map(rh):k.none(),ch=(e,t)=>Re(t)?sh(e,t).map(rh):De(t)?e.getRangedRect(t,0,t,pl(t)).map(rh):k.none(),ah=5,ih=100,mh=Ji.generate([{none:[]},{retry:["caret"]}]),dh=(e,t)=>e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right,uh=(e,t,o)=>so(t,km).fold(D,(t=>ch(e,t).exists((e=>dh(o,e))))),fh=(e,t,o,n,r)=>{const s=Xg(r,ah);return Math.abs(o.bottom-n.bottom)<1||o.top>r.bottom?mh.retry(s):o.top===r.bottom?mh.retry(Xg(r,1)):uh(e,t,r)?mh.retry(eh(s,ah,0)):mh.none()},gh=(e,t,o,n,r)=>{const s=Zg(r,ah);return Math.abs(o.top-n.top)<1||o.bottom<r.top?mh.retry(s):o.bottom===r.top?mh.retry(Zg(r,1)):uh(e,t,r)?mh.retry(eh(s,ah,0)):mh.none()},hh={point:th,adjuster:gh,move:Zg,gather:Ag},ph={point:oh,adjuster:fh,move:Xg,gather:zg},bh=(e,t,o)=>e.elementFromPoint(t,o).filter((e=>"table"===Ce(e))).isSome(),wh=(e,t,o,n,r)=>vh(e,t,o,t.move(n,ah),r),vh=(e,t,o,n,r)=>0===r?k.some(n):bh(e,n.left,t.point(n))?wh(e,t,o,n,r-1):e.situsFromPoint(n.left,t.point(n)).bind((s=>s.start.fold(k.none,(s=>ch(e,s).bind((l=>t.adjuster(e,s,l,o,n).fold(k.none,(n=>vh(e,t,o,n,r-1))))).orThunk((()=>k.some(n)))),k.none))),yh=(e,t,o)=>e.point(t)>o.getInnerHeight()?k.some(e.point(t)-o.getInnerHeight()):e.point(t)<0?k.some(-e.point(t)):k.none(),Ch=(e,t,o)=>{const n=e.move(o,ah),r=vh(t,e,o,n,ih).getOr(n);return yh(e,r,t).fold((()=>t.situsFromPoint(r.left,e.point(r))),(o=>(t.scrollBy(0,o),t.situsFromPoint(r.left,e.point(r)-o))))},xh={tryUp:x(Ch,hh),tryDown:x(Ch,ph),getJumpSize:v(ah)},Sh=20,Th=(e,t,o)=>e.getSelection().bind((n=>Jg(t,n.finish,n.foffset,o).fold((()=>k.some(Xc(n.finish,n.foffset))),(r=>{const s=e.fromSitus(r),l=Fg.verify(e,n.finish,n.foffset,s.finish,s.foffset,o.failure,t);return Qg(l)})))),Rh=(e,t,o,n,r,s)=>0===s?k.none():kh(e,t,o,n,r).bind((l=>{const c=e.fromSitus(l),a=Fg.verify(e,o,n,c.finish,c.foffset,r.failure,t);return Fg.cata(a,(()=>k.none()),(()=>k.some(l)),(l=>Ke(o,l)&&0===n?Dh(e,o,n,Zg,r):Rh(e,t,l,0,r,s-1)),(l=>Ke(o,l)&&n===pl(l)?Dh(e,o,n,Xg,r):Rh(e,t,l,pl(l),r,s-1)))})),Dh=(e,t,o,n,r)=>lh(e,t,o).bind((t=>Oh(e,r,n(t,xh.getJumpSize())))),Oh=(e,t,o)=>{const n=$n().browser;return n.isChromium()||n.isSafari()||n.isFirefox()?t.retry(e,o):k.none()},kh=(e,t,o,n,r)=>lh(e,o,n).bind((t=>Oh(e,r,t))),Eh=(e,t,o)=>Th(e,t,o).bind((n=>Rh(e,t,n.element,n.offset,o,Sh).map(e.fromSitus))),Nh=(e,t)=>Lg(e,(e=>tt(e).exists((e=>Ke(e,t))))),Ah=(e,t,o,n,r)=>uo(n,"td,th",t).bind((n=>uo(n,"table",t).bind((s=>Nh(r,s)?Eh(e,t,o).bind((e=>uo(e.finish,"td,th",t).map((t=>({start:n,finish:t,range:e}))))):k.none())))),zh=(e,t,o,n,r,s)=>s(n,t).orThunk((()=>Ah(e,t,o,n,r).map((e=>{const t=e.range;return Hf.create(k.some(ig(t.start,t.soffset,t.finish,t.foffset)),!0)})))),Bh=(e,t)=>uo(e,"tr",t).bind((e=>uo(e,"table",t).bind((o=>{const n=oo(o,"tr");return Ke(e,n[0])?Bg(o,(e=>Cl(e).isSome()),t).map((e=>{const t=pl(e);return Hf.create(k.some(ig(e,t,e,t)),!0)})):k.none()})))),jh=(e,t)=>uo(e,"tr",t).bind((e=>uo(e,"table",t).bind((o=>{const n=oo(o,"tr");return Ke(e,n[n.length-1])?jg(o,(e=>yl(e).isSome()),t).map((e=>Hf.create(k.some(ig(e,0,e,0)),!0))):k.none()})))),Lh=(e,t,o,n,r,s,l)=>Ah(e,o,n,r,s).bind((e=>dg(t,o,e.start,e.finish,l))),Wh=e=>{let t=e;const o=()=>t,n=e=>{t=e};return{get:o,set:n}},_h=e=>{const t=Wh(k.none()),o=()=>t.get().each(e),n=()=>{o(),t.set(k.none())},r=()=>t.get().isSome(),s=()=>t.get(),l=e=>{o(),t.set(k.some(e))};return{clear:n,isSet:r,get:s,set:l}},Mh=()=>{const e=_h(p),t=t=>e.get().each(t);return{...e,on:t}},Ih=(e,t)=>uo(e,"td,th",t),Ph=(e,t,o,n)=>{const r=Mh(),s=r.clear,l=s=>{r.on((r=>{n.clearBeforeUpdate(t),Ih(s.target,o).each((l=>{vc(r,l,o).each((o=>{const r=o.boxes.getOr([]);if(1===r.length){const o=r[0],l="false"===Aa(o),c=fo(Ea(s.target),o,Ke);l&&c&&(n.selectRange(t,r,o,o),e.selectContents(o))}else r.length>1&&(n.selectRange(t,r,o.start,o.finish),e.selectContents(l))}))}))}))},c=e=>{n.clear(t),Ih(e.target,o).each(r.set)},a=e=>{l(e)},i=e=>{l(e),s()};return{clearstate:s,mousedown:c,mouseover:a,mouseup:i}},Fh={traverse:st,gather:zg,relative:Pf.before,retry:xh.tryDown,failure:Fg.failedDown},Hh={traverse:rt,gather:Ag,relative:Pf.before,retry:xh.tryUp,failure:Fg.failedUp},$h=e=>t=>t===e,qh=$h(38),Vh=$h(40),Uh=e=>e>=37&&e<=40,Gh={isBackward:$h(37),isForward:$h(39)},Kh={isBackward:$h(39),isForward:$h(37)},Yh=e=>{const t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return Ir(o,n)},Jh=(e,t,o)=>{const n=void 0!==o?o.dom:document,r=n.defaultView;r&&r.scrollBy(e,t)},Qh=Ji.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Xh=e=>Qh.exact(e.start,e.soffset,e.finish,e.foffset),Zh=e=>e.match({domRange:e=>$e.fromDom(e.startContainer),relative:(e,t)=>Pf.getStart(e),exact:(e,t,o,n)=>e}),ep=Qh.domRange,tp=Qh.relative,op=Qh.exact,np=e=>{const t=Zh(e);return et(t)},rp=sg.create,sp={domRange:ep,relative:tp,exact:op,exactFromRange:Xh,getWin:np,range:rp},lp=(e,t,o)=>{var n,r;return k.from(null===(r=(n=e.dom).caretPositionFromPoint)||void 0===r?void 0:r.call(n,t,o)).bind((t=>{if(null===t.offsetNode)return k.none();const o=e.dom.createRange();return o.setStart(t.offsetNode,t.offset),o.collapse(),k.some(o)}))},cp=(e,t,o)=>{var n,r;return k.from(null===(r=(n=e.dom).caretRangeFromPoint)||void 0===r?void 0:r.call(n,t,o))},ap=(()=>document.caretPositionFromPoint?lp:document.caretRangeFromPoint?cp:k.none)(),ip=(e,t,o)=>{const n=$e.fromDom(e.document);return ap(n,t,o).map((e=>sg.create($e.fromDom(e.startContainer),e.startOffset,$e.fromDom(e.endContainer),e.endOffset)))},mp=(e,t)=>{const o=Ce(e);return"input"===o?Pf.after(e):B(["br","img"],o)?0===t?Pf.before(e):Pf.after(e):Pf.on(e,t)},dp=(e,t)=>{const o=e.fold(Pf.before,mp,Pf.after),n=t.fold(Pf.before,mp,Pf.after);return sp.relative(o,n)},up=(e,t,o,n)=>{const r=mp(e,t),s=mp(o,n);return sp.relative(r,s)},fp=(e,t,o,n)=>{const r=Qe(e),s=r.dom.createRange();return s.setStart(e.dom,t),s.setEnd(o.dom,n),s},gp=(e,t,o,n)=>{const r=fp(e,t,o,n),s=Ke(e,o)&&t===n;return r.collapsed&&!s},hp=e=>k.from(e.getSelection()),pp=(e,t)=>{hp(e).each((e=>{e.removeAllRanges(),e.addRange(t)}))},bp=(e,t,o,n,r)=>{const s=Yf(e,t,o,n,r);pp(e,s)},wp=(e,t,o,n,r,s)=>{t.collapse(o.dom,n),t.extend(r.dom,s)},vp=(e,t)=>og(e,t).match({ltr:(t,o,n,r)=>{bp(e,t,o,n,r)},rtl:(t,o,n,r)=>{hp(e).each((s=>{if(s.setBaseAndExtent)s.setBaseAndExtent(t.dom,o,n.dom,r);else if(s.extend)try{wp(e,s,t,o,n,r)}catch(l){bp(e,n,r,t,o)}else bp(e,n,r,t,o)}))}}),yp=(e,t,o,n,r)=>{const s=up(t,o,n,r);vp(e,s)},Cp=(e,t,o)=>{const n=dp(t,o);vp(e,n)},xp=e=>{if(e.rangeCount>0){const t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return k.some(sg.create($e.fromDom(t.startContainer),t.startOffset,$e.fromDom(o.endContainer),o.endOffset))}return k.none()},Sp=e=>{if(null===e.anchorNode||null===e.focusNode)return xp(e);{const t=$e.fromDom(e.anchorNode),o=$e.fromDom(e.focusNode);return gp(t,e.anchorOffset,o,e.focusOffset)?k.some(sg.create(t,e.anchorOffset,o,e.focusOffset)):xp(e)}},Tp=(e,t,o=!0)=>{const n=o?qf:$f,r=n(e,t);pp(e,r)},Rp=e=>hp(e).filter((e=>e.rangeCount>0)).bind(Sp),Dp=e=>Rp(e).map((e=>sp.exact(e.start,e.soffset,e.finish,e.foffset))),Op=(e,t)=>{const o=ng(e,t);return Qf(o)},kp=(e,t,o)=>ip(e,t,o),Ep=e=>{hp(e).each((e=>e.removeAllRanges()))},Np=e=>{const t=(t,o)=>$e.fromPoint($e.fromDom(e.document),t,o),o=e=>e.dom.getBoundingClientRect(),n=(t,o,n,r)=>{const s=sp.exact(t,o,n,r);return Op(e,s)},r=()=>Dp(e).map((t=>ag(e,t))),s=t=>{const o=sp.relative(t.start,t.finish);return ag(e,o)},l=(t,o)=>kp(e,t,o).map((e=>cg.create(e.start,e.soffset,e.finish,e.foffset))),c=()=>{Ep(e)},a=(t=!1)=>{Dp(e).each((o=>o.fold((e=>e.collapse(t)),((o,n)=>{const r=t?o:n;Cp(e,r,r)}),((o,n,r,s)=>{const l=t?o:r,c=t?n:s;yp(e,l,c,l,c)}))))},i=t=>{Tp(e,t,!1)},m=t=>{Tp(e,t)},d=t=>{yp(e,t.start,t.soffset,t.finish,t.foffset)},u=(t,o)=>{Cp(e,t,o)},f=()=>e.innerHeight,g=()=>{const t=Yh($e.fromDom(e.document));return t.top},h=(t,o)=>{Jh(t,o,$e.fromDom(e.document))};return{elementFromPoint:t,getRect:o,getRangedRect:n,getSelection:r,fromSitus:s,situsFromPoint:l,clearSelection:c,collapseSelection:a,setSelection:d,setRelativeSelection:u,selectNode:i,selectContents:m,getInnerHeight:f,getScrollY:g,scrollBy:h}},Ap=(e,t)=>({rows:e,cols:t}),zp=(e,t,o,n)=>{const r=Np(e),s=Ph(r,t,o,n);return{clearstate:s.clearstate,mousedown:s.mousedown,mouseover:s.mouseover,mouseup:s.mouseup}},Bp=(e,t,o,n)=>{const r=Np(e),s=()=>(n.clear(t),k.none()),l=(e,l,c,a,i,m)=>{const d=e.raw,u=d.which,f=!0===d.shiftKey,g=yc(t,n.selectedSelector).fold((()=>(Uh(u)&&!f&&n.clearBeforeUpdate(t),Vh(u)&&f?x(Lh,r,t,o,Fh,a,l,n.selectRange):qh(u)&&f?x(Lh,r,t,o,Hh,a,l,n.selectRange):Vh(u)?x(zh,r,o,Fh,a,l,jh):qh(u)?x(zh,r,o,Hh,a,l,Bh):k.none)),(e=>{const o=o=>()=>{const s=te(o,(o=>ug(o.rows,o.cols,t,e,n)));return s.fold((()=>xc(t,n.firstSelectedSelector,n.lastSelectedSelector).map((e=>{const o=Vh(u)||m.isForward(u)?Pf.after:Pf.before;return r.setRelativeSelection(Pf.on(e.first,0),o(e.table)),n.clear(t),Hf.create(k.none(),!0)}))),(e=>k.some(Hf.create(k.none(),!0))))};return Vh(u)&&f?o([Ap(1,0)]):qh(u)&&f?o([Ap(-1,0)]):m.isBackward(u)&&f?o([Ap(0,-1),Ap(-1,0)]):m.isForward(u)&&f?o([Ap(0,1),Ap(1,0)]):Uh(u)&&!f?s:k.none}));return g()},c=(e,r,s,l,c)=>yc(t,n.selectedSelector).fold((()=>{const a=e.raw,i=a.which,m=!0===a.shiftKey;return m&&Uh(i)?mg(t,o,r,s,l,c,n.selectRange):k.none()}),k.none);return{keydown:l,keyup:c}},jp=(e,t,o,n)=>{const r=Np(e);return(e,s)=>{n.clearBeforeUpdate(t),vc(e,s,o).each((e=>{const o=e.boxes.getOr([]);n.selectRange(t,o,e.start,e.finish),r.selectContents(s),r.collapseSelection()}))}},Lp=(e,t)=>{const o=je(e,t);return void 0===o||""===o?[]:o.split(" ")},Wp=(e,t,o)=>{const n=Lp(e,t),r=n.concat([o]);return Ae(e,t,r.join(" ")),!0},_p=(e,t,o)=>{const n=P(Lp(e,t),(e=>e!==o));return n.length>0?Ae(e,t,n.join(" ")):We(e,t),!1},Mp=e=>void 0!==e.dom.classList,Ip=e=>Lp(e,"class"),Pp=(e,t)=>Wp(e,"class",t),Fp=(e,t)=>_p(e,"class",t),Hp=(e,t)=>{Mp(e)?e.dom.classList.add(t):Pp(e,t)},$p=e=>{const t=Mp(e)?e.dom.classList:Ip(e);0===t.length&&We(e,"class")},qp=(e,t)=>{if(Mp(e)){const o=e.dom.classList;o.remove(t)}else Fp(e,t);$p(e)},Vp=(e,t)=>Mp(e)&&e.dom.classList.contains(t),Up=(e,t)=>{_(t,(t=>{qp(e,t)}))},Gp=e=>t=>{Hp(t,e)},Kp=e=>t=>{Up(t,e)},Yp=e=>{const t=Gp(e.selected),o=Kp([e.selected,e.lastSelected,e.firstSelected]),n=t=>{const n=oo(t,e.selectedSelector);_(n,o)},r=(o,r,s,l)=>{n(o),_(r,t),Hp(s,e.firstSelected),Hp(l,e.lastSelected)};return{clearBeforeUpdate:n,clear:n,selectRange:r,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Jp=(e,t,o)=>{const n=t=>{We(t,e.selected),We(t,e.firstSelected),We(t,e.lastSelected)},r=t=>{Ae(t,e.selected,"1")},s=e=>{l(e),o()},l=t=>{const o=oo(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);_(o,n)},c=(o,n,l,c)=>{s(o),_(n,r),Ae(l,e.firstSelected,"1"),Ae(c,e.lastSelected,"1"),t(n,l,c)};return{clearBeforeUpdate:l,clear:s,selectRange:c,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Qp={byClass:Yp,byAttr:Jp},Xp=(e,t,o,n)=>{switch(e.tag){case"none":return t();case"single":return n(e.element);case"multiple":return o(e.elements)}},Zp=()=>({tag:"none"}),eb=e=>({tag:"multiple",elements:e}),tb=e=>({tag:"single",element:e}),ob=(e,t,o)=>{const n=()=>Rc(e(),o).fold((()=>t().fold(Zp,tb)),eb);return{get:n}},nb=(e,t)=>{const o=e.slice(0,t[t.length-1].row+1),n=qa(o);return G(n,(e=>{const o=e.cells.slice(0,t[t.length-1].column+1);return W(o,(e=>e.element))}))},rb=(e,t)=>{const o=e.slice(t[0].row+t[0].rowspan-1,e.length),n=qa(o);return G(n,(e=>{const o=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return W(o,(e=>e.element))}))},sb=(e,t,o)=>{const n=Or.fromTable(e),r=Xa(n,t);return r.map((e=>{const t=Ha(n,o,!1),{rows:r}=dr(t),s=nb(r,e),l=rb(r,e);return{upOrLeftCells:s,downOrRightCells:l}}))},lb=(e,t,o,n,r,s,l)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:s,raw:l}),cb=e=>{const t=$e.fromDom(Ut(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=b(n,o);return lb(t,e.clientX,e.clientY,o,n,r,e)},ab=(e,t)=>o=>{e(o)&&t(cb(o))},ib=(e,t,o,n,r)=>{const s=ab(o,n);return e.dom.addEventListener(t,s,r),{unbind:x(db,e,t,s,r)}},mb=(e,t,o,n)=>ib(e,t,o,n,!1),db=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},ub=O,fb=(e,t,o)=>mb(e,t,ub,o),gb=cb,hb=e=>!Vp($e.fromDom(e.target),"ephox-snooker-resizer-bar"),pb=(e,t)=>{const o=ob((()=>$e.fromDom(e.getBody())),(()=>Vc(Il(e),_l(e))),Mc.selectedSelector),n=(t,o,n)=>{const r=Ko(o);r.each((r=>{const s=su(e),l=zl(p,$e.fromDom(e.getDoc()),s),c=Uc(e),a=sb(r,{selection:c},l);Ud(e,t,o,n,a)}))},r=()=>Gd(e),s=Qp.byAttr(Mc,n,r);e.on("init",(o=>{const n=e.getWin(),r=Wl(e),l=_l(e),c=()=>{const t=e.selection,o=$e.fromDom(t.getStart()),n=$e.fromDom(t.getEnd()),l=pc(Ko,[o,n]);l.fold((()=>s.clear(r)),p)},a=zp(n,r,l,s),i=Bp(n,r,l,s),m=jp(n,r,l,s),d=e=>!0===e.raw.shiftKey;e.on("TableSelectorChange",(e=>m(e.start,e.finish)));const u=(t,o)=>{d(t)&&(o.kill&&t.kill(),o.selection.each((t=>{const o=sp.relative(t.start,t.finish),r=ng(n,o);e.selection.setRng(r)})))},f=t=>{const o=gb(t);if(o.raw.shiftKey&&Uh(o.raw.which)){const t=e.selection.getRng(),n=$e.fromDom(t.startContainer),r=$e.fromDom(t.endContainer);i.keyup(o,n,t.startOffset,r,t.endOffset).each((e=>{u(o,e)}))}},g=o=>{const n=gb(o);t.hide();const r=e.selection.getRng(),s=$e.fromDom(r.startContainer),l=$e.fromDom(r.endContainer),c=zr(Gh,Kh)($e.fromDom(e.selection.getStart()));i.keydown(n,s,r.startOffset,l,r.endOffset,c).each((e=>{u(n,e)})),t.show()},h=e=>0===e.button,b=e=>void 0===e.buttons||0!==(1&e.buttons),w=e=>{a.clearstate()},v=e=>{h(e)&&hb(e)&&a.mousedown(gb(e))},y=e=>{b(e)&&hb(e)&&a.mouseover(gb(e))},C=e=>{h(e)&&hb(e)&&a.mouseup(gb(e))},x=()=>{const e=Wh($e.fromDom(r)),t=Wh(0),o=o=>{const n=$e.fromDom(o.target);if(Ee("td")(n)||Ee("th")(n)){const r=e.get(),s=t.get();Ke(r,n)&&o.timeStamp-s<300&&(o.preventDefault(),m(n,n))}e.set(n),t.set(o.timeStamp)};return{touchEnd:o}},S=x();e.on("dragstart",w),e.on("mousedown",v),e.on("mouseover",y),e.on("mouseup",C),e.on("touchend",S.touchEnd),e.on("keyup",f),e.on("keydown",g),e.on("NodeChange",c)})),e.on("PreInit",(()=>{e.serializer.addTempAttr(Mc.firstSelected),e.serializer.addTempAttr(Mc.lastSelected)}));const l=e=>s.clear($e.fromDom(e)),c=()=>Xp(o.get(),v([]),(e=>W(e,(e=>e.dom))),(e=>[e.dom]));return{getSelectedCells:c,clearSelectedCells:l}},bb=e=>{let t=[];const o=e=>{if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},n=e=>{t=P(t,(t=>t!==e))},r=(...o)=>{const n={};_(e,((e,t)=>{n[e]=o[t]})),_(t,(e=>{e(n)}))};return{bind:o,unbind:n,trigger:r}},wb=e=>{const t=se(e,(e=>({bind:e.bind,unbind:e.unbind}))),o=se(e,(e=>e.trigger));return{registry:t,trigger:o}},vb=(e,t)=>{let o=null;const n=()=>{i(o)||(clearTimeout(o),o=null)},r=(...r)=>{n(),o=setTimeout((()=>{o=null,e.apply(null,r)}),t)};return{cancel:n,throttle:r}},yb=e=>e.slice(0).sort(),Cb=(e,t)=>{throw new Error("All required keys ("+yb(e).join(", ")+") were not specified. Specified keys were: "+yb(t).join(", ")+".")},xb=e=>{throw new Error("Unsupported keys for object: "+yb(e).join(", "))},Sb=(e,t)=>{if(!a(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");_(t,(t=>{if(!l(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))},Tb=(e,t)=>{throw new Error("All values need to be of type: "+t+". Keys ("+yb(e).join(", ")+") were not.")},Rb=e=>{const t=yb(e),o=q(t,((e,o)=>o<t.length-1&&e===t[o+1]));o.each((e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))},Db=(e,t)=>Ob(e,t,{validate:g,label:"function"}),Ob=(e,t,o)=>{if(0===t.length)throw new Error("You must specify at least one required field.");return Sb("required",t),Rb(t),n=>{const r=oe(n),s=K(t,(e=>B(r,e)));s||Cb(t,r),e(t,r);const l=P(t,(e=>!o.validate(n[e],e)));return l.length>0&&Tb(l,o.label),n}},kb=(e,t)=>{const o=P(t,(t=>!B(e,t)));o.length>0&&xb(o)},Eb=e=>Db(kb,e),Nb=Eb(["compare","extract","mutate","sink"]),Ab=Eb(["element","start","stop","destroy"]),zb=Eb(["forceDrop","drop","move","delayDrop"]),Bb=()=>{let e=k.none();const t=()=>{e=k.none()},o=(t,o)=>{const n=e.map((e=>t.compare(e,o)));return e=k.some(o),n},n=(e,t)=>{const n=t.extract(e);n.each((e=>{const n=o(t,e);n.each((e=>{r.trigger.move(e)}))}))},r=wb({move:bb(["info"])});return{onEvent:n,reset:t,events:r.registry}},jb=()=>{const e=wb({move:bb(["info"])});return{onEvent:p,reset:p,events:e.registry}},Lb=()=>{const e=jb(),t=Bb();let o=e;const n=()=>{o.reset(),o=t},r=()=>{o.reset(),o=e},s=(e,t)=>{o.onEvent(e,t)},l=()=>o===t;return{on:n,off:r,isOn:l,onEvent:s,events:t.events}},Wb=(e,t,o)=>{let n=!1;const r=wb({start:bb([]),stop:bb([])}),s=Lb(),l=()=>{f.stop(),s.isOn()&&(s.off(),r.trigger.stop())},c=vb(l,200),a=e=>{f.start(e),s.on(),r.trigger.start()},i=e=>{c.cancel(),s.onEvent(e,t)};s.events.move.bind((o=>{t.mutate(e,o.info)}));const m=()=>{n=!0},d=()=>{n=!1},u=e=>(...t)=>{n&&e.apply(null,t)},f=t.sink(zb({forceDrop:l,drop:u(l),move:u(i),delayDrop:u(c.throttle)}),o),g=()=>{f.destroy()};return{element:f.element,go:a,on:m,off:d,destroy:g,events:r.registry}},_b=e=>{const t=e.replace(/\./g,"-"),o=e=>t+"-"+e;return{resolve:o}},Mb=_b("ephox-dragster"),Ib=Mb.resolve,Pb=e=>{const t={layerClass:Ib("blocker"),...e},o=$e.fromTag("div");Ae(o,"role","presentation"),Eo(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Hp(o,Ib("blocker")),Hp(o,t.layerClass);const n=v(o),r=()=>{wt(o)};return{element:n,destroy:r}},Fb=(e,t)=>Ir(t.left-e.left,t.top-e.top),Hb=e=>k.some(Ir(e.x,e.y)),$b=(e,t)=>{e.mutate(t.left,t.top)},qb=(e,t)=>{const o=Pb(t),n=fb(o.element(),"mousedown",e.forceDrop),r=fb(o.element(),"mouseup",e.drop),s=fb(o.element(),"mousemove",e.move),l=fb(o.element(),"mouseout",e.delayDrop),c=()=>{o.destroy(),r.unbind(),s.unbind(),l.unbind(),n.unbind()},a=e=>{ut(e,o.element())},i=()=>{wt(o.element())};return Ab({element:o.element,start:a,stop:i,destroy:c})};var Vb=Nb({compare:Fb,extract:Hb,sink:qb,mutate:$b});const Ub=(e,t={})=>{var o;const n=null!==(o=t.mode)&&void 0!==o?o:Vb;return Wb(e,n,t)},Gb=_b("ephox-snooker"),Kb=Gb.resolve,Yb=()=>{const e=wb({drag:bb(["xDelta","yDelta"])}),t=(t,o)=>{e.trigger.drag(t,o)};return{mutate:t,events:e.registry}},Jb=()=>{const e=wb({drag:bb(["xDelta","yDelta","target"])});let t=k.none();const o=Yb();o.events.drag.bind((o=>{t.each((t=>{e.trigger.drag(o.xDelta,o.yDelta,t)}))}));const n=e=>{t=k.some(e)},r=()=>t;return{assign:n,get:r,mutate:o.mutate,events:e.registry}},Qb=(e,t,o,n,r)=>{const s=$e.fromTag("div");return Eo(s,{position:"absolute",left:t-n/2+"px",top:o+"px",height:r+"px",width:n+"px"}),ze(s,{"data-column":e,role:"presentation"}),s},Xb=(e,t,o,n,r)=>{const s=$e.fromTag("div");return Eo(s,{position:"absolute",left:t+"px",top:o-r/2+"px",height:r+"px",width:n+"px"}),ze(s,{"data-row":e,role:"presentation"}),s},Zb=Kb("resizer-bar"),ew=Kb("resizer-rows"),tw=Kb("resizer-cols"),ow=7,nw=(e,t)=>G(e.all,((e,o)=>t(e.element)?[o]:[])),rw=(e,t)=>{const o=[];return L(e.grid.columns,(n=>{const r=Or.getColumnAt(e,n).map((e=>e.element));r.forall(t)&&o.push(n)})),P(o,(o=>{const n=Or.filterItems(e,(e=>e.column===o));return K(n,(e=>t(e.element)))}))},sw=e=>{const t=oo(e.parent(),"."+Zb);_(t,wt)},lw=(e,t,o)=>{const n=e.origin();_(t,(t=>{t.each((t=>{const r=o(n,t);Hp(r,Zb),ut(e.parent(),r)}))}))},cw=(e,t,o,n)=>{lw(e,t,((e,t)=>{const r=Qb(t.col,t.x-e.left,o.top-e.top,ow,n);return Hp(r,tw),r}))},aw=(e,t,o,n)=>{lw(e,t,((e,t)=>{const r=Xb(t.row,o.left-e.left,t.y-e.top,n,ow);return Hp(r,ew),r}))},iw=(e,t,o,n,r)=>{const s=Hr(o),l=t.isResizable,c=n.length>0?ts.positions(n,o):[],a=c.length>0?nw(e,l):[],i=P(c,((e,t)=>j(a,(e=>t===e))));aw(t,i,s,er(o));const m=r.length>0?ss.positions(r,o):[],d=m.length>0?rw(e,l):[],u=P(m,((e,t)=>j(d,(e=>t===e))));cw(t,u,s,Wr(o))},mw=(e,t)=>{if(sw(e),e.isResizable(t)){const o=Or.fromTable(t),n=Nr(o),r=kr(o);iw(o,e,t,n,r)}},dw=(e,t)=>{const o=oo(e.parent(),"."+Zb);_(o,t)},uw=e=>{dw(e,(e=>{ko(e,"display","none")}))},fw=e=>{dw(e,(e=>{ko(e,"display","block")}))},gw=e=>Vp(e,ew),hw=e=>Vp(e,tw),pw=Kb("resizer-bar-dragging"),bw=e=>{const t=Jb(),o=Ub(t,{});let n=k.none();const r=(e,t)=>k.from(je(e,t));t.events.drag.bind((e=>{r(e.target,"data-row").each((t=>{const o=Io(e.target,"top");ko(e.target,"top",o+e.yDelta+"px")})),r(e.target,"data-column").each((t=>{const o=Io(e.target,"left");ko(e.target,"left",o+e.xDelta+"px")}))}));const s=(e,t)=>{const o=Io(e,t),n=Lo(e,"data-initial-"+t,0);return o-n};o.events.stop.bind((()=>{t.get().each((t=>{n.each((o=>{r(t,"data-row").each((e=>{const n=s(t,"top");We(t,"data-initial-top"),f.trigger.adjustHeight(o,n,parseInt(e,10))})),r(t,"data-column").each((e=>{const n=s(t,"left");We(t,"data-initial-left"),f.trigger.adjustWidth(o,n,parseInt(e,10))})),mw(e,o)}))}))}));const l=(n,r)=>{f.trigger.startAdjust(),t.assign(n),Ae(n,"data-initial-"+r,Io(n,r)),Hp(n,pw),ko(n,"opacity","0.2"),o.go(e.parent())},c=fb(e.parent(),"mousedown",(e=>{gw(e.target)&&l(e.target,"top"),hw(e.target)&&l(e.target,"left")})),a=t=>Ke(t,e.view()),i=e=>uo(e,"table",a).filter(Na),m=fb(e.view(),"mouseover",(t=>{i(t.target).fold((()=>{Kt(t.target)&&sw(e)}),(t=>{n=k.some(t),mw(e,t)}))})),d=()=>{c.unbind(),m.unbind(),o.destroy(),sw(e)},u=t=>{mw(e,t)},f=wb({adjustHeight:bb(["table","delta","row"]),adjustWidth:bb(["table","delta","column"]),startAdjust:bb([])});return{destroy:d,refresh:u,on:o.on,off:o.off,hideBars:x(uw,e),showBars:x(fw,e),events:f.registry}},ww=(e,t,o)=>{const n=ts,r=ss,s=bw(e),l=wb({beforeResize:bb(["table","type"]),afterResize:bb(["table","type"]),startDrag:bb([])});return s.events.adjustHeight.bind((e=>{const t=e.table;l.trigger.beforeResize(t,"row");const o=n.delta(e.delta,t);mm(t,o,e.row,n),l.trigger.afterResize(t,"row")})),s.events.startAdjust.bind((e=>{l.trigger.startDrag()})),s.events.adjustWidth.bind((e=>{const n=e.table;l.trigger.beforeResize(n,"col");const s=r.delta(e.delta,n),c=o(n);im(n,s,e.column,t,c),l.trigger.afterResize(n,"col")})),{on:s.on,off:s.off,refreshBars:s.refresh,hideBars:s.hideBars,showBars:s.showBars,destroy:s.destroy,events:l.registry}},vw={create:ww},yw=(e,t)=>{const o=Oe(e)?Ze(e):e;return{parent:v(o),view:v(e),origin:v(Ir(0,0)),isResizable:t}},Cw=(e,t,o)=>{const n=()=>Hr(t);return{parent:v(t),view:v(e),origin:n,isResizable:o}},xw=(e,t,o)=>({parent:v(t),view:v(e),origin:v(Ir(0,0)),isResizable:o}),Sw={only:yw,detached:Cw,body:xw},Tw=()=>{const e=$e.fromTag("div");return Eo(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ut(Yt(),e),e},Rw=(e,t)=>e.inline?Sw.body($e.fromDom(e.getBody()),Tw(),t):Sw.only($e.fromDom(e.getDoc()),t),Dw=(e,t)=>{e.inline&&wt(t.parent())},Ow=e=>f(e)&&"TABLE"===e.nodeName,kw="bar-",Ew=e=>"false"!==je(e,"data-mce-resize"),Nw=e=>{const t=Or.fromTable(e);Or.hasColumns(t)||_(Uo(e),(e=>{const t=No(e,"width");ko(e,"width",t),We(e,"width")}))},Aw=e=>{const t=Mh(),o=Mh(),n=Mh();let r,s;const l=t=>yu(e,t),c=()=>iu(e)?ua():da(),a=e=>fa(e).columns,i=(t,o,n)=>{const i=yo(o,"e");if(""===s&&Qu(t),n!==r&&""!==s){ko(t,"width",s);const o=c(),m=l(t),d=iu(e)||i?a(t)-1:0;im(t,n-r,d,o,m)}else if($l(s)){const e=parseFloat(s.replace("%","")),o=n*e/r;ko(t,"width",o+"%")}ql(s)&&Nw(t)},m=()=>{o.on((e=>{e.destroy()})),n.on((t=>{Dw(e,t)}))};e.on("init",(()=>{const r=Rw(e,Ew);if(n.set(r),lu(e)&&hu(e)){const n=c(),s=vw.create(r,n,l);s.on(),s.events.startDrag.bind((o=>{t.set(e.selection.getRng())})),s.events.beforeResize.bind((t=>{const o=t.table.dom;Kd(e,o,Pl(o),Fl(o),kw+t.type)})),s.events.afterResize.bind((o=>{const n=o.table,r=n.dom;Ml(n),t.on((t=>{e.selection.setRng(t),e.focus()})),Yd(e,r,Pl(r),Fl(r),kw+o.type),e.undoManager.add()})),o.set(s)}})),e.on("ObjectResizeStart",(t=>{const o=t.target;if(Ow(o)){const n=$e.fromDom(o);_(e.dom.select(".mce-clonedresizable"),(t=>{e.dom.addClass(t,"mce-"+au(e)+"-columns")})),!Ku(n)&&fu(e)?Xu(n):!Gu(n)&&uu(e)&&Qu(n),Yu(n)&&vo(t.origin,kw)&&Qu(n),r=t.width,s=gu(e)?"":Hl(e,o).getOr("")}})),e.on("ObjectResized",(t=>{const o=t.target;if(Ow(o)){const n=$e.fromDom(o),r=t.origin;vo(r,"corner-")&&i(n,r,t.width),Ml(n),Vd(e,n.dom,Jd)}})),e.on("SwitchMode",(()=>{o.on((t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),e.on("remove",(()=>{m()}));const d=e=>{o.on((t=>t.refreshBars($e.fromDom(e))))},u=()=>{o.on((e=>e.hideBars()))},f=()=>{o.on((e=>e.showBars()))};return{refresh:d,hide:u,show:f}},zw=e=>{ru(e);const t=Aw(e),o=pb(e,t),n=Cu(e,t,o);return zf(e,n),Bf(e,n),Qc(e,n),{getSelectedCells:o.getSelectedCells,clearSelectedCells:o.clearSelectedCells}},Bw=e=>{const t=zw(e);return{table:t}};var jw=()=>{e.add("dom",Bw)};jw()})();